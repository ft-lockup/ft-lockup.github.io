(this["webpackJsonpft-lockup-contract-frontend"]=this["webpackJsonpft-lockup-contract-frontend"]||[]).push([[0],{240:function(e,t){},250:function(e,t){},301:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){"use strict";n.r(t);var a=n(57),r=n(31),c=n(18),o=n(17),s=n(8),i=n.n(s),l=n(2),u=n(50),d=n(389),p=n(194),b=n.n(p),j=n(23),h=n(25),f=n(20),m=n.n(f),x=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CONTRACT_NAME:"startup0.factory0.ft-lockup.testnet"}).DEFAULT_CONTRACT_NAME||"ft-lockup.demo008.ft-lockup.testnet",O=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CONTRACT_NAME:"startup0.factory0.ft-lockup.testnet"}).FACTORY_CONTRACT_NAME||"factory008.ft-lockup.testnet",v=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CONTRACT_NAME:"startup0.factory0.ft-lockup.testnet"}).FACTORY_CONTRACT_HASH||"DPDYZYHjRqLKZLGpvZYTLKudRrKWmN6a43Pc4MD2t9dg",g=function(){var e=window.location.hash.split("/")[1];return"new_lockup_contract"===e?O:e}();console.log(g);var k=function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CONTRACT_NAME:"startup0.factory0.ft-lockup.testnet"}).REACT_APP_ENVIRONMENT||"development";switch(e){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:g,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org",factoryContractName:O,factoryContractHash:v};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:g,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org",factoryContractName:O,factoryContractHash:v};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:g,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org",factoryContractName:O,factoryContractHash:v};case"local":return{explorerUrl:"",helperUrl:"",networkId:"local",nodeUrl:"http://localhost:3030",walletUrl:"http://localhost:4000/wallet",contractName:g,factoryContractName:O,factoryContractHash:v};case"test":case"ci":return{explorerUrl:"",helperUrl:"",walletUrl:"",networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:g,factoryContractName:O,factoryContractHash:v};case"ci-betanet":return{explorerUrl:"",helperUrl:"",walletUrl:"",networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:g,factoryContractName:O,factoryContractHash:v};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}(),w=3e14;m.a.DP=40,m.a.PE=40;var _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2?arguments[2]:void 0;return m.a.DP=40,m()(e||"0").div(Math.pow(10,24)).toFixed(0===t?void 0:t,n)},y=function(e){return new Date(1e3*e).toLocaleDateString("en-US")},C=function(e,t){return m()(e||"0").div(Math.pow(10,t)).toFixed(2)},S=function(e,t){return new Date(new Date(e).setFullYear(e.getFullYear()+t)).getTime()/1e3},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dump",t=Object.keys(localStorage).map((function(e){return[e,localStorage.getItem(e)]}));localStorage.setItem(e,JSON.stringify(t))},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dump",t=localStorage.getItem(e);if(t){var n=JSON.parse(t);localStorage.clear(),n.forEach((function(e){return localStorage.setItem(e[0],e[1])}))}},T=function(e){return"".concat(k.explorerUrl,"/transactions/").concat(e)},I=n(29),E=n(65),D=n(66),U=["get_draft_group","get_draft_groups_paged","get_drafts","get_lockups_paged","get_token_account_id","get_deposit_whitelist"],P=["create_draft","create_drafts","create_draft_group","convert_draft","convert_drafts","terminate"],F=function(){function e(t){Object(E.a)(this,e),this.near=void 0,this.contract=void 0,this.walletConnection=void 0,this.near=t,this.walletConnection=new I.WalletConnection(t,t.config.contractName),this.contract=new I.Contract(this.walletConnection.account(),this.near.config.contractName,{viewMethods:U,changeMethods:P})}return Object(D.a)(e,[{key:"getDraftGroupsAll",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.get_draft_groups_paged();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object.assign(a,{id:n})})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDraftGroup",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.get_draft_group({index:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDrafts",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.get_drafts({indices:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDraftGroup",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.create_draft_group();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createDraft",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.create_draft({draft:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDrafts",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.create_drafts({args:{drafts:t},gas:"200000000000000"});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertDraft",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.convert_draft({draft_id:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertDrafts",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.convert_drafts({args:{draft_ids:t},gas:"200000000000000"});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"terminate",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.contract.terminate({args:{lockup_index:t,termination_timestamp:n},gas:w,amount:1});case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),console.log(e.t0),Error("Cannot terminate lockup");case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNear",value:function(){return this.near}},{key:"getWalletConnection",value:function(){return this.walletConnection}},{key:"getContract",value:function(){return this.contract}},{key:"getTokenAccountId",value:function(){return this.contract.get_token_account_id()}},{key:"getDepositWhitelist",value:function(){return this.contract.get_deposit_whitelist()}},{key:"loadAllLockups",value:function(){return this.contract.get_lockups_paged().then((function(e){return e.map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object.assign(a,{id:n})}))}))}},{key:"signIn",value:function(){var e="".concat(window.location.href);this.walletConnection.requestSignIn(this.near.config.contractName,void 0,e)}},{key:"signOut",value:function(){this.walletConnection.signOut(),this.near.config.keyStore.clear()}},{key:"get_account_id",value:function(){return this.walletConnection.getAccountId()}},{key:"account",value:function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.near.account(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get_balance",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.account(t);case 2:return n=e.sent,a=null,e.prev=4,e.next=7,n.getAccountBalance();case 7:r=e.sent,c=r.total,a=parseFloat(I.utils.format.formatNearAmount(c||"0")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.error("Account not exist");case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}var c}),e,this,[[4,11]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),M=F,W=n(75),R=n(67),L=n(68),H=n(28),G=n.n(H),K=function(){var e=Object(W.a)(G.a.mark((function e(t,n){var a,r,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.query({request_type:"view_access_key_list",account_id:n,finality:"optimistic"});case 2:if(r=e.sent,null!==(a=r.keys)&&void 0!==a&&a.length){e.next=5;break}throw Error("None of access keys was founded");case 5:if(null!==(c=r.keys.filter((function(e){var t,n;return"string"===typeof(null===e||void 0===e||null===(t=e.access_key)||void 0===t?void 0:t.permission)&&"FullAccess"===(null===e||void 0===e||null===(n=e.access_key)||void 0===n?void 0:n.permission)})))&&void 0!==c&&c.length){e.next=8;break}throw Error("None of full access keys was founded");case 8:return e.abrupt("return",c[0]);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=K,V=[""],J=["claim"],Y=function(){function e(t){Object(R.a)(this,e),this.near=void 0,this.near=t}return Object(L.a)(e,[{key:"claim",value:function(){var e=Object(W.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(),e.next=3,this.setWalletAndContractWithAuth(t);case 3:return e.next=5,this.buildContract().claim({},w);case 5:this.near.config.keyStore.clean();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setWalletAndContractWithAuth",value:function(){var e=Object(W.a)(G.a.mark((function e(t){var n,a,r=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.near.config.contractName,e.next=3,B(this.near.connection.provider,t);case 3:a=e.sent,localStorage.setItem("".concat(n,"_wallet_auth_key"),JSON.stringify({accountId:t,allKeys:[a.public_key]}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"buildContract",value:function(){return new I.Contract(new I.WalletConnection(this.near,this.near.config.contractName).account(),this.near.config.contractName,{viewMethods:V,changeMethods:J})}}]),e}(),q=Y,z=[""],$=["storage_deposit"],Z=function(){function e(t){Object(E.a)(this,e),this.near=void 0,this.near=t}return Object(D.a)(e,[{key:"storageDeposit",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(),e.next=3,this.setWalletAndContractWithAuth(n);case 3:return e.next=5,this.buildContract(t).storage_deposit({args:{account_id:n},gas:w,amount:a});case 5:this.near.config.keyStore.clean();case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"setWalletAndContractWithAuth",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,a,r=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:this.near.config.contractName,e.next=3,B(this.near.connection.provider,t);case 3:a=e.sent,localStorage.setItem("".concat(n,"_wallet_auth_key"),JSON.stringify({accountId:t,allKeys:[a.public_key]}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"buildContract",value:function(e){return new I.Contract(new I.WalletConnection(this.near,this.near.config.contractName).account(),e,{viewMethods:z,changeMethods:$})}}]),e}(),Q=Z,X=n(199),ee=["msg"],te=3e14,ne=["ft_metadata","storage_balance_of","storage_balance_bounds"],ae=["ft_transfer_call","storage_deposit"],re=function(){function e(t,n){Object(E.a)(this,e),this.contract=void 0,this.contract=new I.Contract(t.account(),n,{viewMethods:ne,changeMethods:ae})}return Object(D.a)(e,[{key:"getContract",value:function(){return this.contract}},{key:"createLockup",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n,a,r,c){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ftTransferCall({receiver_id:t,amount:n.toString(),msg:{account_id:a,schedule:r,vesting_schedule:c?{Schedule:c}:null}});case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r,c){return e.apply(this,arguments)}}()},{key:"fundDraftGroup",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n,a){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ftTransferCall({receiver_id:t,amount:a,msg:{draft_group_id:n}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"ftTransferCall",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n,a,c,o,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:te,a=s.length>2&&void 0!==s[2]?s[2]:1,c=t.msg,o=Object(X.a)(t,ee),e.next=5,this.contract.ft_transfer_call(Object(r.a)({msg:JSON.stringify(c)},o),n,a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"storageDeposit",value:function(e,t){return this.contract.storage_deposit({args:{account_id:e},gas:te,amount:t})}},{key:"ftMetadata",value:function(){return this.contract.ft_metadata({})}},{key:"storageBalanceOf",value:function(e){return this.contract.storage_balance_of({account_id:e})}},{key:"storageBalanceBounds",value:function(){return this.contract.storage_balance_bounds()}}]),e}(),ce=re,oe=new m.a(4).mul(new m.a(10).pow(24)).toString(),se=["create"],ie=function(){function e(t,n,a){Object(R.a)(this,e),this.contract=void 0,this.hash=void 0,this.contract=new I.Contract(t.account(),n,{viewMethods:[],changeMethods:se}),this.hash=a}return Object(L.a)(e,[{key:"getContract",value:function(){return this.contract}},{key:"create",value:function(){var e=Object(W.a)(G.a.mark((function e(t,n,a,r){var c,o,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={token_account_id:n,deposit_whitelist:a},o=btoa(JSON.stringify(c)),e.next=4,this.contract.create({args:{name:t,hash:this.hash,access_keys:[],method_name:"new",args:o},callbackUrl:r,gas:3e14,amount:oe});case 4:return s=e.sent,console.log(s),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()}]),e}(),le=ie,ue=n(30),de=["call:AddProposal","*:AddProposal"],pe=["get_policy"],be=function(){function e(t,n){Object(E.a)(this,e),this.near=void 0,this.contract=void 0,this.near=t,this.contract=new I.Contract(new I.WalletConnection(this.near,n).account(),n,{viewMethods:pe,changeMethods:[]})}return Object(D.a)(e,[{key:"getContract",value:function(){return this.contract}},{key:"getCouncilMembers",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.get_policy();case 2:if(t=e.sent,0!==(n=t.roles.filter((function(e){var t,n;return(null===e||void 0===e||null===(t=e.permissions)||void 0===t?void 0:t.includes(de[0]))||(null===e||void 0===e||null===(n=e.permissions)||void 0===n?void 0:n.includes(de[1]))}))).length){e.next=6;break}return e.abrupt("return",[]);case 6:return a=n.map((function(e){var t;return null===e||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.Group})),e.abrupt("return",a.flat().filter((function(e){return e})));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),je=be,he=function(e,t,n,a,r,c,o,s,i,l){var u={details:a,smartContractAddress:r,methodName:c,json:o,actionsGas:s,gas:l,deposit:i};return"".concat("https://dev.app.astrodao.com","/dao/").concat(e,"/proposals?action=").concat(t,"&variant=").concat(n,"&params=").concat(JSON.stringify(u))},fe=function(e,t,n,a,r,c,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"300";return he(e,"create_proposal","ProposeCustomFunctionCall",t,n,a,r,c,o,s)},me=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new je(t,n),e.next=4,a.getCouncilMembers();case 4:return r=e.sent,e.abrupt("return",Object(ue.a)({},n,r));case 8:return e.prev=8,e.t0=e.catch(0),console.log("isDAO ERROR:",e.t0),e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(e,t,n,a,r,c){var o=encodeURIComponent(e),s={receiver_id:t,amount:a,msg:JSON.stringify({draft_group_id:r})};return fe(c,o,n,"ft_transfer_call",s,"100","0.000000000000000000000001")},Oe=function(e,t,n,a,r){var c=encodeURIComponent(e);return fe(r,c,t,"terminate",{lockup_index:n,termination_timestamp:a},"100","0.000000000000000000000001")},ve=Object(l.createContext)(null),ge=function(){var e=Object(c.a)(i.a.mark((function e(){var t,n,a,c,o,s,l,u,d,p,b,j,h,f,m,x,O,v,g,w,_;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.getItem("dump")&&A(),t=new I.keyStores.BrowserLocalStorageKeyStore,e.next=4,I.connect(Object(r.a)({headers:{},keyStore:t},k));case 4:return n=e.sent,a=new M(n),c=new I.keyStores.InMemoryKeyStore,e.next=9,I.connect(Object(r.a)({headers:{},keyStore:c},k));case 9:return o=e.sent,s=new q(o),l=new Q(o),u=new I.WalletConnection(n,k.contractName),d=u.getAccountId(),p="",b=!1,j=[],h=[],e.prev=18,e.next=21,a.getTokenAccountId();case 21:return p=e.sent,e.next=24,a.getDepositWhitelist();case 24:return j=e.sent,console.log("depositWhitelist",j),b=j.includes(d),console.log("isAdmin",b),e.next=30,Promise.all(j.map((function(e){return me(n,e)})));case 30:f=e.sent.filter((function(e){return!!e})),(null===(m=f.filter((function(e){return Object.values(e).pop().includes(d)})))||void 0===m?void 0:m.length)>0&&(h=m.map((function(e){return Object.keys(e).pop()||""}))),console.log("userDaosCouncils",m),console.log("councilMembers",f),console.log("daos",h),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(18),console.log(e.t0);case 41:return x=new ce(u,p),O=!1,v=window.location.hash.split("/")[1],e.prev=44,e.next=47,x.storageBalanceOf(v);case 47:g=e.sent,O=null!==g&&!0,console.log(O),e.next=55;break;case 52:e.prev=52,e.t1=e.catch(44),console.log(e.t1);case 55:return w=new le(u,k.factoryContractName,k.factoryContractHash),_=new I.providers.JsonRpcProvider(k.nodeUrl),e.abrupt("return",{config:k,api:a,tokenContractId:p,noLoginApi:s,tokenApi:x,factoryApi:w,currentUser:{signedIn:!!d,isAdmin:b,isCouncilMember:h.length>0,signedAccountId:d,daos:h},noLoginTokenApi:l,rpcProvider:_,isContractFtStoragePaid:O,lockupContractId:v});case 58:case"end":return e.stop()}}),e,null,[[18,38],[44,52]])})));return function(){return e.apply(this,arguments)}}(),ke=n(1);function we(e){var t=e.lockups,n=e.token_account_id;return Object(ke.jsxs)("div",{className:"container",children:[Object(ke.jsx)("h1",{children:"About Page"}),Object(ke.jsx)("pre",{children:"\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ".concat(k.contractName,"\n          token account id: ").concat(n,"\n\n          Total number of lockups: ").concat(t.length,"\n        ")})]})}var _e=n(362),ye=n(384),Ce=n(385),Se=n(386),Ne=n(387),Ae=n(388),Te=n(379),Ie=n(383),Ee=n(125),De=n.n(Ee),Ue=n(126),Pe=n.n(Ue);function Fe(e){var t=e.url,n=e.size;return Object(ke.jsx)("img",{style:{height:n,width:n,verticalAlign:"middle"},src:t,alt:"Token Icon"})}function Me(e){var t=e.schedule,n=e.title,a=e.token;return Object(ke.jsxs)("div",{className:"inner-table_wrapper",children:[Object(ke.jsx)("h5",{children:n}),Object(ke.jsxs)(ye.a,{className:"inner-table",size:"small","aria-label":"purchases",children:[Object(ke.jsx)(Ce.a,{children:Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{children:"DATE"}),Object(ke.jsx)(Ne.a,{align:"right",children:"AMOUNT"})]})}),Object(ke.jsx)(Ae.a,{children:t.map((function(e){return Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{component:"th",scope:"row",children:y(e.timestamp)}),Object(ke.jsxs)(Ne.a,{align:"right",children:[C(e.balance,a.decimals),"\xa0",a.symbol,"\xa0",Object(ke.jsx)(Fe,{url:a.icon||"",size:32})]})]},e.timestamp)}))})]})]})}function We(e){var t,n=Object(j.f)(),a=Object(l.useState)(!1),r=Object(o.a)(a,2),c=r[0],s=r[1],i=e.row,u=e.token,p=e.adminControls,b=e.progressShow;if(!Object(l.useContext)(ve).near)return null;var f=null===i||void 0===i||null===(t=i.vesting_schedule)||void 0===t?void 0:t.Schedule,m=n.pathname.split("/")[1],x="".concat(C(i.claimed_balance,u.decimals)),O="".concat(C(i.unclaimed_balance,u.decimals)),v="".concat(C(i.total_balance-i.claimed_balance-i.unclaimed_balance,u.decimals)),g="".concat(C(i.total_balance-i.total_balance,u.decimals));return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsxs)(Se.a,{className:c?"expanded exp-row":"exp-row",sx:{"& > *":{borderBottom:"unset"}},children:[Object(ke.jsx)(Ne.a,{children:Object(ke.jsx)(d.a,{"aria-label":"expand row",size:"small",onClick:function(){return s(!c)},children:c?Object(ke.jsx)(De.a,{}):Object(ke.jsx)(Pe.a,{})})}),Object(ke.jsx)(Ne.a,{align:"left",children:i.id}),Object(ke.jsx)(Ne.a,{align:"left",children:Object(ke.jsx)(h.b,{to:p?"".concat(m,"/admin/lockups/").concat(i.account_id):"".concat(m,"/lockups/").concat(i.account_id),children:i.account_id})}),Object(ke.jsx)(Ne.a,{align:"right",children:y(i.schedule[0].timestamp)}),Object(ke.jsx)(Ne.a,{align:"right",children:y(i.schedule[i.schedule.length-1].timestamp)}),Object(ke.jsxs)(Ne.a,{align:"right",children:[C(i.total_balance,u.decimals),"\xa0",u.symbol,"\xa0",Object(ke.jsx)(Fe,{url:u.icon||"",size:32})]}),b&&Object(ke.jsx)(Ne.a,{align:"center",children:Object(ke.jsx)(Te.a,{title:Object(ke.jsxs)("div",{className:"progress-bar__tooltip",children:[Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"claimed",children:"\xa0"}),Object(ke.jsx)("b",{children:x})," ","Claimed"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"available",children:"\xa0"}),Object(ke.jsx)("b",{children:O})," ","Available"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"vested",children:"\xa0"}),Object(ke.jsx)("b",{children:v})," ","Vested"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"unvested",children:"\xa0"}),Object(ke.jsx)("b",{children:g})," ","Unvested"]})]}),placement:"top",arrow:!0,children:Object(ke.jsxs)("div",{className:"progress-bar",children:[Object(ke.jsx)("div",{style:{width:"".concat(i.claimed_balance/i.total_balance*100,"%")},className:"claimed",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat(i.unclaimed_balance/i.total_balance*100,"%")},className:"available",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat((i.total_balance-i.claimed_balance-i.unclaimed_balance)/i.total_balance*100,"%")},className:"vested",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat(100*(i.total_balance-i.total_balance),"%")},className:"unvested",children:"\xa0"})]})})})]}),Object(ke.jsx)(Se.a,{sx:{background:"#F4F7FC"},children:Object(ke.jsx)(Ne.a,{style:{padding:0},colSpan:8,children:Object(ke.jsx)(Ie.a,{in:c,timeout:"auto",unmountOnExit:!0,children:Object(ke.jsx)("div",{className:"lockup-row",children:Object(ke.jsxs)("div",{style:{display:"flex",gap:20},children:[Object(ke.jsx)(Me,{schedule:i.schedule,title:"Lockup schedule",token:u}),f&&Object(ke.jsx)(Me,{schedule:f,title:"Vesting schedule",token:u})]})})})})})]})}function Re(e){var t=e.lockups,n=e.token,a=e.adminControls,r=e.progressShow;return Object(ke.jsxs)(ye.a,{className:"main-table","aria-label":"collapsible table",children:[Object(ke.jsx)(Ce.a,{className:"table-head",children:t.length>0&&Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{}),Object(ke.jsx)(Ne.a,{align:"left",children:"ID"}),Object(ke.jsx)(Ne.a,{align:"left",children:"Account ID"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Start\xa0date"}),Object(ke.jsx)(Ne.a,{align:"right",children:"End\xa0date"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Total\xa0amount"}),r&&Object(ke.jsx)(Ne.a,{align:"center",children:"Progress"})]})}),Object(ke.jsx)(Ae.a,{children:t.map((function(e){return Object(ke.jsx)(We,{row:e,token:n,adminControls:a,progressShow:r},e.id)}))})]})}var Le=n(198),He=n(190),Ge=n(36),Ke=n.n(Ge);Ke.a.prototype.toJSON=function(){return this.toString()};var Be=function(e){var t=e.trim().split("\n");if(t.length<=1)return[];var n=t.map((function(e){return e.split("\t").map((function(e){return e.trim()}))})),a=Object(He.a)(n),r=a[0];return a.slice(1).map((function(e){return Object.fromEntries(r.map((function(t,n){return[t,e[n]||""]})))}))},Ve=function(e){var t=Object(Le.a)(/^P(((((\d+)Y)?((\d+)M)?((\d+)D)?)(T((\d+)H)?((\d+)M)?((\d+)S)?)?)|((\d+)W)?)$/,{year:5,month:7,day:9,hour:12,minute:14,second:16,week:18}),n=e.match(t);if(!n)throw new Error("invalid duration");var a=n&&n.groups||{};return{year:parseInt(a.year,10)||0,month:parseInt(a.month,10)||0,week:parseInt(a.week,10)||0,day:parseInt(a.day,10)||0,hour:parseInt(a.hour,10)||0,minute:parseInt(a.minute,10)||0,second:parseInt(a.second,10)||0}},Je=function(e){var t=e.split("|");if(4!==t.length)throw new Error("invalid human friendly schedule, expected 4 parts");var n=Object(o.a)(t,4),a=n[0],r=n[1],c=n[2],s=n[3],i=function(e){if(!e.match(/\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\dZ/))throw new Error("invalid timestamp");var t=new Date(e);if(Number.isNaN(t.getTime()))throw new Error("invalid timestamp");return t}(a),l=Ve(r),u=function(e){var t=e.split(":");if(2!==t.length)throw new Error("expected 2 parts");var n=Object(o.a)(t,2),a=n[0],r=n[1],c=Ve(a),s=parseInt(r,10);if(s<0||s>100)throw new Error("invalid cliff percentage");return{duration:c,percentage:s}}(c),d=Ve(s);return{timestampStart:i,durationTotal:l,durationCliff:u.duration,percentageCliff:u.percentage,releaseEvery:d}},Ye=function(e){return{account_id:function(e){var t=!0;if(e.length<2&&(t=!1),e.length>64&&(t=!1),e.match(/^[a-z0-9._-]+$/)||(t=!1),t)return e;throw new Error("invalid near account id")}(e.account_id),amount:function(e){if(e.match(/^[0-9]+(\.[0-9]+)?$/))return e;throw new Error("invalid token amount")}(e.amount),lockup_schedule:Je(e.lockup_schedule),vesting_schedule:""===e.vesting_schedule?null:Je(e.vesting_schedule)}},qe=function(e,t,n){var a=Math.floor(n);return new Date(Date.UTC(e.getUTCFullYear()+t.year*a,e.getUTCMonth()+t.month*a,e.getUTCDate()+(7*t.week+t.day)*a,e.getUTCHours()+t.hour*a,e.getUTCMinutes()+t.minute*a,e.getUTCSeconds()+t.second*a))},ze=function(e){return Math.floor(new Date(e).getTime()/1e3)},$e=function(e,t,n){if(!(n>=0&&n===Math.floor(n)))throw new Error("invalid token decimals");var a=new m.a(10).pow(n),r=e.timestampStart,c=qe(r,e.durationCliff,1),o=qe(c,Ve("PT1S"),-1),s=qe(r,e.durationTotal,1),i=new Ke.a(new m.a(t).mul(a).round(0,m.a.roundDown).toString()),l=new Ke.a(i).muln(e.percentageCliff).divn(100).clone();if(l.gt(i))throw new Error("error: cliffAmount > totalAmount");if(c>s)throw new Error("error: timestampCliff > timestampFinish");if(c<r)throw new Error("error: timestampPreCliff < timestampStart");var u=e.releaseEvery,d=c,p=qe(c,u,1);if(ze(p)<=ze(d))throw new Error("invalid releaseEvery, zero duration");if(ze(p)-ze(d)===1){var b={timestamp:ze(r),balance:new Ke.a("0").toString()},j={timestamp:ze(o),balance:new Ke.a("0").toString()},h={timestamp:ze(c),balance:l.toString()},f={timestamp:ze(s),balance:i.toString()},x=[];return x.unshift(f),h.timestamp<f.timestamp&&x.unshift(h),x.unshift(j),b.timestamp<j.timestamp&&x.unshift(b),x}for(var O=[],v=c;;){if(v>=s){v=s,O.push(v);break}if(O.push(v),v=qe(v,u,1),O.length>=100)throw new Error("too many checkpoints for schedule")}var g=i.sub(l).divn(O.length-1),k=O.flatMap((function(e,t){if(1===O.length)return[{timestamp:ze(s),balance:i.toString()}];if(0===t)return[{timestamp:ze(e),balance:l.toString()}];var n=t===O.length-1?i:l.add(g.muln(t)).toString();return[{timestamp:ze(e)-1,balance:l.add(g.muln(t-1)).toString()},{timestamp:ze(e),balance:n.toString()}]})),w=[],_={timestamp:ze(r),balance:new Ke.a("0").toString()},y={timestamp:ze(o),balance:new Ke.a("0").toString()};return w.unshift(y),_.timestamp<y.timestamp&&w.unshift(_),w.concat(k)},Ze=function(e,t){return Be(e).map((function(e,n){return function(e,t,n){var a=Ye(e),r=null;return a.vesting_schedule&&(r={Schedule:$e(a.vesting_schedule,a.amount,t)}),{id:n,account_id:a.account_id,schedule:$e(a.lockup_schedule,a.amount,t),vesting_schedule:r}}(e,t,n)}))};var Qe=function(e){var t=e.token,n=e.adminControls,a=Object(j.f)(),r=Object(l.useContext)(ve).near,s=Object(l.useState)([]),d=Object(o.a)(s,2),p=d[0],b=d[1],h=Object(l.useState)(!1),f=Object(o.a)(h,2),m=f[0],x=f[1],O=Object(j.g)(),v=Object(u.b)().enqueueSnackbar,g=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),v("".concat(t," failed with error: '").concat(e.t0,"'"),{variant:"error"}),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(i.a.mark((function e(){var t,n,o,s,l,u,d,b;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("near is null");case 2:return x(!0),e.next=5,g("Create draft group",Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.api.createDraftGroup();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))));case 5:t=e.sent,n="Created draft group id: ".concat(t),v(n,{variant:"success"}),o=100,s=i.a.mark((function e(n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.slice(n,n+o),s=a.map((function(e){return{draft_group_id:t,lockup_create:e}})),e.next=4,g("Create drafts",Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.api.createDrafts(s);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})),l=0;case 11:if(!(l<p.length)){e.next=16;break}return e.delegateYield(s(l),"t0",13);case 13:l+=o,e.next=11;break;case 16:u="Created ".concat(p.length," draft").concat(p.length>1?"s":"","."),v(u,{variant:"success"}),d=a.pathname.split("/")[1],b="/".concat(d,"/admin/draft_groups/").concat(t),O(b);case 21:case"end":return e.stop()}}),e)}))(),"t0",2);case 2:e.next=7;break;case 4:e.prev=4,e.t1=e.catch(0),x(!1);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(){return e.apply(this,arguments)}}();return Object(ke.jsx)("div",{className:"main",children:Object(ke.jsxs)("div",{className:"container",children:[Object(ke.jsx)("h2",{children:"Import Draft Group"}),Object(ke.jsxs)("div",{className:"import-draft-group-wrapper",children:[Object(ke.jsxs)("p",{children:["Copy lockups from a spreadsheet editor and paste into the area below. See"," ",Object(ke.jsx)("a",{href:"".concat("","/lockup_import_example.xlsx"),children:"example and format specifications"}),"."]}),Object(ke.jsx)(_e.a,{className:"import-draft-group-textarea",id:"spreadsheet-input",placeholder:"Excel input",maxRows:5,onChange:function(e){try{var n;if(null===r||void 0===r||null===(n=r.currentUser)||void 0===n||!n.signedAccountId)throw new Error("expected present signedAccountId");console.log(t);var a=e.target.value,c=Ze(a,t.decimals);b(c)}catch(o){o instanceof Error&&console.log(o)}}})]}),Object(ke.jsx)(Re,{lockups:p,token:t,adminControls:n,progressShow:!1}),Object(ke.jsx)("button",{disabled:!(p.length>=1&&!m),onClick:k,type:"button",className:"button",children:"Import"})]})})},Xe=n(374),et=n(373);function tt(e){var t=e.token,n=e.amount;return Object(ke.jsxs)("div",{className:"token-info",children:[Object(ke.jsxs)("div",{className:"token-amount",children:[n," ",t.symbol]}),Object(ke.jsx)(Fe,{url:t.icon||"",size:32})]})}var nt=function(e){var t=Object(l.useContext)(ve).near,n=e.draftGroupIndex,a=e.amount;if(!t)throw Error("Cannot access lockup api");if(void 0===n)throw Error("Cannot fund draft group without index");if(void 0===a)throw Error("Cannot fund draft group without specified amount");return Object(ke.jsx)("button",{className:"button",type:"button",onClick:function(){t.tokenApi.fundDraftGroup(t.api.getContract().contractId,n,a)},children:"Fund"})},at=n(366),rt=n(367),ct=n(393),ot=n(394),st=n(71),it=n.n(st),lt=n(372),ut=n(377),dt=n(376),pt=n(378);var bt=function(e){var t=e.selectedAddress,n=e.setSelectedAddress,a=Object(l.useContext)(ve).near;if(!a)throw Error("Cannot access lockup api");var r=a.currentUser.daos;r.length>0&&(""===t||!r.includes(t))&&n(r[0]);var c=function(e){n(e.target.value)};return r.length>0?Object(ke.jsxs)("div",{children:[Object(ke.jsx)(ut.a,{children:"Select DAO contract address"}),Object(ke.jsx)(lt.a,{required:!0,sx:{marginBottom:3,width:1},value:t,onChange:c,children:r.map((function(e){return Object(ke.jsx)(dt.a,{value:e,children:e})}))})]}):Object(ke.jsx)(pt.a,{required:!0,sx:{marginBottom:3,width:1},id:"outlined-helperText",label:"DAO contract address",onChange:c})};var jt=function(e){var t=e.proposalDescription,n=e.setProposalDescription;return Object(ke.jsx)(pt.a,{sx:{width:1},id:"outlined-multiline-static",label:"Proposal description",multiline:!0,minRows:5,onChange:function(e){n(e.target.value)},defaultValue:t})};var ht=function(e){var t=Object(l.useContext)(ve).near,n=e.draftGroupIndex,a=e.amount,r="Fund draft group ".concat(n," with amount ").concat(null===a||void 0===a?void 0:a.label,". Draft group link: ").concat(window.location.href),c=Object(l.useState)(r),s=Object(o.a)(c,2),i=s[0],u=s[1],p=Object(l.useState)(""),b=Object(o.a)(p,2),j=b[0],h=b[1],f=Object(l.useState)(!1),m=Object(o.a)(f,2),x=m[0],O=m[1],v=function(){return O(!1)};if(!t)throw Error("Cannot access lockup api");if(void 0===n)throw Error("Cannot fund draft group without index");if(void 0===(null===a||void 0===a?void 0:a.value))throw Error("Cannot fund draft group without specified amount");return console.log("AMOUNT",a),Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)("button",{className:"button",type:"button",onClick:function(){return O(!0)},children:"Fund with DAO"}),Object(ke.jsx)(at.a,{open:x,sx:{padding:1,minWidth:1},onClose:v,children:Object(ke.jsxs)("form",{className:"form-submit",onSubmit:function(){var e,r=xe(i,t.api.getContract().contractId,t.tokenApi.getContract().contractId,a.value,n,j);null===(e=window.open(r,"_blank"))||void 0===e||e.focus()},children:[Object(ke.jsxs)(rt.a,{children:["Fund with DAO",Object(ke.jsx)(d.a,{"aria-label":"close",onClick:v,sx:{position:"absolute",right:8,top:8},children:Object(ke.jsx)(it.a,{})})]}),Object(ke.jsxs)(ct.a,{style:{minWidth:"320px",paddingTop:"1.25em"},children:[Object(ke.jsx)(bt,{selectedAddress:j,setSelectedAddress:h}),Object(ke.jsx)(jt,{proposalDescription:i,setProposalDescription:u})]}),Object(ke.jsx)(ot.a,{sx:{padding:"14px 24px 24px"},children:Object(ke.jsx)("button",{className:"button fullWidth noMargin",type:"submit",children:"Fund"})})]})})]})};function ft(e){var t=e.token,n=e.adminControls,a=Object(j.f)(),r=Object(u.b)().enqueueSnackbar,s=parseInt(Object(j.h)().draftGroupId||"",10),d=Object(l.useContext)(ve).near,p=Object(l.useState)(null),b=Object(o.a)(p,2),h=b[0],f=b[1],m=Object(l.useState)([]),x=Object(o.a)(m,2),O=x[0],v=x[1],g=Object(l.useState)(!1),k=Object(o.a)(g,2),w=k[0],_=k[1];console.log(t),console.log(h),console.log(f),Object(l.useEffect)((function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(null),console.log("fetchDraftGroup called"),d){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,d.api.getDraftGroup(s);case 6:t=e.sent,console.log(t),f(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[d,s]),Object(l.useEffect)((function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v([]),console.log("fetchDrafts called"),d){e.next=4;break}return e.abrupt("return");case 4:if(h){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,d.api.getDrafts(h.draft_indices);case 8:t=e.sent,console.log(t),v(t.map((function(e){return Object.assign(e[1].lockup_create,{id:e[0]})})));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[d,h]);var y=Object(j.g)(),S=function(){var e=Object(c.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),r("".concat(t," failed with error: '").concat(e.t0,"'"),{variant:"error"}),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();if(!h)return null;var N={value:h.total_amount,label:C(h.total_amount,t.decimals)||""};return Object(ke.jsxs)("div",{className:"container",children:[Object(ke.jsxs)("div",{className:"draft-group-preview-wrapper",children:[Object(ke.jsxs)("div",{className:"draft-group-preview-info",style:{display:"flex"},children:[Object(ke.jsx)("h5",{children:"Draft group ".concat(s)}),Object(ke.jsx)(tt,{token:t,amount:N.label})]}),!h.funded&&Object(ke.jsxs)("div",{className:"draft-group-fund-button-wrapper",children:[n&&Object(ke.jsx)(nt,{draftGroupIndex:s,amount:N.value}),Object(ke.jsx)(ht,{draftGroupIndex:s,amount:N})]}),h.funded&&h.draft_indices.length>0&&Object(ke.jsx)("div",{className:"draft-group-fund-button-wrapper",children:Object(ke.jsx)(et.a,{className:"button",type:"button",onClick:function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var t,n,o,l,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}throw new Error("near is null");case 2:e.prev=2,_(!0),t=h.draft_indices,n=100,o=i.a.mark((function e(a){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(a,a+n),e.next=3,S("Convert drafts",Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.api.convertDrafts(r);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)})),l=0;case 8:if(!(l<t.length)){e.next=13;break}return e.delegateYield(o(l),"t0",10);case 10:l+=n,e.next=8;break;case 13:r("Converted drafts for draft group ".concat(s),{variant:"success"}),u=a.pathname.split("/")[1],y("/".concat(u,"/admin/lockups")),window.location.reload(),e.next=22;break;case 19:e.prev=19,e.t1=e.catch(2),console.log("ERROR: ".concat(e.t1));case 22:return e.prev=22,_(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[2,19,22,25]])})));return function(){return e.apply(this,arguments)}}();e()},loading:w,variant:"contained",color:"success",children:"Convert"})}),h.funded&&0===h.draft_indices.length&&Object(ke.jsx)("div",{style:{marginTop:20},children:Object(ke.jsx)(Xe.a,{severity:"success",children:"Draft Group converted"})})]}),(!h.funded||h.draft_indices.length>0)&&Object(ke.jsx)(Re,{lockups:O,token:t,adminControls:n,progressShow:!0})]})}function mt(e){var t=e.token,n=e.adminControls,a=Object(j.f)();console.log(a);var r=Object(l.useContext)(ve).near,s=Object(l.useState)([]),u=Object(o.a)(s,2),d=u[0],p=u[1];Object(l.useEffect)((function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p([]),console.log("fetchDraftGroup called"),r){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,r.api.getDraftGroupsAll();case 6:t=e.sent,console.log(t),p(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r]);var b=a.pathname.split("/")[1],f="/".concat(b,"/admin/import_draft_group");return Object(ke.jsx)("div",{className:"main",children:Object(ke.jsxs)("div",{className:"container",children:[Object(ke.jsx)("h1",{children:"All draft groups"}),Object(ke.jsxs)(ye.a,{className:"main-table","aria-label":"collapsible table",children:[Object(ke.jsx)(Ce.a,{className:"table-head",children:Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{align:"center",children:"ID"}),Object(ke.jsx)(Ne.a,{align:"center",children:"Funded"}),Object(ke.jsx)(Ne.a,{align:"center",children:"Number\xa0of\xa0lockups"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Total\xa0amount"})]})}),Object(ke.jsx)(Ae.a,{children:d.map((function(e){return Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{align:"center",children:Object(ke.jsx)(h.b,{to:"/".concat(b,"/").concat(n?"admin/":"","draft_groups/").concat(e.id),children:e.id})}),Object(ke.jsx)(Ne.a,{align:"center",children:e.funded?"Yes":"No"}),Object(ke.jsx)(Ne.a,{align:"center",children:e.draft_indices.length}),Object(ke.jsxs)(Ne.a,{align:"right",children:[C(e.total_amount,t.decimals),"\xa0",t.symbol,"\xa0",Object(ke.jsx)(Fe,{url:t.icon||"",size:32})]})]})}))})]}),Object(ke.jsx)(h.b,{to:f,children:Object(ke.jsx)("button",{className:"button",type:"button",children:"Import Draft Group"})})]})})}var xt=n(395);function Ot(){var e=Object(u.b)().enqueueSnackbar,t=Object(l.useContext)(ve),n=t.near,a=t.signIn;return n?Object(ke.jsxs)("div",{children:[Object(ke.jsx)("div",{className:"header",children:Object(ke.jsx)("div",{className:"container",children:Object(ke.jsxs)(xt.a,{sx:{display:"flex"},children:[Object(ke.jsx)(h.b,{className:"logo",to:"/",children:"LOCKUPS"}),Object(ke.jsx)("div",{className:"nav",children:Object(ke.jsx)(h.b,{className:"nav-link",to:"/",children:"Home"})})]})})}),Object(ke.jsxs)("div",{className:"container new-lockup-contract",children:[Object(ke.jsx)("h2",{children:"Create Lockup Contract for your Fungible Tokens"}),Object(ke.jsx)("form",{className:"form-submit",onSubmit:function(t){t.preventDefault();var a=function(){var a=Object(c.a)(i.a.mark((function a(){var r,c,o,s,l;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,null!==n&&void 0!==n&&null!==(r=n.currentUser)&&void 0!==r&&r.signedAccountId){a.next=3;break}throw new Error("expected signedAccountId to be present");case 3:if(c=t.target.elements.lockup_operators.value.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0})),o=t.target.elements.token_account_id.value,s=t.target.elements.lockup_subaccount_id.value,0!==c.length){a.next=8;break}throw new Error("empty lockup operators");case 8:if(0!==o.length){a.next=10;break}throw new Error("empty tokenAccountId");case 10:if(0!==s.length){a.next=12;break}throw new Error("empty lockupSubaccountId");case 12:return a.next=14,n.factoryApi.create(s,o,c,"".concat(window.location.origin+window.location.pathname,"#/").concat(s,".").concat(O,"/admin/lockups"));case 14:return l=a.sent,console.log(l),a.abrupt("return",l);case 19:return a.prev=19,a.t0=a.catch(0),console.log(a.t0),e(a.t0.toString(),{variant:"error"}),a.abrupt("return",null);case 24:case"end":return a.stop()}}),a,null,[[0,19]])})));return function(){return a.apply(this,arguments)}}();a()},children:Object(ke.jsxs)("div",{className:"form-wrapper",children:[Object(ke.jsx)("p",{children:"On this page you can deploy your own copy of lockup contract. Some more elaborative description follows here."}),Object(ke.jsxs)("div",{className:"form-row",children:[Object(ke.jsx)("span",{children:"Contract creator: "}),Object(ke.jsxs)("div",{className:"form-cell",children:[n.currentUser.signedAccountId&&Object(ke.jsx)("strong",{children:n.currentUser.signedAccountId}),Object(ke.jsx)("button",{className:"button",type:"button",onClick:a,children:n.currentUser.signedAccountId?"Login as someone else":"Login"})]})]}),Object(ke.jsxs)("div",{className:"form-row",children:[Object(ke.jsx)("span",{children:"Lockup operators: "}),Object(ke.jsx)("input",{type:"text",id:"lockup_operators"})]}),Object(ke.jsxs)("div",{className:"form-row",children:[Object(ke.jsx)("span",{children:"Fungible token contract address: "}),Object(ke.jsx)("input",{type:"text",id:"token_account_id"})]}),Object(ke.jsxs)("div",{className:"form-row",children:[Object(ke.jsx)("span",{children:"New Lockup Contract Address: "}),Object(ke.jsx)("input",{type:"text",id:"lockup_subaccount_id"})]}),Object(ke.jsx)("button",{className:"button submit",type:"submit",disabled:!n.currentUser.signedAccountId,children:"Deploy Contract"})]})})]})]}):null}var vt=n(51),gt=n(397),kt=n(195);n(301);function wt(e){var t=e.data,n={title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{bottom:"3%",selectedMode:!1,icon:"circle"},grid:{top:"15%",left:"2%",right:"3%",bottom:"15%",containLabel:!0},xAxis:[{type:"time",boundaryGap:["1%","1%"],splitNumber:15}],yAxis:[{type:"value"}],series:[{name:"Vested",type:"line",color:"#0069D1",areaStyle:{opacity:1},markLine:{data:[[{xAxis:new Date,yAxis:0},{xAxis:new Date,yAxis:"max"}]],lineStyle:{type:"dashed",color:"#FF594E"},symbol:"none"},data:t.vested},{name:"Unlocked",type:"line",color:"#00B988",areaStyle:{opacity:1},data:t.unlocked}]};return Object(ke.jsx)(kt.a,{option:n})}var _t=n(396),yt=n(392),Ct=n(369),St=n(191),Nt=n(370);function At(e){var t=e.token,n=Object(l.useContext)(ve).near,a=Object(l.useState)(!1),s=Object(o.a)(a,2),u=s[0],p=s[1],b=Object(l.useState)(null),j=Object(o.a)(b,2),h=j[0],f=j[1],x=Object(l.useState)("4_year"),O=Object(o.a)(x,2),v=O[0],g=O[1],k=function(){return p(!1)},w=function(){var e=Object(c.a)(i.a.mark((function e(a){var r,c,s,l,u,d,p,b,j,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw Error("Cannot access token api");case 2:if(n.currentUser.signedAccountId){e.next=4;break}throw new Error("signedAccountId requred to set lockup terminator");case 4:if(h){e.next=6;break}throw Error("Start date not set");case 6:a.preventDefault(),r=a.target.elements,c=r.account,s=r.amount,console.log(c.value,s.value),l=(null===n||void 0===n?void 0:n.api.getContract().contractId)||"",u=c.value,d=new m.a(s.value).mul(new m.a(10).pow(t.decimals)).round(0,m.a.roundDown).toString(),p=function(e,t,n){var a=new Ke.a(t),r={"4y_cliff_1y_25":[{timestamp:S(e,0),balance:"0"},{timestamp:S(e,1)-1,balance:"0"},{timestamp:S(e,1),balance:a.divn(4).toString()},{timestamp:S(e,4),balance:a.toString()}]};return{"4_year":[r["4y_cliff_1y_25"],null],"4_year_vested":[r["4y_cliff_1y_25"],r["4y_cliff_1y_25"]]}[n]}(h,d,v),b=Object(o.a)(p,2),j=b[0],f=b[1],n.tokenApi.createLockup(l,d.toString(),u,j,f);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)("button",{className:"button",type:"button",onClick:function(){return p(!0)},children:"Create Lockup"}),Object(ke.jsx)(at.a,{open:u,sx:{padding:2},maxWidth:"xs",onClose:k,children:Object(ke.jsxs)("form",{className:"form-submit",onSubmit:w,children:[Object(ke.jsxs)(rt.a,{children:["Create Lockup",Object(ke.jsx)(d.a,{"aria-label":"close",onClick:k,sx:{position:"absolute",right:8,top:8},children:Object(ke.jsx)(it.a,{})})]}),Object(ke.jsxs)(ct.a,{sx:{maxWidth:"320px"},children:[Object(ke.jsx)(pt.a,{margin:"normal",id:"account",label:"Account Id",type:"text",fullWidth:!0,variant:"standard"}),Object(ke.jsx)(pt.a,{margin:"normal",id:"amount",label:"Amount",type:"number",variant:"standard",InputProps:{endAdornment:Object(ke.jsx)(_t.a,{position:"end",children:t.symbol})},fullWidth:!0}),Object(ke.jsx)("br",{}),Object(ke.jsx)(yt.a,{fullWidth:!0,sx:{marginTop:"20px"},children:Object(ke.jsxs)(lt.a,{id:"schedule-select",value:v,label:"Schedule",onChange:function(e){g(e.target.value)},variant:"standard",fullWidth:!0,children:[Object(ke.jsx)(dt.a,{value:"4_year",children:"4 year lockup with 25% cliff in 1 year"}),Object(ke.jsx)(dt.a,{value:"4_year_vested",children:"4 year lockup with 25% cliff in 1 year (VESTED)"})]})}),Object(ke.jsx)(St.a,{dateAdapter:Ct.a,children:Object(ke.jsx)(Nt.a,{label:"Start date",value:h,onChange:function(e){f(e)},renderInput:function(e){return Object(ke.jsx)(pt.a,Object(r.a)({margin:"normal",fullWidth:!0,variant:"standard"},e))}})})]}),Object(ke.jsx)(ot.a,{sx:{padding:"14px 24px 24px"},children:Object(ke.jsx)("button",{disabled:!h,className:"button fullWidth noMargin",type:"submit",children:"Create"})})]})})]})}var Tt=function(e){var t=e.currentState,n=e.handlers,a=e.dialog;return Object(ke.jsx)(at.a,{open:t.value,sx:{padding:2},maxWidth:"xs",onClose:n.onClose,children:Object(ke.jsxs)("form",{className:"form-submit",children:[Object(ke.jsxs)(rt.a,{children:["Terminate Lockup",Object(ke.jsx)(d.a,{"aria-label":"close",onClick:n.onClose,sx:{position:"absolute",right:8,top:8},children:Object(ke.jsx)(it.a,{})})]}),Object(ke.jsxs)(ct.a,{sx:{maxWidth:"320px"},children:[Object(ke.jsxs)(St.a,{dateAdapter:Ct.a,children:[a.datePicker&&Object(ke.jsx)(Nt.a,{label:"Custom termination date",minDate:new Date,value:a.datePicker.currentState.value,onChange:function(e){a.datePicker.currentState.setValue(e)},renderInput:function(e){return Object(ke.jsx)(pt.a,Object(r.a)({sx:{margin:"0px 0 24px"},margin:"normal",fullWidth:!0,variant:"standard"},e))}}),(null===a||void 0===a?void 0:a.daoSelector)&&Object(ke.jsx)(bt,{selectedAddress:a.daoSelector.currentState.value,setSelectedAddress:a.daoSelector.currentState.setValue}),(null===a||void 0===a?void 0:a.daoProposalDescription)&&Object(ke.jsx)(jt,{proposalDescription:a.daoProposalDescription.currentState.value,setProposalDescription:a.daoProposalDescription.currentState.setValue})]}),Object(ke.jsx)("span",{style:{minHeight:"40px"}}),Object(ke.jsx)("button",{className:"button red fullWidth",style:{marginTop:"40px"},type:"button",onClick:n.onSubmit,children:"Terminate"})]})]})})};var It=function(e){var t=Object(l.useContext)(ve).near,n=e.adminControls,a=e.lockupIndex,s=e.config,d=e.token,p=e.buttonText,b=Object(u.b)().enqueueSnackbar,j=Object(l.useState)(null),h=Object(o.a)(j,2),f=h[0],x=h[1],O=Object(l.useState)(!1),v=Object(o.a)(O,2),g=v[0],k=v[1];if(!t)throw Error("Cannot access lockup api");if(void 0===a)throw Error("Cannot terminate lockup without lockupIndex");var w=function(){var e=Object(c.a)(i.a.mark((function e(){var n,r,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=2;break}return e.abrupt("return");case 2:return n=f?f.getTime()/1e3:null,e.next=5,t.api.terminate(a,n);case 5:r=e.sent,c=new m.a(r).div(new m.a(10).pow(d.decimals)).round(2,m.a.roundDown),console.log(c),o="Terminated lockup #".concat(a,", refunded ").concat(c," ").concat(d.symbol),b(o,{variant:"success"}),setTimeout((function(){return window.location.reload()}),1e3);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=n&&s,y={currentState:{value:g,setValue:k},handlers:{onClose:function(){return k(!1)},onSubmit:w},dialog:{datePicker:{currentState:{value:f,setValue:x}}}};return Object(ke.jsxs)(ke.Fragment,{children:[_&&Object(ke.jsx)("button",{className:"button",type:"button",onClick:function(){return k(!0)},children:p}),g&&Object(ke.jsx)(Tt,Object(r.a)({},y))]})};var Et=function(e){var t=Object(l.useContext)(ve).near,n=e.adminControls,a=e.lockupIndex,c=e.config,s=e.buttonText,i=Object(l.useState)(null),u=Object(o.a)(i,2),d=u[0],p=u[1],b=Object(l.useState)(!1),j=Object(o.a)(b,2),h=j[0],f=j[1],m="Terminate lockup ".concat(a,". Lockup link: ").concat(window.location.href),x=Object(l.useState)(m),O=Object(o.a)(x,2),v=O[0],g=O[1],k=Object(l.useState)((null===c||void 0===c?void 0:c.beneficiary_id)||""),w=Object(o.a)(k,2),_=w[0],y=w[1];if(!t)throw Error("Cannot access lockup api");if(void 0===a)throw Error("Cannot terminate lockup without lockupIndex");var C=n&&c,S={currentState:{value:h,setValue:f},handlers:{onClose:function(){return f(!1)},onSubmit:function(){var e,n=Oe(v,t.api.getContract().contractId,a,d?d.getTime()/1e3:null,_);null===(e=window.open(n,"_blank"))||void 0===e||e.focus()}},dialog:{datePicker:{currentState:{value:d,setValue:p}},daoSelector:{currentState:{value:_,setValue:y}},daoProposalDescription:{currentState:{value:v,setValue:g}}}};return Object(ke.jsxs)("div",{children:[Object(ke.jsx)("button",{className:"button",disabled:!C,type:"button",onClick:function(){return f(!0)},style:{marginTop:0},children:s}),h&&Object(ke.jsx)(Tt,Object(r.a)({},S))]})};function Dt(e){var t,n,a,r,c=Object(l.useState)(!1),s=Object(o.a)(c,2),i=s[0],u=s[1],p=e.adminControls,b=e.row,j=e.token,f=Object(l.useContext)(ve).near;if(!f)return null;var m,x,O=null===b||void 0===b||null===(t=b.termination_config)||void 0===t||null===(n=t.vesting_schedule)||void 0===n?void 0:n.Schedule,v=window.location.href.split("/").pop()===b.account_id,g="".concat(C(b.claimed_balance,j.decimals)),k="".concat(C(b.unclaimed_balance,j.decimals)),w="".concat(C(b.total_balance-b.claimed_balance-b.unclaimed_balance,j.decimals)),_="".concat(C(b.total_balance-b.total_balance,j.decimals));null!==(a=b.termination_config)&&void 0!==a&&a.beneficiary_id?m="Unvested amount will return to ".concat(null===(x=b.termination_config)||void 0===x?void 0:x.beneficiary_id):m="This lockup cannot be terminated";var S,N,A,T=null===b||void 0===b||null===(r=b.termination_config)||void 0===r?void 0:r.beneficiary_id;return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsxs)(Se.a,{className:i?"expanded exp-row":"exp-row",sx:{"& > *":{borderBottom:"unset"}},children:[Object(ke.jsx)(Ne.a,{children:Object(ke.jsx)(d.a,{"aria-label":"expand row",size:"small",onClick:function(){return u(!i)},children:i?Object(ke.jsx)(De.a,{}):Object(ke.jsx)(Pe.a,{})})}),Object(ke.jsx)(Ne.a,{align:"left",children:b.id}),Object(ke.jsx)(Ne.a,{align:"left",children:Object(ke.jsx)(h.b,{to:"".concat(v?"":b.account_id),children:b.account_id})}),Object(ke.jsx)(Ne.a,{align:"right",children:y(b.schedule[0].timestamp)}),Object(ke.jsx)(Ne.a,{align:"right",children:y(b.schedule[b.schedule.length-1].timestamp)}),Object(ke.jsx)(Ne.a,{align:"center",children:O?"Yes":"No"}),Object(ke.jsxs)(Ne.a,{align:"right",children:[C(b.total_balance,j.decimals),"\xa0",j.symbol,"\xa0",Object(ke.jsx)(Fe,{url:j.icon||"",size:32})]}),Object(ke.jsx)(Ne.a,{align:"center",children:Object(ke.jsx)(Te.a,{title:Object(ke.jsxs)("div",{className:"progress-bar__tooltip",children:[Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"claimed",children:"\xa0"}),Object(ke.jsx)("b",{children:g})," ","Claimed"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"available",children:"\xa0"}),Object(ke.jsx)("b",{children:k})," ","Available"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"vested",children:"\xa0"}),Object(ke.jsx)("b",{children:w})," ","Vested"]}),Object(ke.jsxs)("span",{children:[Object(ke.jsx)("i",{className:"unvested",children:"\xa0"}),Object(ke.jsx)("b",{children:_})," ","Unvested"]})]}),placement:"top",arrow:!0,children:Object(ke.jsxs)("div",{className:"progress-bar",children:[Object(ke.jsx)("div",{style:{width:"".concat(b.claimed_balance/b.total_balance*100,"%")},className:"claimed",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat(b.unclaimed_balance/b.total_balance*100,"%")},className:"available",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat((b.total_balance-b.claimed_balance-b.unclaimed_balance)/b.total_balance*100,"%")},className:"vested",children:"\xa0"}),Object(ke.jsx)("div",{style:{width:"".concat(100*(b.total_balance-b.total_balance),"%")},className:"unvested",children:"\xa0"})]})})})]}),Object(ke.jsx)(Se.a,{sx:{background:"#F4F7FC"},children:Object(ke.jsx)(Ne.a,{style:{padding:0},colSpan:8,children:Object(ke.jsx)(Ie.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(ke.jsx)("div",{className:"lockup-row",children:Object(ke.jsxs)("div",{style:{display:"flex",gap:20},children:[Object(ke.jsx)(Me,{schedule:b.schedule,title:"Lockup schedule",token:j}),O&&Object(ke.jsx)(Me,{schedule:O,title:"Vesting schedule",token:j}),Object(ke.jsxs)("div",{className:"terminate",children:[Object(ke.jsx)("span",{className:"fine-print",children:m}),(S=T,N=f.currentUser.signedAccountId,A=f.currentUser.daos,N&&S===N?Object(ke.jsx)(It,{token:j,adminControls:p,lockupIndex:b.id,config:b.termination_config,buttonText:S?"Terminate":"No termination config"}):A.includes(S)?Object(ke.jsx)(Et,{token:j,adminControls:p,lockupIndex:b.id,config:b.termination_config,buttonText:S?"Terminate with Dao":"No termination config"}):null)]})]})})})})})]})}function Ut(e){var t=e.lockups,n=e.token,a=e.adminControls;return Object(ke.jsxs)(ye.a,{className:"main-table","aria-label":"collapsible table",children:[Object(ke.jsx)(Ce.a,{className:"table-head",children:Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{}),Object(ke.jsx)(Ne.a,{align:"left",children:"ID"}),Object(ke.jsx)(Ne.a,{align:"left",children:"Account ID"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Start\xa0date"}),Object(ke.jsx)(Ne.a,{align:"right",children:"End\xa0date"}),Object(ke.jsx)(Ne.a,{align:"center",children:"Terminatable"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Total\xa0amount"}),Object(ke.jsx)(Ne.a,{align:"center",children:"Progress"})]})}),Object(ke.jsx)(Ae.a,{children:t.map((function(e){return Object(ke.jsx)(Dt,{row:e,token:n,adminControls:a},e.id)}))})]})}function Pt(e){var t=e.tokenContractId,n=e.favouriteAccounts,a=e.uniqueUsers,r=e.onSave;console.log("unique users",a);var c=Object(l.useRef)(null),o=function(e){return e.replaceAll(" ","").split(",")},s=function(){var e,n=function(e){return JSON.stringify({favouriteAccounts:e})};if(null===c||void 0===c||null===(e=c.current)||void 0===e||!e.value)return localStorage.setItem(t,n([])),void r([]);var a=o(c.current.value);r(a),localStorage.setItem(t,n(a))};return Object(ke.jsx)("div",{style:{display:"flex",marginBottom:"2em"},children:Object(ke.jsx)(pt.a,{inputProps:{sx:{margin:0}},size:"small",sx:{width:1,padding:0,margin:0},id:"outlined-helperText",label:"My accounts",placeholder:"Comma separated list of your near accounts",defaultValue:n.join(", "),inputRef:c,onKeyPress:function(e){return"Enter"===e.key&&s()},onChange:function(e){var t=e.target.value,a=o(t).filter((function(e){return e.match(/.*(\.)(near|testnet)$/)}));n.toString()!==a.toString()&&s()}})})}var Ft=function(e,t,n){return{timestamp:n,balance:function(e,t,n,a,r){if(n<=e)throw new Error("invalid range");if(r<e||r>=n)throw new Error("xM out of bound");return t+(a-t)*(r-e)/(n-e)}(e.timestamp,parseFloat(e.balance),t.timestamp,parseFloat(t.balance),n).toString()}},Mt=function(e,t){if(0===e.length)throw new Error("empty schedule");if(t<e[0].timestamp)return{timestamp:t,balance:e[0].balance};if(t>=e[e.length-1].timestamp)return{timestamp:t,balance:e[e.length-1].balance};for(var n=0;n<e.length-1;n++)if(!(e[n+1].timestamp<=t))return Ft(e[n],e[n+1],t);throw new Error("unreachable")},Wt=function(e){if(0===e.length)throw new Error("schedules is empty");var t=Array.from(new Set(e.flat().map((function(e){return e.timestamp})).sort((function(e,t){return e-t})))),n=[];return t.forEach((function(t){for(var a=new f.Big(0),r=0;r<e.length;r++){var c=new f.Big(Mt(e[r],t).balance);a=a.plus(c)}n.push({timestamp:t,balance:a.toString()})})),n};function Rt(e){var t,n=e.lockups,a=e.token,r=e.adminControls,c=Array.from(new Set(n.map((function(e){return e.account_id})))),s=Object(l.useContext)(ve).near,i=s.currentUser,u=i.signedIn,d=i.isAdmin,p=localStorage.getItem(a.contractId),b=p?null===(t=JSON.parse(p))||void 0===t?void 0:t.favouriteAccounts:[],j=Object(l.useState)(b),f=Object(o.a)(j,2),m=f[0],x=f[1],O=n.filter((function(e){return m.includes(e.account_id)})),v=function(e){var t,n=Array.from(e.map((function(e){return e.schedule}))),r=Math.round((new Date).getTime()/1e3),c=e.map((function(e){return e.schedule[0].timestamp})),o=e.map((function(e){var t,n;return null===e||void 0===e||null===(t=e.termination_config)||void 0===t||null===(n=t.vesting_schedule[0])||void 0===n?void 0:n.timestamp})).filter((function(e){return e})),s=Math.min.apply(Math,Object(vt.a)(c).concat(Object(vt.a)(o),[r])),i=Array.from(e.map((function(e){var t,n,a,r,c=null===e||void 0===e||null===(t=e.termination_config)||void 0===t||null===(n=t.vesting_schedule)||void 0===n?void 0:n.Schedule;return c||(c||(a=s,r=e.schedule[e.schedule.length-1].balance,[{timestamp:a-1,balance:"0"},{timestamp:a,balance:r}]))}))),l=Wt(i),u=Wt(n);(null===(t=l[l.length-1])||void 0===t?void 0:t.timestamp)!==u[u.length-1].timestamp&&l.push(u[u.length-1]);var d=function(e,t){return e.map((function(e){return[1e3*e.timestamp,C(e.balance,t)]}))};return{unlocked:e.length?d(u,a.decimals):[],vested:e.length?d(l,a.decimals):[]}},g=function(e){return e.length>0?Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(wt,{data:v(e)}),u&&r&&d&&Object(ke.jsx)(At,{token:a}),Object(ke.jsx)(gt.a,{sx:{boxShadow:"unset",margin:"0 0 20px"},children:Object(ke.jsx)(Ut,{lockups:e,token:a,adminControls:r})})]}):Object(ke.jsxs)("div",{children:["There are no lockups yet.",r&&Object(ke.jsxs)("div",{children:["Create single lockup or create batch of them via"," ",Object(ke.jsx)(h.b,{to:"/".concat(s.lockupContractId,"/admin/import_draft_group"),children:"Draft Groups"}),"."]})]})};return console.log("favouriteAccountsLockups",O),r?Object(ke.jsx)("div",{className:"main",children:Object(ke.jsx)("div",{className:"container",children:g(n)})}):Object(ke.jsx)("div",{className:"main",children:Object(ke.jsxs)("div",{className:"container",children:[Object(ke.jsx)(Pt,{tokenContractId:a.contractId,favouriteAccounts:m,uniqueUsers:c,onSave:x}),g(O)]})})}var Lt=n(381);function Ht(e){var t=e.message,n=e.isOpen,a=e.closeFn,r=e.callback;return Object(ke.jsxs)(at.a,{open:n,sx:{padding:2},maxWidth:"md",onClose:a,children:[Object(ke.jsxs)(rt.a,{children:["Confirmation",Object(ke.jsx)(d.a,{"aria-label":"close",sx:{position:"absolute",right:8,top:8},onClick:a,children:Object(ke.jsx)(it.a,{})})]}),Object(ke.jsx)(ct.a,{sx:{minWidth:"320px"},children:Object(ke.jsx)("div",{children:t})}),Object(ke.jsxs)(ot.a,{children:[Object(ke.jsx)(Lt.a,{color:"error",onClick:a,children:"Cancel"}),Object(ke.jsx)(Lt.a,{color:"success",variant:"contained",onClick:function(){a(),r()},children:"Confirm"})]})]})}var Gt=function(e){var t=Object(l.useContext)(ve).near,n=e.accountId,a=e.token,r=e.total,s=Object(l.useState)(!1),u=Object(o.a)(s,2),d=u[0],p=u[1],b=Object(l.useState)((function(){return null})),j=Object(o.a)(b,2),h=j[0],f=j[1];if(!t)throw Error("Cannot access lockup api");if(!n)throw Error("Undefined account cannot claim");var m="\n    Your account doesn't have storage deposit on the token contract. You will be redirected to pay for the storage, after that you will be able to claim your tokens.\n  ".trim();return Object(ke.jsxs)("div",{className:"claim-wrapper",children:[Object(ke.jsx)("h5",{children:"Total available"}),Object(ke.jsx)(tt,{token:a,amount:r}),Object(ke.jsx)("button",{className:"button fullWidth",type:"button",onClick:function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var a,r,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(t.tokenApi){e.next=4;break}return e.abrupt("return");case 4:if(t.noLoginTokenApi){e.next=6;break}return e.abrupt("return");case 6:if(t.tokenContractId){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.tokenApi.storageBalanceOf(n);case 10:if(a=e.sent,!(null!==a&&!0)){e.next=16;break}t.noLoginApi.claim(n),e.next=23;break;case 16:return e.next=18,t.tokenApi.storageBalanceBounds();case 18:r=e.sent,c=r.max,o=function(){t.noLoginTokenApi.storageDeposit(t.tokenContractId,n,c)},f((function(){return o})),p(!0);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()},children:"Claim All"}),Object(ke.jsx)(Ht,{message:m,isOpen:d,closeFn:function(){return p(!1)},callback:h})]})};function Kt(e){var t=e.lockups,n=e.token,a=e.adminControls,r=Object(j.h)().userId,c=t.filter((function(e){return e.account_id===r})),o=c.reduce((function(e,t){return e+parseFloat(t.unclaimed_balance)}),0);return console.log("user lockups",r,c),Object(ke.jsxs)("div",{className:"container",children:[!a&&Object(ke.jsx)(Gt,{accountId:r,token:n,total:C(o,n.decimals)}),Object(ke.jsx)(gt.a,{sx:{boxShadow:"unset"},children:Object(ke.jsxs)(ye.a,{className:"main-table","aria-label":"collapsible table",children:[Object(ke.jsx)(Ce.a,{className:"table-head",children:Object(ke.jsxs)(Se.a,{children:[Object(ke.jsx)(Ne.a,{}),Object(ke.jsx)(Ne.a,{align:"left",children:"ID"}),Object(ke.jsx)(Ne.a,{align:"left",children:"Account ID"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Start\xa0date"}),Object(ke.jsx)(Ne.a,{align:"right",children:"End\xa0date"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Terminatable"}),Object(ke.jsx)(Ne.a,{align:"right",children:"Total\xa0amount"}),Object(ke.jsx)(Ne.a,{align:"center",children:"Progress"})]})}),Object(ke.jsx)(Ae.a,{children:c.map((function(e){return Object(ke.jsx)(Dt,{row:e,token:n,adminControls:a},e.id)}))})]})})]})}function Bt(e){var t=e.adminControls,n=Object(j.f)(),a=n.pathname.split("/")[1],r=Object(l.useContext)(ve),c=r.near,o=r.signOut;if(Object(l.useEffect)((function(){return console.log(n.pathname),function(){}}),[n]),!c)return null;var s=c.currentUser,i=s.signedIn,u=s.signedAccountId,d=s.isAdmin,p=s.isCouncilMember,b=t&&(d||p);return Object(ke.jsx)("div",{className:"header",children:Object(ke.jsx)("div",{className:"container",children:Object(ke.jsxs)(xt.a,{sx:{display:"flex"},children:[Object(ke.jsx)(h.b,{className:"logo",to:"/",children:"LOCKUPS"}),Object(ke.jsxs)("div",{className:"nav",children:[Object(ke.jsx)(h.c,{className:"nav-link",to:"/".concat(a,b?"/admin/lockups":"/lockups"),children:"Lockups"}),Object(ke.jsx)(h.c,{className:"nav-link",to:"/".concat(a,t?"/admin/draft_groups":"/draft_groups"),children:"Lockup Drafts"}),Object(ke.jsx)(h.c,{className:"nav-link",to:"/".concat(a,t?"/admin/about":"/about"),children:"About"})]}),t&&i&&Object(ke.jsxs)(xt.a,{sx:{marginTop:"23px"},children:[Object(ke.jsx)("span",{className:"account-name",children:u}),Object(ke.jsx)("button",{className:"button",type:"button",onClick:o,children:"Log out"})]})]})})})}function Vt(e){var t=e.children;return Object(ke.jsx)("div",{className:"container login",children:t})}var Jt=function(){var e=Object(l.useContext)(ve),t=e.near,n=e.signIn;if(!t)return null;var a=t.currentUser,r=a.signedIn,c=a.isAdmin,o=a.isCouncilMember,s=r&&!(c||o),i=r&&(c||o);return Object(ke.jsxs)(Vt,{children:[s&&Object(ke.jsx)(Xe.a,{sx:{margin:2,width:"500px"},severity:"error",children:"You are not admin"}),!r&&Object(ke.jsx)("button",{className:"button",type:"button",onClick:n,children:"Sign In"}),i&&Object(ke.jsx)(j.a,{to:"lockups",replace:!0})]})};function Yt(){var e=Object(l.useContext)(ve).near;return Object(ke.jsx)("div",{children:Object(ke.jsxs)("div",{style:{maxWidth:640,margin:"auto",paddingTop:20},children:[Object(ke.jsx)("p",{children:"Please pay for the account storage in fungible token contract. This is necessary to allow lockup contract to hold locked fungible token funds. This is a one time payment for the lockup contract. Additionally, all users claiming lockups will have to pay for the storage for their account too."}),Object(ke.jsx)("button",{className:"button fullWidth",type:"button",onClick:function(){var t=function(){var t=Object(c.a)(i.a.mark((function t(){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if(e.tokenApi){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.tokenApi.storageBalanceBounds();case 6:return n=t.sent,a=n.max,console.log(a),t.next=11,e.tokenApi.storageDeposit(e.lockupContractId,a);case 11:r=t.sent,console.log(r);case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()},children:"Pay"})]})})}function qt(e){var t=e.children,n=Object(j.f)(),a=Object(l.useContext)(ve).near;if(!a)return null;var r=a.currentUser,c=r.signedIn,o=r.isAdmin,s=r.isCouncilMember,i=n.pathname.split("/")[1];return c&&(o||s)?a.isContractFtStoragePaid?t:Object(ke.jsx)("div",{className:"container",children:Object(ke.jsx)(Yt,{})}):Object(ke.jsx)(j.a,{to:"/".concat(i,"/admin"),replace:!0})}var zt=n(193),$t=n.n(zt);function Zt(e){var t=e.lockups,n=Object(l.useState)(x),a=Object(o.a)(n,2),r=a[0],c=a[1],s=Object(j.g)();return Object(ke.jsxs)("div",{className:"root",children:[Object(ke.jsx)("div",{className:"header",children:Object(ke.jsx)("div",{className:"container",children:Object(ke.jsx)(xt.a,{sx:{display:"flex"},children:Object(ke.jsx)(h.b,{className:"logo",to:"/",children:"LOCKUPS"})})})}),Object(ke.jsx)("div",{className:"main",children:Object(ke.jsxs)("div",{className:"container home",children:[Object(ke.jsxs)("ul",{className:"home-list",children:[Object(ke.jsx)("li",{children:Object(ke.jsxs)("div",{children:[Object(ke.jsx)("span",{children:"Total contracts"}),Object(ke.jsx)("b",{children:"256"})]})}),Object(ke.jsx)("li",{children:Object(ke.jsxs)("div",{children:[Object(ke.jsx)("span",{children:"Total locked"}),Object(ke.jsx)("b",{children:"$5,336,000"})]})}),Object(ke.jsx)("li",{children:Object(ke.jsxs)("div",{children:[Object(ke.jsx)("span",{children:"Total lockups"}),Object(ke.jsx)("b",{children:(null===t||void 0===t?void 0:t.length)||42})]})})]}),Object(ke.jsx)("h2",{children:"Manage token vesting on NEAR"}),Object(ke.jsx)("p",{children:"Create new lockup contract to be used by startup"}),Object(ke.jsx)(h.b,{to:"/new_lockup_contract",className:"button link-button",children:"Create Lockup Contract"}),Object(ke.jsx)("div",{className:"line"}),Object(ke.jsxs)("div",{className:"search-container",children:[Object(ke.jsx)(pt.a,{variant:"outlined",value:r,onChange:function(e){c(e.target.value)},className:"input",placeholder:"Enter existing Lockup contract address",InputProps:{startAdornment:Object(ke.jsx)(_t.a,{position:"start",children:Object(ke.jsx)($t.a,{})})}}),Object(ke.jsx)("button",{className:"button",onClick:function(){var e="/".concat(r,"/lockups");s(e),window.location.reload()},"aria-label":"open",type:"button",children:"Search"})]})]})})]})}function Qt(){return Object(ke.jsx)("div",{className:"container",children:"Contract not found"})}n(304);function Xt(){var e=Object(j.f)(),t=e.pathname,n=e.pathname.includes("admin"),a=t.indexOf("/",1),r="".concat(t.substring(0,a),"/admin").concat(t.substring(a,t.length));return Object(l.useContext)(ve).near?Object(ke.jsx)("div",{className:"footer",children:Object(ke.jsx)("div",{className:"container",children:Object(ke.jsx)(xt.a,{sx:{display:"flex"},children:Object(ke.jsxs)("div",{className:"nav",children:[Object(ke.jsx)(h.b,{className:"nav-link",to:"/terms",children:"Terms"}),Object(ke.jsx)(h.b,{className:"nav-link",to:"/privacy",children:"Privacy"}),n?Object(ke.jsx)(h.b,{className:"nav-link",to:t.replace(/\/admin/,""),children:"User view"}):Object(ke.jsx)(h.b,{className:"nav-link",to:r,children:"Admin view"})]})})})}):null}function en(e){var t=e.lockups,n=e.token,a=e.contractId,c=e.near;return t?Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(Bt,{adminControls:!1}),Object(ke.jsxs)(j.d,{children:[Object(ke.jsx)(j.b,{path:"/",element:Object(ke.jsx)(j.a,{replace:!0,to:"lockups"})}),Object(ke.jsx)(j.b,{path:"/about",element:Object(ke.jsx)(we,{lockups:t,token_account_id:a})}),Object(ke.jsx)(j.b,{path:"/lockups",element:a&&c&&Object(ke.jsx)(Rt,{lockups:t,token:Object(r.a)(Object(r.a)({},n),{},{contractId:a}),adminControls:!1})}),Object(ke.jsx)(j.b,{path:"/lockups/:userId",element:Object(ke.jsx)(Kt,{lockups:t,token:n,adminControls:!1})}),Object(ke.jsx)(j.b,{path:"/draft_groups",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(mt,{token:n,adminControls:!1})})}),Object(ke.jsx)(j.b,{path:"/draft_groups/:draftGroupId",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(ft,{token:n,adminControls:!1})})})]})]}):null}function tn(e){var t=e.lockups,n=e.token,a=e.tokenContractId,c=e.near;if(!t)return null;var o=a&&c;return Object(ke.jsxs)(ke.Fragment,{children:[Object(ke.jsx)(Bt,{adminControls:!0}),Object(ke.jsxs)(j.d,{children:[Object(ke.jsx)(j.b,{path:"/",element:Object(ke.jsx)(Jt,{})}),Object(ke.jsx)(j.b,{path:"/about",element:Object(ke.jsx)(we,{lockups:t,token_account_id:a})}),Object(ke.jsx)(j.b,{path:"/lockups",element:o&&Object(ke.jsx)(qt,{children:Object(ke.jsx)(Rt,{lockups:t,token:Object(r.a)(Object(r.a)({},n),{},{contractId:a}),adminControls:!0})})}),Object(ke.jsx)(j.b,{path:"/lockups/:userId",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(Kt,{lockups:t,token:n,adminControls:!0})})}),Object(ke.jsx)(j.b,{path:"/draft_groups",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(mt,{token:n,adminControls:!0})})}),Object(ke.jsx)(j.b,{path:"/draft_groups/:draftGroupId",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(ft,{token:n,adminControls:!0})})}),Object(ke.jsx)(j.b,{path:"/import_draft_group",element:Object(ke.jsx)(qt,{children:Object(ke.jsx)(Qe,{token:n,adminControls:!0})})})]})]})}function nn(){var e=Object(u.b)().enqueueSnackbar,t=Object(l.useContext)(ve).near,n=Object(l.useState)({}),a=Object(o.a)(n,2),r=a[0],s=a[1],d=Object(l.useState)(null),p=Object(o.a)(d,2),b=p[0],f=p[1],x=Object(l.useState)({decimals:0,icon:null,name:"",reference:null,reference_hash:null,spec:"",symbol:""}),O=Object(o.a)(x,2),v=O[0],g=O[1];Object(l.useEffect)((function(){if(e&&t&&v&&""!==v.spec){var n=function(){var n=Object(c.a)(i.a.mark((function n(){var a,r,c,o,s,l,u,d,p,b,j,h,f,x,O,g,k,w,y,C,S,N,A,I,E,D;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=new URLSearchParams(window.location.search),r=a.get("transactionHashes")){n.next=4;break}return n.abrupt("return");case 4:return c=r.split(",")[0],console.log("txHash",c),n.next=8,t.rpcProvider.txStatus(c,"sender.testnet");case 8:if(o=n.sent,console.log(o),s=o.transaction.actions[0].FunctionCall.method_name,l=o.status.SuccessValue,u=JSON.parse(atob(o.transaction.actions[0].FunctionCall.args)),"claim"!==s){n.next=22;break}if(!l){n.next=20;break}if("0"===(d=JSON.parse(atob(l)))){n.next=20;break}return p=new m.a(d).div(new m.a(10).pow(v.decimals)).round(2,m.a.roundDown),e("Claimed ".concat(p," ").concat(v.symbol),{variant:"success"}),n.abrupt("return");case 20:return e("Claim failed: ".concat(T(c)),{variant:"error"}),n.abrupt("return");case 22:if("storage_deposit"!==s){n.next=30;break}return b=JSON.parse(atob(l)),j=parseFloat(_(b.total,9)).toString(),console.log(j),h=u.account_id,f="Successfully paid ".concat(j,"N for FT storage of ").concat(h),e(f,{variant:"success"}),n.abrupt("return");case 30:if("ft_transfer_call"!==s){n.next=58;break}if(x=JSON.parse(u.msg),console.log(x),!x.schedule){n.next=45;break}if(O=JSON.parse(atob(l)),g=new m.a(O).div(new m.a(10).pow(v.decimals)).round(2,m.a.roundDown),console.log(g),x.schedule[x.schedule.length-1].balance!==O){n.next=42;break}return k="Created lockup for ".concat(x.account_id," with amount ").concat(g," ").concat(v.symbol),e(k,{variant:"success"}),n.abrupt("return");case 42:return w="Failed to create lockup for ".concat(x.account_id,": ").concat(T(c)),e(w,{variant:"error"}),n.abrupt("return");case 45:if(null===x.draft_group_id){n.next=56;break}if(y=JSON.parse(atob(l)),C=new m.a(y).div(new m.a(10).pow(v.decimals)).round(2,m.a.roundDown),console.log(C),"0"===y){n.next=53;break}return S="Funded draft group ".concat(x.draft_group_id," with amount ").concat(C," ").concat(v.symbol),e(S,{variant:"success"}),n.abrupt("return");case 53:return N="Failed to fund draft group ".concat(x.draft_group_id,": ").concat(T(c)),e(N,{variant:"error"}),n.abrupt("return");case 56:return e("Transaction performed, TODO ".concat(c,"!"),{variant:"warning"}),n.abrupt("return");case 58:if("terminate"!==s){n.next=68;break}if(!l){n.next=66;break}return A=JSON.parse(atob(l)),console.log(A),I=new m.a(A).div(new m.a(10).pow(v.decimals)).round(2,m.a.roundDown),E="Terminated lockup #".concat(u.lockup_index,", unvested amount: ").concat(I),e(E,{variant:"success"}),n.abrupt("return");case 66:return e("Terminate lockup failed: ".concat(T(c)),{variant:"error"}),n.abrupt("return");case 68:D='UNHANDLED Transaction "'.concat(s,'" : ').concat(T(c)),e(D,{variant:"warning"});case 70:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}}),[e,t,v]),Object(l.useEffect)((function(){var e=!0;if(t){var n=function(){var n=Object(c.a)(i.a.mark((function n(){var a,r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.api.loadAllLockups();case 2:return a=n.sent,n.next=5,t.tokenApi.ftMetadata();case 5:if(r=n.sent,e){n.next=8;break}return n.abrupt("return");case 8:g(r),s({lockups:a,name:"name"});case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();t.tokenContractId&&n()}return function(){e=!1}}),[t]),Object(l.useEffect)((function(){return t&&t.tokenApi&&f(t.tokenApi.getContract().contractId),function(){}}),[t]);var k=r.lockups;return Object(ke.jsxs)(h.a,{children:[Object(ke.jsxs)(j.d,{children:[Object(ke.jsx)(j.b,{path:"/",element:Object(ke.jsx)(Zt,{lockups:k})}),Object(ke.jsx)(j.b,{path:"/new_lockup_contract/",element:Object(ke.jsx)(Ot,{})}),Object(ke.jsx)(j.b,{path:"/:cid/*",element:b&&t&&Object(ke.jsx)(en,{lockups:k,token:v,contractId:b,near:t})}),Object(ke.jsx)(j.b,{path:"/:cid/admin/*",element:b&&t&&Object(ke.jsx)(tn,{lockups:k,token:v,tokenContractId:b,near:t})}),Object(ke.jsx)(j.b,{path:"/:cid/not_found_contract/",element:Object(ke.jsx)(Qt,{})}),Object(ke.jsx)(j.b,{path:"*",element:Object(ke.jsx)(Qt,{})})]}),Object(ke.jsx)(Xt,{})]})}n(305);function an(e){var t=e.snackbarKey,n=Object(u.b)().closeSnackbar;return Object(ke.jsx)(d.a,{onClick:function(){return n(t)},children:Object(ke.jsx)(b.a,{style:{color:"white"}})})}function rn(){var e=Object(l.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1];Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}try{!function(){e.apply(this,arguments)}()}catch(t){console.log(t)}}),[]);var s=Object(l.useMemo)((function(){return{near:n,signIn:function(){var e;null===n||void 0===n||null===(e=n.api)||void 0===e||e.signIn()},signOut:function(){n&&(n.api.signOut(),a(Object(r.a)(Object(r.a)({},n),{},{currentUser:{signedIn:!1,signedAccountId:null,isAdmin:!1,isCouncilMember:!1,daos:[]}})))}}}),[n]);return Object(ke.jsx)(l.StrictMode,{children:Object(ke.jsx)(ve.Provider,{value:s,children:Object(ke.jsx)(u.a,{autoHideDuration:null,action:function(e){return Object(ke.jsx)(an,{snackbarKey:e})},onClose:function(){var e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("transactionHashes"),e.search=t.toString(),console.log(e),window.history.pushState({},null,e.toString())},children:Object(ke.jsx)(nn,{})})})})}Object(a.render)(Object(ke.jsx)(rn,{}),document.getElementById("root"))}},[[306,1,2]]]);
//# sourceMappingURL=main.c32dc86d.chunk.js.map