{"version":3,"sources":["config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/tokenApi.ts","services/factoryApi.ts","services/near.ts","pages/About/index.tsx","components/TokenIcon/index.tsx","components/ScheduleTable/index.tsx","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","services/spreadsheetImport.ts","components/ProcessLog/index.tsx","components/ImportDraftGroup/index.tsx","components/TokenAmountPreview/index.tsx","components/FundButton/index.tsx","pages/PageDraftGroup/index.tsx","pages/PageDraftGroupsIndex/index.tsx","components/Header/index.tsx","pages/NewLockupContract/index.tsx","components/CreateLockup/index.tsx","components/TerminateLockup/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","pages/Lockups/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Authorize/index.tsx","components/RequireAuth/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["FACTORY_CONTRACT_NAME","process","FACTORY_CONTRACT_HASH","CONTRACT_NAME","window","location","hash","split","console","log","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","factoryContractName","factoryContractHash","Error","getConfig","MAX_GAS","Big","DP","PE","convertTimestamp","time","Date","toLocaleDateString","convertAmount","value","decimals","div","toFixed","addYear","date","year","setFullYear","getFullYear","getTime","dumpLocalStorage","dumpKey","dumpValue","Object","keys","localStorage","map","key","getItem","setItem","JSON","stringify","restoreLocalStorage","data","parse","clear","forEach","record","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","convert_draft","draft_id","convert_drafts","draft_ids","lockupIndex","timestamp","terminate","lockup_index","termination_timestamp","get_token_account_id","get_deposit_whitelist","get_lockups_paged","then","response","successUrl","href","requestSignIn","undefined","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","amount","total","parseFloat","utils","format","formatNearAmount","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","length","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","TokenApi","contractId","lockupContractId","draftGroupId","ftTransferCall","receiver_id","msg","draft_group_id","meta","gas","deposit","rest","ft_transfer_call","ft_metadata","DEPLOY_DEPOSIT","mul","pow","toString","FACTORY_CHANGE_METHODS","FactoryApi","name","tokenAccountId","depositWhitelist","argsRaw","token_account_id","deposit_whitelist","argsPacked","btoa","create","access_keys","method_name","args","NearContext","createContext","connectNear","nearAPI","BrowserLocalStorageKeyStore","headers","api","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","signedAccountId","tokenContractId","isAdmin","getTokenAccountId","getDepositWhitelist","includes","tokenApi","factoryApi","signedIn","About","lockups","className","TokenIcon","params","url","size","style","height","width","verticalAlign","src","alt","ScheduleTable","schedule","title","token","Table","TableHead","TableRow","TableCell","align","TableBody","x","component","scope","symbol","icon","DraftsTableRow","props","useState","open","setOpen","row","useContext","vestingSchedule","termination_config","vesting_schedule","Schedule","sx","borderBottom","IconButton","onClick","to","total_balance","claimed_balance","unclaimed_balance","background","padding","colSpan","Collapse","in","timeout","unmountOnExit","display","gap","DraftsTable","lockup","BN","prototype","toJSON","parseSpreadsheetColumns","input","lines","trim","table","line","columns","fromEntries","col","colIdx","parseDuration","pattern","match","groups","parseInt","month","week","day","hour","minute","second","parseHumanFriendlySchedule","parts","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","durationRaw","percentageRaw","duration","percentage","parseCliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","isValid","parseValidAccountId","parseTokenAmount","lockup_schedule","datePlusDurationMul","mulInput","Math","floor","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","toUnix","toLockupSchedule","inputTotalAmount","tokenDecimals","decimalsMultiplier","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","round","roundDown","cliffAmount","muln","divn","clone","gt","tmCliff","tmFirstStep","cpStart","cpPreCliff","cpCliff","cpFinish","unshift","tms","tm","push","increment","sub","cps","flatMap","i","stepBalance","add","cpsStart","concat","parseRawSpreadsheetInput","spreadsheetInput","payerId","rawSpreadsheetRow","terminationConfig","payer_id","parseLockup","ProcessLog","inProgress","LinearProgress","color","marginTop","ImportDraftGroup","setData","importLog","setImportLog","importProgress","setImportProgress","message","currentLog","navigate","useNavigate","handleClickImport","createDraftGroup","chunkSize","chunk","slice","createDrafts","TextareaAutosize","placeholder","maxRows","onChange","event","target","e","disabled","type","TokenAmountPreview","flex","alignContent","FundButton","draftGroupIndex","fundDraftGroup","getContract","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","processLog","setProcessLog","setInProgress","oldLog","useEffect","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","total_amount","funded","convertDrafts","draftIds","Alert","severity","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","group","Header","adminControls","Box","NewLockupContract","signIn","onSubmit","preventDefault","perform","lockupOperators","elements","lockup_operators","lockupSubaccountId","lockup_subaccount_id","CreateLockup","startDate","setStartDate","setSchedule","handleClose","handleCreateLockup","userAccountId","lockupTotalAmount","balanceInput","selected","schedules","getScheduleList","lockupSchedule","Dialog","maxWidth","onClose","DialogTitle","position","right","top","DialogContent","TextField","margin","label","fullWidth","variant","InputProps","endAdornment","InputAdornment","FormControl","Select","MenuItem","LocalizationProvider","dateAdapter","AdapterDateFns","DatePicker","newValue","renderInput","DialogActions","TerminateLockup","setDate","payerMessage","handleTerminateLockup","ts","reload","canTerminate","minDate","Row","LockupsTable","Lockups","uniqueUsers","Array","from","Set","TableContainer","boxShadow","Paper","ClaimAllLockups","UserLockups","allLockups","userId","totalUnclaimedBalance","reduce","acc","obj","Claim","Auth","children","Authorize","replace","RequireAuth","useLocation","state","Customer","path","element","Admin","App","contractState","setContractState","setContractId","reference","reference_hash","spec","setToken","active","load","loadAllLockups","ftMetadata","metadata","NearApp","setNear","nearConn","connect","useMemo","Provider","render","document","getElementById"],"mappings":"ySAYMA,EAAwBC,iMAAYD,uBAAyB,6BAC7DE,EAAwBD,iMAAYC,uBAAyB,+CAEtDC,EAAgBC,OAAOC,SAASC,KAAKC,MAAM,KAAK,IAAM,sCAEnEC,QAAQC,IAAIN,GAgFL,IAAMO,EA7Eb,WACE,IAAMC,EAAMV,iMAAYW,uBAAyB,cACjD,OAAQD,GACN,IAAK,aACL,IAAK,UACH,MAAO,CACLE,UAAW,UACXC,QAAS,+BACTC,aAAcZ,EACda,UAAW,0BACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,IAAK,cACL,IAAK,UACH,MAAO,CACLW,UAAW,UACXC,QAAS,+BACTC,aAAcZ,EACda,UAAW,kCACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,IAAK,UACH,MAAO,CACLW,UAAW,UACXC,QAAS,+BACTC,aAAcZ,EACda,UAAW,kCACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,IAAK,QACH,MAAO,CACLgB,YAAa,GACbD,UAAW,GACXJ,UAAW,QACXC,QAAS,wBACTE,UAAW,+BACXD,aAAcZ,EACdgB,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,IAAK,OACL,IAAK,KACH,MAAO,CACLgB,YAAa,GACbD,UAAW,GACXD,UAAW,GACXH,UAAW,cACXC,QAAS,kCACTC,aAAcZ,EACdgB,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,IAAK,aACH,MAAO,CACLgB,YAAa,GACbD,UAAW,GACXD,UAAW,GACXH,UAAW,sBACXC,QAAS,kCACTC,aAAcZ,EACdgB,oBAAqBnB,EACrBoB,oBAAqBlB,GAEzB,QACE,MAAMmB,MAAM,6BAAD,OAA8BV,EAA9B,4CAIKW,G,iBC/FTC,EAAU,KAEvBC,IAAIC,GAAK,GACTD,IAAIE,GAAK,GACF,IAkBMC,EAAmB,SAACC,GAAD,OAAkB,IAAIC,KAAY,IAAPD,GAAaE,mBAAmB,UAC9EC,EAAgB,SAACC,EAAeC,GAAhB,OAAqCT,IAAIQ,GAAS,KAAKE,IAAlB,SAAsB,GAAMD,IAAUE,QAnBvE,IAqBpBC,EAAU,SAACC,EAAYC,GAAb,OAA8B,IAAIT,KAAK,IAAIA,KAAKQ,GAAME,YAAaF,EAAKG,cAAiBF,IAAOG,UAAY,KAEtHC,EAAmB,WAA+B,IAA9BC,EAA6B,uDAAX,OAC3CC,EAAYC,OAAOC,KAAKC,cAAcC,KAAI,SAACC,GAAD,MAAS,CAACA,EAAKF,aAAaG,QAAQD,OAEpFF,aAAaI,QAAQR,EAASS,KAAKC,UAAUT,KAGlCU,EAAsB,WAA+B,IAA9BX,EAA6B,uDAAX,OAC9CY,EAAOR,aAAaG,QAAQP,GAElC,GAAKY,EAAL,CAIA,IAAMX,EAAYQ,KAAKI,MAAMD,GAE7BR,aAAaU,QAEbb,EAAUc,SAAQ,SAACC,GAAD,OAAqBZ,aAAaI,QAAQQ,EAAO,GAAIA,EAAO,S,gBCtC1EC,EAAsB,CAC1B,kBACA,yBACA,aACA,oBACA,uBACA,yBAGIC,EAAwB,CAC5B,eACA,gBACA,qBACA,gBACA,iBACA,aA4DIC,E,WAOJ,WAAYC,GAAa,yBANjBA,UAMgB,OAJhBC,cAIgB,OAFhBC,sBAEgB,EACtBC,KAAKH,KAAOA,EACZG,KAAKD,iBAAmB,IAAIE,mBAAiBJ,EAAMA,EAAKrD,OAAOK,cAC/DmD,KAAKF,SAAW,IAAII,WAClBF,KAAKD,iBAAiBI,UACtBH,KAAKH,KAAKrD,OAAOK,aACjB,CAAEuD,YAAaV,EAAqBW,cAAeV,I,4FAIvD,4BAAAW,EAAA,sEACuBN,KAAKF,SAASS,yBADrC,cACQC,EADR,yBAESA,EAAO1B,KAAI,mCAAE2B,EAAF,KAAcC,EAAd,YAAqC/B,OAAOgC,OAAOD,EAAO,CAAEE,GAAIH,QAFpF,gD,wHAKA,WAAoBI,GAApB,eAAAP,EAAA,sEACuBN,KAAKF,SAASgB,gBAAgB,CAAED,UADvD,cACQL,EADR,yBAGSA,GAHT,gD,qHAMA,WAAgBO,GAAhB,eAAAT,EAAA,sEACuBN,KAAKF,SAASkB,WAAW,CAAED,YADlD,cACQP,EADR,yBAGSA,GAHT,gD,4HAMA,4BAAAF,EAAA,sEACuBN,KAAKF,SAASmB,qBADrC,cACQT,EADR,yBAESA,GAFT,gD,sHAKA,WAAkBE,GAAlB,eAAAJ,EAAA,sEACuBN,KAAKF,SAASoB,aAAa,CAAER,UADpD,cACQF,EADR,yBAGSA,GAHT,gD,wHAMA,WAAmBW,GAAnB,eAAAb,EAAA,sEACuBN,KAAKF,SAASsB,cAAc,CAAED,UAAU,mBAD/D,cACQX,EADR,yBAGSA,GAHT,gD,wHAMA,WAAmBK,GAAnB,eAAAP,EAAA,sEACuBN,KAAKF,SAASuB,cAAc,CAAEC,SAAUT,IAD/D,cACQL,EADR,yBAGSA,GAHT,gD,yHAMA,WAAoBO,GAApB,eAAAT,EAAA,sEACuBN,KAAKF,SAASyB,eAAe,CAAEC,UAAWT,GAAW,mBAD5E,cACQP,EADR,yBAGSA,GAHT,gD,qHAMA,WAAgBiB,EAAqBC,GAArC,eAAApB,EAAA,+EAEyBN,KAAKF,SAAS6B,UACjC,CAAEC,aAAcH,EAAaI,sBAAuBH,GACpDrE,GAJN,cAEUmD,EAFV,yBAMWA,GANX,sCAQUrD,MAAM,2BARhB,yD,8EAYA,WACE,OAAO6C,KAAKH,O,iCAGd,WACE,OAAOG,KAAKD,mB,yBAGd,WACE,OAAOC,KAAKF,W,+BAGd,WACE,OAAQE,KAAKF,SAA6BgC,yB,iCAG5C,WACE,OAAQ9B,KAAKF,SAA6BiC,0B,4BAG5C,WACE,OAAQ/B,KAAKF,SAA6BkC,oBAAoBC,MAC5D,SAACC,GAAD,OAAmBA,EAASpD,KAAI,mCAAE8B,EAAF,KAAMvB,EAAN,YAA+BV,OAAOgC,OAAOtB,EAAM,CAAEuB,e,oBAIzF,WACE,IAAMuB,EAAU,UAAMjG,OAAOC,SAASiG,MACtCpC,KAAKD,iBAAiBsC,cAAcrC,KAAKH,KAAKrD,OAAOK,kBAAcyF,EAAWH,K,qBAGhF,WACEnC,KAAKD,iBAAiBwC,UACtBvC,KAAKH,KAAKrD,OAAOgG,SAASjD,U,4BAG5B,WACE,OAAOS,KAAKD,iBAAiB0C,iB,4DAG/B,WAAcC,GAAd,SAAApC,EAAA,+EACSN,KAAKH,KAAKM,QAAQuC,IAD3B,gD,uHAIA,WAAkBA,GAAlB,mBAAApC,EAAA,sEACwBN,KAAKG,QAAQuC,GADrC,cACQvC,EADR,OAEMwC,EAAU,KAFhB,kBAIoBxC,EAAQyC,oBAJ5B,OAIUC,EAJV,OArMuBC,EA0MAD,EAAEE,MAArBJ,EA1M8CK,WAAWC,QAAMC,OAAOC,iBAAiBL,GAAU,MAqMrG,kDAOIxG,QAAQ8G,MAAM,qBAPlB,iCASST,GATT,kCArMsB,IAACG,IAqMvB,qB,8DAaalD,ICvNTyD,EAAqB,uCAAG,WAAOC,EAAeC,GAAtB,mBAAAjD,EAAA,sEACAgD,EAASE,MAAM,CACzCC,aAAc,uBACdC,WAAYH,EACZI,SAAU,eAJgB,UACtBC,EADsB,iBAOvBA,EAAchF,YAPS,OAOvB,EAAoBiF,OAPG,sBAQpB1G,MAAM,mCARc,kBAWtB2G,EAAoBF,EAAchF,KAAKmF,QAAO,SAAChF,GAAD,cAAsD,kBAAvC,OAAOA,QAAP,IAAOA,GAAP,UAAOA,EAAKiF,kBAAZ,aAAO,EAAiBC,aAA4D,gBAA7B,OAAHlF,QAAG,IAAHA,GAAA,UAAAA,EAAKiF,kBAAL,eAAiBC,sBAX5G,IAavBH,KAAmBD,OAbI,sBAcpB1G,MAAM,wCAdc,gCAiBrB2G,EAAkB,IAjBG,2CAAH,wDAoBZT,ICdT3D,EAAsB,CAAC,IACvBC,EAAwB,CAAC,SAQzBuE,E,WAGJ,WAAYrE,GAAa,yBAFjBA,UAEgB,EACtBG,KAAKH,KAAOA,E,gFAGd,WAAY0D,GAAZ,SAAAjD,EAAA,6DACE9B,IADF,SAGQwB,KAAKmE,6BAA6BZ,GAH1C,uBAKQvD,KAAKoE,gBAAgBC,MAAM,GAAIhH,GALvC,OAOE2C,KAAKH,KAAKrD,OAAOgG,SAAS8B,QAP5B,gD,wIAUA,WACEf,GADF,6BAAAjD,EAAA,6DAEEzD,EAFF,+BAEyBmD,KAAKH,KAAKrD,OAAOK,aAF1C,SAImCwG,EAC/BrD,KAAKH,KAAK0E,WAAWjB,SACrBC,GANJ,OAIQiB,EAJR,OASE3F,aAAaI,QAAb,UACKpC,EADL,oBAEEqC,KAAKC,UAAU,CAAEoE,YAAWkB,QAAS,CAACD,EAAmBE,eAX7D,gD,kFAeA,WACE,OAAO,IAAIxE,WACR,IAAID,mBAAiBD,KAAKH,KAAMG,KAAKH,KAAKrD,OAAOK,cAAesD,UACjEH,KAAKH,KAAKrD,OAAOK,aACjB,CAAEuD,YAAaV,EAAqBW,cAAeV,Q,KAK1CuE,I,mBCnDT7G,EAAU,KAGVsH,EAAqB,CACzB,eAGIC,EAAuB,CAC3B,oBAyCIC,E,WAGJ,WAAY9E,EAAoC+E,GAAqB,yBAF7DhF,cAE4D,EAClEE,KAAKF,SAAW,IAAII,WAClBH,EAAiBI,UACjB2E,EACA,CAAE1E,YAAauE,EAAoBtE,cAAeuE,I,+CAItD,WACE,OAAO5E,KAAKF,W,mEAGd,WAAqBiF,EAA0BC,EAAsBlC,GAArE,eAAAxC,EAAA,6DACQE,EAASR,KAAKiF,eAAe,CACjCC,YAAaH,EACbjC,SACAqC,IAAK,CACHC,eAAgBJ,KALtB,kBASSxE,GATT,gD,uFAYA,SACE6E,GAOO,IAFPC,EAEM,uDAFAjI,EACNkI,EACM,uDAnFQ,EAoFNJ,EAAiBE,EAAjBF,IAAQK,EAAhB,YAAyBH,EAAzB,GAEArF,KAAKF,SAAS2F,iBAAd,aACIN,IAAKjG,KAAKC,UAAUgG,IAASK,GAC/BF,EACAC,K,wBAIJ,WACE,OAAOvF,KAAKF,SAAS4F,YAAY,Q,KAItBb,ICjGTc,EAAiB,IAAIrI,IAAI,GAAGsI,IAAI,IAAItI,IAAI,IAAIuI,IAAI,KAAKC,WAErDC,EAAyB,CAC7B,UAWIC,E,WAKJ,WAAYjG,EAAoC+E,EAAoB1I,GAAe,yBAJ3E0D,cAI0E,OAF1E1D,UAE0E,EAChF4D,KAAKF,SAAW,IAAII,WAClBH,EAAiBI,UACjB2E,EACA,CAAE1E,YAAa,GAAIC,cAAe0F,IAEpC/F,KAAK5D,KAAOA,E,+CAGd,WACE,OAAO4D,KAAKF,W,2DAGd,WAAamG,EAAcC,EAAwBC,GAAnD,mBAAA7F,EAAA,6DACQ8F,EAAU,CACdC,iBAAkBH,EAClBI,kBAAmBH,GAEfI,EAAaC,KAAKtH,KAAKC,UAAUiH,IALzC,SAMuBpG,KAAKF,SAAS2G,OAAO,CACxCR,OACA7J,KAAM4D,KAAK5D,KACXsK,YAAa,GACbC,YAAa,MACbC,KAAML,GA5CI,KA6CAZ,GAZd,cAMQnF,EANR,OAcElE,QAAQC,IAAIiE,GAdd,kBAgBSA,GAhBT,gD,kEAoBawF,ICtCFa,EAAcC,wBAAmB,MAEjCC,EAAW,uCAAG,oDAAAzG,EAAA,6DACrBzB,aAAaG,QAAQ,SACvBI,IAGIoD,EAAW,IAAIwE,YAAkBC,4BALd,SAMND,UAAA,aAAkBE,QAAS,GAAI1E,YAAahG,IANtC,cAMnBqD,EANmB,OAOnBsH,EAAM,IAAIvH,EAAQC,GAElBuH,EAAkB,IAAIJ,YAAkBK,iBATrB,SAUCL,UAAA,aAAkBE,QAAS,GAAI1E,SAAU4E,GAAoB5K,IAV9D,cAUnB8K,EAVmB,OAWnBC,EAAa,IAAIrD,EAAWoD,GAE5BvH,EAAmB,IAAIiH,mBAAyBnH,EAAMrD,EAAOK,cAC7D2K,EAAkBzH,EAAiB0C,eACrCgF,EAA0B,GAC1BC,GAAmB,EAhBE,oBAkBCP,EAAIQ,oBAlBL,eAkBvBF,EAlBuB,iBAmBQN,EAAIS,sBAnBZ,QAmBjBzB,EAnBiB,OAoBvBuB,EAAUvB,EAAiB0B,SAASL,GApBb,mDAsBvBlL,QAAQC,IAAR,MAtBuB,eAwBnBuL,EAAW,IAAIjD,EAAS9E,EAAkB0H,GAC1CM,EAAa,IAAI/B,EACrBjG,EACAvD,EAAOS,oBACPT,EAAOU,qBA5BgB,kBA+BlB,CACLV,SACA2K,MACAM,kBACAF,aACAS,WAAYR,EACZE,UACAF,kBACAM,WACAC,eAxCuB,2DAAH,qD,OCrBT,SAASE,EAAT,GAEZ,IADCC,EACF,EADEA,QAAS7B,EACX,EADWA,iBAEX,OACE,sBAAK8B,UAAU,YAAf,UACE,4CAEA,oNAK4B3L,EAAOK,aALnC,yCAMwBwJ,EANxB,kDAQ+B6B,EAAQrE,OARvC,mB,4HCTS,SAASuE,GAAUC,GAChC,IAAQC,EAAcD,EAAdC,IAAKC,EAASF,EAATE,KACb,OACE,qBACEC,MAAO,CACLC,OAAQF,EAAMG,MAAOH,EAAMI,cAAe,UAE5CC,IAAKN,EACLO,IAAI,eCIK,SAASC,GAAcT,GACpC,IAAQU,EAA2BV,EAA3BU,SAAUC,EAAiBX,EAAjBW,MAAOC,EAAUZ,EAAVY,MAEzB,OACE,sBAAKd,UAAU,sBAAf,UACE,6BAAKa,IACL,eAACE,EAAA,EAAD,CAAOf,UAAU,cAAcI,KAAK,QAAQ,aAAW,YAAvD,UACE,cAACY,GAAA,EAAD,UACE,eAACC,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,mBACA,cAACA,GAAA,EAAD,CAAWC,MAAM,QAAjB,yBAGJ,cAACC,GAAA,EAAD,UACGR,EAASjK,KAAI,SAAC0K,GAAD,OACZ,eAACJ,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,CAAWI,UAAU,KAAKC,MAAM,MAAhC,SACGjM,EAAiB+L,EAAE9H,aAEtB,eAAC2H,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACGzL,EAAc2L,EAAE7G,QAASsG,EAAMlL,UADlC,OAGGkL,EAAMU,OAHT,OAKE,cAACvB,GAAD,CAAWE,IAAKW,EAAMW,MAAQ,GAAIrB,KAAM,UAT7BiB,EAAE9H,sBCXd,SAASmI,GAAeC,GAAoD,IAAD,IACxF,EAAwBC,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACQC,EAAeJ,EAAfI,IAAKjB,EAAUa,EAAVb,MAEXpJ,EAGEsK,qBAAWtD,GAHbhH,KAKF,IAAKA,EAAM,OAAO,KAElB,IAAQmI,EAAanI,EAAbmI,SAEFoC,EAAe,OAAGF,QAAH,IAAGA,GAAH,UAAGA,EAAKG,0BAAR,iBAAG,EAAyBC,wBAA5B,aAAG,EAA2CC,SAEnE,OACE,qCACE,eAACnB,GAAA,EAAD,CAAUjB,UAAW6B,EAAO,mBAAqB,UAAWQ,GAAI,CAAE,QAAS,CAAEC,aAAc,UAA3F,UACE,cAACpB,GAAA,EAAD,UACE,cAACqB,GAAA,EAAD,CACE,aAAW,aACXnC,KAAK,QACLoC,QAAS,kBAAMV,GAASD,IAH1B,SAKGA,EAAO,cAAC,KAAD,IAA0B,cAAC,KAAD,QAGtC,cAACX,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAyBY,EAAItJ,KAC7B,cAACyI,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,cAAC,IAAD,CAAMsB,GAAI5C,EAAQ,yBAAqBkC,EAAIxG,YAAzB,mBAAoDwG,EAAIxG,YAA1E,SAAyFwG,EAAIxG,eACrH,cAAC2F,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACG7L,EAAiByM,EAAInB,SAAS,GAAGrH,aAEpC,cAAC2H,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACG7L,EAAiByM,EAAInB,SAASmB,EAAInB,SAASlF,OAAS,GAAGnC,aAE1D,eAAC2H,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACGzL,EAAcqM,EAAIW,cAAe5B,EAAMlL,UAD1C,OAGGkL,EAAMU,OAHT,OAKE,cAACvB,GAAD,CAAWE,IAAKW,EAAMW,MAAQ,GAAIrB,KAAM,QAE1C,cAACc,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,sBAAKnB,UAAU,eAAf,UACE,qBAAKK,MAAO,CAAEE,MAAM,GAAD,OAAMwB,EAAIY,gBAAkBZ,EAAIW,cAAiB,IAAjD,MAA2D1C,UAAU,UAAxF,SACE,+BAAOtK,EAAcqM,EAAIY,gBAAiB7B,EAAMlL,cAElD,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,OAAMwB,EAAIa,kBAAoBb,EAAIW,cAAiB,IAAnD,MAA6D1C,UAAU,YAA1F,SACE,+BACGtK,EAAcqM,EAAIa,kBAAmB9B,EAAMlL,cAGhD,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,QAAOwB,EAAIW,cAAgBX,EAAIY,gBAAkBZ,EAAIa,mBAAqBb,EAAIW,cAAiB,IAA/F,MAAyG1C,UAAU,SAAtI,SACE,gCACK+B,EAAIW,cAAgBX,EAAIY,gBAAkBZ,EAAIa,mBAC7Cb,EAAIW,cAAiB,IAAOhN,EAAcqM,EAAIW,cAC9CX,EAAIY,gBAAkBZ,EAAIa,kBAAmB9B,EAAMlL,cAG3D,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,OAA+C,KAAzCwB,EAAIW,cAAgBX,EAAIW,eAA9B,MAAyD1C,UAAU,WAAtF,0BAIN,cAACiB,GAAA,EAAD,CAAUoB,GAAI,CAAEQ,WAAY,WAA5B,SACE,cAAC3B,GAAA,EAAD,CAAWb,MAAO,CAAEyC,QAAS,GAAKC,QAAS,EAA3C,SACE,cAACC,GAAA,EAAD,CAAUC,GAAIpB,EAAMqB,QAAQ,OAAOC,eAAa,EAAhD,SACE,qBAAKnD,UAAU,aAAf,SACE,sBAAKK,MAAO,CAAE+C,QAAS,OAAQC,IAAK,IAApC,UACE,cAAC1C,GAAD,CAAeC,SAAUmB,EAAInB,SAAUC,MAAM,kBAAkBC,MAAOA,IACrEmB,GACC,cAACtB,GAAD,CAAeC,SAAUqB,EAAiBpB,MAAM,mBAAmBC,MAAOA,kBC5E7E,SAASwC,GAAT,GAAgF,IAAzDvD,EAAwD,EAAxDA,QAASe,EAA+C,EAA/CA,MAC7C,OACE,eAACC,EAAA,EAAD,CAAOf,UAAU,aAAa,aAAW,oBAAzC,UACE,cAACgB,GAAA,EAAD,CAAWhB,UAAU,aAArB,SACE,eAACiB,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,IACA,cAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,OAAjB,wBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,2BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,yBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,6BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAGJ,cAACC,GAAA,EAAD,UACGrB,EAAQpJ,KAAI,SAAC4M,GAAD,OACX,cAAC7B,GAAD,CAAgCK,IAAKwB,EAAQzC,MAAOA,GAA/ByC,EAAO9K,Y,4CCtBtC+K,KAAGC,UAAUC,OAAS,WACpB,OAAO7L,KAAK8F,YAGP,IAAMgG,GAA0B,SAACC,GACtC,IAEMC,EAAQD,EAAME,OAAO5P,MADZ,MAEf,GAAI2P,EAAMnI,QAAU,EAClB,MAAO,GAET,IAAMqI,EAAQF,EAAMlN,KAAI,SAACqN,GAAD,OAAUA,EAAK9P,MANxB,MAMsCyC,KAAI,SAAC0K,GAAD,OAAOA,EAAEyC,aAClE,eAAgCC,GAAzBE,EAAP,KAMA,OANA,WAE6BtN,KAAI,SAACoL,GAAD,OAASvL,OAAO0N,YAC/CD,EAAQtN,KAAI,SAACwN,EAAKC,GAAN,MAAiB,CAACD,EAAKpC,EAAIqC,IAAW,YAmDzCC,GAAgB,SAACT,GAE5B,IAAMU,EAAO,aAAG,gFAAH,4DACPC,EAAQX,EAAMW,MAAMD,GAC1B,IAAKC,EACH,MAAM,IAAIvP,MAAM,oBAGlB,IAAMwP,EAASD,GAASA,EAAMC,QAAU,GAWxC,MAVe,CACbvO,KAAMwO,SAASD,EAAOvO,KAAM,KAAO,EACnCyO,MAAOD,SAASD,EAAOE,MAAO,KAAO,EACrCC,KAAMF,SAASD,EAAOG,KAAM,KAAO,EACnCC,IAAKH,SAASD,EAAOI,IAAK,KAAO,EACjCC,KAAMJ,SAASD,EAAOK,KAAM,KAAO,EACnCC,OAAQL,SAASD,EAAOM,OAAQ,KAAO,EACvCC,OAAQN,SAASD,EAAOO,OAAQ,KAAO,IAiC9BC,GAA6B,SAACpE,GACzC,IAAMqE,EAAQrE,EAAS1M,MAAM,KAC7B,GAAqB,IAAjB+Q,EAAMvJ,OACR,MAAM,IAAI1G,MAAM,qDAGlB,kBAKIiQ,EALJ,GACEC,EADF,KAEEC,EAFF,KAGEC,EAHF,KAIEC,EAJF,KAOMC,EApFsB,SAAC/L,GAC7B,IAAKA,EAAUgL,MAAM,sCACnB,MAAM,IAAIvP,MAAM,qBAElB,IAAMqD,EAAS,IAAI7C,KAAK+D,GACxB,GAAIgM,OAAOC,MAAMnN,EAAOjC,WACtB,MAAM,IAAIpB,MAAM,qBAGlB,OAAOqD,EA2EgBoN,CAAeP,GAChCQ,EAAgBrB,GAAcc,GAC9BQ,EArCsB,SAAC/B,GAC7B,IAAMqB,EAAQrB,EAAM1P,MAAM,KAC1B,GAAqB,IAAjB+Q,EAAMvJ,OACR,MAAM,IAAI1G,MAAM,oBAElB,kBAAqCiQ,EAArC,GAAOW,EAAP,KAAoBC,EAApB,KACMC,EAAWzB,GAAcuB,GACzBG,EAAatB,SAASoB,EAAe,IAC3C,GAAIE,EAAa,GAAKA,EAAa,IACjC,MAAM,IAAI/Q,MAAM,4BAElB,MAAO,CAAE8Q,WAAUC,cA0BDC,CAAeZ,GAC3Ba,EAAe5B,GAAcgB,GAEnC,MAAO,CACLC,iBACAI,gBACAQ,cAAeP,EAAUG,SACzBK,gBAAiBR,EAAUI,WAC3BE,iBAkBSG,GAAwB,SAACxC,GAMpC,MAAO,CACLrI,WA5I+B,SAACH,GAClC,IAAIiL,GAAU,EAKd,GAJIjL,EAAUM,OAAS,IAAG2K,GAAU,GAChCjL,EAAUM,OAAS,KAAI2K,GAAU,GAChCjL,EAAUmJ,MAAM,oBAAmB8B,GAAU,GAE9CA,EACF,OAAOjL,EAET,MAAM,IAAIpG,MAAM,2BA6HEsR,CAAoB1C,EAAMrI,YAO1CZ,OA/H4B,SAACA,GAC/B,GAAIA,EAAO4J,MAAM,uBACf,OAAO5J,EAET,MAAM,IAAI3F,MAAM,wBAqHDuR,CAAiB3C,EAAMjJ,QAOpC6L,gBANqBxB,GAA2BpB,EAAM4C,iBAOtDrE,iBANiD,KAA3ByB,EAAMzB,iBAA0B,KAAO6C,GAA2BpB,EAAMzB,oBAsCrFsE,GAAsB,SAACzQ,EAAY8P,EAAuBY,GACrE,IAAMjJ,EAAMkJ,KAAKC,MAAMF,GASvB,OARe,IAAIlR,KAAKA,KAAKqR,IAC3B7Q,EAAK8Q,iBAAmBhB,EAAS7P,KAAOwH,EACxCzH,EAAK+Q,cAAgBjB,EAASpB,MAAQjH,EACtCzH,EAAKgR,cAAgC,EAAhBlB,EAASnB,KAAWmB,EAASlB,KAAOnH,EACzDzH,EAAKiR,cAAgBnB,EAASjB,KAAOpH,EACrCzH,EAAKkR,gBAAkBpB,EAAShB,OAASrH,EACzCzH,EAAKmR,gBAAkBrB,EAASf,OAAStH,KAKhC2J,GAAS,SAACpR,GAAD,OAAyB2Q,KAAKC,MAAM,IAAIpR,KAAKQ,GAAMI,UAAY,MAExEiR,GAAmB,SAACzG,EAAiC0G,EAA+BC,GAC/F,KAAMA,GAAiB,GAAKA,IAAkBZ,KAAKC,MAAMW,IACvD,MAAM,IAAIvS,MAAM,0BAElB,IAAMwS,EAAqB,IAAIrS,IAAI,IAAIuI,IAAI6J,GAEnCjC,EAAmB1E,EAAnB0E,eACFmC,EAAiBhB,GAAoBnB,EAAgB1E,EAASsF,cAAe,GAC7EwB,EAAoBjB,GAAoBgB,EAAgBpD,GAAc,SAAU,GAChFsD,EAAkBlB,GAAoBnB,EAAgB1E,EAAS8E,cAAe,GAG9EkC,EAAc,IAAIpE,KAAG,IAAIrO,IAAImS,GAAkB7J,IAAI+J,GAAoBK,MAAM,EAAG1S,IAAI2S,WAAWnK,YAC/FoK,EAAc,IAAIvE,KAAGoE,GAAaI,KAAKpH,EAASuF,iBAAiB8B,KAAK,KAAKC,QAEjF,GAAIH,EAAYI,GAAGP,GACjB,MAAM,IAAI5S,MAAM,oCAElB,GAAIyS,EAAiBE,EACnB,MAAM,IAAI3S,MAAM,2CAElB,GAAIyS,EAAiBnC,EACnB,MAAM,IAAItQ,MAAM,6CAGlB,IAAQiR,EAAiBrF,EAAjBqF,aAEFmC,EAAUX,EACVY,EAAc5B,GAAoBgB,EAAgBxB,EAAc,GACtE,GAAImB,GAAOiB,IAAgBjB,GAAOgB,GAChC,MAAM,IAAIpT,MAAM,uCAElB,GAAIoS,GAAOiB,GAAejB,GAAOgB,KAAa,EAAG,CAC/C,IAAME,EAAU,CAAE/O,UAAW6N,GAAO9B,GAAiB9K,QAAS,IAAIgJ,KAAG,KAAK7F,YACpE4K,EAAa,CAAEhP,UAAW6N,GAAOM,GAAoBlN,QAAS,IAAIgJ,KAAG,KAAK7F,YAC1E6K,EAAU,CAAEjP,UAAW6N,GAAOK,GAAiBjN,QAASuN,EAAYpK,YACpE8K,EAAW,CAAElP,UAAW6N,GAAOO,GAAkBnN,QAASoN,EAAYjK,YAEtEtF,EAAS,GAUf,OATAA,EAAOqQ,QAAQD,GACXD,EAAQjP,UAAYkP,EAASlP,WAC/BlB,EAAOqQ,QAAQF,GAEjBnQ,EAAOqQ,QAAQH,GACXD,EAAQ/O,UAAYgP,EAAWhP,WACjClB,EAAOqQ,QAAQJ,GAGVjQ,EAQP,IALF,IAAMsQ,EAAM,GAGNC,EAAKnB,IAEA,CACP,GAAImB,GAAMjB,EAAiB,CACzBiB,EAAKjB,EACLgB,EAAIE,KAAKD,GACT,MAIF,GAFAD,EAAIE,KAAKD,GACTA,EAAKnC,GAAoBmC,EAAI3C,EAAc,GACvC0C,EAAIjN,QATO,IAUb,MAAM,IAAI1G,MAAM,qCAKtB,IAAM8T,EAAYlB,EAAYmB,IAAIhB,GAAaE,KAAKU,EAAIjN,OAAS,GAE3DsN,EAAoBL,EAAIM,SAAQ,SAACL,EAAIM,GACzC,GAAmB,IAAfP,EAAIjN,OACN,MAAO,CAAC,CAAEnC,UAAW6N,GAAOO,GAAkBnN,QAASoN,EAAYjK,aAErE,GAAU,IAANuL,EACF,MAAO,CAAC,CAAE3P,UAAW6N,GAAOwB,GAAKpO,QAASuN,EAAYpK,aAExD,IAAMwL,EAAcD,IAAMP,EAAIjN,OAAS,EACnCkM,EACAG,EAAYqB,IAAIN,EAAUd,KAAKkB,IAAIvL,WACvC,MAAO,CACL,CAAEpE,UAAW6N,GAAOwB,GAAM,EAAGpO,QAASuN,EAAYqB,IAAIN,EAAUd,KAAKkB,EAAI,IAAIvL,YAC7E,CAAEpE,UAAW6N,GAAOwB,GAAKpO,QAAS2O,EAAYxL,gBAI5C0L,EAAyB,GACzBf,EAAU,CAAE/O,UAAW6N,GAAO9B,GAAiB9K,QAAS,IAAIgJ,KAAG,KAAK7F,YACpE4K,EAAa,CAAEhP,UAAW6N,GAAOM,GAAoBlN,QAAS,IAAIgJ,KAAG,KAAK7F,YAQhF,OANA0L,EAASX,QAAQH,GACbD,EAAQ/O,UAAYgP,EAAWhP,WACjC8P,EAASX,QAAQJ,GAGJe,EAASC,OAAON,IA6BpBO,GAA2B,SAACC,EAA0BjC,EAAuBkC,GAExF,OADa9F,GAAwB6F,GACzB7S,KAAI,SAAC0K,GAAD,OApBS,SAACqI,EAAsCnC,EAAuBkC,GACvF,IAEIE,EArIiC/I,EAmI/BmB,EAAMqE,GAAsBsD,GASlC,OANI3H,EAAII,kBAtI6BvB,EAuIQyG,GAAiBtF,EAAII,iBAAkBJ,EAAIpH,OAAQ4M,GAA9FoC,EAvIwG,CAC1GC,SAsIgHH,EArIhHtH,iBAAkB,CAChBC,SAAUxB,KAsIV+I,EAAoB,KAGf,CACLpO,WAAYwG,EAAIxG,WAChBqF,SAAUyG,GAAiBtF,EAAIyE,gBAAiBzE,EAAIpH,OAAQ4M,GAC5D5E,gBAAiB,IAAIa,KAAG,GAAG7F,WAC3BuE,mBAAoByH,GAMCE,CAAYxI,EAAGkG,EAAekC,O,UCvVxC,SAASK,GAAW5J,GACjC,IAAQ2D,EAAsB3D,EAAtB2D,MAAOkG,EAAe7J,EAAf6J,WACf,OACE,sBAAK/J,UAAU,cAAf,UACG6D,EAAMlN,KAAI,SAAC0K,GAAD,OACT,8BAAMA,OAEP0I,GAAe,cAACC,GAAA,EAAD,CAAgBC,MAAM,UAAU5J,MAAO,CAAE6J,UAAW,SC0G3DC,OAzGf,YAA4D,IAAhCrJ,EAA+B,EAA/BA,MAClBpJ,EAAsCsK,qBAAWtD,GAAjDhH,KAER,EAAwBkK,mBAAmB,IAA3C,mBAAO1K,EAAP,KAAakT,EAAb,KACA,EAAkCxI,mBAAmB,IAArD,mBAAOyI,EAAP,KAAkBC,EAAlB,KACA,EAA4C1I,oBAAkB,GAA9D,mBAAO2I,EAAP,KAAuBC,EAAvB,KAEMpW,EAAM,SAACqW,GACXtW,QAAQC,IAAIqW,GACZH,GAAa,SAACI,GAAD,OAAgBA,EAAWpB,OAAO,CAACmB,QAOlDtW,QAAQC,IAAIgW,GAEZ,IAgBMO,EAAWC,cAEXC,EAAiB,uCAAG,sBAAA1S,EAAA,yDACnBT,EADmB,sBAEhB,IAAI1C,MAAM,gBAFM,cAIxBwV,GAAkB,GAJM,2BAAArS,EAAA,4CAAAA,EAAA,6DAvBxBmS,EAAa,IA8BXlW,EAAI,2BAPkB,SAQKsD,EAAKsH,IAAI8L,mBARd,OAQhBjO,EARgB,OAShBG,EATgB,kCASiBH,GACvCzI,EAAI4I,GAEE+N,EAAY,IACT7B,EAAI,EAbS,YAaNA,EAAIhS,EAAKwE,QAbH,wBAcdsP,EAAQ9T,EAAK+T,MAAM/B,EAAGA,EAAI6B,GAChC3W,EAAI,kBAAD,OAAmB8U,EAAnB,YAAwBhS,EAAKwE,OAA7B,SACG1C,EAASgS,EAAMrU,KAAI,SAAC4M,GAAD,MAAa,CACpCtG,eAAgBJ,EAChB0G,aAlBkB,UAoBd7L,EAAKsH,IAAIkM,aAAalS,GApBR,QAaWkQ,GAAK6B,EAbhB,uBAuBtB3W,EAAI,kBAAD,OAAmB8C,EAAKwE,OAAxB,MAEHiP,EAAS,uBAAD,OAAwB9N,IAzBV,4GA2BtBzI,EAAI,UAAD,cACHoW,GAAkB,GA5BI,yDAAH,qDAgCvB,OACE,sBAAKxK,UAAU,YAAf,UACE,oDAGA,4GAGG,IACD,mBAAG/F,KAAI,UAAKrG,GAAL,+BAAP,+CAJF,OASA,8BACE,cAACuX,EAAA,EAAD,CACE9K,MAAO,CAAEE,MAAO,OAAQ2J,UAAW,IACnCzR,GAAG,oBACH2S,YAAY,cACZC,QAAS,EACTC,SAtEkB,SAACC,GACzB,IACE,GAAI,OAAC7T,QAAD,IAACA,MAAM2H,gBACT,MAAM,IAAIrK,MAAM,oCAElBb,QAAQC,IAAI0M,GACZ,IAAM8C,EAAQ2H,EAAMC,OAAO7V,MACrBoK,EAAUwJ,GAAyB3F,EAAO9C,EAAMlL,SAAU8B,EAAK2H,iBACrE+K,EAAQrK,GACR,MAAO0L,GACHA,aAAazW,OACfb,QAAQC,IAAIqX,SA8Dd,cAACnI,GAAD,CAAavD,QAAS7I,EAAM4J,MAAOA,IACnC,uBACA,8BACE,wBAAQ4K,WAAYxU,EAAKwE,QAAU,IAAM6O,GAAiBvK,UAAU,kBAAkBwC,QAASqI,EAAmBc,KAAK,SAAvH,sBAIF,uBACEtB,EAAU3O,OAAS,GACnB,cAACoO,GAAD,CAAYjG,MAAOwG,EAAWN,WAAYQ,Q,UC3GnC,SAASqB,GAAmB1L,GACzC,IAAQY,EAAkBZ,EAAlBY,MAAOnG,EAAWuF,EAAXvF,OAEf,OACE,sBAAKqF,UAAU,qBAAqBK,MAAO,CAAE+C,QAAS,QAAtD,UACE,sBAAK/C,MAAO,CAAEwL,KAAM,EAAGC,aAAc,UAAY9L,UAAU,cAA3D,UACE,qBAAKA,UAAU,eAAf,SACGc,EAAMU,SAET,qBAAKxB,UAAU,eAAf,SACGrF,OAGL,qBAAK0F,MAAO,CAAEwL,KAAM,GAApB,SACE,cAAC5L,GAAD,CAAWE,IAAKW,EAAMW,MAAQ,GAAIrB,KAAM,UCejC2L,OA7Bf,SAAoBpK,GAClB,IAAQjK,EAAsCsK,qBAAWtD,GAAjDhH,KACAsU,EAA4BrK,EAA5BqK,gBAAiBrR,EAAWgH,EAAXhH,OAEzB,IAAKjD,EACH,MAAM1C,MAAM,4BAGd,QAAwBmF,IAApB6R,EACF,MAAMhX,MAAM,yCAGd,QAAemF,IAAXQ,EACF,MAAM3F,MAAM,oDAWd,OACE,wBAAQgL,UAAU,mBAAmB2L,KAAK,SAASnJ,QATlC,WACjB9K,EAAKiI,SAASsM,eACZvU,EAAKsH,IAAIkN,cAAcvP,WACvBqP,EACArR,IAKF,mBCjBW,SAASwR,GAAT,GAA0D,IAAhCrL,EAA+B,EAA/BA,MACjCjE,EAAe4H,SAAS2H,cAAYvP,cAAgB,GAAI,IACtDnF,EAAsCsK,qBAAWtD,GAAjDhH,KACR,EAAoCkK,mBAAc,MAAlD,mBAAOyK,EAAP,KAAmBC,EAAnB,KACA,EAA4B1K,mBAAgB,IAA5C,mBAAO5I,EAAP,KAAeuT,EAAf,KACA,EAAoC3K,mBAAmB,IAAvD,mBAAO4K,EAAP,KAAmBC,EAAnB,KACA,EAAoC7K,oBAAkB,GAAtD,mBAAOmI,EAAP,KAAmB2C,EAAnB,KAEMtY,EAAM,SAACqW,GACXtW,QAAQC,IAAIqW,GACZgC,GAAc,SAACE,GAAD,OAAYA,EAAOrD,OAAO,CAACmB,QAM3CtW,QAAQC,IAAI0M,GACZ3M,QAAQC,IAAIiY,GACZlY,QAAQC,IAAIkY,GAEZM,qBAAU,WACR,IAAMC,EAAe,uCAAG,4BAAA1U,EAAA,yDACtBmU,EAAc,MACdnY,QAAQC,IAAI,0BACPsD,EAHiB,iEAMDA,EAAKsH,IAAI8N,cAAcjQ,GANtB,OAMhBxE,EANgB,OAOtBlE,QAAQC,IAAIiE,GACZiU,EAAcjU,GARQ,2CAAH,qDAWrBwU,MACC,CAACnV,EAAMmF,IAEV+P,qBAAU,WACR,IAAMG,EAAW,uCAAG,4BAAA5U,EAAA,yDAClBoU,EAAU,IACVpY,QAAQC,IAAI,sBACPsD,EAHa,oDAMb2U,EANa,iEASG3U,EAAKsH,IAAIgO,UAAUX,EAAWY,eATjC,OASZ5U,EATY,OAUlBlE,QAAQC,IAAIiE,GACZkU,EAAUlU,EAAO1B,KAAI,SAAC0K,GAAD,OAAY7K,OAAOgC,OAAO6I,EAAE,GAAGkC,OAAQ,CAAE9K,GAAI4I,EAAE,SAXlD,4CAAH,qDAcjB0L,MACC,CAACrV,EAAM2U,IAEV,IAAM1B,EAAWC,cA6BjB,OAAKyB,EAKH,sBAAKrM,UAAU,YAAf,UACE,sBAAKA,UAAU,8BAAf,UACE,mDACkBnD,KAElB,cAAC+O,GAAD,CAAoB9K,MAAOA,EAAOnG,OAAQjF,EAAc2W,EAAWa,aAAcpM,EAAMlL,aAErFyW,EAAWc,QACX,qBAAK9M,MAAO,CAAE6J,UAAW,IAAzB,SACE,cAAC,GAAD,CAAY8B,gBAAiBnP,EAAclC,OAAQ0R,EAAWa,iBAGjEb,EAAWc,QAAUd,EAAWY,cAAcvR,OAAS,GACtD,wBAAQsE,UAAU,mBAAmB2L,KAAK,SAASnJ,QA7CrC,WACpB,IAAM4K,EAAa,uCAAG,kCAAAjV,EAAA,yDACfT,EADe,sBAEZ,IAAI1C,MAAM,gBAFE,gBAKlB0X,GAAc,GAhDlBD,EAAc,IAkDJY,EAAWhB,EAAWY,cACtBlC,EAAY,IACT7B,EAAI,EATK,YASFA,EAAImE,EAAS3R,QATX,wBAUVsP,EAAQqC,EAASpC,MAAM/B,EAAGA,EAAI6B,GACpC3W,EAAI,sBAAD,OAAuB8U,EAAvB,YAA4BmE,EAAS3R,OAArC,SAXa,UAYVhE,EAAKsH,IAAIoO,cAAcpC,GAZb,QASmB9B,GAAK6B,EATxB,uBAclB3W,EAAI,uBACJuW,EAAS,kBAfS,kDAiBlBvW,EAAI,UAAD,cAjBe,yBAmBlBsY,GAAc,GAnBI,6EAAH,qDAuBnBU,KAqBM,qBAEDf,EAAWc,QAA8C,IAApCd,EAAWY,cAAcvR,QAC7C,qBAAK2E,MAAO,CAAE6J,UAAW,IAAzB,SACE,cAACoD,GAAA,EAAD,CAAOC,SAAS,UAAhB,wCAKJf,EAAW9Q,OAAS,GACpB,cAACoO,GAAD,CAAYjG,MAAO2I,EAAYzC,WAAYA,MAG1CsC,EAAWc,QAAUd,EAAWY,cAAcvR,OAAS,IACxD,cAAC4H,GAAD,CAAavD,QAAS/G,EAAQ8H,MAAOA,OA/BlC,KC/EI,SAAS0M,GAAT,GAAgE,IAAhC1M,EAA+B,EAA/BA,MACrCpJ,EAAsCsK,qBAAWtD,GAAjDhH,KACR,EAAsCkK,mBAAgB,IAAtD,mBAAO6L,EAAP,KAAoBC,EAApB,KA4CA,OArCAd,qBAAU,WACR,IAAMe,EAAgB,uCAAG,4BAAAxV,EAAA,yDACvBuV,EAAe,IACfvZ,QAAQC,IAAI,0BACPsD,EAHkB,iEAMFA,EAAKsH,IAAI4O,oBANP,OAMjBvV,EANiB,OAOvBlE,QAAQC,IAAIiE,GACZqV,EAAerV,GARQ,2CAAH,qDAWtBsV,MACC,CAACjW,IAyBF,sBAAKsI,UAAU,YAAf,UACE,kDAIA,eAACe,EAAA,EAAD,CAAOf,UAAU,aAAa,aAAW,oBAAzC,UACE,cAACgB,GAAA,EAAD,CAAWhB,UAAU,aAArB,SACE,eAACiB,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,oBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,qCACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,kCAGJ,cAACC,GAAA,EAAD,UACGqM,EAAY9W,KAAI,SAACkX,GAAD,OACf,eAAC5M,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,CAAWC,MAAM,OAAjB,SACE,cAAC,IAAD,CAAMsB,GAAE,8BAAyBoL,EAAMpV,IAAvC,SAA8CoV,EAAMpV,OAEtD,cAACyI,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2B0M,EAAMV,OAAS,MAAQ,OAClD,cAACjM,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAA0B0M,EAAMZ,cAAcvR,SAC9C,eAACwF,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACGzL,EAAcmY,EAAMX,aAAcpM,EAAMlL,UAD3C,OAGGkL,EAAMU,OAHT,OAKE,cAACvB,GAAD,CAAWE,IAAKW,EAAMW,MAAQ,GAAIrB,KAAM,mBAOlD,uBAEA,cAAC,IAAD,CAAMqC,GAAG,4BAAT,SACE,wBAAQzC,UAAU,SAAS2L,KAAK,SAAhC,qC,cC7FO,SAASmC,GAAT,GAAgE,IAA9CC,EAA6C,EAA7CA,cAC/B,EAII/L,qBAAWtD,GAHbhH,EADF,EACEA,KAAM0C,EADR,EACQA,QAKR,IAAK1C,EAAM,OAAO,KAElBvD,QAAQC,IAAIN,GAEZ,IAAQ+L,EAAuCnI,EAAvCmI,SAAUR,EAA6B3H,EAA7B2H,gBAAiBE,EAAY7H,EAAZ6H,QAEnC,OACE,qBAAKS,UAAU,SAAf,SACE,qBAAKA,UAAU,YAAf,SACE,eAACgO,GAAA,EAAD,CAAK3L,GAAI,CAAEe,QAAS,QAApB,UACE,sBAAKpD,UAAU,MAAf,UACE,cAAC,IAAD,CAAMA,UAAU,WAAWyC,GAAI,WAA+B3O,EAA/Bia,GAAiBxO,EAAjB,6BAA/B,qBACA,cAAC,IAAD,CAAMS,UAAU,WAAWyC,GAAiB,WAAO3O,EAApBia,EAAa,yBAA5C,mBACCA,GAAkB,cAAC,IAAD,CAAM/N,UAAU,WAAWyC,GAAE,WAAM3O,EAAN,uBAA7B,6BAEpBia,GAAiBlO,GAChB,eAACmO,GAAA,EAAD,CAAK3L,GAAI,CAAE6H,UAAW,QAAtB,UACE,iCACG7K,EACA,OAEH,wBAAQW,UAAU,SAAS2L,KAAK,SAASnJ,QAASpI,EAAlD,+BC7BC,SAAS6T,KACtB,MAA0EjM,qBAAWtD,GAA7EhH,EAAR,EAAQA,KAAMwW,EAAd,EAAcA,OAkDd,OAAMxW,EAKJ,gCACE,cAACoW,GAAD,CAAQC,eAAe,IACvB,sBAAK/N,UAAU,gCAAf,UACE,iFAIA,sBAAMA,UAAU,cAAcmO,SA5DD,SAAC1C,GAClCA,EAAE2C,iBAEF,IAAMC,EAAO,uCAAG,kCAAAlW,EAAA,gEACTT,QADS,IACTA,KAAM2H,gBADG,sBAEN,IAAIrK,MAAM,0CAFJ,UAMRsZ,EAA4B7C,EAAED,OAAO+C,SAASC,iBAAiB7Y,MAClEzB,MAAM,KAAKyC,KAAI,SAAC0K,GAAD,OAAeA,EAAEyC,UAAQlI,QAAO,SAACyF,GAAD,OAAeA,EAAE3F,OAAS,KACtEqC,EAAyB0N,EAAED,OAAO+C,SAASrQ,iBAAiBvI,MAC5D8Y,EAA6BhD,EAAED,OAAO+C,SAASG,qBAAqB/Y,MAE3C,IAA3B2Y,EAAgB5S,OAXN,sBAYN,IAAI1G,MAAM,0BAZJ,UAegB,IAA1B+I,EAAerC,OAfL,sBAgBN,IAAI1G,MAAM,wBAhBJ,UAmBoB,IAA9ByZ,EAAmB/S,OAnBT,uBAoBN,IAAI1G,MAAM,4BApBJ,yBA+BO0C,EAAKkI,WAAWtB,OACnCmQ,EACA1Q,EACAuQ,GAlCY,eA+BRjW,EA/BQ,OAqCdlE,QAAQC,IAAIiE,GArCE,kBAuCPA,GAvCO,4CAAH,qDA0CbgW,KAeI,SACE,sBAAKrO,UAAU,eAAf,0HAGE,sBAAKA,UAAU,WAAf,UACE,sDACA,iCACGtI,EAAK2H,gBACL,IACD,wBAAQW,UAAU,SAAS2L,KAAK,SAASnJ,QAAS0L,EAAlD,SACGxW,EAAK2H,gBAAmB,wBAA2B,gBAI1D,sBAAKW,UAAU,WAAf,UACE,sDACA,uBAAOvH,GAAG,wBAEZ,sBAAKuH,UAAU,WAAf,UACE,qEACA,uBAAOvH,GAAG,wBAEZ,sBAAKuH,UAAU,WAAf,UACE,iEACA,uBAAOvH,GAAG,4BAGZ,wBAAQuH,UAAU,SAAS2L,KAAK,SAASD,UAAWhU,EAAK2H,gBAAzD,wCAtCD,K,qKCjCI,SAASsP,GAAT,GAAyD,IAAjC7N,EAAgC,EAAhCA,MAEnCpJ,EAGEsK,qBAAWtD,GAHbhH,KAKF,EAAwBkK,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAkCF,mBAAsB,MAAxD,mBAAOgN,EAAP,KAAkBC,EAAlB,KACA,EAAgCjN,mBAAiB,UAAjD,mBAAOhB,EAAP,KAAiBkO,EAAjB,KAEMC,EAAc,kBAAMjN,GAAQ,IAM5BkN,EAAkB,uCAAG,WAAOvD,GAAP,mCAAAtT,EAAA,yDACpBT,EADoB,sBAEjB1C,MAAM,2BAFW,UAIpB0C,EAAK2H,gBAJe,sBAKjB,IAAIrK,MAAM,oDALO,UAOpB4Z,EAPoB,sBAQjB5Z,MAAM,sBARW,OAWzByW,EAAE2C,iBAXuB,EAaG3C,EAAED,OAAO+C,SAA7BvW,EAbiB,EAajBA,QAAS2C,EAbQ,EAaRA,OAEjBxG,QAAQC,IAAI4D,EAAQrC,MAAOgF,EAAOhF,OAE5BiH,GAAuB,OAAJlF,QAAI,IAAJA,OAAA,EAAAA,EAAMsH,IAAIkN,cAAcvP,aAAc,GACxC,IACjBsS,EAAgBjX,EAAQrC,MACxBuZ,EAAoB,IAAI/Z,IAAIwF,EAAOhF,OAAO8H,IAAI,IAAItI,IAAI,IAAIuI,IAAIoD,EAAMlL,WACvEiS,MAAM,EAAG1S,IAAI2S,WAAWnK,WArBF,EAuBD,SAAC3H,EAAYmZ,EAAsBC,GACzD,IAAM5U,EAAU,IAAIgJ,KAAG2L,GAEjBE,EAA0C,CAC9C,iBAAkB,CAChB,CAAE9V,UAAWxD,EAAQC,EAAM,GAAIwE,QAAS,KACxC,CAAEjB,UAAWxD,EAAQC,EAAM,GAAK,EAAGwE,QAAS,KAC5C,CAAEjB,UAAWxD,EAAQC,EAAM,GAAIwE,QAASA,EAAQyN,KAAK,GAAGtK,YACxD,CAAEpE,UAAWxD,EAAQC,EAAM,GAAIwE,QAASA,EAAQmD,cASpD,MALwE,CACtE,SAAU,CAAC0R,EAAU,kBAAmB,MACxC,gBAAiB,CAACA,EAAU,kBAAmBA,EAAU,oBAGtCD,GAGmBE,CAAgBV,EAAWM,EAAmBtO,GA3C/D,mBA2ClB2O,EA3CkB,KA2CFtN,EA3CE,KA6CrB0H,EAAoB,KAEpB1H,IACF0H,EAAoB,CAClBC,SAAUlS,EAAK2H,gBACf8C,iBAAkB,CAChBC,SAAUH,KAKhBvK,EAAKiI,SAAS7C,eAAe,CAC3BC,YAAaH,EACbjC,OAAQuU,EAAkBvR,WAC1BX,IAAK,CACHzB,WAAY0T,EACZrO,SAAU2O,EACVrN,mBAAoByH,EACpBhH,gBA7CmB,OAlBE,4CAAH,sDAoExB,OACE,gCACE,wBAAQ3C,UAAU,SAAS2L,KAAK,SAASnJ,QA7E1B,kBAAMV,GAAQ,IA6E7B,2BACA,cAAC0N,GAAA,EAAD,CAAQ3N,KAAMA,EAAMQ,GAAI,CAAES,QAAS,GAAK2M,SAAS,KAAKC,QAASX,EAA/D,SACE,uBAAM/O,UAAU,cAAcmO,SAAUa,EAAxC,UACE,eAACW,GAAA,EAAD,2BAEE,cAACpN,GAAA,EAAD,CACE,aAAW,QACXC,QAASuM,EACT1M,GAAI,CACFuN,SAAU,WACVC,MAAO,EACPC,IAAK,GANT,SASE,cAAC,KAAD,SAGJ,eAACC,GAAA,EAAD,CAAe1N,GAAI,CAAEoN,SAAU,SAA/B,UACE,cAACO,GAAA,EAAD,CACEC,OAAO,SACPxX,GAAG,UACHyX,MAAM,aACNvE,KAAK,OACLwE,WAAS,EACTC,QAAQ,aAEV,cAACJ,GAAA,EAAD,CACEC,OAAO,SACPxX,GAAG,SACHyX,MAAM,SACNvE,KAAK,SACLyE,QAAQ,WACRC,WAAY,CACVC,aAAc,cAACC,GAAA,EAAD,CAAgBX,SAAS,MAAzB,SAAgC9O,EAAMU,UAEtD2O,WAAS,IAEX,uBACA,cAACK,GAAA,EAAD,CACEL,WAAS,EACT9N,GAAI,CAAE6H,UAAW,QAFnB,SAIE,eAACuG,GAAA,EAAD,CACEhY,GAAG,kBACH9C,MAAOiL,EACPsP,MAAM,WACN5E,SAxHW,SAAC3V,GACxBmZ,EAAYnZ,EAAM6V,OAAO7V,QAwHbya,QAAQ,WACRD,WAAS,EANX,UAQE,cAACO,GAAA,EAAD,CAAU/a,MAAM,SAAhB,oDACA,cAAC+a,GAAA,EAAD,CAAU/a,MAAM,gBAAhB,kEAGJ,cAACgb,GAAA,EAAD,CAAsBC,YAAaC,KAAnC,SACE,cAACC,GAAA,EAAD,CACEZ,MAAM,aACNva,MAAOiZ,EACPtD,SAAU,SAACyF,GACTlC,EAAakC,IAEfC,YACE,SAAC9Q,GAAD,OACE,cAAC8P,GAAA,EAAD,aACEC,OAAO,SACPE,WAAS,EACTC,QAAQ,YACJlQ,YAOhB,cAAC+Q,GAAA,EAAD,CAAe5O,GAAI,CAAES,QAAS,kBAA9B,SACE,wBAAQ4I,UAAWkD,EAAW5O,UAAU,4BAA4B2L,KAAK,SAAzE,8BCtEGuF,OAtGf,SACEvP,GAMA,IAAQjK,EAAsCsK,qBAAWtD,GAAjDhH,KACAqW,EAAuCpM,EAAvCoM,cAAezU,EAAwBqI,EAAxBrI,YAAajF,EAAWsN,EAAXtN,OAEpC,EAAwBuN,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAwBF,mBAAsB,MAA9C,mBAAO5L,EAAP,KAAamb,EAAb,KAEMpC,EAAc,kBAAMjN,GAAQ,IAElC,IAAKpK,EACH,MAAM1C,MAAM,4BAGd,QAAoBmF,IAAhBb,EACF,MAAMtE,MAAM,+CAGd,IAMIyV,EACA2G,EAPEC,EAAqB,uCAAG,4BAAAlZ,EAAA,6DACtBmZ,EAAKtb,EAAOA,EAAKI,UAAY,IAAO,KADd,SAEtBsB,EAAKsH,IAAIxF,UAAUF,EAAagY,GAFV,OAG5Bvd,OAAOC,SAASud,SAHY,2CAAH,qDAQtBld,GAIHoW,EAAU,YACV2G,EAAY,yCAAqC/c,EAAOuV,YAJxDa,EAAU,wBACV2G,EAAe,oCAMjB,IAAMI,EAAezD,GAAiB1Z,EAEtC,OACE,gCACE,wBACE2L,UAAU,uBACV0L,UAAW8F,EACX7F,KAAK,SACLnJ,QAnCa,kBAAMV,GAAQ,IA+B7B,SAMG2I,IAEH,sBAAMzK,UAAU,aAAhB,SACGoR,IAEH,cAAC5B,GAAA,EAAD,CAAQ3N,KAAMA,EAAMQ,GAAI,CAAES,QAAS,GAAK2M,SAAS,KAAKC,QAASX,EAA/D,SACE,uBAAM/O,UAAU,cAAhB,UACE,eAAC2P,GAAA,EAAD,2BAEE,cAACpN,GAAA,EAAD,CACE,aAAW,QACXC,QAASuM,EACT1M,GAAI,CACFuN,SAAU,WACVC,MAAO,EACPC,IAAK,GANT,SASE,cAAC,KAAD,SAGJ,eAACC,GAAA,EAAD,CAAe1N,GAAI,CAAEoN,SAAU,SAA/B,UACE,cAACkB,GAAA,EAAD,CAAsBC,YAAaC,KAAnC,SACE,cAACC,GAAA,EAAD,CACEZ,MAAM,0BACNuB,QAAS,IAAIjc,KACbG,MAAOK,EACPsV,SAAU,SAACyF,GACTI,EAAQJ,IAEVC,YACE,SAAC9Q,GAAD,OACE,cAAC8P,GAAA,EAAD,aACE3N,GAAI,CAAE4N,OAAQ,eACdA,OAAO,SACPE,WAAS,EACTC,QAAQ,YACJlQ,SAMd,wBAAQF,UAAU,uBAAuB2L,KAAK,SAASnJ,QAAS6O,EAAhE,mCCzFG,SAASK,GAAI/P,GAA4E,IAAD,IACrG,EAAwBC,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KACQiM,EAA8BpM,EAA9BoM,cAAehM,EAAeJ,EAAfI,IAAKjB,EAAUa,EAAVb,MAO5B,IAFIkB,qBAAWtD,GAHbhH,KAKS,OAAO,KAElB,IAAMuK,EAAe,OAAGF,QAAH,IAAGA,GAAH,UAAGA,EAAKG,0BAAR,iBAAG,EAAyBC,wBAA5B,aAAG,EAA2CC,SAEnE,OACE,qCACE,eAACnB,GAAA,EAAD,CAAUjB,UAAW6B,EAAO,mBAAqB,UAAWQ,GAAI,CAAE,QAAS,CAAEC,aAAc,UAA3F,UACE,cAACpB,GAAA,EAAD,UACE,cAACqB,GAAA,EAAD,CACE,aAAW,aACXnC,KAAK,QACLoC,QAAS,kBAAMV,GAASD,IAH1B,SAKGA,EAAO,cAAC,KAAD,IAA0B,cAAC,KAAD,QAGtC,cAACX,GAAA,EAAD,CAAWC,MAAM,OAAjB,SACGY,EAAItJ,KAEP,cAACyI,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,cAAC,IAAD,CAAMsB,GAAE,UAAKV,EAAIxG,YAAjB,SAAgCwG,EAAIxG,eAC5D,cAAC2F,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACG7L,EAAiByM,EAAInB,SAAS,GAAGrH,aAEpC,cAAC2H,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACG7L,EAAiByM,EAAInB,SAASmB,EAAInB,SAASlF,OAAS,GAAGnC,aAE1D,cAAC2H,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACGc,EAAkB,MAAQ,OAE7B,eAACf,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACGzL,EAAcqM,EAAIW,cAAe5B,EAAMlL,UAD1C,OAGGkL,EAAMU,OAHT,OAKE,cAACvB,GAAD,CAAWE,IAAKW,EAAMW,MAAQ,GAAIrB,KAAM,QAE1C,cAACc,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,sBAAKnB,UAAU,eAAf,UACE,qBAAKK,MAAO,CAAEE,MAAM,GAAD,OAAMwB,EAAIY,gBAAkBZ,EAAIW,cAAiB,IAAjD,MAA2D1C,UAAU,UAAxF,SACE,+BAAOtK,EAAcqM,EAAIY,gBAAiB7B,EAAMlL,cAElD,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,OAAMwB,EAAIa,kBAAoBb,EAAIW,cAAiB,IAAnD,MAA6D1C,UAAU,YAA1F,SACE,+BACGtK,EAAcqM,EAAIa,kBAAmB9B,EAAMlL,cAGhD,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,QAAOwB,EAAIW,cAAgBX,EAAIY,gBAAkBZ,EAAIa,mBAAqBb,EAAIW,cAAiB,IAA/F,MAAyG1C,UAAU,SAAtI,SACE,gCACK+B,EAAIW,cAAgBX,EAAIY,gBAAkBZ,EAAIa,mBAC7Cb,EAAIW,cAAiB,IAAOhN,EAAcqM,EAAIW,cAC9CX,EAAIY,gBAAkBZ,EAAIa,kBAAmB9B,EAAMlL,cAG3D,qBAAKyK,MAAO,CAAEE,MAAM,GAAD,OAA+C,KAAzCwB,EAAIW,cAAgBX,EAAIW,eAA9B,MAAyD1C,UAAU,WAAtF,0BAIN,cAACiB,GAAA,EAAD,CAAUoB,GAAI,CAAEQ,WAAY,WAA5B,SACE,cAAC3B,GAAA,EAAD,CAAWb,MAAO,CAAEyC,QAAS,GAAKC,QAAS,EAA3C,SACE,cAACC,GAAA,EAAD,CAAUC,GAAIpB,EAAMqB,QAAQ,OAAOC,eAAa,EAAhD,SACE,qBAAKnD,UAAU,aAAf,SACE,sBAAKK,MAAO,CAAE+C,QAAS,OAAQC,IAAK,IAApC,UACE,cAAC1C,GAAD,CAAeC,SAAUmB,EAAInB,SAAUC,MAAM,kBAAkBC,MAAOA,IACrEmB,GACC,cAACtB,GAAD,CAAeC,SAAUqB,EAAiBpB,MAAM,mBAAmBC,MAAOA,IAE5E,qBAAKd,UAAU,YAAf,SACE,cAAC,GAAD,CAAiB+N,cAAeA,EAAezU,YAAayI,EAAItJ,GAAIpE,OAAQ0N,EAAIG,qCCnFnF,SAASyP,GAAT,GAEZ,IADC5R,EACF,EADEA,QAASe,EACX,EADWA,MAAOiN,EAClB,EADkBA,cAElB,OACE,eAAChN,EAAA,EAAD,CAAOf,UAAU,aAAa,aAAW,oBAAzC,UACE,cAACgB,GAAA,EAAD,CAAWhB,UAAU,aAArB,SACE,eAACiB,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,IACA,cAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,OAAjB,wBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,2BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,yBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,0BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,6BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAGJ,cAACC,GAAA,EAAD,UACGrB,EAAQpJ,KAAI,SAAC4M,GAAD,OACX,cAACmO,GAAD,CAAqB3P,IAAKwB,EAAQzC,MAAOA,EAAOiN,cAAeA,GAArDxK,EAAO9K,YCnBZ,SAASmZ,GAAT,GAAmH,IAAhG7R,EAA+F,EAA/FA,QAASe,EAAsF,EAAtFA,MAAOiN,EAA+E,EAA/EA,cAC1C8D,EAAcC,MAAMC,KAAK,IAAIC,IAAIjS,EAAQpJ,KAAI,SAAC0K,GAAD,OAAOA,EAAE9F,gBAE5DpH,QAAQC,IAAI,eAAgByd,GAE5B,IACEna,EAGEsK,qBAAWtD,GAHbhH,KAKF,IAAKA,EAAM,OAAO,KAElB,IAAQmI,EAAsBnI,EAAtBmI,SAAUN,EAAY7H,EAAZ6H,QAElB,OACE,sBAAKS,UAAU,YAAf,UAEGH,GAAYkO,GAAiBxO,GAAW,cAACoP,GAAD,CAAc7N,MAAOA,IAE9D,cAACmR,GAAA,EAAD,CAAgB5P,GAAI,CAAE6P,UAAW,QAASjC,OAAQ,YAAc3O,UAAW6Q,KAA3E,SACE,cAACR,GAAD,CAAc5R,QAASA,EAASe,MAAOA,EAAOiN,cAAeA,SCDtDqE,OAzBf,SAAyBlS,GACvB,IAAQxI,EAAsCsK,qBAAWtD,GAAjDhH,KACA0D,EAA4B8E,EAA5B9E,UAAW0F,EAAiBZ,EAAjBY,MAAOlG,EAAUsF,EAAVtF,MAE1B,IAAKlD,EACH,MAAM1C,MAAM,4BAGd,IAAKoG,EACH,MAAMpG,MAAM,kCAOd,OACE,sBAAKgL,UAAU,gBAAf,UACE,iDACA,cAAC4L,GAAD,CAAoB9K,MAAOA,EAAOnG,OAAQC,IAC1C,wBAAQoF,UAAU,mBAAmB2L,KAAK,SAASnJ,QARzB,WAC5B9K,EAAK0H,WAAWlD,MAAMd,IAOpB,2BCVS,SAASiX,GAAT,GAAmI,IAAnGC,EAAkG,EAA3GvS,QAAqBe,EAAsF,EAAtFA,MAAOiN,EAA+E,EAA/EA,cACxDwE,EAAWnG,cAAXmG,OAEFxS,EAAUuS,EAAW1W,QAAO,SAACyF,GAAD,OAAOA,EAAE9F,aAAegX,KAEpDC,EAAwBzS,EAAQ0S,QAAO,SAACC,EAAKC,GAAN,OAAcD,EAAM7X,WAAW8X,EAAI/P,qBAAoB,GAIpG,OAFAzO,QAAQC,IAAI,eAAgBme,EAAQxS,GAGlC,sBAAKC,UAAU,YAAf,WAEI+N,GAAiB,cAAC6E,GAAD,CAAiBxX,UAAWmX,EAAQzR,MAAOA,EAAOlG,MAAOlF,EAAc8c,EAAuB1R,EAAMlL,YAEvH,cAACqc,GAAA,EAAD,CAAgB5P,GAAI,CAAE6P,UAAW,SAAW5Q,UAAW6Q,KAAvD,SACE,eAACpR,EAAA,EAAD,CAAOf,UAAU,aAAa,aAAW,oBAAzC,UACE,cAACgB,GAAA,EAAD,CAAWhB,UAAU,aAArB,SACE,eAACiB,GAAA,EAAD,WACE,cAACC,GAAA,EAAD,IACA,cAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,OAAjB,wBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,2BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,yBACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,0BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,6BACA,cAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAGJ,cAACC,GAAA,EAAD,UACGrB,EAAQpJ,KAAI,SAAC4M,GAAD,OACX,cAACmO,GAAD,CAAqB3P,IAAKwB,EAAQzC,MAAOA,EAAOiN,cAAeA,GAArDxK,EAAO9K,iBCxC/B,SAASoa,GAAT,GAAsD,IAAtCC,EAAqC,EAArCA,SACd,OAAO,qBAAK9S,UAAU,kBAAf,SAAkC8S,IAsB5BC,OAnBf,WACE,MAII/Q,qBAAWtD,GAHbhH,EADF,EACEA,KAAMwW,EADR,EACQA,OAKR,IAAKxW,EAAM,OAAO,KAElB,IAAQmI,EAAsBnI,EAAtBmI,SAAUN,EAAY7H,EAAZ6H,QAElB,OACE,eAACsT,GAAD,WACIhT,IAAaN,GAAW,cAAC+N,GAAA,EAAD,CAAOjL,GAAI,CAAE4N,OAAQ,EAAG1P,MAAO,SAAWgN,SAAS,QAAnD,gCACvB1N,GAAY,wBAAQG,UAAU,SAAS2L,KAAK,SAASnJ,QAAS0L,EAAlD,qBACbrO,GAAYN,GAAW,cAAC,IAAD,CAAUkD,GAAG,UAAUuQ,SAAO,QCpB9C,SAASC,GAAT,GAA+D,IAAxCH,EAAuC,EAAvCA,SAC9B9e,EAAWkf,cAEfxb,EAGEsK,qBAAWtD,GAHbhH,KAKF,IAAKA,EAAM,OAAO,KAElB,IAAQmI,EAAsBnI,EAAtBmI,SAAUN,EAAY7H,EAAZ6H,QAElB,OAAKM,GAAaN,EAIXuT,EAHE,cAAC,IAAD,CAAUrQ,GAAG,SAAS0Q,MAAO,CAAEpB,KAAM/d,GAAYgf,SAAO,ICInE,SAASI,GAAT,GAAoH,IAAhGrT,EAA+F,EAA/FA,QAASe,EAAsF,EAAtFA,MAAOnE,EAA+E,EAA/EA,WAClC,OACE,qCACE,cAACmR,GAAD,CAAQC,eAAe,IACvB,eAAC,IAAD,WACE,cAAC,IAAD,CAAOsF,KAAK,IAAIC,QAAS,cAAC,IAAD,CAAUN,SAAO,EAACvQ,GAAG,cAC9C,cAAC,IAAD,CAAO4Q,KAAK,SAASC,QAAS,cAACxT,EAAD,CAAOC,QAASA,EAAS7B,iBAAkBvB,MACzE,cAAC,IAAD,CAAO0W,KAAK,WAAWC,QAAS,cAAC1B,GAAD,CAAS7R,QAASA,EAASe,MAAOA,EAAOiN,eAAe,MACxF,cAAC,IAAD,CAAOsF,KAAK,mBAAmBC,QAAS,cAACjB,GAAD,CAAatS,QAASA,EAASe,MAAOA,EAAOiN,eAAe,YAM5G,SAASwF,GAAT,GAA2H,IAA1GxT,EAAyG,EAAzGA,QAASe,EAAgG,EAAhGA,MAAOxB,EAAyF,EAAzFA,gBAC/B,OACE,qCACE,cAACwO,GAAD,CAAQC,eAAa,IACrB,eAAC,IAAD,WACE,cAAC,IAAD,CAAOsF,KAAK,IAAIC,QAAS,cAAC,GAAD,MACzB,cAAC,IAAD,CAAOD,KAAK,SAASC,QAAS,cAACxT,EAAD,CAAOC,QAASA,EAAS7B,iBAAkBoB,MACzE,cAAC,IAAD,CAAO+T,KAAK,WAAWC,QAAS,cAACL,GAAD,UAAa,cAACrB,GAAD,CAAS7R,QAASA,EAASe,MAAOA,EAAOiN,eAAa,QACnG,cAAC,IAAD,CAAOsF,KAAK,mBAAmBC,QAAS,cAACL,GAAD,UAAa,cAACZ,GAAD,CAAatS,QAASA,EAASe,MAAOA,EAAOiN,eAAa,QAC/G,cAAC,IAAD,CAAOsF,KAAK,gBAAgBC,QAAS,cAACL,GAAD,UAAa,cAACzF,GAAD,CAAsB1M,MAAOA,QAC/E,cAAC,IAAD,CAAOuS,KAAK,8BAA8BC,QAAS,cAACL,GAAD,UAAa,cAAC9G,GAAD,CAAgBrL,MAAOA,QACvF,cAAC,IAAD,CAAOuS,KAAK,sBAAsBC,QAAS,cAACL,GAAD,UAAa,cAAC,GAAD,CAAkBnS,MAAOA,cAM1E,SAAS0S,KACtB,IAAQ9b,EAAsCsK,qBAAWtD,GAAjDhH,KACR,EAA0CkK,mBAAS,IAAnD,mBAAO6R,EAAP,KAAsBC,EAAtB,KACA,EAAoC9R,mBAAwB,MAA5D,mBAAOjF,EAAP,KAAmBgX,EAAnB,KACA,EAA0B/R,mBAAoB,CAC5ChM,SAAU,EACV6L,KAAM,KACN3D,KAAM,GACN8V,UAAW,KACXC,eAAgB,KAChBC,KAAM,GACNtS,OAAQ,KAPV,mBAAOV,EAAP,KAAciT,EAAd,KAwCA,GA9BAnH,qBAAU,WACR,IAAIoH,GAAS,EAEb,GAAItc,EAAM,CACR,IAAMuc,EAAI,uCAAG,8BAAA9b,EAAA,sEACWT,EAAKsH,IAAIkV,iBADpB,cACLnU,EADK,gBAEYrI,EAAKiI,SAASwU,aAF1B,UAELC,EAFK,OAGNJ,EAHM,iDAMXD,EAASK,GACTV,EAAiB,CAAE3T,UAASjC,KAAM,SAPvB,4CAAH,qDAUNpG,EAAK4H,iBACP2U,IAIJ,OAAO,WAAQD,GAAS,KACvB,CAACtc,IAEJkV,qBAAU,WAKR,OAJIlV,GAAQA,EAAKiI,UACfgU,EAAcjc,EAAKiI,SAASuM,cAAcvP,YAGrC,eACN,CAACjF,IAEsC,IAAtClB,OAAOC,KAAKgd,GAAe/X,OAAc,OAAO,KAEpD,IAAQqE,EAAiB0T,EAAjB1T,QAER,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOsT,KAAK,UAAUC,QAAS,cAACF,GAAD,CAAUrT,QAASA,EAASe,MAAOA,EAAOnE,WAAYA,MACrF,cAAC,IAAD,CAAO0W,KAAK,gBAAgBC,QAAS,cAACC,GAAD,CAAOxT,QAASA,EAASe,MAAOA,EAAOxB,gBAAiB3C,MAC7F,cAAC,IAAD,CAAO0W,KAAK,uBAAuBC,QAAS,cAACrF,GAAD,W,OCjGrC,SAASoG,KACtB,MAAwBzS,mBAA4B,MAApD,mBAAOlK,EAAP,KAAa4c,EAAb,KAEA1H,qBAAU,WAAM,4CACd,4BAAAzU,EAAA,sEACqCyG,IADrC,OACQ2V,EADR,OAEED,EAAQC,GAFV,4CADc,sBAMd,KANe,WAAD,wBAOZC,GACA,MAAO/I,GACPtX,QAAQC,IAAIqX,MAEb,IAEH,IAAM9V,EAAQ8e,mBAAQ,iBAAO,CAC3B/c,OACAwW,OAAQ,WAAO,IAAD,EAAM,OAAJxW,QAAI,IAAJA,GAAA,UAAAA,EAAMsH,WAAN,SAAWkP,UAC3B9T,QAAS,WACF1C,IAELA,EAAKsH,IAAI5E,UACTka,EAAQ,2BACH5c,GADE,IAELmI,UAAU,EACVR,gBAAiB,aAGnB,CAAC3H,IAEL,OACE,cAAC,aAAD,UACE,cAACgH,EAAYgW,SAAb,CAAsB/e,MAAOA,EAA7B,SACE,cAAC6d,GAAD,QCtCRmB,iBACE,cAACN,GAAD,IACAO,SAASC,eAAe,W","file":"static/js/main.cbe7e409.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n  factoryContractHash: string,\n}\n\n// const CONTRACT_NAME = process.env.REACT_APP_CONTRACT_NAME || 'ft-lockup.demo005.ft-lockup.testnet';\nconst FACTORY_CONTRACT_NAME = process.env.FACTORY_CONTRACT_NAME || 'factory0.ft-lockup.testnet';\nconst FACTORY_CONTRACT_HASH = process.env.FACTORY_CONTRACT_HASH || 'C6w1pKPB9H6HcceqPG9qxS2bLTWgsBwQCj4T2xrz63a3';\n\nexport const CONTRACT_NAME = window.location.hash.split('/')[1] || 'ft-lockup.demo005.ft-lockup.testnet';\n\nconsole.log(CONTRACT_NAME);\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\n\nexport const MAX_GAS = 300_000_000_000_000;\n\nBig.DP = 40;\nBig.PE = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\nexport const convertTimestamp = (time: number) => new Date(time * 1000).toLocaleDateString('en-US');\nexport const convertAmount = (value: number, decimals: number) => Big(value || '0').div(10 ** decimals).toFixed(NEAR_ROUND_DIGITS);\n// @ts-ignore\nexport const addYear = (date: Date, year: number) => new Date(new Date(date).setFullYear((date.getFullYear()) + year)).getTime() / 1000;\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'convert_draft',\n  'convert_drafts',\n  'terminate',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'convert_draft': any,\n  'convert_drafts': any,\n  'terminate': any,\n};\n\nexport type TNearAmount = string;\nexport type TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TSchedule = TCheckpoint[];\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TSchedule,\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ drafts }, '200000000000000');\n\n    return result;\n  }\n\n  async convertDraft(index: DraftIndex): Promise<LockupIndex> {\n    const result = await this.contract.convert_draft({ draft_id: index });\n\n    return result;\n  }\n\n  async convertDrafts(indices: DraftIndex[]): Promise<LockupIndex[]> {\n    const result = await this.contract.convert_drafts({ draft_ids: indices }, '200000000000000');\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number, timestamp: number | null): Promise<void> {\n    try {\n      const result = await this.contract.terminate(\n        { lockup_index: lockupIndex, termination_timestamp: timestamp },\n        MAX_GAS,\n      );\n      return result;\n    } catch (e) {\n      throw Error('Cannot terminate lockup');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getWalletConnection(): WalletConnection {\n    return this.walletConnection;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    this.walletConnection.requestSignIn(this.near.config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TSchedule, TNearAmount } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TTerminationConfig = {\n  payer_id: string,\n  vesting_schedule: {\n    Schedule: TSchedule,\n  },\n};\n\ntype TLockupCreate = {\n  account_id: string,\n  schedule: TSchedule,\n  termination_config: TTerminationConfig | null,\n  claimed_balance: TNearAmount,\n};\n\ntype TDraftGroupFund = {\n  draft_group_id: number,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  async fundDraftGroup(lockupContractId: string, draftGroupId: number, amount: string): Promise<void> {\n    const result = this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount,\n      msg: {\n        draft_group_id: draftGroupId,\n      },\n    });\n\n    return result;\n  }\n\n  ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: TLockupCreate | TDraftGroupFund,\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): void {\n    const { msg, ...rest } = meta;\n\n    this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n}\n\nexport default TokenApi;\n","import Big from 'big.js';\n\nimport {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst DEPLOY_DEPOSIT = new Big(4).mul(new Big(10).pow(24)).toString();\n\nconst FACTORY_CHANGE_METHODS = [\n  'create',\n];\n\ntype TFactoryChangeMethods = {\n  'create': (opts: {\n    name: string, hash: string, access_keys: string[], method_name: string, args: string,\n  }, deposit: string | number, gas: string | number) => any,\n};\n\ntype TFactoryContract = Contract & TFactoryChangeMethods;\n\nclass FactoryApi {\n  private contract: TFactoryContract;\n\n  private hash: string;\n\n  constructor(walletConnection: WalletConnection, contractId: string, hash: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: [], changeMethods: FACTORY_CHANGE_METHODS },\n    ) as TFactoryContract;\n    this.hash = hash;\n  }\n\n  getContract(): TFactoryContract {\n    return this.contract;\n  }\n\n  async create(name: string, tokenAccountId: string, depositWhitelist: string[]): Promise<void> {\n    const argsRaw = {\n      token_account_id: tokenAccountId,\n      deposit_whitelist: depositWhitelist,\n    };\n    const argsPacked = btoa(JSON.stringify(argsRaw));\n    const result = await this.contract.create({\n      name,\n      hash: this.hash,\n      access_keys: [],\n      method_name: 'new',\n      args: argsPacked,\n    }, MAX_GAS, DEPLOY_DEPOSIT);\n\n    console.log(result);\n\n    return result;\n  }\n}\n\nexport default FactoryApi;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport TokenApi from './tokenApi';\nimport FactoryApi from './factoryApi';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  signedIn: boolean;\n  isAdmin: boolean;\n  signedAccountId: string | null;\n  tokenContractId: string;\n  tokenApi: TokenApi;\n  factoryApi: FactoryApi;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  let tokenContractId: string = '';\n  let isAdmin: boolean = false;\n  try {\n    tokenContractId = await api.getTokenAccountId();\n    const depositWhitelist = await api.getDepositWhitelist();\n    isAdmin = depositWhitelist.includes(signedAccountId);\n  } catch (e) {\n    console.log(e);\n  }\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n  const factoryApi = new FactoryApi(\n    walletConnection,\n    config.factoryContractName,\n    config.factoryContractHash,\n  );\n\n  return {\n    config,\n    api,\n    tokenContractId,\n    noLoginApi,\n    signedIn: !!signedAccountId,\n    isAdmin,\n    signedAccountId,\n    tokenApi,\n    factoryApi,\n  };\n};\n","import { config } from '../../config';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  return (\n    <div className=\"container\">\n      <h1>About Page</h1>\n\n      <pre>\n        {`\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ${config.contractName}\n          token account id: ${token_account_id}\n\n          Total number of lockups: ${lockups.length}\n        `}\n      </pre>\n\n    </div>\n  );\n}\n","export default function TokenIcon(params: { url: string, size: number }) {\n  const { url, size } = params;\n  return (\n    <img\n      style={{\n        height: size, width: size, verticalAlign: 'middle',\n      }}\n      src={url}\n      alt=\"Token Icon\"\n    />\n  );\n}\n","import {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport TokenIcon from '../TokenIcon';\n\nexport default function ScheduleTable(params: { token: TMetadata, title: String, schedule: TSchedule }) {\n  const { schedule, title, token } = params;\n\n  return (\n    <div className=\"inner-table_wrapper\">\n      <h5>{title}</h5>\n      <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n        <TableHead>\n          <TableRow>\n            <TableCell>DATE</TableCell>\n            <TableCell align=\"right\">AMOUNT</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {schedule.map((x: any) => (\n            <TableRow key={x.timestamp}>\n              <TableCell component=\"th\" scope=\"row\">\n                {convertTimestamp(x.timestamp)}\n              </TableCell>\n              <TableCell align=\"right\">\n                {convertAmount(x.balance, token.decimals)}\n                &nbsp;\n                {token.symbol}\n                &nbsp;\n                <TokenIcon url={token.icon || ''} size={32} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\n\nexport default function DraftsTableRow(props: { row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">{row.id}</TableCell>\n        <TableCell align=\"left\"><Link to={signedIn ? `/admin/lockups/${row.account_id}` : `/lockups/${row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div style={{ display: 'flex', gap: 20 }}>\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                  <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport DraftsTableRow from './row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function DraftsTable({ lockups, token }: { lockups: any[], token: TMetadata }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <DraftsTableRow key={lockup.id} row={lockup} token={token} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import BN from 'bn.js';\nimport Big from 'big.js';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+(\\.[0-9]+)?$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = parseInt(percentageRaw, 10);\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = parseTimestamp(timestampStartRaw);\n  const durationTotal = parseDuration(durationTotalRaw);\n  const cliffInfo = parseCliffInfo(cliffInfoRaw);\n  const releaseEvery = parseDuration(releaseEveryRaw);\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = {\n  account_id: string,\n  amount: string,\n  lockup_schedule: string,\n  vesting_schedule: string,\n};\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const accountId = parseValidAccountId(input.account_id);\n  const amount = parseTokenAmount(input.amount);\n  const lockupSchedule = parseHumanFriendlySchedule(input.lockup_schedule);\n  const vestingSchedule = input.vesting_schedule === '' ? null : parseHumanFriendlySchedule(input.vesting_schedule);\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = string;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\ntype TerminationConfig = {\n  payer_id: ValidAccountId,\n  vesting_schedule: {\n    Schedule: Schedule,\n  },\n};\n\nexport const buildTerminationConfig = (schedule: Schedule, payer_id: ValidAccountId): TerminationConfig => ({\n  payer_id,\n  vesting_schedule: {\n    Schedule: schedule,\n  },\n});\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new Big(10).pow(tokenDecimals);\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(new Big(inputTotalAmount).mul(decimalsMultiplier).round(0, Big.roundDown).toString());\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const { releaseEvery } = schedule;\n\n  const tmCliff = timestampCliff;\n  const tmFirstStep = datePlusDurationMul(timestampCliff, releaseEvery, 1);\n  if (toUnix(tmFirstStep) <= toUnix(tmCliff)) {\n    throw new Error('invalid releaseEvery, zero duration');\n  }\n  if (toUnix(tmFirstStep) - toUnix(tmCliff) === 1) { // linear unlock during cliff\n    const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n    const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n    const cpCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount.toString() };\n    const cpFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount.toString() };\n\n    const result = [];\n    result.unshift(cpFinish);\n    if (cpCliff.timestamp < cpFinish.timestamp) {\n      result.unshift(cpCliff);\n    }\n    result.unshift(cpPreCliff);\n    if (cpStart.timestamp < cpPreCliff.timestamp) {\n      result.unshift(cpStart);\n    }\n\n    return result;\n  }\n\n  const tms = [];\n  {\n    // otherwise: use steps\n    let tm = timestampCliff;\n    const maxSteps = 100;\n    for (;;) {\n      if (tm >= timestampFinish) {\n        tm = timestampFinish;\n        tms.push(tm);\n        break;\n      }\n      tms.push(tm);\n      tm = datePlusDurationMul(tm, releaseEvery, 1);\n      if (tms.length >= maxSteps) {\n        throw new Error('too many checkpoints for schedule');\n      }\n    }\n  }\n\n  const increment = totalAmount.sub(cliffAmount).divn(tms.length - 1);\n\n  const cps: Checkpoint[] = tms.flatMap((tm, i) => {\n    if (tms.length === 1) {\n      return [{ timestamp: toUnix(timestampFinish), balance: totalAmount.toString() }];\n    }\n    if (i === 0) {\n      return [{ timestamp: toUnix(tm), balance: cliffAmount.toString() }];\n    }\n    const stepBalance = i === tms.length - 1\n      ? totalAmount\n      : cliffAmount.add(increment.muln(i)).toString();\n    return [\n      { timestamp: toUnix(tm) - 1, balance: cliffAmount.add(increment.muln(i - 1)).toString() },\n      { timestamp: toUnix(tm), balance: stepBalance.toString() },\n    ];\n  });\n\n  const cpsStart: Checkpoint[] = [];\n  const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n  const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n\n  cpsStart.unshift(cpPreCliff);\n  if (cpStart.timestamp < cpPreCliff.timestamp) {\n    cpsStart.unshift(cpStart);\n  }\n\n  const result = cpsStart.concat(cps);\n  return result;\n};\n\nexport type Lockup = {\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  claimed_balance: Balance,\n  termination_config: TerminationConfig | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number, payerId: NearAccountId): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  let terminationConfig;\n  if (row.vesting_schedule) {\n    terminationConfig = buildTerminationConfig(toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals), payerId);\n  } else {\n    terminationConfig = null;\n  }\n\n  return {\n    account_id: row.account_id,\n    schedule: toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals),\n    claimed_balance: new BN(0).toString(),\n    termination_config: terminationConfig,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number, payerId: NearAccountId): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x) => parseLockup(x, tokenDecimals, payerId));\n};\n","import LinearProgress from '@mui/material/LinearProgress';\n\nexport default function ProcessLog(params: { lines: string[], inProgress: boolean }) {\n  const { lines, inProgress } = params;\n  return (\n    <div className=\"process-log\">\n      {lines.map((x) => (\n        <div>{x}</div>\n      ))}\n      {inProgress && (<LinearProgress color=\"inherit\" style={{ marginTop: 10 }} />)}\n    </div>\n  );\n}\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport DraftsTable from '../DraftsTable';\nimport { parseRawSpreadsheetInput, Lockup } from '../../services/spreadsheetImport';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport ProcessLog from '../ProcessLog';\n\nfunction ImportDraftGroup({ token }: { token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<Lockup[]>([]);\n  const [importLog, setImportLog] = useState<string[]>([]);\n  const [importProgress, setImportProgress] = useState<boolean>(false);\n\n  const log = (message: string) => {\n    console.log(message);\n    setImportLog((currentLog) => currentLog.concat([message]));\n  };\n\n  const clearLog = () => {\n    setImportLog([]);\n  };\n\n  console.log(setData);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      if (!near?.signedAccountId) {\n        throw new Error('expected present signedAccountId');\n      }\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInput(input, token.decimals, near.signedAccountId);\n      setData(lockups);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const handleClickImport = async () => {\n    if (!near) {\n      throw new Error('near is null');\n    }\n    setImportProgress(true);\n    try {\n      clearLog();\n      log('creating draft group...');\n      const draftGroupId = await near.api.createDraftGroup();\n      const msg = `created draft group id: ${draftGroupId}`;\n      log(msg);\n\n      const chunkSize = 100;\n      for (let i = 0; i < data.length; i += chunkSize) {\n        const chunk = data.slice(i, i + chunkSize);\n        log(`adding drafts (${i}/${data.length})...`);\n        const drafts = chunk.map((lockup) => ({\n          draft_group_id: draftGroupId,\n          lockup,\n        }));\n        await near.api.createDrafts(drafts);\n      }\n\n      log(`added lockups (${data.length})`);\n\n      navigate(`/admin/draft_groups/${draftGroupId}`);\n    } catch (e) {\n      log(`ERROR: ${e}`);\n      setImportProgress(false);\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <h3>\n        Import Draft Group\n      </h3>\n      <div>\n        Copy lockups from a spreadsheet editor and paste into the area below.\n        See\n        {' '}\n        <a href={`${process.env.PUBLIC_URL}/lockup_import_example.xlsx`}>\n          example and format specifications\n        </a>\n        .\n      </div>\n      <div>\n        <TextareaAutosize\n          style={{ width: '100%', marginTop: 20 }}\n          id=\"spreadsheet-input\"\n          placeholder=\"Excel input\"\n          maxRows={5}\n          onChange={handleChangeInput}\n        />\n      </div>\n      <DraftsTable lockups={data} token={token} />\n      <br />\n      <div>\n        <button disabled={!(data.length >= 1 && !importProgress)} className=\"button noMargin\" onClick={handleClickImport} type=\"button\">\n          Import\n        </button>\n      </div>\n      <br />\n      {(importLog.length > 0) && (\n        <ProcessLog lines={importLog} inProgress={importProgress} />\n      )}\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\n\nexport default function TokenAmountPreview(params: { token: TMetadata, amount: String }) {\n  const { token, amount } = params;\n\n  return (\n    <div className=\"balance-info-block\" style={{ display: 'flex' }}>\n      <div style={{ flex: 1, alignContent: 'center' }} className=\"amount-info\">\n        <div className=\"token-symbol\">\n          {token.symbol}\n        </div>\n        <div className=\"token-amount\">\n          {amount}\n        </div>\n      </div>\n      <div style={{ flex: 1 }}>\n        <TokenIcon url={token.icon || ''} size={64} />\n      </div>\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction FundButton(props: { draftGroupIndex: number | undefined, amount: string | undefined }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (draftGroupIndex === undefined) {\n    throw Error('Cannot fund draft group without index');\n  }\n\n  if (amount === undefined) {\n    throw Error('Cannot fund draft group without specified amount');\n  }\n\n  const handleFund = () => {\n    near.tokenApi.fundDraftGroup(\n      near.api.getContract().contractId,\n      draftGroupIndex,\n      amount,\n    );\n  };\n\n  return (\n    <button className=\"button fullWidth\" type=\"button\" onClick={handleFund}>Fund</button>\n  );\n}\n\nexport default FundButton;\n","import { useState, useEffect, useContext } from 'react';\nimport { Alert } from '@mui/material';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport TokenAmountPreview from '../../components/TokenAmountPreview';\nimport FundButton from '../../components/FundButton';\nimport ProcessLog from '../../components/ProcessLog';\n\nexport default function PageDraftGroup({ token }: { token: TMetadata }) {\n  const draftGroupId = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n  const [processLog, setProcessLog] = useState<string[]>([]);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n\n  const log = (message: string) => {\n    console.log(message);\n    setProcessLog((oldLog) => oldLog.concat([message]));\n  };\n  const clearLog = () => {\n    setProcessLog([]);\n  };\n\n  console.log(token);\n  console.log(draftGroup);\n  console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroup(draftGroupId);\n      console.log(result);\n      setDraftGroup(result);\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup) {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      console.log(result);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  const navigate = useNavigate();\n\n  const handleConvert = () => {\n    const convertDrafts = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      try {\n        setInProgress(true);\n        clearLog();\n        const draftIds = draftGroup.draft_indices;\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n          log(`converting drafts (${i}/${draftIds.length})...`);\n          await near.api.convertDrafts(chunk);\n        }\n        log('conversion finished');\n        navigate('/admin/lockups');\n      } catch (e) {\n        log(`ERROR: ${e}`);\n      } finally {\n        setInProgress(false);\n      }\n    };\n\n    convertDrafts();\n  };\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"draft-group-preview-wrapper\">\n        <h5>\n          {`Draft group ${draftGroupId}`}\n        </h5>\n        <TokenAmountPreview token={token} amount={convertAmount(draftGroup.total_amount, token.decimals)} />\n\n        {!draftGroup.funded && (\n          <div style={{ marginTop: 20 }}>\n            <FundButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} />\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length > 0 && (\n          <button className=\"button fullWidth\" type=\"button\" onClick={handleConvert}>Convert</button>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length === 0 && (\n          <div style={{ marginTop: 20 }}>\n            <Alert severity=\"success\">Draft Group converted</Alert>\n          </div>\n        )}\n      </div>\n\n      {(processLog.length > 0) && (\n        <ProcessLog lines={processLog} inProgress={inProgress} />\n      )}\n\n      {(!draftGroup.funded || draftGroup.draft_indices.length > 0) && (\n        <DraftsTable lockups={drafts} token={token} />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link } from 'react-router-dom';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport TokenIcon from '../../components/TokenIcon';\n\nexport default function PageDraftGroupsIndex({ token }: { token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n  // const [drafts, setDrafts] = useState<any[]>([]);\n\n  // console.log(token);\n  // console.log(draftGroup);\n  // console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      console.log(result);\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  return (\n    <div className=\"container\">\n      <h1>\n        All draft groups\n      </h1>\n\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"center\">Funded</TableCell>\n            <TableCell align=\"right\">Number&nbsp;of&nbsp;lockups</TableCell>\n            <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {draftGroups.map((group) => (\n            <TableRow>\n              <TableCell align=\"left\">\n                <Link to={`/admin/draft_groups/${group.id}`}>{group.id}</Link>\n              </TableCell>\n              <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n              <TableCell align=\"right\">{group.draft_indices.length}</TableCell>\n              <TableCell align=\"right\">\n                {convertAmount(group.total_amount, token.decimals)}\n                &nbsp;\n                {token.symbol}\n                &nbsp;\n                <TokenIcon url={token.icon || ''} size={32} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n\n      <br />\n\n      <Link to=\"/admin/import_draft_group\">\n        <button className=\"button\" type=\"button\">Import Draft Group</button>\n      </Link>\n    </div>\n  );\n}\n","import { Link } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\nimport { CONTRACT_NAME } from '../../config';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  console.log(CONTRACT_NAME);\n\n  const { signedIn, signedAccountId, isAdmin } = near;\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to={adminControls && isAdmin ? `/${CONTRACT_NAME}/admin/lockups` : `/${CONTRACT_NAME}/lockups`}>Lockups</Link>\n            <Link className=\"nav-link\" to={adminControls ? `/${CONTRACT_NAME}/admin/about` : `/${CONTRACT_NAME}/about`}>About</Link>\n            {adminControls && (<Link className=\"nav-link\" to={`/${CONTRACT_NAME}/admin/draft_groups`}>Draft Groups</Link>)}\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span>\n                {signedAccountId}\n                {' '}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { useContext } from 'react';\n\nimport Header from '../../components/Header';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function NewLockupContract() {\n  const { near, signIn }: { near: INearProps | null, signIn: () => void } = useContext(NearContext);\n\n  const handleDeployLockupContract = (e: any) => {\n    e.preventDefault();\n\n    const perform = async () => {\n      if (!near?.signedAccountId) {\n        throw new Error('expected signedAccountId to be present');\n      }\n\n      // const lockupCreator: string = near.signedAccountId;\n      const lockupOperators: string[] = e.target.elements.lockup_operators.value\n        .split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n      const tokenAccountId: string = e.target.elements.token_account_id.value;\n      const lockupSubaccountId: string = e.target.elements.lockup_subaccount_id.value;\n\n      if (lockupOperators.length === 0) {\n        throw new Error('empty lockup operators');\n      }\n\n      if (tokenAccountId.length === 0) {\n        throw new Error('empty tokenAccountId');\n      }\n\n      if (lockupSubaccountId.length === 0) {\n        throw new Error('empty lockupSubaccountId');\n      }\n\n      // const message = `\n      //   lockup_creator: ${lockupCreator}\n      //   lockup_operators: ${JSON.stringify(lockupOperators)}\n      //   token_account_id: ${tokenAccountId}\n      //   lockup_subaccount_id: ${lockupSubaccountId}\n      // `;\n      // alert(message);\n\n      const result = await near.factoryApi.create(\n        lockupSubaccountId,\n        tokenAccountId,\n        lockupOperators,\n      );\n\n      console.log(result);\n\n      return result;\n    };\n\n    perform();\n  };\n\n  if (!(near)) {\n    return null;\n  }\n\n  return (\n    <div>\n      <Header adminControls={false} />\n      <div className=\"container new-lockup-contract\">\n        <h1>\n          Create Lockup Contract for your Fungible Tokens\n        </h1>\n\n        <form className=\"form-submit\" onSubmit={handleDeployLockupContract}>\n          <div className=\"form-wrapper\">\n            On this page you can deploy your own copy of lockup contract. Some more elaborative description follows here.\n\n            <div className=\"form-row\">\n              <span>Contract creator: </span>\n              <span>\n                {near.signedAccountId}\n                {' '}\n                <button className=\"button\" type=\"button\" onClick={signIn}>\n                  {near.signedAccountId && 'Login as someone else' || 'Login'}\n                </button>\n              </span>\n            </div>\n            <div className=\"form-row\">\n              <span>Lockup operators: </span>\n              <input id=\"lockup_operators\" />\n            </div>\n            <div className=\"form-row\">\n              <span>Fungible token contract address: </span>\n              <input id=\"token_account_id\" />\n            </div>\n            <div className=\"form-row\">\n              <span>New Lockup Contract Address: </span>\n              <input id=\"lockup_subaccount_id\" />\n            </div>\n\n            <button className=\"button\" type=\"submit\" disabled={!near.signedAccountId}>\n              Deploy Contract\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport BN from 'bn.js';\nimport Big from 'big.js';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TSchedule } from '../../services/api';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n    if (!near.signedAccountId) {\n      throw new Error('signedAccountId requred to set lockup terminator');\n    }\n    if (!startDate) {\n      throw Error('Start date not set');\n    }\n\n    e.preventDefault();\n\n    const { account, amount } = e.target.elements;\n\n    console.log(account.value, amount.value);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const claimedBalance = '0';\n    const userAccountId = account.value;\n    const lockupTotalAmount = new Big(amount.value).mul(new Big(10).pow(token.decimals))\n      .round(0, Big.roundDown).toString();\n\n    const getScheduleList = (date: Date, balanceInput: string, selected: string): [TSchedule, TSchedule | null] => {\n      const balance = new BN(balanceInput);\n\n      const schedules: { [key: string]: TSchedule } = {\n        '4y_cliff_1y_25': [\n          { timestamp: addYear(date, 0), balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: balance.divn(4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n\n      const schedulePairs: { [key: string]: [TSchedule, TSchedule | null] } = {\n        '4_year': [schedules['4y_cliff_1y_25'], null],\n        '4_year_vested': [schedules['4y_cliff_1y_25'], schedules['4y_cliff_1y_25']],\n      };\n\n      return schedulePairs[selected];\n    };\n\n    const [lockupSchedule, vestingSchedule] = getScheduleList(startDate, lockupTotalAmount, schedule);\n\n    let terminationConfig = null;\n\n    if (vestingSchedule) {\n      terminationConfig = {\n        payer_id: near.signedAccountId,\n        vesting_schedule: {\n          Schedule: vestingSchedule,\n        },\n      };\n    }\n\n    near.tokenApi.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: lockupSchedule,\n        termination_config: terminationConfig,\n        claimed_balance: claimedBalance,\n      },\n    });\n  };\n\n  return (\n    <div>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n            />\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Start date\"\n                value={startDate}\n                onChange={(newValue) => {\n                  setStartDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button disabled={!startDate} className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  TextField,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction TerminateLockup(\n  props: {\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: { payer_id: String, vesting_schedule: [] | null } | null,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { adminControls, lockupIndex, config } = props;\n\n  const [open, setOpen] = useState(false);\n  const [date, setDate] = useState<Date | null>(null);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = async () => {\n    const ts = date ? date.getTime() / 1000 : null;\n    await near.api.terminate(lockupIndex, ts);\n    window.location.reload();\n  };\n\n  let message;\n  let payerMessage;\n  if (!config) {\n    message = 'No termination config';\n    payerMessage = 'This lockup cannot be terminated';\n  } else {\n    message = 'Terminate';\n    payerMessage = `Unvested amount will return to ${config.payer_id}`;\n  }\n\n  const canTerminate = adminControls && config;\n\n  return (\n    <div>\n      <button\n        className=\"button red fullWidth\"\n        disabled={!canTerminate}\n        type=\"button\"\n        onClick={handleOpen}\n      >\n        {message}\n      </button>\n      <span className=\"fine-print\">\n        {payerMessage}\n      </span>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\">\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Custom termination date\"\n                minDate={new Date()}\n                value={date}\n                onChange={(newValue) => {\n                  setDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      sx={{ margin: '20px 0 40px' }}\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n            <button className=\"button red fullWidth\" type=\"button\" onClick={handleTerminateLockup}>\n              Terminate\n            </button>\n          </DialogContent>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TerminateLockup from '../TerminateLockup';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\n\nexport default function Row(props: { adminControls: boolean, row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { adminControls, row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {row.id}\n        </TableCell>\n        <TableCell align=\"left\"><Link to={`${row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"center\">\n          {vestingSchedule ? 'Yes' : 'No'}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div style={{ display: 'flex', gap: 20 }}>\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                  <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n                <div className=\"terminate\">\n                  <TerminateLockup adminControls={adminControls} lockupIndex={row.id} config={row.termination_config} />\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable(\n  { lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean },\n) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"center\">Terminatable</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  Paper,\n  TableContainer,\n} from '@mui/material';\nimport { useContext } from 'react';\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  console.log('unique users', uniqueUsers);\n\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  return (\n    <div className=\"container\">\n\n      {signedIn && adminControls && isAdmin && <CreateLockup token={token} />}\n\n      <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }} component={Paper}>\n        <LockupsTable lockups={lockups} token={token} adminControls={adminControls} />\n      </TableContainer>\n\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountPreview from '../TokenAmountPreview';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, total: String }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { accountId, token, total } = params;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    near.noLoginApi.claim(accountId);\n  };\n\n  return (\n    <div className=\"claim-wrapper\">\n      <h5>Total available</h5>\n      <TokenAmountPreview token={token} amount={total} />\n      <button className=\"button fullWidth\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId } = useParams();\n\n  const lockups = allLockups.filter((x) => x.account_id === userId);\n\n  const totalUnclaimedBalance = lockups.reduce((acc, obj) => acc + parseFloat(obj.unclaimed_balance), 0);\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"container\">\n\n      {!adminControls && <ClaimAllLockups accountId={userId} token={token} total={convertAmount(totalUnclaimedBalance, token.decimals)} />}\n\n      <TableContainer sx={{ boxShadow: 'unset' }} component={Paper}>\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell />\n              <TableCell align=\"left\">ID</TableCell>\n              <TableCell align=\"left\">Account ID</TableCell>\n              <TableCell align=\"right\">Start&nbsp;date</TableCell>\n              <TableCell align=\"right\">End&nbsp;date</TableCell>\n              <TableCell align=\"right\">Terminatable</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              <TableCell align=\"center\">Progress</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {lockups.map((lockup) => (\n              <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return <div className=\"container login\">{children}</div>;\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  return (\n    <Auth>\n      { signedIn && !isAdmin && <Alert sx={{ margin: 2, width: '500px' }} severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { signedIn && isAdmin && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  if (!signedIn || !isAdmin) {\n    return <Navigate to=\"/admin\" state={{ from: location }} replace />;\n  }\n\n  return children;\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport NewLockupContract from '../../pages/NewLockupContract';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\n\nfunction Customer({ lockups, token, contractId }: { lockups: any[], token: TMetadata, contractId: string | null }) {\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={<Lockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({ lockups, token, tokenContractId }: { lockups: any[], token: TMetadata, tokenContractId: string | null }) {\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={tokenContractId} />} />\n        <Route path=\"/lockups\" element={<RequireAuth><Lockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      if (near.tokenContractId) {\n        load();\n      }\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  if (Object.keys(contractState).length === 0) return null;\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/:cid/*\" element={<Customer lockups={lockups} token={token} contractId={contractId} />} />\n        <Route path=\"/:cid/admin/*\" element={<Admin lockups={lockups} token={token} tokenContractId={contractId} />} />\n        <Route path=\"/new_lockup_contract\" element={<NewLockupContract />} />\n      </Routes>\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    try {\n      connect();\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        signedIn: false,\n        signedAccountId: null,\n      });\n    },\n  }), [near]);\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <App />\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}