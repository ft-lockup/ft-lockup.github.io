{"version":3,"sources":["config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/NoLoginTokenApi.ts","services/tokenApi.ts","services/factoryApi.ts","services/DAOs/astroDAO/api.ts","services/DAOs/astroDAO/utils.ts","services/near.ts","services/useTitle.ts","pages/About/index.tsx","components/TimestampDateDisplay/index.tsx","components/Chart/index.tsx","components/TokenIcon/index.tsx","components/TokenAmountDisplay/index.tsx","components/TimestampDisplay/index.tsx","components/ScheduleTable/index.tsx","services/scheduleHelpers.ts","services/chartHelpers.ts","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","services/spreadsheetImport.ts","components/TokenAmountPreview/index.tsx","components/ImportDraftGroup/index.tsx","components/FundButton/index.tsx","components/WithDao/DaoSelector/index.tsx","components/WithDao/DaoProposalDescription/index.tsx","components/FundWithDaoButton/index.tsx","components/DeleteDraftGroupButton/index.tsx","pages/PageDraftGroup/index.tsx","pages/PageDraftGroupsIndex/index.tsx","pages/NewLockupContract/index.tsx","components/UTCDateTimePicker/index.tsx","components/CreateLockup/index.tsx","components/TerminateModal/index.tsx","components/TerminateLockup/index.tsx","components/TerminateWithDaoButton/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","components/FavouriteAccounts/index.tsx","pages/Lockups/index.tsx","components/ConfirmDialog/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/PayForContractStorage/index.tsx","components/RequireAuth/index.tsx","pages/Homepage/index.tsx","pages/NotFoundContract/index.tsx","components/Footer/index.tsx","pages/PageDraft/index.tsx","pages/Terms/index.tsx","pages/Privacy/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["FACTORY_CONTRACT_NAME","process","CONTRACT_NAME","contractNameFromUrl","window","location","hash","split","getCurrentContractName","console","log","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","factoryContractName","Error","getConfig","MAX_GAS","Big","DP","PE","pseudoUtcIsoDateTime","unixSeconds","formatted","date","Date","pad","input","width","toString","padStart","year","getUTCFullYear","month","getUTCMonth","monthDay","getUTCDate","pseudoUtcIsoDate","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","pseudoUtcIsoTime","nearTo","value","digits","mode","div","toFixed","undefined","formatTokenAmount","tokenDecimals","roundDown","addYear","setFullYear","getFullYear","getTime","startOfDay","msInDay","Math","floor","addDays","days","dumpLocalStorage","dumpKey","dumpValue","Object","keys","localStorage","map","key","getItem","setItem","JSON","stringify","restoreLocalStorage","data","parse","clear","forEach","record","toCompactString","string","length","slice","txLinkInExplorer","txHash","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","args","gas","convert_draft","draft_id","convert_drafts","draft_ids","draftGroupId","discard_draft_group","draft_group_id","draftIds","delete_drafts","lockupIndex","timestamp","terminate","lockup_index","termination_timestamp","amount","get_token_account_id","get_deposit_whitelist","get_draft_operators_whitelist","get_lockups_paged","then","response","successUrl","href","requestSignIn","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","total","parseFloat","utils","format","formatNearAmount","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","lockupIds","amounts","x","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","NoLoginTokenApi","tokenAccountId","storage_deposit","TokenApi","contractId","lockupContractId","lockupTotalAmount","userAccountId","lockupSchedule","vestingSchedule","ftTransferCall","receiver_id","msg","schedule","vesting_schedule","Schedule","try_convert","meta","deposit","rest","ft_transfer_call","ft_metadata","storage_balance_of","storage_balance_bounds","DEPLOY_DEPOSIT","mul","pow","FACTORY_CHANGE_METHODS","FactoryApi","name","depositWhitelist","draftOperatorsWhitelist","callbackUrl","argsRaw","token_account_id","deposit_whitelist","draft_operators_whitelist","argsPacked","create","init_function","init_args","FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS","DAO_VIEW_METHODS","AstroDaoApi","get_policy","policy","canProposalRoles","roles","role","permissions","includes","canProposalGroups","kind","Group","flat","member","buildProposalFormLink","contractAddress","action","variant","details","smartContractAddress","methodName","json","actionsGas","actionDeposit","params","customFunctionCallProposalFormLink","daoCouncilMembers","accountAddress","api","getCouncilMembers","councilsMembers","buildFundDraftGroupProposalLink","description","lockupContractAddress","tokenContractAddress","amountValue","draftGroupIndex","daoContractAddress","encodeURIComponent","ONE_YOKTO","buildTerminateLockupProposalLink","NearContext","createContext","connectNear","nearAPI","BrowserLocalStorageKeyStore","headers","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","noLoginTokenApi","signedAccountId","tokenContractId","isAdmin","isDraftOperator","daos","getTokenAccountId","getDepositWhitelist","getDraftOperatorsWhitelist","dcm","Promise","all","dwID","daosCouncilMembers","userDaosCouncils","daoCMs","values","pop","nearConnectionError","currentContractName","notFoundPage","type","notFoundUrl","origin","pathname","reload","tokenApi","isContractFtStoragePaid","storageBalanceOf","storageBalance","factoryApi","rpcProvider","JsonRpcProvider","currentUser","signedIn","isCouncilMember","DEFAULT_USE_TITLE_OPTIONS","restoreOnUnmount","document","title","options","useEffect","prevTitle","About","lockups","useTitle","className","src","alt","TimestampDateDisplay","props","formattedWithTime","Chart","xMax","yMax","xMin","min","unlocked","vested","computedMin","computedMax","option","useUTC","text","top","left","textStyle","fontWeight","fontFamily","fontSize","color","opacity","tooltip","trigger","axisPointer","legend","bottom","selectedMode","icon","grid","right","containLabel","xAxis","boundaryGap","splitNumber","max","yAxis","series","areaStyle","markLine","lineStyle","symbol","claimed","style","borderRadius","TokenIcon","url","size","height","verticalAlign","TokenAmountDisplay","token","decimals","TimestampDisplay","ScheduleTable","Table","TableHead","TableRow","TableCell","align","TableBody","scope","defaultProps","interpolate","checkpoint0","checkpoint1","x0","y0","x1","y1","xM","add","sub","interpolateRaw","interpolateAtY","yM","lt","gte","parseInt","roundUp","interpolateRawAtY","interpolateSchedule","i","sumSchedules","schedules","timestamps","Array","from","Set","sort","y","plus","push","terminateScheduleAtAmount","finishTimestamp","eq","finishCheckpoint","calcBalancesRaw","row","now","totalBalanceRaw","claimedBalanceRaw","claimed_balance","unclaimedBalanceRaw","vestedBalanceFullRaw","termination_config","vestedBalanceRaw","unvestedBalanceRaw","unclaimed","unvested","chartData","lockupsList","lockupSchedules","round","minTimestampsLockup","minTimestampsVesting","minTimestamp","vestingSchedules","sumVesting","sumLockup","convertSchedule","s","totalClaimed","reduce","acc","sumClaimed","DraftsTableRow","useLocation","useState","open","setOpen","pageIndex","adminControls","progressShow","enqueueSnackbar","useSnackbar","useContext","padding","colSpan","message","selectedDraftId","draftPage","importDraftPage","balancesRaw","sx","borderBottom","IconButton","onClick","to","onCopy","autoHideDuration","Tooltip","placement","arrow","Collapse","in","timeout","unmountOnExit","DraftsTable","lockup","BN","prototype","toJSON","prefixErrorWith","prefix","callback","e","parseSpreadsheetColumns","lines","trim","table","line","columns","fromEntries","col","colIdx","parseDuration","pattern","match","groups","week","day","hour","minute","second","parseCliffInfo","parts","durationRaw","percentageRaw","duration","percentage","parsePercentage","parseHumanFriendlySchedule","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","allowedKeys","isValid","parseValidAccountId","parseTokenAmount","lockup_schedule","datePlusDurationMul","mulInput","UTC","toUnix","toLockupSchedule","inputTotalAmount","decimalsMultiplier","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","cliffAmount","muln","divn","clone","gt","tmCliff","tmFirstStep","cpStart","cpPreCliff","cpCliff","cpFinish","unshift","tms","tm","increment","cps","flatMap","stepBalance","cpsStart","concat","parseLockup","rawSpreadsheetRow","vestingSchedulePacked","f","checkpoint","lockupBalance","vestingBalance","lte","assertValidTerminationSchedule","TokenAmountPreview","ImportDraftGroup","setData","parseErrors","setParseErrors","importProgress","setImportProgress","navigate","useNavigate","withNotification","func","handleClickImport","accountIds","createDraftGroup","chunkSize","chunk","lockup_create","createDrafts","path","display","balances","calcTotalBalance","TextareaAutosize","placeholder","maxRows","onChange","event","target","spreadsheetInput","errorsFiltered","LoadingButton","disabled","loading","FundButton","fundDraftGroup","getContract","DaoSelector","selectedAddress","setSelectedAddress","handleSelectedDaoAddressChange","InputLabel","Select","required","marginBottom","dao","MenuItem","TextField","label","DaoProposalDescription","proposalDescription","setProposalDescription","multiline","minRows","defaultValue","FundWithDaoButton","formattedAmount","defaultDescription","replace","setDescription","astroDAOContractAddress","setAstroDAOContractAddress","handleClose","Dialog","minWidth","onClose","onSubmit","link","focus","DialogTitle","position","DialogContent","paddingTop","DialogActions","DeleteDraftGroupButton","inProgress","setInProgress","perform","discardDraftGroup","deleteDrafts","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","isConverted","setIsConverted","searchParams","URLSearchParams","search","transactionHashesRaw","get","txStatus","transaction","actions","FunctionCall","method_name","successValue","status","SuccessValue","atob","msgDraftGroupId","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","discarded","total_amount","funded","convertDrafts","marginTop","Alert","severity","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","importDraftGroupPath","group","NewLockupContract","signIn","setTokenAccountId","setName","lockupOperatorsRaw","setLockupOperatorsRaw","lockupOperators","draftOperatorsRaw","setDraftOperatorsRaw","draftOperators","PENDING","FOUND","NOT_FOUND","accountStatuses","setAccountStatuses","enqueueAccountIdCheck","validateAccountExists","lockupOperatorsMissing","lockupOperatorsPending","draftOperatorsMissing","draftOperatorsPending","Box","preventDefault","allUniqueAccountIds","lockupSubaccountId","elements","lockup_subaccount_id","lineHeight","UTCDateTimePicker","setValue","minTime","offsetMs","getTimezoneOffset","DateTimePicker","minDateTime","newValue","ampm","renderInput","margin","fullWidth","inputProps","inputFormat","CreateLockup","startDate","setStartDate","setSchedule","setAccountId","setAmount","handleCreateLockup","balanceInput","selected","getScheduleList","createLockup","validAmount","maxWidth","handleChangeAccountId","InputProps","endAdornment","InputAdornment","FormControl","LocalizationProvider","dateAdapter","AdapterDateFns","TerminateModal","currentState","handlers","dialog","dateTimePicker","terminationMode","setTerminationMode","terminationTimestamp","vestedAmount","trimmedLockupSchedule","trimmedVestingSchedule","terminateSchedule","trimmedLockup","RadioGroup","_event","FormControlLabel","control","Radio","daoSelector","daoProposalDescription","minHeight","TerminateLockup","buttonText","setDate","handleTerminateLockup","ts","setTimeout","canTerminate","modalProps","TerminateWithDaoButton","uri","URL","beneficiary_id","Row","payerMessage","selectedAccountPage","selectedLockupId","claimedAmount","availbleAmount","unvestedAmount","terminator","terminatorId","total_balance","LockupsTable","FavouriteAccounts","favouriteAccounts","uniqueUsers","onSave","inputRef","useRef","parseAccounts","replaceAll","handleSaveFavouriteAccounts","localStorageValue","current","newFavouriteAccounts","join","onKeyPress","realAccouns","Lockups","storedData","favouriteAccountsFromLocalStorage","setFavouriteAccounts","favouriteAccountsLockups","lockupsPage","TableContainer","boxShadow","ConfirmDialog","isOpen","closeFn","ClaimAllLockups","obj","unclaimed_balance","isDialogOpen","setIsDialogOpen","dialogConfirmCallback","setDialogConfirmCallback","depositConfirmMessage","claimSpecificLockups","storageBalanceBounds","bounds","storageDeposit","UserLockups","allLockups","userId","Claim","Header","lockupsPageViewPolicy","Auth","children","Authorize","showAlertForUser","showLockups","PayForContractStorage","RequireAuth","currentPathname","draftGroupURL","Homepage","address","setAddress","setError","handleOpenLockupContract","startAdornment","helperText","NotFoundContract","Footer","isAdminView","indexOf","updatedPathname","substring","PageDraft","draftId","setDraft","fetchDraft","Terms","Privacy","Customer","element","Admin","App","contractState","setContractState","setContractId","reference","reference_hash","spec","setToken","unpacked","txMsg","statusMessage","active","load","loadAllLockups","ftMetadata","metadata","SnackbarCloseButton","snackbarKey","closeSnackbar","NearApp","setNear","nearConn","connect","useMemo","Provider","sp","delete","history","pushState","render","getElementById"],"mappings":"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","file":"static/js/main.de378efb.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n}\n\nexport const DEFAULT_CONTRACT_NAME = process.env.REACT_APP_DEFAULT_CONTRACT_NAME as string;\nexport const FACTORY_CONTRACT_NAME = process.env.REACT_APP_FACTORY_CONTRACT_NAME as string;\n\nconst getCurrentContractName = (): string => {\n  const contractNameFromUrl = window.location.hash.split('/')[1];\n  if (contractNameFromUrl === 'new_lockup_contract') return FACTORY_CONTRACT_NAME;\n\n  return contractNameFromUrl;\n};\n\nexport const CONTRACT_NAME = getCurrentContractName();\n\nconsole.log(CONTRACT_NAME);\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\nimport { config } from './config';\n\nexport const MAX_GAS = 300_000_000_000_000;\nexport const ONE_YOCTO = 1;\n\nBig.DP = 40;\nBig.PE = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const pseudoUtcIsoDate = (unixSeconds: number) => {\n  const date = new Date(unixSeconds * 1_000);\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const formatted = `${year}-${month}-${monthDay}`;\n\n  return formatted;\n};\n\nexport const pseudoUtcIsoTime = (unixSeconds: number) => {\n  const date = new Date(unixSeconds * 1_000);\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${hours}:${minutes}:${seconds}`;\n\n  return formatted;\n};\n\nexport const pseudoUtcIsoDateTime = (unixSeconds: number) => {\n  const formatted = `${pseudoUtcIsoDate(unixSeconds)} ${pseudoUtcIsoTime(unixSeconds)}`;\n\n  return formatted;\n};\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\n\n// formats token amount, always two digits after comma, fixed, no group separators\nexport const formatTokenAmount = (value: string, tokenDecimals: number) => new Big(value).div(10 ** tokenDecimals).toFixed(NEAR_ROUND_DIGITS, Big.roundDown);\n\n// @ts-ignore\nexport const addYear = (date: Date, year: number) => new Date(new Date(date).setFullYear((date.getFullYear()) + year)).getTime() / 1000;\nexport const startOfDay = (date: Date) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(Math.floor(date.getTime() / msInDay) * msInDay);\n\n  return result;\n};\nexport const addDays = (date: Date, days: number) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(date.getTime() + msInDay * days);\n\n  return result;\n};\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n\nexport const toCompactString = (string: string) => {\n  if (string.length > 24) {\n    return `${string.slice(0, 12)}...${string.slice(-12)}`;\n  }\n  return string;\n};\n\nexport const txLinkInExplorer = (txHash: string) => `${config.explorerUrl}/transactions/${txHash}`;\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS, ONE_YOCTO } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n  'get_draft_operators_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'convert_draft',\n  'convert_drafts',\n  'terminate',\n  'discard_draft_group',\n  'delete_drafts',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n  'get_draft_operators_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'convert_draft': any,\n  'convert_drafts': any,\n  'terminate': any,\n  'discard_draft_group': any,\n  'delete_drafts': any,\n};\n\nexport type TNearAmount = string;\nexport type TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TCheckpointWithIndex = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n  index: number;\n};\n\nexport type TSchedule = TCheckpoint[];\n\nexport type TTerminationConfig = {\n  beneficiary_id: TNearAmount,\n  vesting_schedule: {\n    Schedule: TSchedule,\n  },\n};\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TSchedule,\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n  termination_config: TTerminationConfig | null,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n    if (result) {\n      result.id = index;\n    }\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ args: { drafts }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async convertDraft(index: DraftIndex): Promise<LockupIndex> {\n    const result = await this.contract.convert_draft({ draft_id: index });\n\n    return result;\n  }\n\n  async convertDrafts(indices: DraftIndex[]): Promise<LockupIndex[]> {\n    const result = await this.contract.convert_drafts({ args: { draft_ids: indices }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async discardDraftGroup(draftGroupId: number): Promise<any> {\n    const result = await this.contract.discard_draft_group({ args: { draft_group_id: draftGroupId } });\n\n    return result;\n  }\n\n  async deleteDrafts(draftIds: number[]): Promise<any> {\n    const result = await this.contract.delete_drafts({ args: { draft_ids: draftIds } });\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number, timestamp: number | null): Promise<void> {\n    try {\n      const result = await this.contract.terminate({\n        args: { lockup_index: lockupIndex, termination_timestamp: timestamp },\n        gas: MAX_GAS,\n        amount: ONE_YOCTO,\n      });\n      return result;\n    } catch (e) {\n      console.log(e);\n      throw Error('Cannot terminate lockup');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getWalletConnection(): WalletConnection {\n    return this.walletConnection;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  getDraftOperatorsWhitelist(): Promise<Array<string>> {\n    return this.contract.get_draft_operators_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    this.walletConnection.requestSignIn(this.near.config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async claimSpecificLockups(accountId: string, lockupIds: number[]): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({ amounts: lockupIds.map((x) => [x, null]) }, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst TOKEN_VIEW_METHODS = [''];\nconst TOKEN_CHANGE_METHODS = ['storage_deposit'];\n\ntype TChangeMethods = {\n  'storage_deposit': any,\n};\n\ntype TTokenContract = Contract & TChangeMethods;\n\nclass NoLoginTokenApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async storageDeposit(tokenAccountId: string, accountId: string, amount: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract(tokenAccountId).storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(contractName: string): TTokenContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      contractName,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n}\n\nexport default NoLoginTokenApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TSchedule } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n  'storage_balance_of',\n  'storage_balance_bounds',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n  'storage_deposit',\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any,\n  'storage_deposit': any,\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any,\n  'storage_balance_of': any,\n  'storage_balance_bounds': any,\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TLockupCreate = {\n  account_id: string,\n  schedule: TSchedule,\n  vesting_schedule: { Schedule: TSchedule } | null,\n};\n\ntype TDraftGroupFund = {\n  draft_group_id: number,\n  try_convert: boolean,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  async createLockup(\n    lockupContractId: string,\n    lockupTotalAmount: string,\n    userAccountId: string,\n    lockupSchedule: any[],\n    vestingSchedule: TSchedule | null,\n  ): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: lockupSchedule,\n        vesting_schedule: vestingSchedule ? { Schedule: vestingSchedule } : null,\n      },\n    });\n\n    return result;\n  }\n\n  async fundDraftGroup(lockupContractId: string, draftGroupId: number, amount: string): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount,\n      msg: {\n        draft_group_id: draftGroupId,\n        try_convert: true,\n      },\n    });\n\n    return result;\n  }\n\n  async ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: TLockupCreate | TDraftGroupFund,\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): Promise<void> {\n    const { msg, ...rest } = meta;\n\n    await this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  storageDeposit(accountId: String, amount: String): Promise<any> {\n    return this.contract.storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n\n  storageBalanceOf(accountId: String): Promise<String> {\n    return this.contract.storage_balance_of({ account_id: accountId });\n  }\n\n  storageBalanceBounds(): Promise<{ min: string, max: string }> {\n    return this.contract.storage_balance_bounds();\n  }\n}\n\nexport default TokenApi;\n","import Big from 'big.js';\n\nimport {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst DEPLOY_DEPOSIT = new Big(10).mul(new Big(10).pow(24)).toString();\n\nconst FACTORY_CHANGE_METHODS = [\n  'create',\n];\n\ntype TFactoryChangeMethods = {\n  'create': (opts: {\n    args: { name: string, init_function: string, init_args: string },\n    callbackUrl: string,\n    amount: string | number,\n    gas: string | number\n  }) => any,\n};\n\ntype TFactoryContract = Contract & TFactoryChangeMethods;\n\nclass FactoryApi {\n  private contract: TFactoryContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: [], changeMethods: FACTORY_CHANGE_METHODS },\n    ) as TFactoryContract;\n  }\n\n  getContract(): TFactoryContract {\n    return this.contract;\n  }\n\n  async create(\n    name: string,\n    tokenAccountId: string,\n    depositWhitelist: string[],\n    draftOperatorsWhitelist: string[],\n    callbackUrl: string,\n  ): Promise<void> {\n    const argsRaw = {\n      token_account_id: tokenAccountId,\n      deposit_whitelist: depositWhitelist,\n      draft_operators_whitelist: draftOperatorsWhitelist,\n    };\n    const argsPacked = JSON.stringify(argsRaw);\n    const result = await this.contract.create({\n      args: {\n        name,\n        init_function: 'new',\n        init_args: argsPacked,\n      },\n      callbackUrl,\n      gas: MAX_GAS,\n      amount: DEPLOY_DEPOSIT,\n    });\n\n    console.log(result);\n\n    return result;\n  }\n}\n\nexport default FactoryApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS = ['call:AddProposal', '*:AddProposal'];\n\nconst DAO_VIEW_METHODS = [\n  'get_policy',\n];\n\ntype TAstroDaoViewMethods = {\n  'get_policy': any,\n};\n\ntype TAstroDaoContract = Contract & TAstroDaoViewMethods;\n\nclass AstroDaoApi {\n  private contract: TAstroDaoContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: DAO_VIEW_METHODS, changeMethods: [] },\n    ) as TAstroDaoContract;\n  }\n\n  getContract(): TAstroDaoContract {\n    return this.contract;\n  }\n\n  async getCouncilMembers(): Promise<string[]> {\n    const policy = await this.contract.get_policy();\n    const canProposalRoles = policy.roles.filter(\n      (role: any) => role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[0]) || role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[1]),\n    );\n\n    if (canProposalRoles.length === 0) {\n      return [];\n    }\n\n    const canProposalGroups = canProposalRoles.map((role: any) => role?.kind?.Group);\n\n    return canProposalGroups.flat().filter((member: any) => member);\n  }\n}\n\nexport default AstroDaoApi;\n","import {\n  WalletConnection,\n} from 'near-api-js';\n\nimport AstroDaoApi from './api';\n\n// TODO move to the .env\nconst ASTRO_DAO_HOST = 'https://testnet.app.astrodao.com';\n\nexport const MAX_GAS = '300';\nexport const ONE_YOKTO = '0.000000000000000000000001';\n\nexport const buildProposalFormLink = (\n  contractAddress: string,\n  action: string,\n  variant: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string,\n): string => {\n  const params = {\n    details,\n    smartContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    gas,\n    deposit: actionDeposit,\n  };\n\n  return `${ASTRO_DAO_HOST}/dao/${contractAddress}/proposals?action=${action}&variant=${variant}&params=${JSON.stringify(params)}`;\n};\n\nexport const customFunctionCallProposalFormLink = (\n  contractAddress: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string = MAX_GAS,\n): string => buildProposalFormLink(\n  contractAddress,\n  'create_proposal',\n  'ProposeCustomFunctionCall',\n  details,\n  smartContractAddress,\n  methodName,\n  json,\n  actionsGas,\n  actionDeposit,\n  gas,\n);\n\nexport const daoCouncilMembers = async (walletConnection: WalletConnection, accountAddress: string): Promise<any> => {\n  try {\n    const api = new AstroDaoApi(walletConnection, accountAddress);\n    const councilsMembers = await api.getCouncilMembers();\n\n    return { [accountAddress]: councilsMembers };\n  } catch (e) {\n    console.log('isDAO ERROR:', e);\n    return undefined;\n  }\n};\n\nexport const buildFundDraftGroupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  tokenContractAddress: string,\n  amountValue: string,\n  draftGroupIndex: number,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'ft_transfer_call';\n  const json = {\n    receiver_id: lockupContractAddress,\n    amount: amountValue,\n    msg: JSON.stringify({ draft_group_id: draftGroupIndex, try_convert: true }),\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    tokenContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nexport const buildTerminateLockupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  lockupIndex: number,\n  timestamp: number | null,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'terminate';\n  const json = {\n    lockup_index: lockupIndex,\n    termination_timestamp: timestamp,\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    lockupContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nconst utils = {\n  buildProposalFormLink,\n  customFunctionCallProposalFormLink,\n  daoCouncilMembers,\n  buildFundDraftGroupProposalLink,\n  buildTerminateLockupProposalLink,\n};\n\nexport default utils;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport NoLoginTokenApi from './NoLoginTokenApi';\nimport TokenApi from './tokenApi';\nimport FactoryApi from './factoryApi';\nimport { daoCouncilMembers } from './DAOs/astroDAO/utils';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  currentUser: {\n    signedIn: boolean;\n    isAdmin: boolean;\n    isDraftOperator: boolean;\n    isCouncilMember: boolean;\n    signedAccountId: string | null;\n    daos: string[];\n  }\n  tokenContractId: string;\n  lockupContractId: string;\n  tokenApi: TokenApi;\n  noLoginTokenApi: NoLoginTokenApi;\n  factoryApi: FactoryApi;\n  rpcProvider: nearAPI.providers.JsonRpcProvider;\n  isContractFtStoragePaid: boolean;\n  near: nearAPI.Near;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n  const noLoginTokenApi = new NoLoginTokenApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  let tokenContractId: string = '';\n  let isAdmin: boolean = false;\n  let isDraftOperator: boolean = false;\n  let depositWhitelist: string[] = [];\n  let draftOperatorsWhitelist: string[] = [];\n  let daos: string[] = [];\n  try {\n    tokenContractId = await api.getTokenAccountId();\n    depositWhitelist = await api.getDepositWhitelist();\n    draftOperatorsWhitelist = await api.getDraftOperatorsWhitelist();\n    console.log('depositWhitelist', depositWhitelist);\n    isAdmin = depositWhitelist.includes(signedAccountId);\n    console.log('isAdmin', isAdmin);\n    isDraftOperator = draftOperatorsWhitelist.includes(signedAccountId);\n    console.log('isDraftOperator', isDraftOperator);\n    const dcm = daoCouncilMembers;\n    console.log(dcm);\n    const daosCouncilMembers = (await Promise.all(depositWhitelist.map((dwID): Promise<any[]> => daoCouncilMembers(walletConnection, dwID)))).filter((value) => !!value);\n    console.log(daosCouncilMembers);\n    const userDaosCouncils = daosCouncilMembers.filter((daoCMs) => Object.values(daoCMs).pop().includes(signedAccountId));\n    if (userDaosCouncils?.length > 0) {\n      daos = userDaosCouncils.map((daoCMs) => Object.keys(daoCMs).pop() || '');\n    }\n    console.log('userDaosCouncils', userDaosCouncils);\n    console.log('councilMembers', daosCouncilMembers);\n    console.log('daos', daos);\n  } catch (e) {\n    console.log(e);\n    const nearConnectionError: any = e;\n    const currentContractName = window.location.hash.split('/')[1];\n    const notFoundPage = window.location.href.includes('not_found_contract');\n    if (nearConnectionError.type === 'AccountDoesNotExist' && !notFoundPage) {\n      const notFoundUrl = `${window.location.origin + window.location.pathname}#/${currentContractName}/not_found_contract`;\n      window.location.assign(notFoundUrl);\n      window.location.reload();\n    }\n  }\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  let isContractFtStoragePaid = false;\n  const lockupContractId = window.location.hash.split('/')[1];\n\n  try {\n    const storageBalance = await tokenApi.storageBalanceOf(lockupContractId);\n    isContractFtStoragePaid = (storageBalance !== null) && true;\n    console.log(isContractFtStoragePaid);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const factoryApi = new FactoryApi(\n    walletConnection,\n    config.factoryContractName,\n  );\n\n  const rpcProvider = new nearAPI.providers.JsonRpcProvider(\n    config.nodeUrl,\n  );\n\n  return {\n    config,\n    api,\n    tokenContractId,\n    noLoginApi,\n    tokenApi,\n    factoryApi,\n    currentUser: {\n      signedIn: !!signedAccountId,\n      isAdmin,\n      isDraftOperator,\n      isCouncilMember: daos.length > 0,\n      signedAccountId,\n      daos,\n    },\n    noLoginTokenApi,\n    rpcProvider,\n    isContractFtStoragePaid,\n    lockupContractId,\n    near,\n  };\n};\n","import { useEffect } from 'react';\n\nexport interface UseTitleOptions {\n  restoreOnUnmount?: boolean;\n}\n\nconst DEFAULT_USE_TITLE_OPTIONS: UseTitleOptions = {\n  restoreOnUnmount: false,\n};\n\nfunction useTitle(title: string, options: UseTitleOptions = DEFAULT_USE_TITLE_OPTIONS) {\n  useEffect(() => {\n    const prevTitle = document.title;\n    if (document.title !== title) document.title = title;\n\n    // eslint: disable\n    if (options && options.restoreOnUnmount) {\n      return () => {\n        document.title = prevTitle;\n      };\n    }\n\n    return () => {};\n  });\n}\n\nexport default typeof document !== 'undefined' ? useTitle : () => {};\n","import { config } from '../../config';\n\nimport useTitle from '../../services/useTitle';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  useTitle('About | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"container\">\n      <h1>Fungible Token Lockup</h1>\n\n      <h2>Purpose</h2>\n\n      <div>\n        <p>Community Lockup is dApp implementing locking and vesting of any arbitrary fungible token on NEAR in the generally known sense of these words.</p>\n        <p>Lockup is a gradual release of tokens according to a specified schedule. After release tokens are in full control of the beneficiary.</p>\n        <p>\n          Vesting is a gradual allocation of tokens to the beneficiary according to a specified schedule,\n          provided certain conditions are met (for example, beneficiary keeps working for the payer).\n        </p>\n        <p>\n          Vested tokens are NOT immediately available to the beneficiary, however\n          they WILL be available to the beneficiary according to the lockup\n          schedule. Vested tokens are GUARANTEED to be received at some point in\n          the future, while unvested token amount may be withdrawn by the payer if\n          the lockup agreement is terminated.\n        </p>\n      </div>\n\n      <h2>Users</h2>\n\n      <div>\n        <p>There are two roles in the app: payer (also called admin), most commonly the employer, and beneficiaries, most commonly the employees. There is also an implicit anyone role.</p>\n\n        <ul>\n          <li>\n            All users (anyone) are able to view ALL lockup information stored\n            in the blockchain for any existing lockup contract. They are also\n            able to create new lockup contract and become admin for that new\n            lockup contract.\n          </li>\n          <li>Beneficiary users have ability to claim unlocked tokens dedicated to them</li>\n          <li>Admin users can create new lockups (one by one or via excel import) and terminate existing lockups that can be terminated</li>\n          <li>Draft operators can create draft groups, drafts, delete draft groups, drafts.</li>\n        </ul>\n      </div>\n\n      <h2>Lockups</h2>\n\n      <div>\n        <p>Each lockup has the following fields:</p>\n        <ul>\n          <li>Account ID: NEAR account id that will receive the tokens</li>\n          <li>\n            Schedule: the lockup schedule, according to which the tokens are\n            released. Is represented by a monotonous piecewise linear function .\n            Where x is the time axis and y is the amount of unlocked tokens at\n            any specific moment.\n          </li>\n          <li>\n            Vesting schedule: optional. According to this schedule tokens are\n            vested, i. e. allocated to the beneficiary irrevocably. Operator is\n            able to terminate the lockup at any effective moment in the future.\n            If this happens, then the lockup schedule is capped at the total\n            vested amount at the effective moment of termination.\n          </li>\n          <li>\n            Payer id: optional. account id that paid for the specific lockup.\n            Only recorded for terminatable lockups. If the lockup is terminated\n            - unvested tokens will be returned back to the payer upon\n            termination.\n          </li>\n          <li>\n            Claimed balance: already claimed balance for the lockup. Used for\n            tracking claim progress.\n          </li>\n        </ul>\n      </div>\n\n      <h2>Lockup and vesting logic</h2>\n\n      <div>\n        <img src=\"https://bafkreidqdq6wefcvr436cunap4y5c77nodlgxu6c4qchxkd232g7377cw4.ipfs.nftstorage.link/\" alt=\"Lockup and vesting schedule\" />\n        <p>Consider the following lockup with a four year duration.</p>\n        <p>The vesting schedule is red. One year cliff, then 1 / 4 is vested, then vesting is linear till the end (4 years mark).</p>\n        <p>The lockup schedule is blue. Two years cliff with zero amount. Then two years of linear lockup till 3 / 4 of the amount, then another cliff up to full amount.</p>\n        <p>Consider the termination happening at the 2.5 years mark.</p>\n        <p>First, we find the vested amount for this timestamp. It is 5 / 8.</p>\n        <p>After that we trim the lockup schedule at that amount.</p>\n        <p>In this case, the intersection is at 3y + 1 / 3y.</p>\n        <p>The trimmed lockup schedule is the yellow thin line. Note that it perfectly matches the initial lockup schedule up to the new total ( 5 / 8 ).</p>\n      </div>\n\n      <h2>Technical Info</h2>\n\n      <p>\n        FT lockup account id:\n        {' '}\n        <span className=\"code\">{config.contractName}</span>\n      </p>\n      <p>\n        Token account id:\n        {' '}\n        <span className=\"code\">{token_account_id}</span>\n      </p>\n      <p>\n        Total number of lockups:\n        {' '}\n        <span className=\"code\">{lockups.length}</span>\n      </p>\n    </div>\n  );\n}\n","export default function TimestampDateDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${year}-${month}-${monthDay}`;\n  const formattedWithTime = `${year}-${month}-${monthDay} ${hours}:${minutes}:${seconds} UTC`;\n\n  return (\n    <span className=\"nowrap timestamp-display\" title={formattedWithTime}>\n      {formatted}\n    </span>\n  );\n}\n","import ReactEcharts from 'echarts-for-react';\n\nimport '../../styles/chart.scss';\n\nexport default function Chart({ data, xMax, yMax }: { data: { vested: any[], unlocked: any[], claimed: any[] }, xMax?: number, yMax?: number }) {\n  const xMin = Math.min(...[data.unlocked[0][0], ...(data.vested[0][0] && [data.vested[0][0]] && [])]);\n  console.log('xMin', xMin / 1000);\n  console.log('xMax', xMax);\n  console.log('withOffset', xMax && (xMax + (xMax - xMin / 1000) * 0.03));\n  const computedMin = xMax && (xMin / 1000 - (xMax - xMin / 1000) * 0.03) * 1000;\n  const computedMax = xMax && (xMax + (xMax - xMin / 1000) * 0.03) * 1000;\n  console.log('computedMin', computedMin);\n  console.log('computedMax', computedMax);\n  const option = {\n    useUTC: true,\n    title: [\n      {\n        text: 'Schedule timestamps are in UTC',\n        top: '10px',\n        // left: 'center',\n        left: '7px',\n        // right: '30px',\n        textStyle: {\n          fontWeight: '700',\n          fontFamily: '\"Roboto\",\"Helvetica\",\"Arial\",sans-serif',\n          fontSize: '14px',\n          color: '#242F57',\n          opacity: 1.0,\n        },\n      },\n    ],\n    tooltip: {\n      trigger: 'axis',\n      axisPointer: {\n        type: 'cross',\n      },\n    },\n    legend: {\n      bottom: '3%',\n      selectedMode: false,\n      icon: 'circle',\n    },\n    grid: {\n      top: '50px',\n      left: '12px',\n      right: '12px',\n      bottom: '15%',\n      containLabel: true,\n    },\n    xAxis: [\n      {\n        type: 'time',\n        boundaryGap: ['3%', '3%'],\n        splitNumber: 15,\n        min: computedMin,\n        max: computedMax,\n      },\n    ],\n    yAxis: [\n      {\n        type: 'value',\n        max: yMax,\n      },\n    ],\n    series: [\n      {\n        name: 'Vested',\n        type: 'line',\n        color: '#0069D1',\n        areaStyle: {\n          opacity: 1,\n        },\n        markLine: {\n          data: [\n            [\n              { xAxis: new Date(), yAxis: 0 },\n              { xAxis: new Date(), yAxis: yMax || 'max' },\n            ],\n          ],\n          lineStyle: {\n            type: 'dashed',\n            color: '#FF594E',\n          },\n          symbol: 'none',\n        },\n        data: data.vested,\n      },\n      {\n        name: 'Unlocked',\n        type: 'line',\n        color: '#00B988',\n        areaStyle: {\n          opacity: 1,\n        },\n        data: data.unlocked,\n      },\n      {\n        name: 'Claimed',\n        type: 'line',\n        color: '#E9AF1C',\n        areaStyle: {\n          opacity: 1,\n        },\n        data: data.claimed,\n      },\n    ],\n  };\n  return <ReactEcharts option={option} style={{ borderRadius: 10 }} />;\n}\n\nChart.defaultProps = {\n  xMax: null,\n  yMax: null,\n};\n","export default function TokenIcon(params: { url: string, size: number }) {\n  const { url, size } = params;\n  return (\n    <img\n      style={{\n        height: size, width: size, verticalAlign: 'middle',\n      }}\n      src={url}\n      alt=\"Token Icon\"\n    />\n  );\n}\n","// import Big from 'big.js';\n\nimport { TNearAmount } from '../../services/api';\nimport { formatTokenAmount } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\n\nexport default function TokenAmountDisplay(params: { token: TMetadata, amount: TNearAmount }) {\n  const { token, amount } = params;\n\n  console.log(token, amount);\n\n  return (\n    <span className=\"nowrap\" title={amount}>\n      {formatTokenAmount(amount, token.decimals)}\n      {' '}\n      {token.symbol}\n      {' '}\n      <TokenIcon url={token.icon || ''} size={32} />\n    </span>\n  );\n}\n","export default function TimestampDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${year}-${month}-${monthDay} ${hours}:${minutes}:${seconds} UTC`;\n\n  return (\n    <span className=\"nowrap timestamp-display\" title={formatted}>\n      {formatted}\n    </span>\n  );\n}\n","import {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport TimestampDisplay from '../TimestampDisplay';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\n\nexport default function ScheduleTable(params: { token: TMetadata, title: String, schedule: TSchedule }) {\n  const { schedule, title, token } = params;\n\n  return (\n    <div className=\"inner-table_wrapper\">\n      <h5>{title}</h5>\n      <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n        <TableHead>\n          <TableRow>\n            <TableCell>DATE (UTC)</TableCell>\n            <TableCell align=\"right\">CUMULATIVE AMOUNT</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {schedule.map((x: any) => (\n            <TableRow key={x.timestamp}>\n              <TableCell scope=\"row\">\n                <div className=\"nowrap\">\n                  <TimestampDisplay unixSeconds={x.timestamp} />\n                </div>\n              </TableCell>\n              <TableCell align=\"right\">\n                <TokenAmountDisplay amount={x.balance} token={token} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { Big } from 'big.js';\nimport { TCheckpoint, TNearTimestamp, TSchedule } from './api';\nimport { pseudoUtcIsoDateTime } from '../utils';\n\nexport const interpolateRaw = (x0: number, y0: string, x1: number, y1: string, xM: number) : string => {\n  if (x1 <= x0) {\n    throw new Error('invalid range');\n  }\n  if (xM < x0 || xM >= x1) {\n    throw new Error('xM out of bound');\n  }\n\n  const yM = new Big(y0).add(\n    (new Big(y1).sub(new Big(y0)))\n      .mul(new Big(xM.toString()).sub(new Big(x0.toString())))\n      .div(new Big(x1.toString()).sub(new Big(x0.toString()))),\n  );\n\n  return yM.toFixed(0, Big.roundDown);\n};\n\nexport const interpolateRawAtY = (x0: number, y0: string, x1: number, y1: string, yM: string) : TNearTimestamp => {\n  if (x1 <= x0) {\n    throw new Error('invalid range');\n  }\n  if (new Big(yM).lt(new Big(y0)) || new Big(yM).gte(y1)) {\n    throw new Error('yM out of bound');\n  }\n\n  const xM = new Big(x0).add(\n    (new Big(x1).sub(new Big(x0)))\n      .mul(new Big(yM.toString()).sub(new Big(y0.toString())))\n      .div(new Big(y1.toString()).sub(new Big(y0.toString()))),\n  );\n\n  return parseInt(xM.toFixed(0, Big.roundUp), 10);\n};\n\nexport const interpolate = (checkpoint0: TCheckpoint, checkpoint1: TCheckpoint, timestamp: TNearTimestamp) : TCheckpoint => {\n  const balance = interpolateRaw(\n    checkpoint0.timestamp,\n    checkpoint0.balance,\n    checkpoint1.timestamp,\n    checkpoint1.balance,\n    timestamp,\n  );\n\n  return { timestamp, balance };\n};\n\nexport const interpolateAtY = (checkpoint0: TCheckpoint, checkpoint1: TCheckpoint, balance: string) : TCheckpoint => {\n  const timestamp = interpolateRawAtY(\n    checkpoint0.timestamp,\n    checkpoint0.balance,\n    checkpoint1.timestamp,\n    checkpoint1.balance,\n    balance,\n  );\n\n  return { timestamp, balance };\n};\n\nexport const interpolateSchedule = (schedule: TCheckpoint[], timestamp: TNearTimestamp) : TCheckpoint => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (timestamp < schedule[0].timestamp) {\n    return { timestamp, balance: schedule[0].balance };\n  }\n\n  if (timestamp >= schedule[schedule.length - 1].timestamp) {\n    return { timestamp, balance: schedule[schedule.length - 1].balance };\n  }\n\n  // eslint-disable-next-line no-plusplus\n  for (let i = 0; i < schedule.length - 1; i++) {\n    if (schedule[i + 1].timestamp <= timestamp) {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    return interpolate(schedule[i], schedule[i + 1], timestamp);\n  }\n\n  throw new Error('unreachable');\n};\n\nexport const sumSchedules = (schedules: TSchedule[]) : TSchedule => {\n  if (schedules.length === 0) {\n    throw new Error('schedules is empty');\n  }\n\n  const timestamps = Array.from(new Set(schedules.flat().map((x) => x.timestamp).sort(\n    (x, y) => x - y,\n  )));\n\n  const result: TSchedule = [];\n\n  timestamps.forEach((timestamp:TNearTimestamp) => {\n    let amount = new Big(0);\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < schedules.length; i++) {\n      const balance = new Big(interpolateSchedule(schedules[i], timestamp).balance);\n      amount = amount.plus(balance);\n    }\n    result.push({ timestamp, balance: amount.toString() });\n  });\n\n  return result;\n};\n\nexport const assertValidTerminationSchedule = (lockupSchedule: TSchedule, vestingSchedule: TSchedule) => {\n  const f = (x: number) => `${pseudoUtcIsoDateTime(x)} UTC`;\n\n  lockupSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = checkpoint.balance;\n    const vestingBalance = interpolateSchedule(vestingSchedule, timestamp).balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at ${f(timestamp)} (${timestamp})`);\n    }\n  });\n  vestingSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = interpolateSchedule(lockupSchedule, timestamp).balance;\n    const vestingBalance = checkpoint.balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at ${f(timestamp)} (${timestamp})`);\n    }\n  });\n};\n\nexport const terminateSchedule = (schedule: TSchedule, timestamp: TNearTimestamp) => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (timestamp <= schedule[0].timestamp) {\n    return [\n      schedule[0],\n      { timestamp: schedule[0].timestamp + 1, balance: schedule[0].balance },\n    ];\n  }\n\n  if (timestamp >= schedule[schedule.length - 1].timestamp) {\n    return schedule.slice(0, schedule.length);\n  }\n\n  const result = [];\n\n  for (let i = 0; i < schedule.length - 1; i += 1) {\n    result.push(schedule[i]);\n\n    if (timestamp < schedule[i + 1].timestamp) {\n      const finishCheckpoint = interpolate(schedule[i], schedule[i + 1], timestamp);\n      result.push(finishCheckpoint);\n      return result;\n    }\n\n    if (timestamp === schedule[i + 1].timestamp) {\n      result.push(schedule[i + 1]);\n      return result;\n    }\n  }\n\n  throw new Error('unreachable');\n};\n\nexport const terminateScheduleAtAmount = (schedule: TSchedule, amount: string, finishTimestamp: TNearTimestamp) => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (new Big(amount).eq(new Big('0'))) {\n    return [\n      schedule[0],\n      { timestamp: Math.max(schedule[0].timestamp + 1, finishTimestamp), balance: schedule[0].balance },\n    ];\n  }\n\n  if (new Big(amount).gte(new Big(schedule[schedule.length - 1].balance))) {\n    return schedule.slice(0, schedule.length);\n  }\n\n  const result = [];\n\n  for (let i = 0; i < schedule.length - 1; i += 1) {\n    result.push(schedule[i]);\n\n    if (new Big(amount).lt(new Big(schedule[i + 1].balance))) {\n      const finishCheckpoint = interpolateAtY(schedule[i], schedule[i + 1], amount);\n      result.push(finishCheckpoint);\n      return result;\n    }\n\n    if (new Big(amount).eq(new Big(schedule[i + 1].balance))) {\n      result.push(schedule[i + 1]);\n      return result;\n    }\n  }\n\n  throw new Error('unreachable');\n};\n\nexport type TBalancesRaw = {\n  claimed: string,\n  unclaimed: string,\n  vested: string,\n  unvested: string,\n  total: string,\n};\n\nexport const calcBalancesRaw = (row: any, now: number): TBalancesRaw => {\n  const totalBalanceRaw = row.schedule[row.schedule.length - 1].balance;\n  const claimedBalanceRaw = row.claimed_balance || '0';\n\n  const unclaimedBalanceRaw = new Big(interpolateSchedule(row.schedule, now).balance).sub(new Big(claimedBalanceRaw)).toFixed();\n  let vestedBalanceFullRaw = null;\n  const vestingSchedule = row.vesting_schedule?.Schedule || row.termination_config?.vesting_schedule?.Schedule;\n  if (vestingSchedule) {\n    vestedBalanceFullRaw = interpolateSchedule(vestingSchedule, now).balance;\n  } else {\n    vestedBalanceFullRaw = row.schedule[row.schedule.length - 1].balance;\n  }\n  const vestedBalanceRaw = new Big(vestedBalanceFullRaw)\n    .sub(new Big(claimedBalanceRaw))\n    .sub(new Big(unclaimedBalanceRaw))\n    .toString();\n  const unvestedBalanceRaw = new Big(totalBalanceRaw)\n    .sub(new Big(vestedBalanceFullRaw))\n    .toString();\n  console.log(totalBalanceRaw, claimedBalanceRaw, unclaimedBalanceRaw, vestedBalanceRaw, unvestedBalanceRaw);\n\n  return {\n    claimed: claimedBalanceRaw,\n    unclaimed: unclaimedBalanceRaw,\n    vested: vestedBalanceRaw,\n    unvested: unvestedBalanceRaw,\n    total: totalBalanceRaw,\n  };\n};\n","import { Big } from 'big.js';\n\nimport {\n  TSchedule, TNearTimestamp, TNearAmount, TCheckpoint,\n} from './api';\nimport { formatTokenAmount } from '../utils';\nimport { sumSchedules, terminateScheduleAtAmount } from './scheduleHelpers';\n\nconst buildVestedSchedule = (from: TNearTimestamp, balance: TNearAmount) => [\n  { timestamp: from - 1, balance: '0' },\n  { timestamp: from, balance },\n];\n\nexport const chartData = (lockupsList: any[], tokenDecimals: number): any => {\n  const lockupSchedules = Array.from(\n    lockupsList.map((x) => x.schedule),\n  ) as TSchedule[];\n\n  const now = Math.round(new Date().getTime() / 1000);\n  const minTimestampsLockup = lockupsList.map((x) => x.schedule[0].timestamp);\n  const minTimestampsVesting = lockupsList.map((x) => x?.termination_config?.vesting_schedule[0]?.timestamp).filter((x) => x);\n\n  const minTimestamp = Math.min(...minTimestampsLockup, ...minTimestampsVesting, now);\n\n  const vestingSchedules = Array.from(\n    lockupsList.map((x) => {\n      // for lockups and drafts\n      const result = x?.termination_config?.vesting_schedule?.Schedule\n        || x?.vesting_schedule?.Schedule;\n      if (result) return result;\n      return result || buildVestedSchedule(minTimestamp, x.schedule[x.schedule.length - 1].balance);\n    }),\n  ) as TSchedule[];\n\n  const sumVesting = sumSchedules(vestingSchedules);\n  const sumLockup = sumSchedules(lockupSchedules);\n\n  if (sumVesting.length > 0) {\n    if (sumVesting[sumVesting.length - 1].timestamp < sumLockup[sumLockup.length - 1].timestamp) {\n      sumVesting.push(sumLockup[sumLockup.length - 1]);\n    }\n    if (sumVesting[sumVesting.length - 1].timestamp > sumLockup[sumLockup.length - 1].timestamp) {\n      sumLockup.push(sumVesting[sumVesting.length - 1]);\n    }\n  }\n\n  const convertSchedule = (schedule: TSchedule, decimals: number) => schedule.map((s: TCheckpoint) => [s.timestamp * 1000, formatTokenAmount(s.balance, decimals)]);\n\n  const totalClaimed = lockupsList.map((x) => x.claimed_balance || '0').reduce((acc, x) => new Big(acc).add(new Big(x)).toFixed(), '0');\n\n  // trim lockup schedule at claimed amount\n  const sumClaimed = terminateScheduleAtAmount(sumLockup, totalClaimed, 0);\n\n  if (sumClaimed[sumClaimed.length - 1]?.timestamp !== sumLockup[sumLockup.length - 1].timestamp) {\n    sumClaimed.push({\n      timestamp: sumLockup[sumLockup.length - 1].timestamp,\n      balance: sumClaimed[sumClaimed.length - 1].balance,\n    });\n  }\n\n  return {\n    unlocked: lockupsList.length ? convertSchedule(sumLockup, tokenDecimals) : [],\n    vested: lockupsList.length ? convertSchedule(sumVesting, tokenDecimals) : [],\n    claimed: lockupsList.length ? convertSchedule(sumClaimed, tokenDecimals) : [],\n  };\n};\n\nexport default chartData;\n","import { useState, useContext } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\nimport LinkIcon from '@mui/icons-material/Link';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { useSnackbar } from 'notistack';\n\nimport TimestampDateDisplay from '../TimestampDateDisplay';\nimport Chart from '../Chart';\nimport { formatTokenAmount, toCompactString } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\nimport { calcBalancesRaw } from '../../services/scheduleHelpers';\n\nexport default function DraftsTableRow(props: { pageIndex: number, row: ReturnType<any>, token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  const location = useLocation();\n  const [open, setOpen] = useState(false);\n  const {\n    pageIndex, row, token, adminControls, progressShow,\n  } = props;\n  const { enqueueSnackbar } = useSnackbar();\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  const [now, _setNow] = useState<number>(Math.floor(new Date().getTime() / 1000));\n\n  if (!near) return null;\n\n  if (row instanceof Error) {\n    return (\n      <TableRow>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <div className=\"row-error\">\n            {'row '}\n            {pageIndex}\n            {': '}\n            {row.message}\n          </div>\n        </TableCell>\n      </TableRow>\n    );\n  }\n\n  const vestingSchedule = row?.vesting_schedule?.Schedule;\n\n  const currentContractName = location.pathname.split('/')[1];\n\n  const selectedDraftId = location.pathname.split('/').pop() === row.id.toString();\n  const draftPage = location.pathname.split('/').includes('drafts');\n  const importDraftPage = location.pathname.split('/').includes('import_draft_group');\n\n  const balancesRaw = calcBalancesRaw(row, now);\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {selectedDraftId && draftPage || importDraftPage\n            ? row.id\n            : (\n              <Link\n                to={adminControls\n                  ? `/${currentContractName}/admin/drafts/${row.id}`\n                  : `/${currentContractName}/drafts/${row.id}`}\n              >\n                {row.id}\n              </Link>\n            )}\n          {!importDraftPage && (\n          <CopyToClipboard\n            text={`${window.location.origin}/#/${currentContractName}/drafts/${row.id}`}\n            onCopy={() => enqueueSnackbar('Copied', { variant: 'success', autoHideDuration: 1000 })}\n          >\n            <IconButton aria-label=\"copy link\">\n              <LinkIcon />\n            </IconButton>\n          </CopyToClipboard>\n          )}\n        </TableCell>\n        <TableCell align=\"left\">\n          {toCompactString(row.account_id)}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[0].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[row.schedule.length - 1].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TokenAmountDisplay amount={balancesRaw.total} token={token} />\n        </TableCell>\n        {progressShow && (\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span className=\"nowrap\">\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.claimed, token.decimals)}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.unclaimed, token.decimals)}</b>\n                  {' '}\n                  Available\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.vested, token.decimals)}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.unvested, token.decimals)}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n)}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar-outer\">\n              <div className=\"progress-bar\">\n                <div style={{ width: `${(parseFloat(balancesRaw.claimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"claimed\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.unclaimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"available\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.vested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"vested\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.unvested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"unvested\">\n                &nbsp;\n                </div>\n              </div>\n            </div>\n          </Tooltip>\n        </TableCell>\n        )}\n      </TableRow>\n      <TableRow className=\"expanded\">\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n              {vestingSchedule && (\n                <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n              )}\n              <div className=\"lockup-row-column chart\">\n                <div style={{ height: 300 }}>\n                  <Chart data={chartData([row], token.decimals)} />\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { TMetadata } from '../../services/tokenApi';\nimport DraftsTableRow from './row';\n\nexport default function DraftsTable({\n  lockups, token, adminControls, progressShow,\n}: { lockups: any[], token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        {lockups.length > 0 && (\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\"><span className=\"nowrap\">ID</span></TableCell>\n          <TableCell align=\"left\"><span className=\"nowrap\">Account ID</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Start date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">End date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Total amount</span></TableCell>\n          {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n        </TableRow>\n        )}\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup, i) => (\n          <DraftsTableRow key={lockup.id} pageIndex={i + 1} row={lockup} token={token} adminControls={adminControls} progressShow={progressShow} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import BN from 'bn.js';\nimport Big from 'big.js';\nimport { assertValidTerminationSchedule } from './scheduleHelpers';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nconst prefixErrorWith = (prefix: string, callback: () => any) => {\n  try {\n    return callback();\n  } catch (e) {\n    if (!(e instanceof Error)) throw new Error('unreachable');\n    e.message = `${prefix}: ${e.message}`;\n    throw e;\n  }\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+(\\.[0-9]+)?$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nconst parsePercentage = (input: string): number => {\n  if (!(input.match(/^\\d+$/))) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  const percentage = parseInt(input, 10);\n\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  return percentage;\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = prefixErrorWith('percentage', () => parsePercentage(percentageRaw));\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = prefixErrorWith('start timestamp', () => parseTimestamp(timestampStartRaw));\n  const durationTotal = prefixErrorWith('duration', () => parseDuration(durationTotalRaw));\n  const cliffInfo = prefixErrorWith('cliff', () => parseCliffInfo(cliffInfoRaw));\n  const releaseEvery = prefixErrorWith('release every', () => parseDuration(releaseEveryRaw));\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = any;\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const allowedKeys = ['account_id', 'amount', 'lockup_schedule', 'vesting_schedule'];\n  Object.keys(input).forEach((key) => {\n    if (!allowedKeys.includes(key)) {\n      throw new Error(`unknown column '${key}'`);\n    }\n  });\n\n  if (!input.account_id) throw new Error(\"column 'account_id' not found\");\n  const accountId = parseValidAccountId(input.account_id);\n\n  if (!input.amount) throw new Error(\"column 'amount' not found\");\n  const amount = parseTokenAmount(input.amount);\n\n  if (!input.lockup_schedule) throw new Error(\"column 'lockup_schedule' not found\");\n  const lockupSchedule = prefixErrorWith('lockup schedule', () => parseHumanFriendlySchedule(input.lockup_schedule));\n  let vestingSchedule = null;\n\n  if (input.vesting_schedule) {\n    vestingSchedule = prefixErrorWith('vesting schedule', () => parseHumanFriendlySchedule(input.vesting_schedule));\n  }\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = string;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new Big(10).pow(tokenDecimals);\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(new Big(inputTotalAmount).mul(decimalsMultiplier).round(0, Big.roundDown).toString());\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const { releaseEvery } = schedule;\n\n  const tmCliff = timestampCliff;\n  const tmFirstStep = datePlusDurationMul(timestampCliff, releaseEvery, 1);\n  if (toUnix(tmFirstStep) <= toUnix(tmCliff)) {\n    throw new Error('invalid releaseEvery, zero duration');\n  }\n  if (toUnix(tmFirstStep) - toUnix(tmCliff) === 1) { // linear unlock during cliff\n    const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n    const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n    const cpCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount.toString() };\n    const cpFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount.toString() };\n\n    const result = [];\n    result.unshift(cpFinish);\n    if (cpCliff.timestamp < cpFinish.timestamp) {\n      result.unshift(cpCliff);\n    }\n    result.unshift(cpPreCliff);\n    if (cpStart.timestamp < cpPreCliff.timestamp) {\n      result.unshift(cpStart);\n    }\n\n    return result;\n  }\n\n  const tms = [];\n  {\n    // otherwise: use steps\n    let tm = timestampCliff;\n    const maxSteps = 500;\n    for (;;) {\n      if (tm >= timestampFinish) {\n        tm = timestampFinish;\n        tms.push(tm);\n        break;\n      }\n      tms.push(tm);\n      tm = datePlusDurationMul(tm, releaseEvery, 1);\n      if (tms.length >= maxSteps) {\n        throw new Error('too many checkpoints for schedule');\n      }\n    }\n  }\n\n  const increment = totalAmount.sub(cliffAmount).divn(tms.length - 1);\n\n  const cps: Checkpoint[] = tms.flatMap((tm, i) => {\n    if (tms.length === 1) {\n      return [{ timestamp: toUnix(timestampFinish), balance: totalAmount.toString() }];\n    }\n    if (i === 0) {\n      return [{ timestamp: toUnix(tm), balance: cliffAmount.toString() }];\n    }\n    const stepBalance = i === tms.length - 1\n      ? totalAmount\n      : cliffAmount.add(increment.muln(i)).toString();\n    return [\n      { timestamp: toUnix(tm) - 1, balance: cliffAmount.add(increment.muln(i - 1)).toString() },\n      { timestamp: toUnix(tm), balance: stepBalance.toString() },\n    ];\n  });\n\n  const cpsStart: Checkpoint[] = [];\n  const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n  const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n\n  cpsStart.unshift(cpPreCliff);\n  if (cpStart.timestamp < cpPreCliff.timestamp) {\n    cpsStart.unshift(cpStart);\n  }\n\n  const result = cpsStart.concat(cps);\n  return result;\n};\n\nexport type Lockup = {\n  id: number,\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  vesting_schedule: { Schedule: Schedule } | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number, index: number): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  const lockupSchedule = toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals);\n  let vestingSchedulePacked = null;\n\n  if (row.vesting_schedule) {\n    const vestingSchedule = toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals);\n    assertValidTerminationSchedule(lockupSchedule, vestingSchedule);\n    vestingSchedulePacked = { Schedule: vestingSchedule };\n  }\n\n  return {\n    id: index,\n    account_id: row.account_id,\n    schedule: lockupSchedule,\n    vesting_schedule: vestingSchedulePacked,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => parseLockup(x, tokenDecimals, index + 1));\n};\n\nexport type TLockupOrError = Lockup | Error;\n\nexport const parseRawSpreadsheetInputWithErrors = (spreadsheetInput: string, tokenDecimals: number): TLockupOrError[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => {\n    try {\n      return parseLockup(x, tokenDecimals, index + 1);\n    } catch (e) {\n      if (e instanceof Error) {\n        return e;\n      }\n      throw new Error('unreachable');\n    }\n  });\n};\n\nexport const lockupTotalBalance = (lockup: Lockup): Balance => lockup.schedule[lockup.schedule.length - 1].balance;\n","import { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\nimport { formatTokenAmount } from '../../utils';\n\nexport default function TokenAmountPreview(params: { token: TMetadata, amount: string }) {\n  const { token, amount } = params;\n\n  return (\n    <div className=\"token-info\" title={amount}>\n      <div className=\"token-amount\">\n        {formatTokenAmount(amount, token.decimals)}\n        {' '}\n        {token.symbol}\n      </div>\n      <TokenIcon url={token.icon || ''} size={32} />\n    </div>\n  );\n}\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { LoadingButton } from '@mui/lab';\nimport useTitle from '../../services/useTitle';\nimport DraftsTable from '../DraftsTable';\nimport {\n  parseRawSpreadsheetInputWithErrors, TLockupOrError, Lockup, lockupTotalBalance,\n} from '../../services/spreadsheetImport';\nimport TokenAmountPreview from '../TokenAmountPreview';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction ImportDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  useTitle('Import draft group | FT Lockup', { restoreOnUnmount: true });\n\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<TLockupOrError[]>([]);\n  const [parseErrors, setParseErrors] = useState<Error[]>([]);\n  const [importProgress, setImportProgress] = useState<boolean>(false);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      if (!near?.currentUser?.signedAccountId) {\n        throw new Error('expected present signedAccountId');\n      }\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInputWithErrors(input, token.decimals);\n      const errorsFiltered = lockups.filter((x) => x instanceof Error).map((x) => x as Error);\n      setData(lockups);\n      setParseErrors(errorsFiltered);\n    } catch (e) {\n      if (e instanceof Error) {\n        setData([]);\n        setParseErrors([e]);\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      if (!(e instanceof Error)) {\n        throw new Error('unreachable');\n      }\n      enqueueSnackbar(`${name} failed: ${e.message}`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleClickImport = async () => {\n    try {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      setImportProgress(true);\n\n      await withNotification(\n        'Check accounts',\n        async () => {\n          const accountIds = Array.from(new Set(\n            data.filter((x) => !(x instanceof Error)).map((x) => (x as Lockup).account_id),\n          ));\n\n          for (let i = 0; i < accountIds.length; i += 1) {\n            const accountId = accountIds[i];\n            if (!accountId.match(/^[0-9a-f]{64}$/)) {\n              try {\n                const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n                console.log(`${accountId} balance: ${total}`);\n              } catch (e) {\n                const message = `Account ID ${accountId} does not exist`;\n                throw new Error(message);\n              }\n            }\n          }\n\n          console.log('all accounts exist');\n          enqueueSnackbar('Checked account existence.', { variant: 'success' });\n        },\n      );\n\n      const draftGroupId = await withNotification(\n        'Create draft group',\n        async () => {\n          const result = await near.api.createDraftGroup();\n          return result;\n        },\n      );\n      const msg = `Created draft group id: ${draftGroupId}`;\n      enqueueSnackbar(msg, { variant: 'success' });\n\n      const chunkSize = 20;\n      for (let i = 0; i < data.length; i += chunkSize) {\n        const chunk = data.slice(i, i + chunkSize);\n        const drafts = chunk.map((lockup) => ({\n          draft_group_id: draftGroupId,\n          lockup_create: lockup,\n        }));\n        await withNotification(\n          'Create drafts',\n          async () => {\n            const result = await near.api.createDrafts(drafts);\n            return result;\n          },\n        );\n      }\n\n      const message = `Created ${data.length} draft${data.length > 1 ? 's' : ''}.`;\n      enqueueSnackbar(message, { variant: 'success' });\n\n      const currentContractName = location.pathname.split('/')[1];\n      const path = `/${currentContractName}/admin/draft_groups/${draftGroupId}`;\n\n      navigate(path);\n    } catch (e) {\n      setImportProgress(false);\n    }\n  };\n\n  const calcTotalBalance = (lockups: TLockupOrError[]) => {\n    const lockupsFiltered = lockups.filter((x: TLockupOrError) => !(x instanceof Error)).map((x) => x as Lockup);\n    const balances = lockupsFiltered.map((x: Lockup) => lockupTotalBalance(x));\n    let result = new Big('0');\n\n    balances.forEach((x) => {\n      result = result.add(new Big(x));\n    });\n    return result.toString();\n  };\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h2>\n          Import Draft Group\n        </h2>\n\n        <div className=\"import-draft-group-wrapper\">\n          <div className=\"draft-group-preview-inner\">\n            <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n              <h5>\n                <span className=\"new-draft-count-text\">\n                  {`New draft group with ${data.length} lockup${data.length > 1 ? 's' : ''}`}\n                </span>\n                {' '}\n                {parseErrors.length > 0 && (<span className=\"parse-error-label\">{`${parseErrors.length} parse error${parseErrors.length > 1 ? 's' : ''}`}</span>)}\n              </h5>\n              <TokenAmountPreview amount={calcTotalBalance(data)} token={token} />\n            </div>\n          </div>\n\n          <p>\n            Copy lockups from a spreadsheet editor and paste into the area below.\n            See\n            {' '}\n            <a href={`${process.env.PUBLIC_URL}/lockup_import_example.xlsx`}>\n              example and format specifications\n            </a>\n            .\n          </p>\n          <TextareaAutosize\n            className=\"import-draft-group-textarea\"\n            id=\"spreadsheet-input\"\n            placeholder=\"Excel input\"\n            maxRows={5}\n            onChange={handleChangeInput}\n          />\n        </div>\n        <DraftsTable lockups={data} token={token} adminControls={adminControls} progressShow />\n        <LoadingButton\n          disabled={!(data.length >= 1 && parseErrors.length === 0 && !importProgress)}\n          onClick={handleClickImport}\n          loading={importProgress}\n          type=\"button\"\n          className=\"button\"\n        >\n          Import\n        </LoadingButton>\n      </div>\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction FundButton(props: { draftGroupIndex: number, amount: string }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleFund = () => {\n    near.tokenApi.fundDraftGroup(\n      near.api.getContract().contractId,\n      draftGroupIndex,\n      amount,\n    );\n  };\n\n  return (\n    <button className=\"button\" type=\"button\" onClick={handleFund}>Fund</button>\n  );\n}\n\nexport default FundButton;\n","import { useContext } from 'react';\n\nimport Select from '@mui/material/Select';\n\nimport {\n  TextField,\n  InputLabel,\n  MenuItem,\n} from '@mui/material';\n\nimport { INearProps, NearContext } from '../../../services/near';\n\ntype TProps = {\n  selectedAddress: string,\n  setSelectedAddress: Function,\n};\n\nfunction DaoSelector({ selectedAddress, setSelectedAddress }: TProps): any {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const { daos } = near.currentUser;\n\n  if (daos.length > 0 && (selectedAddress === '' || !daos.includes(selectedAddress))) {\n    setSelectedAddress(daos[0]);\n  }\n\n  const handleSelectedDaoAddressChange = (event: any) => {\n    setSelectedAddress(event.target.value as string);\n  };\n\n  if (daos.length > 0) {\n    return (\n      <div>\n        <InputLabel>Select DAO contract address</InputLabel>\n        <Select\n          required\n          sx={{ marginBottom: 3, width: 1 }}\n          value={selectedAddress}\n          onChange={handleSelectedDaoAddressChange}\n        >\n          {daos.map((dao) => <MenuItem value={dao}>{dao}</MenuItem>)}\n        </Select>\n      </div>\n    );\n  }\n\n  return (\n    <TextField\n      required\n      sx={{ marginBottom: 3, width: 1 }}\n      id=\"outlined-helperText\"\n      label=\"DAO contract address\"\n      onChange={handleSelectedDaoAddressChange}\n    />\n  );\n}\n\nexport default DaoSelector;\n","import {\n  TextField,\n} from '@mui/material';\n\ntype TProps = {\n  proposalDescription: string,\n  setProposalDescription: Function,\n};\n\nfunction DaoProposalDescription({ proposalDescription, setProposalDescription }: TProps): any {\n  const handleDescriptionChange = (e: any) => {\n    setProposalDescription(e.target.value as string);\n  };\n\n  return (\n    <TextField\n      sx={{ width: 1 }}\n      id=\"outlined-multiline-static\"\n      label=\"Proposal description\"\n      multiline\n      minRows={5}\n      onChange={handleDescriptionChange}\n      defaultValue={proposalDescription}\n    />\n  );\n}\n\nexport default DaoProposalDescription;\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { TMetadata } from '../../services/tokenApi';\n\nimport { formatTokenAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { buildFundDraftGroupProposalLink } from '../../services/DAOs/astroDAO/utils';\n\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\n\nfunction FundWithDaoButton(props: { draftGroupIndex: number, amount: string, token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount, token } = props;\n\n  const formattedAmount = formatTokenAmount(amount, token.decimals);\n\n  const defaultDescription = `Fund draft group ${draftGroupIndex} with amount ${formattedAmount}. Draft group link: ${window.location.href.replace(/\\/admin/, '')}`;\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState('');\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleFund = () => {\n    const link = buildFundDraftGroupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      near.tokenApi.getContract().contractId,\n      amount,\n      draftGroupIndex,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Fund with DAO</button>\n      <Dialog open={open} sx={{ padding: 1, minWidth: 1 }} onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleFund}>\n          <DialogTitle>\n            Fund with DAO\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent style={{ minWidth: '320px', paddingTop: '1.25em' }}>\n            <DaoSelector selectedAddress={astroDAOContractAddress} setSelectedAddress={setAstroDAOContractAddress} />\n            <DaoProposalDescription proposalDescription={description} setProposalDescription={setDescription} />\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Fund</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n\nexport default FundWithDaoButton;\n","import { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\n\nimport { LoadingButton } from '@mui/lab';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction DeleteDraftGroupButton(props: { draftGroupId: number, draftIds: [number], disabled: boolean }) {\n  const { draftGroupId, draftIds, disabled } = props;\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { enqueueSnackbar } = useSnackbar();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [inProgress, setInProgress] = useState<boolean>(false);\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleDelete = () => {\n    const perform = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n\n      setInProgress(true);\n\n      // discard draft group\n      try {\n        await near.api.discardDraftGroup(draftGroupId);\n        enqueueSnackbar(`Discarded draft group ${draftGroupId}`, { variant: 'success' });\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          if (!message.includes('cannot discard, draft group already discarded')) {\n            enqueueSnackbar(`Failed to discard draft group ${draftGroupId}: ${message}`, { variant: 'error' });\n            setInProgress(false);\n            return;\n          }\n        } else {\n          throw new Error('unreachable');\n        }\n      }\n\n      // delete all drafts\n      try {\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Delete drafts',\n            async () => {\n              const result = await near.api.deleteDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        enqueueSnackbar(`Deleted draft group ${draftGroupId}`, { variant: 'success' });\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/draft_groups`);\n        window.location.reload();\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          enqueueSnackbar(`Failed to discard draft group ${draftGroupId}: ${message}`, { variant: 'error' });\n          setInProgress(false);\n        } else {\n          throw new Error('unreachable');\n        }\n      }\n    };\n\n    perform();\n  };\n\n  return (\n    <LoadingButton\n      className=\"button compact red\"\n      type=\"button\"\n      variant=\"contained\"\n      onClick={handleDelete}\n      loading={inProgress}\n      disabled={disabled || inProgress}\n    >\n      Delete\n    </LoadingButton>\n  );\n}\n\nexport default DeleteDraftGroupButton;\n","import { useState, useEffect, useContext } from 'react';\nimport { Alert } from '@mui/material';\nimport {\n  useNavigate, useParams, useLocation, Link,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport { LoadingButton } from '@mui/lab';\n\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport TokenAmountPreview from '../../components/TokenAmountPreview';\nimport FundButton from '../../components/FundButton';\nimport FundWithDaoButton from '../../components/FundWithDaoButton';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\n\nexport default function PageDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  const location = useLocation();\n  const { enqueueSnackbar } = useSnackbar();\n  const draftGroupId: number = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n  const [isConverted, setIsConverted] = useState<string>('pending');\n\n  useEffect(() => {\n    const perform = async () => {\n      setIsConverted('pending');\n      console.log(`fetchIsConverted: ${draftGroupId} ${'pending'}`);\n\n      if (!near) return;\n\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n      const msg = args.msg && JSON.parse(args.msg);\n      const msgDraftGroupId = msg && msg.draft_group_id;\n\n      console.log(methodName, successValue, args, msg, msgDraftGroupId);\n\n      const result = methodName === 'ft_transfer_call' && msgDraftGroupId !== undefined && msgDraftGroupId === draftGroupId;\n\n      if (result) {\n        setIsConverted('converted');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'converted'}`);\n      } else {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n      }\n    };\n    perform();\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n\n      console.log(`fetchDraftGroup called: ${draftGroupId} ${isConverted}`);\n      if (!near) return;\n      console.log(isConverted);\n      if (isConverted === 'pending') {\n        return;\n      }\n\n      const result = await near.api.getDraftGroup(draftGroupId);\n      setDraftGroup(result || 'not_found');\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId, isConverted]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup || draftGroup === 'not_found') {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  const navigate = useNavigate();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleConvert = () => {\n    const convertDrafts = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      try {\n        setInProgress(true);\n        const draftIds = draftGroup.draft_indices;\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Convert drafts',\n            async () => {\n              const result = await near.api.convertDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        enqueueSnackbar(`Converted drafts for draft group ${draftGroupId}`, { variant: 'success' });\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/lockups`);\n        window.location.reload();\n      } catch (e) {\n        console.log(`ERROR: ${e}`);\n      } finally {\n        setInProgress(false);\n      }\n    };\n\n    convertDrafts();\n  };\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  if (draftGroup === 'not_found') {\n    const currentContractName = location.pathname.split('/')[1];\n    return (\n      <div className=\"container\">\n        <h1>{isConverted === 'converted' ? `Success! Draft group ${draftGroupId} have been converted!` : `Draft group ${draftGroupId} have been converted or deleted.`}</h1>\n        <div>\n          <br />\n          Check\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups`}>lockups</Link>\n          {' '}\n          to find converted lockups or\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/draft_groups`}>draft groups</Link>\n          {' '}\n          to see all existing draft groups.\n        </div>\n      </div>\n    );\n  }\n\n  if (!near) return null;\n  const { isAdmin } = near.currentUser;\n\n  return (\n    <div className=\"container\">\n      <div className=\"draft-group-preview-wrapper draft-group-preview-inner\">\n        <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n          <h5>\n            {`Draft group ${draftGroupId}`}\n            {' '}\n            {draftGroup.discarded && (<span className=\"discarded-marker\">DISCARDED</span>)}\n          </h5>\n          <TokenAmountPreview token={token} amount={draftGroup.total_amount} />\n        </div>\n        {!draftGroup.funded && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            {!draftGroup.discarded && isAdmin && <FundButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} /> }\n            {!draftGroup.discarded && <FundWithDaoButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} token={token} />}\n            <DeleteDraftGroupButton\n              draftGroupId={draftGroup.id}\n              draftIds={draftGroup.draft_indices}\n              disabled={draftGroup.funded}\n            />\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length > 0 && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            <LoadingButton\n              className=\"button\"\n              type=\"button\"\n              onClick={handleConvert}\n              loading={inProgress}\n              variant=\"contained\"\n              color=\"success\"\n            >\n              Convert\n            </LoadingButton>\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length === 0 && (\n          <div style={{ marginTop: 20 }}>\n            <Alert severity=\"success\">Draft Group converted</Alert>\n          </div>\n        )}\n      </div>\n\n      {(!draftGroup.funded || draftGroup.draft_indices.length > 0) && (\n        <DraftsTable lockups={drafts} token={token} adminControls={adminControls} progressShow />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport useTitle from '../../services/useTitle';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { formatTokenAmount } from '../../utils';\nimport TokenIcon from '../../components/TokenIcon';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\n\nexport default function PageDraftGroupsIndex({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  useTitle('Draft Groups | FT Lockup', { restoreOnUnmount: true });\n\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  const currentContractName = location.pathname.split('/')[1];\n  const importDraftGroupPath = `/${currentContractName}/admin/import_draft_group`;\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h1>\n          All draft groups\n        </h1>\n\n        {draftGroups.length === 0 && (\n          <div>\n            There are no draft groups yet.\n          </div>\n        )}\n\n        {draftGroups.length !== 0 && (\n          <Table className=\"main-table\" aria-label=\"collapsible table\">\n            <TableHead className=\"table-head\">\n              <TableRow>\n                <TableCell align=\"center\">ID</TableCell>\n                <TableCell align=\"center\">Funded</TableCell>\n                <TableCell align=\"center\">Number&nbsp;of&nbsp;lockups</TableCell>\n                <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n                {adminControls && <TableCell align=\"right\" width=\"0%\">Delete</TableCell>}\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {draftGroups.map((group) => (\n                <TableRow key={group.id}>\n                  <TableCell align=\"center\">\n                    <Link to={`/${currentContractName}/${adminControls ? 'admin/' : ''}draft_groups/${group.id}`}>{group.id}</Link>\n                  </TableCell>\n                  <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n                  <TableCell align=\"center\">{group.draft_indices.length}</TableCell>\n                  <TableCell align=\"right\">\n                    {formatTokenAmount(group.total_amount, token.decimals)}\n                  &nbsp;\n                    {token.symbol}\n                  &nbsp;\n                    <TokenIcon url={token.icon || ''} size={32} />\n                  </TableCell>\n                  {adminControls && (\n                    <TableCell align=\"right\">\n                      {!group.funded && (\n                      <DeleteDraftGroupButton\n                        draftGroupId={group.id}\n                        draftIds={group.draft_indices}\n                        disabled={group.funded}\n                      />\n                      )}\n                    </TableCell>\n                  )}\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        )}\n\n        {adminControls && (\n        <Link to={importDraftGroupPath}>\n          <button className=\"button\" type=\"button\">Import Draft Group</button>\n        </Link>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Box } from '@mui/material';\nimport { useSnackbar } from 'notistack';\n\nimport useTitle from '../../services/useTitle';\nimport { FACTORY_CONTRACT_NAME } from '../../config';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function NewLockupContract() {\n  useTitle('Create Lockup Contract | FT Lockup', { restoreOnUnmount: true });\n\n  const { enqueueSnackbar } = useSnackbar();\n  const { near, signIn }: { near: INearProps | null, signIn: () => void } = useContext(NearContext);\n\n  const [tokenAccountId, setTokenAccountId] = useState<string>('');\n  const [name, setName] = useState<string>('');\n  const [lockupOperatorsRaw, setLockupOperatorsRaw] = useState<string>('');\n  const lockupOperators = lockupOperatorsRaw.split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n\n  const [draftOperatorsRaw, setDraftOperatorsRaw] = useState<string>('');\n  const draftOperators = draftOperatorsRaw.split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n\n  const PENDING = 'pending';\n  const FOUND = 'found';\n  const NOT_FOUND = 'not_found';\n\n  const [accountStatuses, setAccountStatuses] = useState<any>({ '': NOT_FOUND }); // pending success error\n\n  const enqueueAccountIdCheck = async (accountId: string) => {\n    if (!near) return;\n    console.log('accountStatuses', accountStatuses);\n\n    if (accountStatuses[accountId]) {\n      // lookup finished or in progress\n      return;\n    }\n\n    if (accountId.match(/^[0-9a-f]{64}$/)) {\n      setAccountStatuses((acc: any) => {\n        console.log('.');\n        return { ...acc, [accountId]: FOUND };\n      });\n      return;\n    }\n\n    setAccountStatuses((acc: any) => {\n      console.log('... pending');\n      return { ...acc, [accountId]: PENDING };\n    });\n\n    try {\n      const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n      console.log(total);\n      setAccountStatuses((acc: any) => {\n        console.log('...found');\n        return { ...acc, [accountId]: FOUND };\n      });\n    } catch (e) {\n      console.log(e);\n      setAccountStatuses((acc: any) => {\n        console.log('...not found');\n        return { ...acc, [accountId]: NOT_FOUND };\n      });\n    }\n\n    console.log('accountStatuses', accountStatuses);\n  };\n  console.log(enqueueAccountIdCheck);\n\n  const validateAccountExists = async (accountId: string) => {\n    if (!near) throw new Error('unreachable');\n    if (accountId.match(/^[0-9a-f]{64}$/)) {\n      return;\n    }\n    try {\n      const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n      console.log(`${accountId} balance: ${total}`);\n    } catch (e) {\n      const message = `Account ID \"${accountId}\" does not exist`;\n      throw new Error(message);\n    }\n  };\n\n  const handleChangeTokenAccountId = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setTokenAccountId(value);\n    enqueueAccountIdCheck(value);\n  };\n\n  const handleChangeName = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setName(value);\n    enqueueAccountIdCheck(`${value}.${FACTORY_CONTRACT_NAME}`);\n  };\n\n  const handleChangeLockupOperatorsRaw = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setLockupOperatorsRaw(value);\n    const parsed = value.split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n    parsed.forEach((x) => enqueueAccountIdCheck(x));\n  };\n\n  const handleChangeDraftOperatorsRaw = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setDraftOperatorsRaw(value);\n    const parsed = value.split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n    parsed.forEach((x) => enqueueAccountIdCheck(x));\n  };\n\n  const handleDeployLockupContract = (e: any) => {\n    e.preventDefault();\n\n    const perform = async () => {\n      try {\n        if (!near?.currentUser?.signedAccountId) {\n          throw new Error('expected signedAccountId to be present');\n        }\n\n        const allUniqueAccountIds = Array.from(new Set(\n          [...lockupOperators, ...draftOperators, tokenAccountId],\n        ));\n        for (let i = 0; i < allUniqueAccountIds.length; i += 1) {\n          const accountId = allUniqueAccountIds[i];\n          await validateAccountExists(accountId);\n        }\n\n        const lockupSubaccountId: string = e.target.elements.lockup_subaccount_id.value;\n\n        if (lockupOperators.length === 0) {\n          throw new Error('empty lockup operators');\n        }\n\n        if (tokenAccountId.length === 0) {\n          throw new Error('empty tokenAccountId');\n        }\n\n        if (lockupSubaccountId.length === 0) {\n          throw new Error('empty lockupSubaccountId');\n        }\n\n        // const message = `\n        //   lockup_creator: ${lockupCreator}\n        //   lockup_operators: ${JSON.stringify(lockupOperators)}\n        //   token_account_id: ${tokenAccountId}\n        //   lockup_subaccount_id: ${lockupSubaccountId}\n        // `;\n        // alert(message);\n\n        const result = await near.factoryApi.create(\n          lockupSubaccountId,\n          tokenAccountId,\n          lockupOperators,\n          draftOperators,\n          `${window.location.origin + window.location.pathname}#/${lockupSubaccountId}.${FACTORY_CONTRACT_NAME}/admin/lockups`,\n        );\n\n        console.log(result);\n\n        return result;\n      } catch (error) {\n        console.log(error);\n        enqueueSnackbar((error as any).toString(), { variant: 'error' });\n        return null;\n      }\n    };\n\n    perform();\n  };\n\n  if (!(near)) {\n    return null;\n  }\n\n  const lockupOperatorsMissing = lockupOperators.filter((x) => accountStatuses[x] === NOT_FOUND);\n  const lockupOperatorsPending = lockupOperators.filter((x) => accountStatuses[x] === PENDING);\n\n  const draftOperatorsMissing = draftOperators.filter((x) => accountStatuses[x] === NOT_FOUND);\n  const draftOperatorsPending = draftOperators.filter((x) => accountStatuses[x] === PENDING);\n  return (\n    <div>\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n            <div className=\"nav\">\n              <Link className=\"nav-link\" to=\"/\">Home</Link>\n            </div>\n          </Box>\n        </div>\n      </div>\n\n      <div className=\"container new-lockup-contract\">\n        <h2>\n          Create Lockup Contract for your Fungible Tokens\n        </h2>\n\n        <form className=\"form-submit\" onSubmit={handleDeployLockupContract}>\n          <div className=\"form-wrapper\">\n\n            <p>On this page you can deploy your own copy of lockup contract. Some more elaborative description follows here.</p>\n            <div className=\"form-row\">\n              <span>Contract creator: </span>\n              <div className=\"form-cell\">\n                {near.currentUser.signedAccountId && <strong>{near.currentUser.signedAccountId}</strong>}\n                <button className=\"button\" type=\"button\" onClick={signIn}>\n                  {near.currentUser.signedAccountId && 'Login as someone else' || 'Login'}\n                </button>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <span>Lockup operators: </span>\n              <div style={{ display: 'inline-block' }}>\n                <input type=\"text\" id=\"lockup_operators\" value={lockupOperatorsRaw} onChange={handleChangeLockupOperatorsRaw} />\n                <div style={{ fontSize: 10, height: '0px', position: 'absolute' }}>\n                  {lockupOperatorsMissing.length > 0 && <span style={{ lineHeight: '20px', color: '#FF594E' }}>{`Account \"${lockupOperatorsMissing[0]}\" does not exist`}</span>}\n                  {lockupOperators.length === 0 && <span style={{ lineHeight: '20px', color: '#FF594E' }}>Required</span>}\n                  {lockupOperatorsMissing.length === 0 && lockupOperatorsPending.length > 0 && <span style={{ lineHeight: '20px', color: '#808689' }}>Checking...</span>}\n                </div>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <span>Draft operators: </span>\n              <div style={{ display: 'inline-block' }}>\n                <input type=\"text\" id=\"draft_operators\" value={draftOperatorsRaw} onChange={handleChangeDraftOperatorsRaw} />\n                <div style={{ fontSize: 10, height: '0px', position: 'absolute' }}>\n                  {draftOperatorsMissing.length > 0 && <span style={{ lineHeight: '20px', color: '#FF594E' }}>{`Account \"${draftOperatorsMissing[0]}\" does not exist`}</span>}\n                  {draftOperatorsMissing.length === 0 && draftOperatorsPending.length > 0 && <span style={{ lineHeight: '20px', color: '#808689' }}>Checking...</span>}\n                </div>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <span>Fungible token contract address: </span>\n              <div style={{ display: 'inline-block' }}>\n                <input\n                  type=\"text\"\n                  id=\"token_account_id\"\n                  value={tokenAccountId}\n                  onChange={handleChangeTokenAccountId}\n                />\n                <div style={{ fontSize: 10, height: '0px', position: 'absolute' }}>\n                  {tokenAccountId && accountStatuses[tokenAccountId] === NOT_FOUND && <span style={{ lineHeight: '20px', color: '#FF594E' }}>Account does not exist</span>}\n                  {!tokenAccountId && <span style={{ lineHeight: '20px', color: '#FF594E' }}>Required</span>}\n                  {accountStatuses[tokenAccountId] === PENDING && <span style={{ lineHeight: '20px', color: '#808689' }}>Checking...</span>}\n                </div>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <span>New Lockup Contract Address: </span>\n              <div style={{ display: 'inline-block', position: 'absolute' }}>\n                <input type=\"text\" id=\"lockup_subaccount_id\" value={name} onChange={handleChangeName} />\n                <div style={{ fontSize: 10, height: '0px' }}>\n                  {accountStatuses[`${name}.${FACTORY_CONTRACT_NAME}`] === FOUND && <span style={{ lineHeight: '20px', color: '#FF594E' }}>Account already exists</span>}\n                  {accountStatuses[`${name}.${FACTORY_CONTRACT_NAME}`] === PENDING && <span style={{ lineHeight: '20px', color: '#808689' }}>Checking...</span>}\n                  {accountStatuses[`${name}.${FACTORY_CONTRACT_NAME}`] === NOT_FOUND && name && <span style={{ lineHeight: '20px', color: '#00B988' }}>Account is available</span>}\n                  {!name && <span style={{ lineHeight: '20px', color: '#FF594E' }}>Required</span>}\n                </div>\n              </div>\n            </div>\n\n            <button\n              className=\"button submit\"\n              type=\"submit\"\n              disabled={!(\n                near.currentUser.signedAccountId && accountStatuses[tokenAccountId] === FOUND && lockupOperators.length > 0\n              )}\n            >\n              Deploy Contract\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { DateTimePicker } from '@mui/x-date-pickers/DateTimePicker';\nimport { TextField } from '@mui/material';\n\ntype TProps = {\n  value: Date | null,\n  setValue: (newValue: Date | null) => any,\n  label: String,\n  minTime: Date | null,\n  disabled: boolean,\n};\n\nexport default function UTCDateTimePicker(props: TProps) {\n  const {\n    value, setValue, label, minTime, disabled,\n  } = props;\n\n  const offsetMs = 1_000 * 60 * new Date().getTimezoneOffset();\n\n  return (\n    <DateTimePicker\n      disabled={disabled}\n      label={label}\n      value={value && new Date(value.getTime() + offsetMs)}\n      minDateTime={minTime && new Date(minTime.getTime() + offsetMs)}\n      onChange={(newValue) => {\n        setValue(newValue && new Date(newValue.getTime() - offsetMs));\n      }}\n      ampm={false}\n      renderInput={\n        (params) => (\n          <TextField\n            sx={{ margin: '0px 0 24px' }}\n            margin=\"normal\"\n            fullWidth\n            variant=\"standard\"\n            {...params}\n            inputProps={{\n              ...params.inputProps,\n              placeholder: 'YYYY-MM-DD hh:mm:ss UTC',\n            }}\n          />\n        )\n      }\n      inputFormat=\"yyyy-MM-dd HH:mm:ss 'UTC'\"\n    />\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport BN from 'bn.js';\nimport Big from 'big.js';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear, startOfDay, addDays } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TSchedule } from '../../services/api';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setStartDate', newValue?.getTime());\n    setStartDate(newValue);\n    setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n  const [accountId, setAccountId] = useState<string>('');\n  const [accountStatuses, setAccountStatuses] = useState<any>({ '': 'error' }); // pending success error\n  const [amount, setAmount] = useState<string>('');\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleChangeAmount = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const perform = async () => {\n      if (!near) return;\n      const { value } = event.target;\n\n      setAmount(value);\n    };\n\n    perform();\n  };\n\n  const handleChangeAccountId = (value: any) => {\n    const perform = async () => {\n      if (!near) return;\n      console.log('accountStatuses', accountStatuses);\n\n      setAccountId(value);\n\n      if (accountStatuses[value]) {\n        // lookup finished or in progress\n        return;\n      }\n\n      if (value.match(/^[0-9a-f]{64}$/)) {\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'success' };\n        });\n        return;\n      }\n\n      setAccountStatuses((acc: any) => {\n        console.log('.');\n        return { ...acc, [value]: 'pending' };\n      });\n\n      try {\n        const { total } = (await (await near.near.account(value)).getAccountBalance());\n        console.log(total);\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'success' };\n        });\n      } catch (e) {\n        console.log(e);\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'error' };\n        });\n      }\n\n      console.log('accountStatuses', accountStatuses);\n    };\n\n    perform();\n  };\n\n  const handleChangeAccountIdEvent = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const { value } = event.target;\n    return handleChangeAccountId(value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n    if (!near.currentUser.signedAccountId) {\n      throw new Error('signedAccountId requred to set lockup terminator');\n    }\n    if (!startDate) {\n      throw Error('Start date not set');\n    }\n\n    e.preventDefault();\n\n    console.log(amount);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const lockupTotalAmount = new Big(amount).mul(new Big(10).pow(token.decimals))\n      .round(0, Big.roundDown).toString();\n\n    const getScheduleList = (date: Date, balanceInput: string, selected: string): [TSchedule, TSchedule | null] => {\n      const balance = new BN(balanceInput);\n\n      const schedules: { [key: string]: TSchedule } = {\n        '4y_cliff_1y_25': [\n          { timestamp: addYear(date, 0), balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: balance.divn(4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n\n      const schedulePairs: { [key: string]: [TSchedule, TSchedule | null] } = {\n        '4_year': [schedules['4y_cliff_1y_25'], null],\n        '4_year_vested': [schedules['4y_cliff_1y_25'], schedules['4y_cliff_1y_25']],\n      };\n\n      return schedulePairs[selected];\n    };\n\n    const [lockupSchedule, vestingSchedule] = getScheduleList(startDate, lockupTotalAmount, schedule);\n\n    near.tokenApi.createLockup(\n      lockupContractId,\n      lockupTotalAmount.toString(),\n      accountId,\n      lockupSchedule,\n      vestingSchedule,\n    );\n  };\n\n  const validAmount = !Number.isNaN(parseFloat(amount));\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"md\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n              value={accountId}\n              onChange={handleChangeAccountIdEvent}\n            />\n            <div style={{ fontSize: 10 }}>\n              {accountStatuses[accountId] === 'error' && <span style={{ color: '#FF594E' }}>Account does not exist</span>}\n              {accountStatuses[accountId] === 'pending' && <span style={{ color: '#808689' }}>Checking...</span>}\n              {accountStatuses[accountId] === 'success' && <span style={{ color: '#00B988' }}>Account found</span>}\n            </div>\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n              onChange={handleChangeAmount}\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <UTCDateTimePicker\n                value={startDate}\n                setValue={(newValue) => {\n                  console.log('setStartDate', newValue?.getTime());\n                  setStartDate(newValue);\n                }}\n                label=\"Start date and time\"\n                minTime={null}\n                disabled={false}\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button disabled={!startDate || accountStatuses[accountId] === 'error' || !validAmount} className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n","import { useState } from 'react';\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  RadioGroup,\n  Radio,\n  FormControl,\n  FormControlLabel,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\n\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport { interpolateSchedule, terminateScheduleAtAmount, terminateSchedule } from '../../services/scheduleHelpers';\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\nimport { startOfDay, addDays } from '../../utils';\nimport { TSchedule, TLockup } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport Chart from '../Chart';\nimport { chartData } from '../../services/chartHelpers';\n\ntype TUIElement<Ctype> = {\n  currentState: {\n    value: Ctype,\n    setValue: any,\n  },\n};\n\nexport type TProps = {\n  currentState: {\n    value: boolean,\n    setValue: any,\n  },\n  schedule: TSchedule,\n  vestingSchedule: TSchedule,\n  handlers: {\n    onClose: any,\n    onSubmit: any,\n  },\n  dialog: {\n    dateTimePicker: TUIElement<Date | null>,\n    daoSelector?: TUIElement<string>,\n    daoProposalDescription?: TUIElement<string>,\n  },\n  token: TMetadata,\n  lockup: TLockup,\n};\n\nexport function TerminateModal({\n  currentState,\n  schedule,\n  vestingSchedule,\n  handlers,\n  dialog,\n  token,\n  lockup,\n}: TProps) {\n  console.log(schedule);\n  const [terminationMode, setTerminationMode] = useState<string>(\n    dialog.dateTimePicker.currentState.value ? 'with_timestamp' : 'now',\n  );\n  const calcDefaultTimestamp = () => addDays(startOfDay(new Date()), 1);\n\n  const xMax = Math.max(\n    schedule[schedule.length - 1].timestamp,\n    schedule[schedule.length - 1].timestamp,\n  );\n  const terminationTimestamp = (\n    (dialog.dateTimePicker.currentState.value && !Number.isNaN(dialog.dateTimePicker.currentState.value.getTime()))\n      ? new Date(Math.max(dialog.dateTimePicker.currentState.value.getTime(), new Date().getTime()))\n      : new Date()\n  ).getTime() / 1_000;\n\n  const vestedAmount: string = interpolateSchedule(vestingSchedule, terminationTimestamp).balance;\n\n  const trimmedLockupSchedule = terminateScheduleAtAmount(lockup.schedule, vestedAmount, 0);\n  const trimmedVestingSchedule = terminateSchedule(vestingSchedule, terminationTimestamp);\n\n  const yMax = Math.max(\n    parseFloat(vestingSchedule[vestingSchedule.length - 1].balance),\n    parseFloat(vestingSchedule[vestingSchedule.length - 1].balance),\n  ) / 10 ** token.decimals;\n\n  const trimmedLockup = {\n    schedule: trimmedLockupSchedule,\n    termination_config: {\n      vesting_schedule: {\n        Schedule: trimmedVestingSchedule,\n      },\n    },\n    claimed_balance: lockup.claimed_balance,\n  };\n\n  return (\n    <Dialog open={currentState.value} sx={{ padding: 2 }} maxWidth=\"md\" onClose={handlers.onClose}>\n      <form className=\"form-submit\">\n        <DialogTitle>\n          Terminate Lockup\n          <IconButton\n            aria-label=\"close\"\n            onClick={handlers.onClose}\n            sx={{\n              position: 'absolute',\n              right: 8,\n              top: 8,\n            }}\n          >\n            <CloseRoundedIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent sx={{ minWidth: '720px' }}>\n          <div style={{ height: 300 }}>\n            <Chart data={chartData([trimmedLockup], token.decimals)} xMax={xMax} yMax={yMax} />\n          </div>\n          <div className=\"vested-amount-info\">\n            <div style={{ lineHeight: '30px' }}>\n              Vested amount\n              {terminationMode === 'now' ? ' (approximate)' : ''}\n              :\n            </div>\n            <div>\n              <TokenAmountDisplay amount={vestedAmount} token={token} />\n            </div>\n          </div>\n          <FormControl>\n            <RadioGroup\n              aria-labelledby=\"demo-radio-buttons-group-label\"\n              defaultValue=\"female\"\n              name=\"radio-buttons-group\"\n              value={terminationMode}\n              onChange={(_event, newValue: string) => {\n                setTerminationMode(newValue);\n                if (newValue === 'with_timestamp') {\n                  dialog.dateTimePicker.currentState.setValue(calcDefaultTimestamp());\n                } else {\n                  dialog.dateTimePicker.currentState.setValue(null);\n                }\n              }}\n            >\n              <FormControlLabel value=\"now\" control={<Radio />} label=\"now\" />\n              <FormControlLabel value=\"with_timestamp\" control={<Radio />} label=\"at specific timestamp\" />\n            </RadioGroup>\n          </FormControl>\n          <LocalizationProvider dateAdapter={AdapterDateFns}>\n            {dialog.dateTimePicker && (\n              <UTCDateTimePicker\n                value={dialog.dateTimePicker.currentState.value}\n                setValue={(newValue) => {\n                  dialog.dateTimePicker.currentState.setValue(newValue);\n                }}\n                label=\"Custom termination date and time\"\n                minTime={new Date()}\n                disabled={!(terminationMode === 'with_timestamp')}\n              />\n            )}\n          </LocalizationProvider>\n          { dialog?.daoSelector && (\n            <DaoSelector\n              selectedAddress={dialog.daoSelector.currentState.value}\n              setSelectedAddress={dialog.daoSelector.currentState.setValue}\n            />\n          ) }\n          { dialog?.daoProposalDescription && (\n            <DaoProposalDescription\n              proposalDescription={dialog.daoProposalDescription.currentState.value}\n              setProposalDescription={dialog.daoProposalDescription.currentState.setValue}\n            />\n          ) }\n          <span style={{ minHeight: '40px' }} />\n          <button\n            className=\"button red fullWidth\"\n            style={{ marginTop: '40px' }}\n            type=\"button\"\n            onClick={handlers.onSubmit}\n            disabled={\n              terminationMode === 'with_timestamp'\n                && (\n                  (\n                    !dialog.dateTimePicker.currentState.value\n                    || Number.isNaN(dialog.dateTimePicker.currentState.value.getTime())\n                    || (\n                      dialog.dateTimePicker.currentState.value.getTime() <= new Date().getTime()\n                    )\n                  )\n                )\n            }\n          >\n            Terminate\n          </button>\n        </DialogContent>\n      </form>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\n\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\nimport { TTerminationConfig, TLockup, TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TerminateModal, TProps } from '../TerminateModal';\nimport { startOfDay, addDays } from '../../utils';\n\nfunction TerminateLockup(\n  props: {\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: TTerminationConfig | null,\n    token: TMetadata,\n    buttonText: string,\n    lockup: TLockup,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n    buttonText,\n    lockup,\n  } = props;\n\n  const { enqueueSnackbar } = useSnackbar();\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setDate', newValue?.getTime());\n    setDate(newValue);\n\n    return setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = async () => {\n    if (!enqueueSnackbar) return;\n\n    const ts = date ? date.getTime() / 1000 : null;\n    const result = await near.api.terminate(lockupIndex, ts);\n    const amount = new Big(result as any).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n    console.log(amount);\n    const message = `Terminated lockup #${lockupIndex}, refunded ${amount} ${token.symbol}`;\n    enqueueSnackbar(message, { variant: 'success' });\n    setTimeout(() => window.location.reload(), 1000);\n  };\n\n  const canTerminate = adminControls && config;\n\n  if (!lockup?.termination_config?.vesting_schedule?.Schedule) {\n    console.log('lockup doesnt have termination config');\n    return null;\n  }\n  const modalProps: TProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    schedule: lockup.schedule,\n    vestingSchedule: lockup?.termination_config?.vesting_schedule?.Schedule as TSchedule,\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminateLockup,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: (newValue: Date | null) => {\n            console.log('setDate', newValue?.getTime());\n            setDate(newValue);\n          },\n        },\n      },\n    },\n    token,\n    lockup,\n  };\n\n  return (\n    <>\n      {canTerminate && (\n        <button\n          className=\"button\"\n          type=\"button\"\n          onClick={handleOpen}\n        >\n          {buttonText}\n        </button>\n      )}\n      { open && <TerminateModal {...modalProps} /> }\n    </>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TerminateModal } from '../TerminateModal';\nimport { buildTerminateLockupProposalLink } from '../../services/DAOs/astroDAO/utils';\nimport { TTerminationConfig, TLockup, TSchedule } from '../../services/api';\n\nfunction TerminateWithDaoButton(\n  props: {\n    accountId: string,\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: TTerminationConfig | null,\n    token: TMetadata,\n    buttonText: string,\n    lockup: TLockup,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    accountId,\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n    buttonText,\n    lockup,\n  } = props;\n\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n  const location = useLocation();\n\n  const currentContractName = location.pathname.split('/')[1];\n  const pathname = `/${currentContractName}/lockups/${accountId}/${lockupIndex}`;\n  const uri = new URL(window.location.href);\n  uri.hash = `#${pathname}`;\n  const defaultDescription = `Terminate lockup ${lockupIndex}. Lockup link: ${uri.toString()}`;\n\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState((config?.beneficiary_id || '') as string);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminate = () => {\n    const link = buildTerminateLockupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      lockupIndex,\n      date ? date.getTime() / 1000 : null,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  const canTerminate = adminControls && config;\n\n  if (!lockup?.termination_config?.vesting_schedule?.Schedule) {\n    console.log('lockup doesnt have termination config');\n    return null;\n  }\n  const modalProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    schedule: lockup.schedule,\n    vestingSchedule: lockup?.termination_config?.vesting_schedule?.Schedule as TSchedule,\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminate,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: setDate,\n        },\n      },\n      daoSelector: {\n        currentState: {\n          value: astroDAOContractAddress,\n          setValue: setAstroDAOContractAddress,\n        },\n      },\n      daoProposalDescription: {\n        currentState: {\n          value: description,\n          setValue: setDescription,\n        },\n      },\n    },\n    token,\n    lockup,\n  };\n\n  return (\n    <div>\n      <button\n        className=\"button\"\n        disabled={!canTerminate}\n        type=\"button\"\n        onClick={handleOpen}\n        style={{ marginTop: 0 }}\n      >\n        {buttonText}\n      </button>\n      { open && <TerminateModal {...modalProps} /> }\n    </div>\n  );\n}\n\nexport default TerminateWithDaoButton;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport TimestampDateDisplay from '../TimestampDateDisplay';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport Chart from '../Chart';\nimport { formatTokenAmount, toCompactString } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TLockup } from '../../services/api';\nimport TerminateLockup from '../TerminateLockup';\nimport TerminateWithDaoButton from '../TerminateWithDaoButton';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\nimport { calcBalancesRaw } from '../../services/scheduleHelpers';\n\nexport default function Row(props: { adminControls: boolean, row: TLockup, token: TMetadata }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const [open, setOpen] = useState(false);\n  const { adminControls, row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  const [now, _setNow] = useState<number>(Math.floor(new Date().getTime() / 1000));\n\n  if (!near) return null;\n\n  const { isAdmin } = near.currentUser;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  const selectedAccountPage = window.location.href.split('/').pop() === row.account_id;\n\n  const selectedLockupId = window.location.href.split('/').pop() === row.id.toString();\n\n  const balancesRaw = calcBalancesRaw(row, now);\n\n  const claimedAmount = `${formatTokenAmount(balancesRaw.claimed, token.decimals)}`;\n  const availbleAmount = `${formatTokenAmount(balancesRaw.unclaimed, token.decimals)}`;\n  const vestedAmount = `${formatTokenAmount(balancesRaw.vested, token.decimals)}`;\n  const unvestedAmount = `${formatTokenAmount(balancesRaw.unvested, token.decimals)}`;\n\n  let payerMessage;\n  if (!row.termination_config?.beneficiary_id) {\n    payerMessage = 'This lockup cannot be terminated';\n  } else {\n    payerMessage = `Unvested amount will return to ${row.termination_config?.beneficiary_id}`;\n  }\n\n  const terminatorId = row?.termination_config?.beneficiary_id;\n\n  const terminateButton = (terminator: string) => {\n    if (!adminControls) {\n      return null;\n    }\n    return (\n      <>\n        <div>\n          {isAdmin && (\n            <TerminateLockup\n              token={token}\n              adminControls={adminControls}\n              lockupIndex={row.id}\n              config={row.termination_config}\n              buttonText={terminator ? 'Terminate' : 'No termination config'}\n              lockup={row}\n            />\n          )}\n        </div>\n        <div>\n          <TerminateWithDaoButton\n            accountId={row.account_id}\n            token={token}\n            adminControls={adminControls}\n            lockupIndex={row.id}\n            config={row.termination_config}\n            buttonText={terminator ? 'Terminate with Dao' : 'No termination config'}\n            lockup={row}\n          />\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedLockupId\n            ? <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups/${row.account_id}/${row.id}`}>{row.id}</Link>\n            : row.id}\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedAccountPage\n            ? <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups/${row.account_id}`}>{toCompactString(row.account_id)}</Link>\n            : toCompactString(row.account_id)}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[0].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[row.schedule.length - 1].timestamp} />\n        </TableCell>\n        <TableCell align=\"center\">\n          {vestingSchedule ? 'Yes' : 'No'}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TokenAmountDisplay amount={row.total_balance} token={token} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span className=\"nowrap\">\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{claimedAmount}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{availbleAmount}</b>\n                  {' '}\n                  Available\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{vestedAmount}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{unvestedAmount}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n            )}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar-outer\">\n              <div className=\"progress-bar\">\n                <div style={{ width: `${balancesRaw.total === '0' ? '100' : (parseFloat(balancesRaw.claimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"claimed\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.unclaimed) / parseFloat(row.total_balance)) * 100}%` }} className=\"available\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.vested) / parseFloat(row.total_balance)) * 100}%` }} className=\"vested\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.unvested) / parseFloat(row.total_balance)) * 100}%` }} className=\"unvested\">\n                  &nbsp;\n                </div>\n              </div>\n            </div>\n          </Tooltip>\n        </TableCell>\n      </TableRow>\n      <TableRow className=\"expanded\">\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n              {vestingSchedule && (\n              <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n              )}\n\n              <div className=\"lockup-row-column chart\">\n                <div style={{ height: 300 }}>\n                  <Chart data={chartData([row], token.decimals)} />\n                </div>\n\n                {adminControls && (\n                <div className=\"terminate\">\n                  <span className=\"fine-print\">{payerMessage}</span>\n                  {terminatorId && terminateButton(terminatorId)}\n\n                </div>\n                )}\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable(\n  { lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean },\n) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\"><span className=\"nowrap\">ID</span></TableCell>\n          <TableCell align=\"left\"><span className=\"nowrap\">Account ID</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Start date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">End date (UTC)</span></TableCell>\n          <TableCell align=\"center\"><span className=\"nowrap\">Terminatable</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Total amount</span></TableCell>\n          <TableCell align=\"center\"><span className=\"nowrap\">Progress</span></TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  TextField,\n} from '@mui/material';\n\nimport { useRef } from 'react';\n\nexport default function FavouriteAccounts({\n  tokenContractId, favouriteAccounts, uniqueUsers, onSave,\n}: {\n  tokenContractId: string, favouriteAccounts: string[], uniqueUsers: string[], onSave: Function,\n}) {\n  console.log('unique users', uniqueUsers);\n\n  const inputRef = useRef<null | HTMLInputElement>(null);\n\n  const parseAccounts = (input: string): string[] => input.replaceAll(' ', '').split(',');\n\n  const handleSaveFavouriteAccounts = (): void => {\n    const localStorageValue = (value: string[]): string => JSON.stringify({ favouriteAccounts: value });\n\n    if (!inputRef?.current?.value) {\n      localStorage.setItem(tokenContractId, localStorageValue([]));\n      onSave([]);\n      return;\n    }\n\n    const newFavouriteAccounts = parseAccounts(inputRef.current.value);\n    onSave(newFavouriteAccounts);\n    localStorage.setItem(tokenContractId, localStorageValue(newFavouriteAccounts));\n  };\n\n  const handleChangeFavouriteAccounts = (e: any) => {\n    const { value } = e.target;\n\n    const realAccouns = parseAccounts(value).filter((account) => account.match(/.*(\\.)(near|testnet)$/));\n\n    if (favouriteAccounts.toString() !== realAccouns.toString()) {\n      handleSaveFavouriteAccounts();\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex', marginBottom: '2em' }}>\n      <TextField\n        inputProps={{\n          sx: {\n            margin: 0,\n          },\n        }}\n        size=\"small\"\n        sx={{ width: 1, padding: 0, margin: 0 }}\n        id=\"outlined-helperText\"\n        label=\"My accounts\"\n        placeholder=\"Comma separated list of your near accounts\"\n        defaultValue={favouriteAccounts.join(', ')}\n        inputRef={inputRef}\n        onKeyPress={(e) => e.key === 'Enter' && handleSaveFavouriteAccounts()}\n        onChange={handleChangeFavouriteAccounts}\n      />\n    </div>\n  );\n}\n","import {\n  TableContainer,\n} from '@mui/material';\nimport { useContext, useState } from 'react';\n\nimport { Link } from 'react-router-dom';\nimport Chart from '../../components/Chart';\n\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport useTitle from '../../services/useTitle';\nimport { TMetadata } from '../../services/tokenApi';\nimport FavouriteAccounts from '../../components/FavouriteAccounts';\nimport { chartData } from '../../services/chartHelpers';\n\ntype TToken = TMetadata & { contractId: string };\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TToken, adminControls: boolean }) {\n  useTitle('Lockups | FT Lockup', { restoreOnUnmount: true });\n\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  const {\n    near,\n  }: {\n    near: INearProps,\n  } = useContext(NearContext);\n\n  const { signedIn, isAdmin } = near.currentUser;\n\n  const storedData = localStorage.getItem(token.contractId);\n  const favouriteAccountsFromLocalStorage = storedData ? JSON.parse(storedData)?.favouriteAccounts : [];\n  const [favouriteAccounts, setFavouriteAccounts] = useState<string[]>(favouriteAccountsFromLocalStorage);\n  const favouriteAccountsLockups = lockups.filter((lockup) => favouriteAccounts.includes(lockup.account_id));\n\n  const lockupsPage = (lockupsList: any): any => {\n    if (lockupsList.length > 0) {\n      return (\n        <>\n          <Chart data={chartData(lockupsList, token.decimals)} />\n\n          { signedIn && adminControls && isAdmin && <CreateLockup token={token} /> }\n\n          <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }}>\n            <LockupsTable lockups={lockupsList} token={token} adminControls={adminControls} />\n          </TableContainer>\n        </>\n      );\n    }\n\n    return (\n      <div>\n        There are no lockups yet.\n        {adminControls && (\n          <div>\n            {isAdmin && 'Create single lockup or create a batch of lockups via' || 'Create a batch of lockups via'}\n            {' '}\n            <Link to={`/${near.lockupContractId}/admin/import_draft_group`}>Draft Groups</Link>\n            .\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  console.log('favouriteAccountsLockups', favouriteAccountsLockups);\n\n  if (adminControls) {\n    return (\n      <div className=\"main\">\n        <div className=\"container\">\n          {lockupsPage(lockups)}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <FavouriteAccounts\n          tokenContractId={token.contractId}\n          favouriteAccounts={favouriteAccounts}\n          uniqueUsers={uniqueUsers}\n          onSave={setFavouriteAccounts}\n        />\n        {lockupsPage(favouriteAccountsLockups)}\n      </div>\n    </div>\n  );\n}\n","import {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  IconButton,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nexport default function ConfirmDialog(props: { message: string, isOpen: boolean, closeFn: any, callback: any }) {\n  const {\n    message,\n    isOpen,\n    closeFn,\n    callback,\n  } = props;\n\n  const handleConfirm = () => {\n    closeFn();\n    callback();\n  };\n\n  return (\n    <Dialog open={isOpen} sx={{ padding: 2 }} maxWidth=\"md\" onClose={closeFn}>\n      <DialogTitle>\n        Confirmation\n        <IconButton\n          aria-label=\"close\"\n          sx={{\n            position: 'absolute',\n            right: 8,\n            top: 8,\n          }}\n          onClick={closeFn}\n        >\n          <CloseRoundedIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent sx={{ minWidth: '320px' }}>\n        <div>{message}</div>\n      </DialogContent>\n      <DialogActions sx={{ padding: '14px 24px 24px' }}>\n        <button className=\"button red\" type=\"button\" onClick={closeFn}>Cancel</button>\n        <button className=\"button\" type=\"button\" onClick={handleConfirm}>Confirm</button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\nimport { Big } from 'big.js';\n\nimport ConfirmDialog from '../ConfirmDialog';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountPreview from '../TokenAmountPreview';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, lockups: any[] }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    accountId, token, lockups,\n  } = params;\n\n  const total: string = lockups.reduce((acc, obj) => new Big(acc).add(obj.unclaimed_balance), '0').toFixed();\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [dialogConfirmCallback, setDialogConfirmCallback] = useState<any>(() => null);\n  const closeDialog = () => setIsDialogOpen(false);\n  const openDialog = () => setIsDialogOpen(true);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    const perform = async () => {\n      if (!near) return;\n      if (!near.tokenApi) return;\n      if (!near.noLoginTokenApi) return;\n      if (!near.tokenContractId) return;\n\n      const storageBalance = await near.tokenApi.storageBalanceOf(accountId);\n      const isStoragePaid = (storageBalance !== null) && true;\n      if (isStoragePaid) {\n        near.noLoginApi.claimSpecificLockups(accountId, lockups.map((x) => x.id));\n      } else {\n        const bounds = await near.tokenApi.storageBalanceBounds();\n        const amount = bounds.max;\n\n        const callback = () => {\n          near.noLoginTokenApi.storageDeposit(near.tokenContractId, accountId, amount);\n        };\n        setDialogConfirmCallback(() => callback);\n        openDialog();\n      }\n    };\n\n    perform();\n  };\n\n  const depositConfirmMessage = `\n    Your account doesn't have storage deposit on the token contract. You will be redirected to pay for the storage, after that you will be able to claim your tokens.\n  `.trim();\n\n  return (\n    <div className=\"claim-wrapper\">\n      <div className=\"claim-preview-info\">\n        <h5>Total available</h5>\n        <TokenAmountPreview token={token} amount={total} />\n      </div>\n      <div className=\"claim-button-wrapper\">\n        <button className=\"button\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n        <ConfirmDialog message={depositConfirmMessage} isOpen={isDialogOpen} closeFn={closeDialog} callback={dialogConfirmCallback} />\n      </div>\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\n\nimport useTitle from '../../services/useTitle';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport Chart from '../../components/Chart';\nimport { chartData } from '../../services/chartHelpers';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId, id } = useParams();\n  useTitle(`Lockup${id ? ` #${id}` : 's'} for ${userId} | FT Lockup`, { restoreOnUnmount: true });\n\n  const lockups = allLockups.filter((x) => {\n    if (id) {\n      return x.id.toString() === id;\n    }\n\n    return x.account_id === userId || x.id.toString() === userId;\n  });\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n\n        {!adminControls && <ClaimAllLockups accountId={userId} token={token} lockups={lockups} />}\n\n        <Chart data={chartData(lockups, token.decimals)} />\n\n        <TableContainer sx={{ boxShadow: 'unset' }}>\n          <Table className=\"main-table\" aria-label=\"collapsible table\">\n            <TableHead className=\"table-head\">\n              <TableRow>\n                <TableCell />\n                <TableCell align=\"left\">ID</TableCell>\n                <TableCell align=\"left\">Account ID</TableCell>\n                <TableCell align=\"right\">Start date (UTC)</TableCell>\n                <TableCell align=\"right\">End date (UTC)</TableCell>\n                <TableCell align=\"right\">Terminatable</TableCell>\n                <TableCell align=\"right\">Total amount</TableCell>\n                <TableCell align=\"center\">Progress</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {lockups.map((lockup) => (\n                <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n              ))}\n            </TableBody>\n          </Table>\n        </TableContainer>\n\n      </div>\n    </div>\n  );\n}\n","import { Link, NavLink, useLocation } from 'react-router-dom';\nimport { useContext, useEffect } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  useEffect(() => {\n    console.log(location.pathname);\n\n    return () => {};\n  }, [location]);\n\n  if (!near) return null;\n\n  const {\n    signedIn,\n    signedAccountId,\n    isAdmin,\n    isDraftOperator,\n    isCouncilMember,\n  } = near.currentUser;\n\n  const lockupsPageViewPolicy = adminControls && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          <div className=\"nav\">\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/lockups` : `/${currentContractName}/lockups`}>Lockups</NavLink>\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/draft_groups` : `/${currentContractName}/draft_groups`}>Lockup Drafts</NavLink>\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/about` : `/${currentContractName}/about`}>About</NavLink>\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span className=\"account-name\">\n                {signedAccountId}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return (\n    <div className=\"container\">\n      <div className=\"login\">\n        <h2>To start using app, please sign in</h2>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n\n  const showAlertForUser = signedIn && !(isAdmin || isCouncilMember || isDraftOperator);\n  const showLockups = signedIn && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <Auth>\n      { showAlertForUser && <Alert severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { showLockups && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PayForContractStorage() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const handlePay = () => {\n    const perform = async () => {\n      if (!near) {\n        return;\n      }\n      if (!near.tokenApi) {\n        return;\n      }\n      const bounds = await near.tokenApi.storageBalanceBounds();\n      const amount = bounds.max;\n\n      console.log(amount);\n      const result = await near.tokenApi.storageDeposit(near.lockupContractId, amount);\n      console.log(result);\n    };\n    perform();\n  };\n\n  return (\n    <div>\n      <div style={{ maxWidth: 640, margin: 'auto', paddingTop: 20 }}>\n        <p>\n          Please pay for the account storage in fungible token contract.\n          This is necessary to allow lockup contract to hold locked fungible token funds.\n          This is a one time payment for the lockup contract.\n          Additionally, all users claiming lockups will have to pay for the\n          storage for their account too.\n        </p>\n\n        <button className=\"button fullWidth\" type=\"button\" onClick={handlePay}>\n          Pay\n        </button>\n      </div>\n    </div>\n  );\n}\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport PayForContractStorage from '../PayForContractStorage';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n  if (!near) return null;\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n  const currentPathname = location.pathname;\n  const currentContractName = location.pathname.split('/')[1];\n  const currentPathWithoutContract = location.pathname.split(currentContractName)[1];\n  const draftGroupURL = currentPathWithoutContract.includes('/draft');\n\n  if (!signedIn || !(isAdmin || isCouncilMember || isDraftOperator)) {\n    if (draftGroupURL) {\n      return <Navigate to={currentPathname.replace(/\\/admin/, '')} replace />;\n    }\n    return <Navigate to={`/${currentContractName}/admin`} replace />;\n  }\n\n  if (!near.isContractFtStoragePaid) {\n    return (\n      <div className=\"container\">\n        <PayForContractStorage />\n      </div>\n    );\n  }\n\n  return children;\n}\n","import { Box, InputAdornment, TextField } from '@mui/material';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { ChangeEvent, useState } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\n\nimport useTitle from '../../services/useTitle';\nimport { DEFAULT_CONTRACT_NAME } from '../../config';\n\nexport default function Homepage(\n  { lockups }: { lockups: any[] },\n) {\n  useTitle('Welcome | FT Lockup', { restoreOnUnmount: true });\n\n  const [address, setAddress] = useState(DEFAULT_CONTRACT_NAME);\n  const [error, setError] = useState('');\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n    setError('');\n  };\n  const navigate = useNavigate();\n\n  const handleOpenLockupContract = () => {\n    if (!address || address.length < 5) {\n      setError('length should be more than 5 symbols');\n      return;\n    }\n    if (!address.match(/^(([a-z\\d]+[-_])*[a-z\\d]+\\.)*([a-z\\d]+[-_])*[a-z\\d]+\\.(testnet|near)$/)) {\n      setError('address should be for NEAR network');\n      return;\n    }\n    setError('');\n    const url = `/${address}/lockups`;\n    navigate(url);\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container home\">\n\n          <ul className=\"home-list\">\n            <li>\n              <div>\n                <span>Total contracts</span>\n                <b>256</b>\n              </div>\n            </li>\n            <li>\n              <div>\n                <span>Total locked</span>\n                <b>$5,336,000</b>\n              </div>\n            </li>\n            <li>\n              <div>\n                <span>Total lockups</span>\n                <b>{lockups?.length || 42}</b>\n              </div>\n            </li>\n          </ul>\n\n          <h2>Manage token vesting on NEAR</h2>\n          <h5>Create new lockup contract to be used by startup</h5>\n\n          <Link to=\"/new_lockup_contract\" className=\"button link-button\">Create Lockup Contract</Link>\n\n          <div className=\"line\" />\n\n          <div className=\"search-container\">\n            <TextField\n              variant=\"outlined\"\n              value={address}\n              onChange={handleChange}\n              onKeyPress={(e) => {\n                if (e.key === 'Enter') {\n                  handleOpenLockupContract();\n                }\n              }}\n              className=\"input large\"\n              placeholder=\"Enter existing Lockup contract address\"\n              InputProps={{\n                startAdornment: (\n                  <InputAdornment position=\"start\">\n                    <SearchIcon />\n                  </InputAdornment>\n                ),\n              }}\n              error={!!error}\n              helperText={error}\n            />\n            <button className=\"button\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\">\n              Search\n            </button>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { Box, InputAdornment, TextField } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { ChangeEvent, useState } from 'react';\nimport { Link, useLocation, useNavigate } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function NotFoundContract() {\n  useTitle('Not Found | FT Lockup', { restoreOnUnmount: true });\n  const location = useLocation();\n  const navigate = useNavigate();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const [address, setAddress] = useState(currentContractName);\n  const [error, setError] = useState('');\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n    setError('');\n  };\n\n  const handleOpenLockupContract = () => {\n    if (!address || address.length < 5) {\n      setError('length should be more than 5 symbols');\n      return;\n    }\n    if (!address.match(/^(([a-z\\d]+[-_])*[a-z\\d]+\\.)*([a-z\\d]+[-_])*[a-z\\d]+\\.(testnet|near)$/)) {\n      setError('address should be for NEAR network');\n      return;\n    }\n    setError('');\n    const url = `/${address}/lockups`;\n    navigate(url);\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"container not_found\">\n        <div className=\"search-container\">\n          <TextField\n            variant=\"outlined\"\n            value={address}\n            onChange={handleChange}\n            onKeyPress={(e) => {\n              if (e.key === 'Enter') {\n                handleOpenLockupContract();\n              }\n            }}\n            className=\"input fullWidth\"\n            placeholder=\"Enter existing Lockup contract address\"\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              ),\n            }}\n            error={!!error}\n            helperText={error}\n          />\n          <button className=\"button large\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\">\n            Search\n          </button>\n        </div>\n\n        <div className=\"block\">\n          <p className=\"right_part\">\n            Contract\n            {' '}\n            <span className=\"red\">{currentContractName}</span>\n            {' '}\n            not found.\n          </p>\n\n          <div className=\"left_part\">\n            <Link to=\"/new_lockup_contract\" className=\"button link-button\">Create Lockup Contract</Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {\n  Link, useLocation,\n} from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nimport '../../styles/footer.scss';\n\nexport default function Footer() {\n  const location = useLocation();\n  const currentPathname = location.pathname;\n  const isAdminView = location.pathname.includes('admin');\n\n  const index = currentPathname.indexOf('/', 1);\n  const updatedPathname = `${currentPathname.substring(0, index)}/admin${currentPathname.substring(index, currentPathname.length)}`;\n\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  return (\n    <div className=\"footer\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to=\"/terms\">Terms</Link>\n            <Link className=\"nav-link\" to=\"/privacy\">Privacy</Link>\n            {isAdminView ? <Link className=\"nav-link\" to={currentPathname.replace(/\\/admin/, '')}>User view</Link>\n              : <Link className=\"nav-link\" to={updatedPathname}>Admin view</Link>}\n          </div>\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { useParams } from 'react-router-dom';\nimport { useContext, useEffect, useState } from 'react';\nimport DraftsTableRow from '../../components/DraftsTable/row';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PageDraft({\n  token, adminControls,\n}: { token: TMetadata, adminControls: boolean }) {\n  const draftId = parseInt(useParams().draftId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draft, setDraft] = useState<any>();\n\n  useEffect(() => {\n    const fetchDraft = async () => {\n      console.log('fetchDraft called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDrafts([draftId]);\n      const drafts = result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] }));\n      setDraft(drafts[0]);\n    };\n\n    fetchDraft(); // .catch(console.error);\n  }, [near, draftId]);\n\n  console.log(draft);\n\n  const progressShow = true;\n\n  return (\n    <div className=\"container\">\n      {draft && (\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell />\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"left\">Account ID</TableCell>\n            <TableCell align=\"right\">Start date (UTC)</TableCell>\n            <TableCell align=\"right\">End date (UTC)</TableCell>\n            <TableCell align=\"right\">Total amount</TableCell>\n            {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <DraftsTableRow pageIndex={-1} row={draft} token={token} adminControls={adminControls} progressShow={progressShow} />\n        </TableBody>\n      </Table>\n      )}\n    </div>\n  );\n}\n","import { Box } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function Terms() {\n  useTitle('Terms | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container\">\n          <h1>Terms</h1>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { Box } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function Privacy() {\n  useTitle('Privacy | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container\">\n          <h1>Privacy</h1>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { txLinkInExplorer, nearTo } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport NewLockupContract from '../../pages/NewLockupContract';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\nimport Homepage from '../../pages/Homepage';\nimport NotFoundContract from '../../pages/NotFoundContract';\nimport Footer from '../Footer';\nimport PageDraft from '../../pages/PageDraft';\nimport Terms from '../../pages/Terms';\nimport Privacy from '../../pages/Privacy';\n\nfunction Customer({\n  lockups, token, contractId, near,\n}: {\n  lockups: any, token: TMetadata, contractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={contractId && near && <Lockups lockups={lockups} token={{ ...token, contractId }} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId/:id\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups\" element={<PageDraftGroupsIndex token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<PageDraftGroup token={token} adminControls={false} />} />\n        <Route path=\"/drafts/:draftId\" element={<PageDraft token={token} adminControls={false} />} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({\n  lockups, token, tokenContractId, near,\n}: {\n  lockups: any, token: TMetadata, tokenContractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  const showLockups = tokenContractId && near;\n\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={tokenContractId} />} />\n        <Route path=\"/lockups\" element={showLockups && <RequireAuth><Lockups lockups={lockups} token={{ ...token, contractId: tokenContractId }} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId/:id\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/drafts/:draftId\" element={<RequireAuth><PageDraft token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} adminControls /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    if (!enqueueSnackbar) return;\n    if (!near) return;\n    if (!token) return;\n    if (token.spec === '') {\n      return;\n    }\n\n    const perform = async () => {\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n\n      if (methodName === 'claim') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          if (unpacked !== '0') {\n            const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n            enqueueSnackbar(`Claimed ${amount} ${token.symbol}`, { variant: 'success' });\n            return;\n          }\n        }\n        enqueueSnackbar(`Claim failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      if (methodName === 'storage_deposit') {\n        const unpacked = JSON.parse(atob(successValue));\n        const amount = parseFloat(nearTo(unpacked.total, 9)).toString();\n        console.log(amount);\n        const accountId = args.account_id;\n        const message = `Successfully paid ${amount}N for FT storage of ${accountId}`;\n        enqueueSnackbar(message, { variant: 'success' });\n        return;\n      }\n\n      if (methodName === 'ft_transfer_call') {\n        const txMsg = JSON.parse(args.msg);\n        console.log(txMsg);\n        if (txMsg.schedule) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          const totalBalance = txMsg.schedule[txMsg.schedule.length - 1].balance;\n          if (totalBalance === unpacked) {\n            const statusMessage = `Created lockup for ${txMsg.account_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success', autoHideDuration: 60_000 });\n            return;\n          }\n\n          const statusMessage = `Failed to create lockup for ${txMsg.account_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n        if (txMsg.draft_group_id !== null) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          if (unpacked !== '0') {\n            const statusMessage = `Funded draft group ${txMsg.draft_group_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success' });\n            return;\n          }\n          const statusMessage = `Failed to fund draft group ${txMsg.draft_group_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n\n        enqueueSnackbar(`Transaction performed, TODO ${txHash}!`, { variant: 'warning' });\n        return;\n      }\n\n      if (methodName === 'terminate') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          console.log(unpacked);\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          const message = `Terminated lockup #${args.lockup_index}, unvested amount: ${amount}`;\n          enqueueSnackbar(message, { variant: 'success' });\n          return;\n        }\n        enqueueSnackbar(`Terminate lockup failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      const message = `UNHANDLED Transaction \"${methodName}\" : ${txLinkInExplorer(txHash)}`;\n      enqueueSnackbar(message, { variant: 'warning' });\n    };\n\n    perform();\n  }, [enqueueSnackbar, near, token]);\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      if (near.tokenContractId) {\n        load();\n      }\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/\" element={<Homepage lockups={lockups} />} />\n        <Route path=\"/terms\" element={<Terms />} />\n        <Route path=\"/privacy\" element={<Privacy />} />\n        <Route path=\"/new_lockup_contract/\" element={<NewLockupContract />} />\n        <Route path=\"/:cid/*\" element={contractId && near && <Customer lockups={lockups} token={token} contractId={contractId} near={near} />} />\n        <Route path=\"/:cid/admin/*\" element={contractId && near && <Admin lockups={lockups} token={token} tokenContractId={contractId} near={near} />} />\n        <Route path=\"/:cid/not_found_contract/\" element={<NotFoundContract />} />\n        <Route path=\"*\" element={<NotFoundContract />} />\n      </Routes>\n      <Footer />\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport { SnackbarProvider, useSnackbar } from 'notistack';\nimport { IconButton } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\n\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nfunction SnackbarCloseButton(props: { snackbarKey: any }) {\n  const { snackbarKey } = props;\n  const { closeSnackbar } = useSnackbar();\n\n  return (\n    <IconButton onClick={() => closeSnackbar(snackbarKey)}>\n      <CloseIcon style={{ color: 'white' }} />\n    </IconButton>\n  );\n}\n\n/* eslint react/no-unstable-nested-components: \"off\" */\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    try {\n      connect();\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        currentUser: {\n          signedIn: false,\n          signedAccountId: null,\n          isAdmin: false,\n          isDraftOperator: false,\n          isCouncilMember: false,\n          daos: [],\n        },\n      });\n    },\n  }), [near]);\n\n  const handleClose = () => {\n    const url = new URL(window.location.href);\n    const sp = new URLSearchParams(url.search);\n    sp.delete('transactionHashes');\n    url.search = sp.toString();\n    window.history.pushState({}, null as any, url.toString());\n  };\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <SnackbarProvider\n          autoHideDuration={null}\n          action={(snackbarKey) => <SnackbarCloseButton snackbarKey={snackbarKey} />}\n          onClose={handleClose}\n        >\n          <App />\n        </SnackbarProvider>\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}