(this["webpackJsonpft-lockup-contract-frontend"]=this["webpackJsonpft-lockup-contract-frontend"]||[]).push([[0],{131:function(t,e,n){},132:function(t,e,n){"use strict";n.r(e);var r=n(62),c=n(26),a=n(11),o=n(7),s=n(3),u=n.n(s),i=n(0),l=n(16),p=n(2),d=n(13),h="ft-lockup.demo000.ft-lockup.testnet";var f=function(){var t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CONTRACT_NAME:"ft-lockup.demo000.ft-lockup.testnet"}).REACT_APP_ENVIRONMENT||"development";switch(t){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:h,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:h,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:h,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org"};case"local":return{explorerUrl:"",helperUrl:"",networkId:"local",nodeUrl:"http://localhost:3030",walletUrl:"http://localhost:4000/wallet",contractName:h};case"test":case"ci":return{explorerUrl:"",helperUrl:"",walletUrl:"",networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:h};case"ci-betanet":return{explorerUrl:"",helperUrl:"",walletUrl:"",networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:h};default:throw Error("Unconfigured environment '".concat(t,"'. Can be configured in src/config.js."))}}(),j=n(63),b=n(64),O=function(){function t(e){Object(j.a)(this,t),this.near=void 0,this.contract=void 0,this.walletConnection=void 0,this.near=e,this.walletConnection=new d.WalletConnection(e,f.contractName),this.contract=new d.Contract(this.walletConnection.account(),f.contractName,{viewMethods:["get_lockups_paged","get_token_account_id"],changeMethods:[]})}return Object(b.a)(t,[{key:"getTokenAccountId",value:function(){return this.contract.get_token_account_id()}},{key:"loadAllLockups",value:function(){return this.contract.get_lockups_paged().then((function(t){return t.map((function(t){var e=Object(o.a)(t,2),n=e[0],r=e[1];return Object.assign(r,{id:n})}))}))}},{key:"signIn",value:function(){var t=window.location.href;this.walletConnection.requestSignIn(f.contractName,void 0,t)}},{key:"signOut",value:function(){this.walletConnection.signOut()}},{key:"get_account_id",value:function(){return this.walletConnection.getAccountId()}},{key:"account",value:function(){var t=Object(a.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.near.account(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get_balance",value:function(){var t=Object(a.a)(u.a.mark((function t(e){var n,r,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.account(e);case 2:return n=t.sent,r=null,t.prev=4,t.next=7,n.getAccountBalance();case 7:c=t.sent,a=c.total,r=parseFloat(d.utils.format.formatNearAmount(a||"0")),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Account not exist");case 14:return t.abrupt("return",r);case 15:case"end":return t.stop()}var a}),t,this,[[4,11]])})));return function(e){return t.apply(this,arguments)}}()}]),t}(),v=O,x=Object(i.createContext)(null),g=function(){var t=Object(a.a)(u.a.mark((function t(){var e,n,r,a,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new d.keyStores.BrowserLocalStorageKeyStore,t.next=3,d.connect(Object(c.a)({headers:{},keyStore:e},f));case 3:return n=t.sent,r=new d.WalletConnection(n,f.contractName),a=new v(n),o=r.getAccountId(),t.abrupt("return",{config:f,api:a,signedIn:!!o,signedAccountId:o});case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),k=n(1);function m(t){var e=t.lockups,n=t.token_account_id;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"About Page"}),Object(k.jsx)("pre",{children:"\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ".concat(f.contractName,"\n          token account id: ").concat(n,"\n\n          Total number of lockups: ").concat(e.length,"\n        ")})]})}function w(t){var e=t.lockups,n=Array.from(new Set(e.map((function(t){return t.account_id}))));return console.log("unique users",n),Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"Users"}),"This page should render list of all users that have lockups.",Object(k.jsx)("ul",{children:n.map((function(t){return Object(k.jsx)("li",{children:Object(k.jsx)(l.b,{to:"/users/".concat(t),children:t})},t)}))})]})}function _(t){var e=t.lockups,n=Object(p.g)().userId,r=e.filter((function(t){return t.account_id===n}));return console.log("user lockups",n,r),Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"User Lockups Page"}),"This page should render all active lockups for specific user.",Object(k.jsxs)("h2",{children:["User:"," ",n]}),"Lockups:",Object(k.jsx)("div",{children:r.map((function(t){return Object(k.jsxs)("div",{className:"lockup-row",children:[Object(k.jsx)("div",{children:"\n                id: ".concat(t.id,",\n                total amount: ").concat(t.total_balance,",\n                claimed amount: ").concat(t.claimed_balance,",\n                available amount: ").concat(t.unclaimed_balance,"\n              ")}),Object(k.jsx)("div",{children:"Schedule: ".concat(JSON.stringify(t.schedule,null,2))})]},t.id)}))})]})}function U(t){var e=t.children;return Object(k.jsx)("div",{children:e})}var I=function(){var t=Object(i.useContext)(x),e=t.near,n=t.signIn,r=t.signOut;if(!e)return null;var c=e.signedIn,o=e.signedAccountId,s=function(){var t=Object(a.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),l=function(){var t=Object(a.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return c?Object(k.jsxs)(U,{children:[Object(k.jsx)("span",{children:o})," ",Object(k.jsx)("button",{type:"button",onClick:l,children:"Log out"})]}):Object(k.jsx)(U,{children:Object(k.jsx)("button",{type:"button",onClick:s,children:"Sign In"})})};function y(){return Object(k.jsxs)("div",{children:[Object(k.jsx)("div",{className:"float-right",children:Object(k.jsx)(I,{})}),Object(k.jsxs)("div",{className:"tabs",children:[Object(k.jsx)(l.b,{to:"/",children:"About"})," ",Object(k.jsx)(l.b,{to:"/users",children:"Users"})]})]})}function A(){var t=Object(i.useContext)(x).near,e=Object(i.useState)({}),n=Object(o.a)(e,2),r=n[0],c=n[1],s=Object(i.useState)(null),d=Object(o.a)(s,2),h=d[0],f=d[1];if(Object(i.useEffect)((function(){var e=!0;if(t){var n=function(){var n=Object(a.a)(u.a.mark((function n(){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.api.loadAllLockups();case 2:if(r=n.sent,e){n.next=5;break}return n.abrupt("return");case 5:c({lockups:r,name:"name"});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}return function(){e=!1}}),[t]),Object(i.useEffect)((function(){var e=!0;if(t){var n=function(){var n=Object(a.a)(u.a.mark((function n(){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.api.getTokenAccountId();case 2:if(r=n.sent,e){n.next=5;break}return n.abrupt("return");case 5:f(r);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}return function(){e=!1}}),[t]),0===Object.keys(r).length)return null;var j=r.lockups;return Object(k.jsxs)(l.a,{children:[Object(k.jsx)(y,{}),Object(k.jsxs)(p.c,{children:[Object(k.jsx)(p.a,{path:"/",element:Object(k.jsx)(m,{lockups:j,token_account_id:h})}),Object(k.jsx)(p.a,{path:"/users",element:Object(k.jsx)(w,{lockups:j})}),Object(k.jsx)(p.a,{path:"/users/:userId",element:Object(k.jsx)(_,{lockups:j})})]})]})}n(131);function C(){var t=Object(i.useState)(null),e=Object(o.a)(t,2),n=e[0],r=e[1];Object(i.useEffect)((function(){function t(){return(t=Object(a.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:e=t.sent,r(e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var s=Object(i.useMemo)((function(){return{near:n,signIn:function(){var t;null===n||void 0===n||null===(t=n.api)||void 0===t||t.signIn()},signOut:function(){n&&(n.api.signOut(),r(Object(c.a)(Object(c.a)({},n),{},{signedIn:!1,signedAccountId:null})))}}}),[n]);return Object(k.jsx)(i.StrictMode,{children:Object(k.jsx)(x.Provider,{value:s,children:Object(k.jsx)(A,{})})})}Object(r.render)(Object(k.jsx)(C,{}),document.getElementById("root"))},75:function(t,e){},85:function(t,e){}},[[132,1,2]]]);
//# sourceMappingURL=main.fd0ed97f.chunk.js.map