{"version":3,"sources":["config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/NoLoginTokenApi.ts","services/tokenApi.ts","services/factoryApi.ts","services/DAOs/astroDAO/api.ts","services/DAOs/astroDAO/utils.ts","services/near.ts","pages/About/index.tsx","components/Chart/index.tsx","components/TokenIcon/index.tsx","components/TimestampDisplay/index.tsx","components/ScheduleTable/index.tsx","services/scheduleHelpers.ts","services/chartHelpers.ts","services/spreadsheetImport.ts","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","components/TokenAmountPreview/index.tsx","components/ImportDraftGroup/index.tsx","components/FundButton/index.tsx","components/WithDao/DaoSelector/index.tsx","components/WithDao/DaoProposalDescription/index.tsx","components/FundWithDaoButton/index.tsx","components/DeleteDraftGroupButton/index.tsx","pages/PageDraftGroup/index.tsx","pages/PageDraftGroupsIndex/index.tsx","pages/NewLockupContract/index.tsx","components/UTCDateTimePicker/index.tsx","components/CreateLockup/index.tsx","components/TimestampDateDisplay/index.tsx","components/TerminateModal/index.tsx","components/TerminateLockup/index.tsx","components/TerminateWithDaoButton/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","components/FavouriteAccounts/index.tsx","pages/Lockups/index.tsx","components/ConfirmDialog/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/PayForContractStorage/index.tsx","components/RequireAuth/index.tsx","pages/Homepage/index.tsx","pages/NotFoundContract/index.tsx","components/Footer/index.tsx","pages/PageDraft/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["FACTORY_CONTRACT_NAME","process","CONTRACT_NAME","contractNameFromUrl","window","location","hash","split","getCurrentContractName","console","log","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","factoryContractName","Error","getConfig","MAX_GAS","Big","DP","PE","nearTo","value","digits","mode","div","toFixed","undefined","convertTimestamp","time","Date","toLocaleDateString","convertAmount","decimals","addYear","date","year","setFullYear","getFullYear","getTime","startOfDay","msInDay","Math","floor","addDays","days","dumpLocalStorage","dumpKey","dumpValue","Object","keys","localStorage","map","key","getItem","setItem","JSON","stringify","restoreLocalStorage","data","parse","clear","forEach","record","txLinkInExplorer","txHash","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","args","gas","convert_draft","draft_id","convert_drafts","draft_ids","draftGroupId","discard_draft_group","draft_group_id","draftIds","delete_drafts","lockupIndex","timestamp","terminate","lockup_index","termination_timestamp","amount","get_token_account_id","get_deposit_whitelist","get_draft_operators_whitelist","get_lockups_paged","then","response","successUrl","href","requestSignIn","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","total","parseFloat","utils","format","formatNearAmount","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","length","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","NoLoginTokenApi","tokenAccountId","storage_deposit","TokenApi","contractId","lockupContractId","lockupTotalAmount","userAccountId","lockupSchedule","vestingSchedule","ftTransferCall","receiver_id","toString","msg","schedule","vesting_schedule","Schedule","try_convert","meta","deposit","rest","ft_transfer_call","ft_metadata","storage_balance_of","storage_balance_bounds","DEPLOY_DEPOSIT","mul","pow","FACTORY_CHANGE_METHODS","FactoryApi","name","depositWhitelist","draftOperatorsWhitelist","callbackUrl","argsRaw","token_account_id","deposit_whitelist","draft_operators_whitelist","argsPacked","create","init_function","init_args","FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS","DAO_VIEW_METHODS","AstroDaoApi","get_policy","policy","canProposalRoles","roles","role","permissions","includes","canProposalGroups","kind","Group","flat","member","buildProposalFormLink","contractAddress","action","variant","details","smartContractAddress","methodName","json","actionsGas","actionDeposit","params","customFunctionCallProposalFormLink","daoCouncilMembers","accountAddress","api","getCouncilMembers","councilsMembers","buildFundDraftGroupProposalLink","description","lockupContractAddress","tokenContractAddress","amountValue","draftGroupIndex","daoContractAddress","encodeURIComponent","ONE_YOKTO","buildTerminateLockupProposalLink","NearContext","createContext","connectNear","nearAPI","BrowserLocalStorageKeyStore","headers","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","noLoginTokenApi","signedAccountId","tokenContractId","isAdmin","isDraftOperator","daos","getTokenAccountId","getDepositWhitelist","getDraftOperatorsWhitelist","dcm","Promise","all","dwID","daosCouncilMembers","userDaosCouncils","daoCMs","values","pop","tokenApi","isContractFtStoragePaid","storageBalanceOf","storageBalance","factoryApi","rpcProvider","JsonRpcProvider","currentUser","signedIn","isCouncilMember","About","lockups","className","src","alt","Chart","option","useUTC","title","text","tooltip","trigger","axisPointer","type","legend","bottom","selectedMode","icon","grid","top","left","right","containLabel","xAxis","boundaryGap","splitNumber","yAxis","series","color","areaStyle","opacity","markLine","lineStyle","symbol","vested","unlocked","TokenIcon","url","size","style","height","width","verticalAlign","TimestampDisplay","props","unixSeconds","pad","input","padStart","getUTCFullYear","month","getUTCMonth","monthDay","getUTCDate","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","formatted","ScheduleTable","token","Table","TableHead","TableRow","TableCell","align","TableBody","x","component","scope","interpolate","checkpoint0","checkpoint1","x0","y0","x1","y1","xM","interpolateRaw","interpolateSchedule","i","sumSchedules","schedules","timestamps","Array","from","Set","sort","y","plus","push","chartData","lockupsList","tokenDecimals","lockupSchedules","now","round","minTimestampsLockup","minTimestampsVesting","termination_config","minTimestamp","min","vestingSchedules","sumVesting","sumLockup","convertSchedule","s","BN","prototype","toJSON","prefixErrorWith","prefix","callback","e","message","parseSpreadsheetColumns","lines","trim","table","line","columns","row","fromEntries","col","colIdx","parseDuration","pattern","match","groups","parseInt","week","day","hour","minute","second","parseCliffInfo","parts","durationRaw","percentageRaw","duration","percentage","parsePercentage","parseHumanFriendlySchedule","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","allowedKeys","isValid","parseValidAccountId","parseTokenAmount","lockup_schedule","datePlusDurationMul","mulInput","UTC","toUnix","toLockupSchedule","inputTotalAmount","decimalsMultiplier","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","roundDown","cliffAmount","muln","divn","clone","gt","tmCliff","tmFirstStep","cpStart","cpPreCliff","cpCliff","cpFinish","unshift","tms","tm","increment","sub","cps","flatMap","stepBalance","add","cpsStart","concat","parseLockup","rawSpreadsheetRow","vestingSchedulePacked","checkpoint","lockupBalance","vestingBalance","lte","assertValidTerminationSchedule","lockupTotalBalance","lockup","DraftsTableRow","useLocation","useState","open","setOpen","pageIndex","adminControls","progressShow","enqueueSnackbar","useSnackbar","useContext","padding","colSpan","currentContractName","pathname","selectedDraftId","draftPage","importDraftPage","balancesRaw","totalBalanceRaw","m1","m2","unclaimedBalanceRaw","vestedBalanceFullRaw","vestedBalanceRaw","unvestedBalanceRaw","claimed","unclaimed","unvested","calcBalancesRaw","sx","borderBottom","IconButton","onClick","to","origin","onCopy","autoHideDuration","Tooltip","placement","arrow","background","Collapse","in","timeout","unmountOnExit","display","gap","flex","DraftsTable","TokenAmountPreview","ImportDraftGroup","setData","parseErrors","setParseErrors","importProgress","setImportProgress","navigate","useNavigate","withNotification","func","handleClickImport","createDraftGroup","chunkSize","chunk","slice","lockup_create","createDrafts","path","totalBalance","balances","calcTotalBalance","TextareaAutosize","placeholder","maxRows","onChange","event","target","spreadsheetInput","errorsFiltered","LoadingButton","disabled","loading","FundButton","fundDraftGroup","getContract","DaoSelector","selectedAddress","setSelectedAddress","handleSelectedDaoAddressChange","InputLabel","Select","required","marginBottom","dao","MenuItem","TextField","label","DaoProposalDescription","proposalDescription","setProposalDescription","multiline","minRows","defaultValue","FundWithDaoButton","defaultDescription","replace","setDescription","astroDAOContractAddress","setAstroDAOContractAddress","handleClose","Dialog","minWidth","onClose","onSubmit","link","focus","DialogTitle","position","DialogContent","paddingTop","DialogActions","DeleteDraftGroupButton","inProgress","setInProgress","perform","discardDraftGroup","deleteDrafts","reload","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","isConverted","setIsConverted","useEffect","searchParams","URLSearchParams","search","transactionHashesRaw","get","txStatus","transaction","actions","FunctionCall","method_name","successValue","status","SuccessValue","atob","msgDraftGroupId","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","total_amount","discarded","funded","convertDrafts","marginTop","Alert","severity","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","importDraftGroupPath","group","NewLockupContract","signIn","Box","preventDefault","lockupOperators","elements","lockup_operators","draftOperators","draft_operators","lockupSubaccountId","lockup_subaccount_id","UTCDateTimePicker","setValue","minTime","offsetMs","getTimezoneOffset","DateTimePicker","minDateTime","newValue","ampm","renderInput","margin","fullWidth","inputProps","inputFormat","CreateLockup","startDate","setStartDate","setSchedule","setAccountId","accountStatus","setAccountStatus","setAmount","handleCreateLockup","balanceInput","selected","getScheduleList","createLockup","validAmount","maxWidth","InputProps","endAdornment","InputAdornment","FormControl","LocalizationProvider","dateAdapter","AdapterDateFns","TimestampDateDisplay","TerminateModal","currentState","handlers","dialog","dateTimePicker","daoSelector","daoProposalDescription","minHeight","TerminateLockup","buttonText","setDate","handleTerminateLockup","ts","setTimeout","canTerminate","modalProps","TerminateWithDaoButton","uri","URL","beneficiary_id","Row","payerMessage","selectedAccountPage","selectedLockupId","claimedAmount","claimed_balance","availbleAmount","unclaimed_balance","vestedAmount","total_balance","unvestedAmount","terminator","terminatorId","LockupsTable","FavouriteAccounts","favouriteAccounts","uniqueUsers","onSave","inputRef","useRef","parseAccounts","replaceAll","handleSaveFavouriteAccounts","localStorageValue","current","newFavouriteAccounts","join","onKeyPress","realAccouns","Lockups","storedData","favouriteAccountsFromLocalStorage","setFavouriteAccounts","favouriteAccountsLockups","lockupsPage","TableContainer","boxShadow","ConfirmDialog","isOpen","closeFn","Button","ClaimAllLockups","isDialogOpen","setIsDialogOpen","dialogConfirmCallback","setDialogConfirmCallback","depositConfirmMessage","storageBalanceBounds","bounds","max","storageDeposit","UserLockups","allLockups","userId","totalUnclaimedBalance","reduce","acc","obj","Claim","Header","lockupsPageViewPolicy","Auth","children","Authorize","showAlertForUser","showLockups","PayForContractStorage","RequireAuth","currentPathname","draftGroupURL","Homepage","address","setAddress","startAdornment","NotFoundContract","Footer","isAdminView","indexOf","updatedPathname","substring","PageDraft","draftId","setDraft","fetchDraft","Customer","element","Admin","App","contractState","setContractState","setContractId","reference","reference_hash","spec","setToken","unpacked","txMsg","statusMessage","active","load","loadAllLockups","ftMetadata","metadata","SnackbarCloseButton","snackbarKey","closeSnackbar","NearApp","setNear","nearConn","connect","useMemo","Provider","sp","delete","history","pushState","render","document","getElementById"],"mappings":"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","file":"static/js/main.53c612ce.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n}\n\nexport const DEFAULT_CONTRACT_NAME = process.env.REACT_APP_DEFAULT_CONTRACT_NAME as string;\nexport const FACTORY_CONTRACT_NAME = process.env.REACT_APP_FACTORY_CONTRACT_NAME as string;\n\nconst getCurrentContractName = (): string => {\n  const contractNameFromUrl = window.location.hash.split('/')[1];\n  if (contractNameFromUrl === 'new_lockup_contract') return FACTORY_CONTRACT_NAME;\n\n  return contractNameFromUrl;\n};\n\nexport const CONTRACT_NAME = getCurrentContractName();\n\nconsole.log(CONTRACT_NAME);\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\nimport { config } from './config';\n\nexport const MAX_GAS = 300_000_000_000_000;\nexport const ONE_YOCTO = 1;\n\nBig.DP = 40;\nBig.PE = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\nexport const convertTimestamp = (time: number) => new Date(time * 1000).toLocaleDateString('en-US');\nexport const convertAmount = (value: number | string, decimals: number) => Big(value || '0').div(10 ** decimals).toFixed(NEAR_ROUND_DIGITS);\n// @ts-ignore\nexport const addYear = (date: Date, year: number) => new Date(new Date(date).setFullYear((date.getFullYear()) + year)).getTime() / 1000;\nexport const startOfDay = (date: Date) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(Math.floor(date.getTime() / msInDay) * msInDay);\n\n  return result;\n};\nexport const addDays = (date: Date, days: number) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(date.getTime() + msInDay * days);\n\n  return result;\n};\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n\nexport const txLinkInExplorer = (txHash: string) => `${config.explorerUrl}/transactions/${txHash}`;\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS, ONE_YOCTO } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n  'get_draft_operators_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'convert_draft',\n  'convert_drafts',\n  'terminate',\n  'discard_draft_group',\n  'delete_drafts',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n  'get_draft_operators_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'convert_draft': any,\n  'convert_drafts': any,\n  'terminate': any,\n  'discard_draft_group': any,\n  'delete_drafts': any,\n};\n\nexport type TNearAmount = string;\nexport type TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TCheckpointWithIndex = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n  index: number;\n};\n\nexport type TSchedule = TCheckpoint[];\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TSchedule,\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n    if (result) {\n      result.id = index;\n    }\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ args: { drafts }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async convertDraft(index: DraftIndex): Promise<LockupIndex> {\n    const result = await this.contract.convert_draft({ draft_id: index });\n\n    return result;\n  }\n\n  async convertDrafts(indices: DraftIndex[]): Promise<LockupIndex[]> {\n    const result = await this.contract.convert_drafts({ args: { draft_ids: indices }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async discardDraftGroup(draftGroupId: number): Promise<any> {\n    const result = await this.contract.discard_draft_group({ args: { draft_group_id: draftGroupId } });\n\n    return result;\n  }\n\n  async deleteDrafts(draftIds: number[]): Promise<any> {\n    const result = await this.contract.delete_drafts({ args: { draft_ids: draftIds } });\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number, timestamp: number | null): Promise<void> {\n    try {\n      const result = await this.contract.terminate({\n        args: { lockup_index: lockupIndex, termination_timestamp: timestamp },\n        gas: MAX_GAS,\n        amount: ONE_YOCTO,\n      });\n      return result;\n    } catch (e) {\n      console.log(e);\n      throw Error('Cannot terminate lockup');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getWalletConnection(): WalletConnection {\n    return this.walletConnection;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  getDraftOperatorsWhitelist(): Promise<Array<string>> {\n    return this.contract.get_draft_operators_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    this.walletConnection.requestSignIn(this.near.config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst TOKEN_VIEW_METHODS = [''];\nconst TOKEN_CHANGE_METHODS = ['storage_deposit'];\n\ntype TChangeMethods = {\n  'storage_deposit': any,\n};\n\ntype TTokenContract = Contract & TChangeMethods;\n\nclass NoLoginTokenApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async storageDeposit(tokenAccountId: string, accountId: string, amount: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract(tokenAccountId).storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(contractName: string): TTokenContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      contractName,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n}\n\nexport default NoLoginTokenApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TSchedule } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n  'storage_balance_of',\n  'storage_balance_bounds',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n  'storage_deposit',\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any,\n  'storage_deposit': any,\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any,\n  'storage_balance_of': any,\n  'storage_balance_bounds': any,\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TLockupCreate = {\n  account_id: string,\n  schedule: TSchedule,\n  vesting_schedule: { Schedule: TSchedule } | null,\n};\n\ntype TDraftGroupFund = {\n  draft_group_id: number,\n  try_convert: boolean,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  async createLockup(\n    lockupContractId: string,\n    lockupTotalAmount: string,\n    userAccountId: string,\n    lockupSchedule: any[],\n    vestingSchedule: TSchedule | null,\n  ): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: lockupSchedule,\n        vesting_schedule: vestingSchedule ? { Schedule: vestingSchedule } : null,\n      },\n    });\n\n    return result;\n  }\n\n  async fundDraftGroup(lockupContractId: string, draftGroupId: number, amount: string): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount,\n      msg: {\n        draft_group_id: draftGroupId,\n        try_convert: true,\n      },\n    });\n\n    return result;\n  }\n\n  async ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: TLockupCreate | TDraftGroupFund,\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): Promise<void> {\n    const { msg, ...rest } = meta;\n\n    await this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  storageDeposit(accountId: String, amount: String): Promise<any> {\n    return this.contract.storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n\n  storageBalanceOf(accountId: String): Promise<String> {\n    return this.contract.storage_balance_of({ account_id: accountId });\n  }\n\n  storageBalanceBounds(): Promise<{ min: string, max: string }> {\n    return this.contract.storage_balance_bounds();\n  }\n}\n\nexport default TokenApi;\n","import Big from 'big.js';\n\nimport {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst DEPLOY_DEPOSIT = new Big(10).mul(new Big(10).pow(24)).toString();\n\nconst FACTORY_CHANGE_METHODS = [\n  'create',\n];\n\ntype TFactoryChangeMethods = {\n  'create': (opts: {\n    args: { name: string, init_function: string, init_args: string },\n    callbackUrl: string,\n    amount: string | number,\n    gas: string | number\n  }) => any,\n};\n\ntype TFactoryContract = Contract & TFactoryChangeMethods;\n\nclass FactoryApi {\n  private contract: TFactoryContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: [], changeMethods: FACTORY_CHANGE_METHODS },\n    ) as TFactoryContract;\n  }\n\n  getContract(): TFactoryContract {\n    return this.contract;\n  }\n\n  async create(\n    name: string,\n    tokenAccountId: string,\n    depositWhitelist: string[],\n    draftOperatorsWhitelist: string[],\n    callbackUrl: string,\n  ): Promise<void> {\n    const argsRaw = {\n      token_account_id: tokenAccountId,\n      deposit_whitelist: depositWhitelist,\n      draft_operators_whitelist: draftOperatorsWhitelist,\n    };\n    const argsPacked = JSON.stringify(argsRaw);\n    const result = await this.contract.create({\n      args: {\n        name,\n        init_function: 'new',\n        init_args: argsPacked,\n      },\n      callbackUrl,\n      gas: MAX_GAS,\n      amount: DEPLOY_DEPOSIT,\n    });\n\n    console.log(result);\n\n    return result;\n  }\n}\n\nexport default FactoryApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS = ['call:AddProposal', '*:AddProposal'];\n\nconst DAO_VIEW_METHODS = [\n  'get_policy',\n];\n\ntype TAstroDaoViewMethods = {\n  'get_policy': any,\n};\n\ntype TAstroDaoContract = Contract & TAstroDaoViewMethods;\n\nclass AstroDaoApi {\n  private contract: TAstroDaoContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: DAO_VIEW_METHODS, changeMethods: [] },\n    ) as TAstroDaoContract;\n  }\n\n  getContract(): TAstroDaoContract {\n    return this.contract;\n  }\n\n  async getCouncilMembers(): Promise<string[]> {\n    const policy = await this.contract.get_policy();\n    const canProposalRoles = policy.roles.filter(\n      (role: any) => role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[0]) || role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[1]),\n    );\n\n    if (canProposalRoles.length === 0) {\n      return [];\n    }\n\n    const canProposalGroups = canProposalRoles.map((role: any) => role?.kind?.Group);\n\n    return canProposalGroups.flat().filter((member: any) => member);\n  }\n}\n\nexport default AstroDaoApi;\n","import {\n  WalletConnection,\n} from 'near-api-js';\n\nimport AstroDaoApi from './api';\n\n// TODO move to the .env\nconst ASTRO_DAO_HOST = 'https://testnet.app.astrodao.com';\n\nexport const MAX_GAS = '300';\nexport const ONE_YOKTO = '0.000000000000000000000001';\n\nexport const buildProposalFormLink = (\n  contractAddress: string,\n  action: string,\n  variant: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string,\n): string => {\n  const params = {\n    details,\n    smartContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    gas,\n    deposit: actionDeposit,\n  };\n\n  return `${ASTRO_DAO_HOST}/dao/${contractAddress}/proposals?action=${action}&variant=${variant}&params=${JSON.stringify(params)}`;\n};\n\nexport const customFunctionCallProposalFormLink = (\n  contractAddress: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string = MAX_GAS,\n): string => buildProposalFormLink(\n  contractAddress,\n  'create_proposal',\n  'ProposeCustomFunctionCall',\n  details,\n  smartContractAddress,\n  methodName,\n  json,\n  actionsGas,\n  actionDeposit,\n  gas,\n);\n\nexport const daoCouncilMembers = async (walletConnection: WalletConnection, accountAddress: string): Promise<any> => {\n  try {\n    const api = new AstroDaoApi(walletConnection, accountAddress);\n    const councilsMembers = await api.getCouncilMembers();\n\n    return { [accountAddress]: councilsMembers };\n  } catch (e) {\n    console.log('isDAO ERROR:', e);\n    return undefined;\n  }\n};\n\nexport const buildFundDraftGroupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  tokenContractAddress: string,\n  amountValue: string,\n  draftGroupIndex: number,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'ft_transfer_call';\n  const json = {\n    receiver_id: lockupContractAddress,\n    amount: amountValue,\n    msg: JSON.stringify({ draft_group_id: draftGroupIndex, try_convert: true }),\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    tokenContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nexport const buildTerminateLockupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  lockupIndex: number,\n  timestamp: number | null,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'terminate';\n  const json = {\n    lockup_index: lockupIndex,\n    termination_timestamp: timestamp,\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    lockupContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nconst utils = {\n  buildProposalFormLink,\n  customFunctionCallProposalFormLink,\n  daoCouncilMembers,\n  buildFundDraftGroupProposalLink,\n  buildTerminateLockupProposalLink,\n};\n\nexport default utils;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport NoLoginTokenApi from './NoLoginTokenApi';\nimport TokenApi from './tokenApi';\nimport FactoryApi from './factoryApi';\nimport { daoCouncilMembers } from './DAOs/astroDAO/utils';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  currentUser: {\n    signedIn: boolean;\n    isAdmin: boolean;\n    isDraftOperator: boolean;\n    isCouncilMember: boolean;\n    signedAccountId: string | null;\n    daos: string[];\n  }\n  tokenContractId: string;\n  lockupContractId: string;\n  tokenApi: TokenApi;\n  noLoginTokenApi: NoLoginTokenApi;\n  factoryApi: FactoryApi;\n  rpcProvider: nearAPI.providers.JsonRpcProvider;\n  isContractFtStoragePaid: boolean;\n  near: nearAPI.Near;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n  const noLoginTokenApi = new NoLoginTokenApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  let tokenContractId: string = '';\n  let isAdmin: boolean = false;\n  let isDraftOperator: boolean = false;\n  let depositWhitelist: string[] = [];\n  let draftOperatorsWhitelist: string[] = [];\n  let daos: string[] = [];\n  try {\n    tokenContractId = await api.getTokenAccountId();\n    depositWhitelist = await api.getDepositWhitelist();\n    draftOperatorsWhitelist = await api.getDraftOperatorsWhitelist();\n    console.log('depositWhitelist', depositWhitelist);\n    isAdmin = depositWhitelist.includes(signedAccountId);\n    console.log('isAdmin', isAdmin);\n    isDraftOperator = draftOperatorsWhitelist.includes(signedAccountId);\n    console.log('isDraftOperator', isDraftOperator);\n    const dcm = daoCouncilMembers;\n    console.log(dcm);\n    const daosCouncilMembers = (await Promise.all(depositWhitelist.map((dwID): Promise<any[]> => daoCouncilMembers(walletConnection, dwID)))).filter((value) => !!value);\n    console.log(daosCouncilMembers);\n    const userDaosCouncils = daosCouncilMembers.filter((daoCMs) => Object.values(daoCMs).pop().includes(signedAccountId));\n    if (userDaosCouncils?.length > 0) {\n      daos = userDaosCouncils.map((daoCMs) => Object.keys(daoCMs).pop() || '');\n    }\n    console.log('userDaosCouncils', userDaosCouncils);\n    console.log('councilMembers', daosCouncilMembers);\n    console.log('daos', daos);\n  } catch (e) {\n    console.log(e);\n  }\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  let isContractFtStoragePaid = false;\n  const lockupContractId = window.location.hash.split('/')[1];\n\n  try {\n    const storageBalance = await tokenApi.storageBalanceOf(lockupContractId);\n    isContractFtStoragePaid = (storageBalance !== null) && true;\n    console.log(isContractFtStoragePaid);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const factoryApi = new FactoryApi(\n    walletConnection,\n    config.factoryContractName,\n  );\n\n  const rpcProvider = new nearAPI.providers.JsonRpcProvider(\n    config.nodeUrl,\n  );\n\n  return {\n    config,\n    api,\n    tokenContractId,\n    noLoginApi,\n    tokenApi,\n    factoryApi,\n    currentUser: {\n      signedIn: !!signedAccountId,\n      isAdmin,\n      isDraftOperator,\n      isCouncilMember: daos.length > 0,\n      signedAccountId,\n      daos,\n    },\n    noLoginTokenApi,\n    rpcProvider,\n    isContractFtStoragePaid,\n    lockupContractId,\n    near,\n  };\n};\n","import { config } from '../../config';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  return (\n    <div className=\"container\">\n      <h1>Fungible Token Lockup</h1>\n\n      <h2>Purpose</h2>\n\n      <div>\n        <p>Community Lockup is dApp implementing locking and vesting of any arbitrary fungible token on NEAR in the generally known sense of these words.</p>\n        <p>Lockup is a gradual release of tokens according to a specified schedule. After release tokens are in full control of the beneficiary.</p>\n        <p>\n          Vesting is a gradual allocation of tokens to the beneficiary according to a specified schedule,\n          provided certain conditions are met (for example, beneficiary keeps working for the payer).\n        </p>\n        <p>\n          Vested tokens are NOT immediately available to the beneficiary, however\n          they WILL be available to the beneficiary according to the lockup\n          schedule. Vested tokens are GUARANTEED to be received at some point in\n          the future, while unvested token amount may be withdrawn by the payer if\n          the lockup agreement is terminated.\n        </p>\n      </div>\n\n      <h2>Users</h2>\n\n      <div>\n        <p>There are two roles in the app: payer (also called admin), most commonly the employer, and beneficiaries, most commonly the employees. There is also an implicit “anyone” role.</p>\n\n        <ul>\n          <li>\n            All users (“anyone”) are able to view ALL lockup information stored\n            in the blockchain for any existing lockup contract. They are also\n            able to create new lockup contract and become admin for that new\n            lockup contract.\n          </li>\n          <li>Beneficiary users have ability to claim unlocked tokens dedicated to them</li>\n          <li>Admin users can create new lockups (one by one or via excel import) and terminate existing lockups that can be terminated</li>\n          <li>Draft operators can create draft groups, drafts, delete draft groups, drafts.</li>\n        </ul>\n      </div>\n\n      <h2>Lockups</h2>\n\n      <div>\n        <p>Each lockup has the following fields:</p>\n        <ul>\n          <li>Account ID: NEAR account id that will receive the tokens</li>\n          <li>\n            Schedule: the lockup schedule, according to which the tokens are\n            released. Is represented by a monotonous piecewise linear function .\n            Where x is the time axis and y is the amount of unlocked tokens at\n            any specific moment.\n          </li>\n          <li>\n            Vesting schedule: optional. According to this schedule tokens are\n            vested, i. e. allocated to the beneficiary irrevocably. Operator is\n            able to terminate the lockup at any effective moment in the future.\n            If this happens, then the lockup schedule is capped at the total\n            vested amount at the effective moment of termination.\n          </li>\n          <li>\n            Payer id: optional. account id that paid for the specific lockup.\n            Only recorded for terminatable lockups. If the lockup is terminated\n            - unvested tokens will be returned back to the payer upon\n            termination.\n          </li>\n          <li>\n            Claimed balance: already claimed balance for the lockup. Used for\n            tracking claim progress.\n          </li>\n        </ul>\n      </div>\n\n      <h2>Lockup and vesting logic</h2>\n\n      <div>\n        <img src=\"https://bafkreidqdq6wefcvr436cunap4y5c77nodlgxu6c4qchxkd232g7377cw4.ipfs.nftstorage.link/\" alt=\"Lockup and vesting schedule\" />\n        <p>Consider the following lockup with a four year duration.</p>\n        <p>The vesting schedule is red. One year cliff, then 1 / 4 is vested, then vesting is linear till the end (4 years mark).</p>\n        <p>The lockup schedule is blue. Two years cliff with zero amount. Then two years of linear lockup till 3 / 4 of the amount, then another cliff up to full amount.</p>\n        <p>Consider the termination happening at the 2.5 years mark.</p>\n        <p>First, we find the vested amount for this timestamp. It is 5 / 8.</p>\n        <p>After that we trim the lockup schedule at that amount.</p>\n        <p>In this case, the intersection is at 3y + 1 / 3y.</p>\n        <p>The trimmed lockup schedule is the yellow thin line. Note that it perfectly matches the initial lockup schedule up to the new total ( 5 / 8 ).</p>\n      </div>\n\n      <h2>Technical Info</h2>\n\n      <p>\n        FT lockup account id:\n        {' '}\n        <span className=\"code\">{config.contractName}</span>\n      </p>\n      <p>\n        Token account id:\n        {' '}\n        <span className=\"code\">{token_account_id}</span>\n      </p>\n      <p>\n        Total number of lockups:\n        {' '}\n        <span className=\"code\">{lockups.length}</span>\n      </p>\n    </div>\n  );\n}\n","import ReactEcharts from 'echarts-for-react';\n\nimport '../../styles/chart.scss';\n\nexport default function Chart({ data }: { data: { vested: any[], unlocked: any[] } }) {\n  const option = {\n    useUTC: true,\n    title: {\n      text: 'Schedule in UTC',\n    },\n    tooltip: {\n      trigger: 'axis',\n      axisPointer: {\n        type: 'cross',\n      },\n    },\n    legend: {\n      bottom: '3%',\n      selectedMode: false,\n      icon: 'circle',\n    },\n    grid: {\n      top: '15%',\n      left: '2%',\n      right: '3%',\n      bottom: '15%',\n      containLabel: true,\n    },\n    xAxis: [\n      {\n        type: 'time',\n        boundaryGap: ['3%', '3%'],\n        splitNumber: 15,\n      },\n    ],\n    yAxis: [\n      {\n        type: 'value',\n      },\n    ],\n    series: [\n      {\n        name: 'Vested',\n        type: 'line',\n        color: '#0069D1',\n        areaStyle: {\n          opacity: 1,\n        },\n        markLine: {\n          data: [\n            [\n              { xAxis: new Date(), yAxis: 0 },\n              { xAxis: new Date(), yAxis: 'max' },\n            ],\n          ],\n          lineStyle: {\n            type: 'dashed',\n            color: '#FF594E',\n          },\n          symbol: 'none',\n        },\n        data: data.vested,\n      },\n      {\n        name: 'Unlocked',\n        type: 'line',\n        color: '#00B988',\n        areaStyle: {\n          opacity: 1,\n        },\n        data: data.unlocked,\n      },\n    ],\n  };\n  return <ReactEcharts option={option} />;\n}\n","export default function TokenIcon(params: { url: string, size: number }) {\n  const { url, size } = params;\n  return (\n    <img\n      style={{\n        height: size, width: size, verticalAlign: 'middle',\n      }}\n      src={url}\n      alt=\"Token Icon\"\n    />\n  );\n}\n","export default function TimestampDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth(), 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${year}-${month}-${monthDay} ${hours}:${minutes}:${seconds} UTC`;\n\n  return (\n    <span className=\"timestamp-display\">\n      {formatted}\n    </span>\n  );\n}\n","import {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport TimestampDisplay from '../TimestampDisplay';\nimport { convertAmount } from '../../utils';\nimport TokenIcon from '../TokenIcon';\n\nexport default function ScheduleTable(params: { token: TMetadata, title: String, schedule: TSchedule }) {\n  const { schedule, title, token } = params;\n\n  return (\n    <div className=\"inner-table_wrapper\">\n      <h5>{title}</h5>\n      <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n        <TableHead>\n          <TableRow>\n            <TableCell>DATE</TableCell>\n            <TableCell align=\"right\">CUMULATIVE AMOUNT</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {schedule.map((x: any) => (\n            <TableRow key={x.timestamp}>\n              <TableCell component=\"th\" scope=\"row\">\n                <div className=\"nowrap\">\n                  <TimestampDisplay unixSeconds={x.timestamp} />\n                </div>\n              </TableCell>\n              <TableCell align=\"right\">\n                <div className=\"nowrap\">\n                  {convertAmount(x.balance, token.decimals)}\n                  &nbsp;\n                  {token.symbol}\n                  &nbsp;\n                  <TokenIcon url={token.icon || ''} size={32} />\n                </div>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { Big } from 'big.js';\nimport { TCheckpoint, TNearTimestamp, TSchedule } from './api';\n\nexport const interpolateRaw = (x0: number, y0: number, x1: number, y1: number, xM: number) : Number => {\n  if (x1 <= x0) {\n    throw new Error('invalid range');\n  }\n  if (xM < x0 || xM >= x1) {\n    throw new Error('xM out of bound');\n  }\n\n  const yM = y0 + (y1 - y0) * (xM - x0) / (x1 - x0);\n\n  return yM;\n};\n\nexport const interpolate = (checkpoint0: TCheckpoint, checkpoint1: TCheckpoint, timestamp: TNearTimestamp) : TCheckpoint => {\n  const balance = interpolateRaw(\n    checkpoint0.timestamp,\n    parseFloat(checkpoint0.balance),\n    checkpoint1.timestamp,\n    parseFloat(checkpoint1.balance),\n    timestamp,\n  );\n\n  return { timestamp, balance: new Big(balance.toString()).toFixed() };\n};\n\nexport const interpolateSchedule = (schedule: TCheckpoint[], timestamp: TNearTimestamp) : TCheckpoint => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (timestamp < schedule[0].timestamp) {\n    return { timestamp, balance: schedule[0].balance };\n  }\n\n  if (timestamp >= schedule[schedule.length - 1].timestamp) {\n    return { timestamp, balance: schedule[schedule.length - 1].balance };\n  }\n\n  // eslint-disable-next-line no-plusplus\n  for (let i = 0; i < schedule.length - 1; i++) {\n    if (schedule[i + 1].timestamp <= timestamp) {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    return interpolate(schedule[i], schedule[i + 1], timestamp);\n  }\n\n  throw new Error('unreachable');\n};\n\nexport const sumSchedules = (schedules: TSchedule[]) : TSchedule => {\n  if (schedules.length === 0) {\n    throw new Error('schedules is empty');\n  }\n\n  const timestamps = Array.from(new Set(schedules.flat().map((x) => x.timestamp).sort(\n    (x, y) => x - y,\n  )));\n\n  const result: TSchedule = [];\n\n  timestamps.forEach((timestamp:TNearTimestamp) => {\n    let amount = new Big(0);\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < schedules.length; i++) {\n      const balance = new Big(interpolateSchedule(schedules[i], timestamp).balance);\n      amount = amount.plus(balance);\n    }\n    result.push({ timestamp, balance: amount.toString() });\n  });\n\n  return result;\n};\n\nexport const assertValidTerminationSchedule = (lockupSchedule: TSchedule, vestingSchedule: TSchedule) => {\n  lockupSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = checkpoint.balance;\n    const vestingBalance = interpolateSchedule(vestingSchedule, timestamp).balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at timestamp ${timestamp}`);\n    }\n  });\n  vestingSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = interpolateSchedule(lockupSchedule, timestamp).balance;\n    const vestingBalance = checkpoint.balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at timestamp ${timestamp}`);\n    }\n  });\n};\n","import {\n  TSchedule, TNearTimestamp, TNearAmount, TCheckpoint,\n} from './api';\nimport { convertAmount } from '../utils';\nimport { sumSchedules } from './scheduleHelpers';\n\nconst buildVestedSchedule = (from: TNearTimestamp, balance: TNearAmount) => [\n  { timestamp: from - 1, balance: '0' },\n  { timestamp: from, balance },\n];\n\nexport const chartData = (lockupsList: any[], tokenDecimals: number): any => {\n  const lockupSchedules = Array.from(\n    lockupsList.map((x) => x.schedule),\n  ) as TSchedule[];\n\n  const now = Math.round(new Date().getTime() / 1000);\n  const minTimestampsLockup = lockupsList.map((x) => x.schedule[0].timestamp);\n  const minTimestampsVesting = lockupsList.map((x) => x?.termination_config?.vesting_schedule[0]?.timestamp).filter((x) => x);\n\n  const minTimestamp = Math.min(...minTimestampsLockup, ...minTimestampsVesting, now);\n\n  const vestingSchedules = Array.from(\n    lockupsList.map((x) => {\n      // for lockups and drafts\n      const result = x?.termination_config?.vesting_schedule?.Schedule\n        || x?.vesting_schedule?.Schedule;\n      if (result) return result;\n      return result || buildVestedSchedule(minTimestamp, x.schedule[x.schedule.length - 1].balance);\n    }),\n  ) as TSchedule[];\n\n  const sumVesting = sumSchedules(vestingSchedules);\n  const sumLockup = sumSchedules(lockupSchedules);\n\n  if (sumVesting[sumVesting.length - 1]?.timestamp !== sumLockup[sumLockup.length - 1].timestamp) {\n    sumVesting.push(sumLockup[sumLockup.length - 1]);\n  }\n\n  const convertSchedule = (schedule: TSchedule, decimals: number) => schedule.map((s: TCheckpoint) => [s.timestamp * 1000, convertAmount(s.balance, decimals)]);\n\n  return {\n    unlocked: lockupsList.length ? convertSchedule(sumLockup, tokenDecimals) : [],\n    vested: lockupsList.length ? convertSchedule(sumVesting, tokenDecimals) : [],\n  };\n};\n\nexport default chartData;\n","import BN from 'bn.js';\nimport Big from 'big.js';\nimport { assertValidTerminationSchedule } from './scheduleHelpers';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nconst prefixErrorWith = (prefix: string, callback: () => any) => {\n  try {\n    return callback();\n  } catch (e) {\n    if (!(e instanceof Error)) throw new Error('unreachable');\n    e.message = `${prefix}: ${e.message}`;\n    throw e;\n  }\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+(\\.[0-9]+)?$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nconst parsePercentage = (input: string): number => {\n  if (!(input.match(/^\\d+$/))) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  const percentage = parseInt(input, 10);\n\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  return percentage;\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = prefixErrorWith('percentage', () => parsePercentage(percentageRaw));\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = prefixErrorWith('start timestamp', () => parseTimestamp(timestampStartRaw));\n  const durationTotal = prefixErrorWith('duration', () => parseDuration(durationTotalRaw));\n  const cliffInfo = prefixErrorWith('cliff', () => parseCliffInfo(cliffInfoRaw));\n  const releaseEvery = prefixErrorWith('release every', () => parseDuration(releaseEveryRaw));\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = any;\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const allowedKeys = ['account_id', 'amount', 'lockup_schedule', 'vesting_schedule'];\n  Object.keys(input).forEach((key) => {\n    if (!allowedKeys.includes(key)) {\n      throw new Error(`unknown column '${key}'`);\n    }\n  });\n\n  if (!input.account_id) throw new Error(\"column 'account_id' not found\");\n  const accountId = parseValidAccountId(input.account_id);\n\n  if (!input.amount) throw new Error(\"column 'amount' not found\");\n  const amount = parseTokenAmount(input.amount);\n\n  if (!input.lockup_schedule) throw new Error(\"column 'lockup_schedule' not found\");\n  const lockupSchedule = prefixErrorWith('lockup schedule', () => parseHumanFriendlySchedule(input.lockup_schedule));\n  let vestingSchedule = null;\n\n  if (input.vesting_schedule) {\n    vestingSchedule = prefixErrorWith('vesting schedule', () => parseHumanFriendlySchedule(input.vesting_schedule));\n  }\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = string;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new Big(10).pow(tokenDecimals);\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(new Big(inputTotalAmount).mul(decimalsMultiplier).round(0, Big.roundDown).toString());\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const { releaseEvery } = schedule;\n\n  const tmCliff = timestampCliff;\n  const tmFirstStep = datePlusDurationMul(timestampCliff, releaseEvery, 1);\n  if (toUnix(tmFirstStep) <= toUnix(tmCliff)) {\n    throw new Error('invalid releaseEvery, zero duration');\n  }\n  if (toUnix(tmFirstStep) - toUnix(tmCliff) === 1) { // linear unlock during cliff\n    const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n    const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n    const cpCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount.toString() };\n    const cpFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount.toString() };\n\n    const result = [];\n    result.unshift(cpFinish);\n    if (cpCliff.timestamp < cpFinish.timestamp) {\n      result.unshift(cpCliff);\n    }\n    result.unshift(cpPreCliff);\n    if (cpStart.timestamp < cpPreCliff.timestamp) {\n      result.unshift(cpStart);\n    }\n\n    return result;\n  }\n\n  const tms = [];\n  {\n    // otherwise: use steps\n    let tm = timestampCliff;\n    const maxSteps = 500;\n    for (;;) {\n      if (tm >= timestampFinish) {\n        tm = timestampFinish;\n        tms.push(tm);\n        break;\n      }\n      tms.push(tm);\n      tm = datePlusDurationMul(tm, releaseEvery, 1);\n      if (tms.length >= maxSteps) {\n        throw new Error('too many checkpoints for schedule');\n      }\n    }\n  }\n\n  const increment = totalAmount.sub(cliffAmount).divn(tms.length - 1);\n\n  const cps: Checkpoint[] = tms.flatMap((tm, i) => {\n    if (tms.length === 1) {\n      return [{ timestamp: toUnix(timestampFinish), balance: totalAmount.toString() }];\n    }\n    if (i === 0) {\n      return [{ timestamp: toUnix(tm), balance: cliffAmount.toString() }];\n    }\n    const stepBalance = i === tms.length - 1\n      ? totalAmount\n      : cliffAmount.add(increment.muln(i)).toString();\n    return [\n      { timestamp: toUnix(tm) - 1, balance: cliffAmount.add(increment.muln(i - 1)).toString() },\n      { timestamp: toUnix(tm), balance: stepBalance.toString() },\n    ];\n  });\n\n  const cpsStart: Checkpoint[] = [];\n  const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n  const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n\n  cpsStart.unshift(cpPreCliff);\n  if (cpStart.timestamp < cpPreCliff.timestamp) {\n    cpsStart.unshift(cpStart);\n  }\n\n  const result = cpsStart.concat(cps);\n  return result;\n};\n\nexport type Lockup = {\n  id: number,\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  vesting_schedule: { Schedule: Schedule } | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number, index: number): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  const lockupSchedule = toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals);\n  let vestingSchedulePacked = null;\n\n  if (row.vesting_schedule) {\n    const vestingSchedule = toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals);\n    assertValidTerminationSchedule(lockupSchedule, vestingSchedule);\n    vestingSchedulePacked = { Schedule: vestingSchedule };\n  }\n\n  return {\n    id: index,\n    account_id: row.account_id,\n    schedule: lockupSchedule,\n    vesting_schedule: vestingSchedulePacked,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => parseLockup(x, tokenDecimals, index));\n};\n\nexport type TLockupOrError = Lockup | Error;\n\nexport const parseRawSpreadsheetInputWithErrors = (spreadsheetInput: string, tokenDecimals: number): TLockupOrError[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => {\n    try {\n      return parseLockup(x, tokenDecimals, index);\n    } catch (e) {\n      if (e instanceof Error) {\n        return e;\n      }\n      throw new Error('unreachable');\n    }\n  });\n};\n\nexport const lockupTotalBalance = (lockup: Lockup): Balance => lockup.schedule[lockup.schedule.length - 1].balance;\n","import { useState, useContext } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport { Big } from 'big.js';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\nimport LinkIcon from '@mui/icons-material/Link';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { useSnackbar } from 'notistack';\n\nimport Chart from '../Chart';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\nimport { lockupTotalBalance } from '../../services/spreadsheetImport';\nimport { interpolateSchedule } from '../../services/scheduleHelpers';\n\ntype TBalancesRaw = {\n  claimed: string,\n  unclaimed: string,\n  vested: string,\n  unvested: string,\n  total: string,\n};\n\nconst calcBalancesRaw = (row: any, now: number): TBalancesRaw => {\n  const totalBalanceRaw = row.schedule[row.schedule.length - 1].balance;\n  const claimedBalanceRaw = '0';\n\n  const m1 = interpolateSchedule;\n  const m2 = lockupTotalBalance;\n  console.log(m1, m2);\n\n  const unclaimedBalanceRaw = interpolateSchedule(row.schedule, now).balance;\n  let vestedBalanceFullRaw = null;\n  const vestingSchedule = row.vesting_schedule?.Schedule;\n  if (vestingSchedule) {\n    vestedBalanceFullRaw = interpolateSchedule(vestingSchedule, now).balance;\n  } else {\n    vestedBalanceFullRaw = lockupTotalBalance(row);\n  }\n  const vestedBalanceRaw = new Big(vestedBalanceFullRaw)\n    .sub(new Big(claimedBalanceRaw))\n    .sub(new Big(unclaimedBalanceRaw))\n    .toString();\n  const unvestedBalanceRaw = new Big(totalBalanceRaw)\n    .sub(new Big(vestedBalanceFullRaw))\n    .toString();\n  console.log(totalBalanceRaw, claimedBalanceRaw, unclaimedBalanceRaw, vestedBalanceRaw, unvestedBalanceRaw);\n\n  return {\n    claimed: claimedBalanceRaw,\n    unclaimed: unclaimedBalanceRaw,\n    vested: vestedBalanceRaw,\n    unvested: unvestedBalanceRaw,\n    total: totalBalanceRaw,\n  };\n};\n\nexport default function DraftsTableRow(props: { pageIndex: number, row: ReturnType<any>, token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  const location = useLocation();\n  const [open, setOpen] = useState(false);\n  const {\n    pageIndex, row, token, adminControls, progressShow,\n  } = props;\n  const { enqueueSnackbar } = useSnackbar();\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  const [now, _setNow] = useState<number>(Math.floor(new Date().getTime() / 1000));\n\n  if (!near) return null;\n\n  if (row instanceof Error) {\n    return (\n      <TableRow>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <div className=\"row-error\">\n            {'row '}\n            {pageIndex}\n            {': '}\n            {row.message}\n          </div>\n        </TableCell>\n      </TableRow>\n    );\n  }\n\n  const vestingSchedule = row?.vesting_schedule?.Schedule;\n\n  const currentContractName = location.pathname.split('/')[1];\n\n  const selectedDraftId = location.pathname.split('/').pop() === row.id.toString();\n  const draftPage = location.pathname.split('/').includes('drafts');\n  const importDraftPage = location.pathname.split('/').includes('import_draft_group');\n\n  const balancesRaw = calcBalancesRaw(row, now);\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {selectedDraftId && draftPage || importDraftPage\n            ? row.id\n            : (\n              <Link\n                to={adminControls\n                  ? `/${currentContractName}/admin/drafts/${row.id}`\n                  : `/${currentContractName}/drafts/${row.id}`}\n              >\n                {row.id}\n              </Link>\n            )}\n          {!importDraftPage && (\n          <CopyToClipboard\n            text={`${window.location.origin}/#/${currentContractName}/drafts/${row.id}`}\n            onCopy={() => enqueueSnackbar('Copied', { variant: 'success', autoHideDuration: 1000 })}\n          >\n            <IconButton aria-label=\"copy link\">\n              <LinkIcon />\n            </IconButton>\n          </CopyToClipboard>\n          )}\n        </TableCell>\n        <TableCell align=\"left\">\n          {row.account_id}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(balancesRaw.total, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        {progressShow && (\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span>\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{convertAmount(balancesRaw.claimed, token.decimals)}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span>\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{convertAmount(balancesRaw.unclaimed, token.decimals)}</b>\n                  {' '}\n                  Available\n                </span>\n                <span>\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{convertAmount(balancesRaw.vested, token.decimals)}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span>\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{convertAmount(balancesRaw.unvested, token.decimals)}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n)}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar\">\n              <div style={{ width: `${(parseFloat(balancesRaw.claimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"claimed\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${(parseFloat(balancesRaw.unclaimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"available\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${(parseFloat(balancesRaw.vested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"vested\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${(parseFloat(balancesRaw.unvested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"unvested\">\n                &nbsp;\n              </div>\n            </div>\n          </Tooltip>\n        </TableCell>\n        )}\n      </TableRow>\n      <TableRow sx={{ background: '#F4F7FC' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div style={{ display: 'flex', gap: 20 }}>\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                  <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n                <div style={{ flex: 1 }}>\n                  <div style={{ height: 300 }}>\n                    <Chart data={chartData([row], token.decimals)} />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { TMetadata } from '../../services/tokenApi';\nimport DraftsTableRow from './row';\n\nexport default function DraftsTable({\n  lockups, token, adminControls, progressShow,\n}: { lockups: any[], token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        {lockups.length > 0 && (\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n        </TableRow>\n        )}\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup, i) => (\n          <DraftsTableRow key={lockup.id} pageIndex={i + 1} row={lockup} token={token} adminControls={adminControls} progressShow={progressShow} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\n\nexport default function TokenAmountPreview(params: { token: TMetadata, amount: String }) {\n  const { token, amount } = params;\n\n  return (\n    <div className=\"token-info\">\n      <div className=\"token-amount\">\n        {amount}\n        {' '}\n        {token.symbol}\n      </div>\n      <TokenIcon url={token.icon || ''} size={32} />\n    </div>\n  );\n}\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { LoadingButton } from '@mui/lab';\nimport DraftsTable from '../DraftsTable';\nimport {\n  parseRawSpreadsheetInputWithErrors, TLockupOrError, Lockup, lockupTotalBalance,\n} from '../../services/spreadsheetImport';\nimport TokenAmountPreview from '../TokenAmountPreview';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport { convertAmount } from '../../utils';\n\nfunction ImportDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<TLockupOrError[]>([]);\n  const [parseErrors, setParseErrors] = useState<Error[]>([]);\n  const [importProgress, setImportProgress] = useState<boolean>(false);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      if (!near?.currentUser?.signedAccountId) {\n        throw new Error('expected present signedAccountId');\n      }\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInputWithErrors(input, token.decimals);\n      const errorsFiltered = lockups.filter((x) => x instanceof Error).map((x) => x as Error);\n      setData(lockups);\n      setParseErrors(errorsFiltered);\n    } catch (e) {\n      if (e instanceof Error) {\n        setData([]);\n        setParseErrors([e]);\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleClickImport = async () => {\n    try {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      setImportProgress(true);\n      const draftGroupId = await withNotification(\n        'Create draft group',\n        async () => {\n          const result = await near.api.createDraftGroup();\n          return result;\n        },\n      );\n      const msg = `Created draft group id: ${draftGroupId}`;\n      enqueueSnackbar(msg, { variant: 'success' });\n\n      const chunkSize = 20;\n      for (let i = 0; i < data.length; i += chunkSize) {\n        const chunk = data.slice(i, i + chunkSize);\n        const drafts = chunk.map((lockup) => ({\n          draft_group_id: draftGroupId,\n          lockup_create: lockup,\n        }));\n        await withNotification(\n          'Create drafts',\n          async () => {\n            const result = await near.api.createDrafts(drafts);\n            return result;\n          },\n        );\n      }\n\n      const message = `Created ${data.length} draft${data.length > 1 ? 's' : ''}.`;\n      enqueueSnackbar(message, { variant: 'success' });\n\n      const currentContractName = location.pathname.split('/')[1];\n      const path = `/${currentContractName}/admin/draft_groups/${draftGroupId}`;\n\n      navigate(path);\n    } catch (e) {\n      setImportProgress(false);\n    }\n  };\n\n  const calcTotalBalance = (lockups: TLockupOrError[]) => {\n    const lockupsFiltered = lockups.filter((x: TLockupOrError) => !(x instanceof Error)).map((x) => x as Lockup);\n    const balances = lockupsFiltered.map((x: Lockup) => lockupTotalBalance(x));\n    let result = new Big('0');\n\n    balances.forEach((x) => {\n      result = result.add(new Big(x));\n    });\n    return result.toString();\n  };\n\n  const totalBalance = convertAmount(calcTotalBalance(data), token.decimals);\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h2>\n          Import Draft Group\n        </h2>\n\n        <div className=\"import-draft-group-wrapper\">\n          <div className=\"draft-group-preview-inner\">\n            <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n              <h5>\n                <span className=\"new-draft-count-text\">\n                  {`New draft group with ${data.length} lockup${data.length > 1 ? 's' : ''}`}\n                </span>\n                {' '}\n                {parseErrors.length > 0 && (<span className=\"parse-error-label\">{`${parseErrors.length} parse error${parseErrors.length > 1 ? 's' : ''}`}</span>)}\n              </h5>\n              <TokenAmountPreview token={token} amount={totalBalance} />\n            </div>\n          </div>\n\n          <p>\n            Copy lockups from a spreadsheet editor and paste into the area below.\n            See\n            {' '}\n            <a href={`${process.env.PUBLIC_URL}/lockup_import_example.xlsx`}>\n              example and format specifications\n            </a>\n            .\n          </p>\n          <TextareaAutosize\n            className=\"import-draft-group-textarea\"\n            id=\"spreadsheet-input\"\n            placeholder=\"Excel input\"\n            maxRows={5}\n            onChange={handleChangeInput}\n          />\n        </div>\n        <DraftsTable lockups={data} token={token} adminControls={adminControls} progressShow />\n        <LoadingButton\n          disabled={!(data.length >= 1 && parseErrors.length === 0 && !importProgress)}\n          onClick={handleClickImport}\n          loading={importProgress}\n          type=\"button\"\n          className=\"button\"\n        >\n          Import\n        </LoadingButton>\n      </div>\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction FundButton(props: { draftGroupIndex: number | undefined, amount: string | undefined }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (draftGroupIndex === undefined) {\n    throw Error('Cannot fund draft group without index');\n  }\n\n  if (amount === undefined) {\n    throw Error('Cannot fund draft group without specified amount');\n  }\n\n  const handleFund = () => {\n    near.tokenApi.fundDraftGroup(\n      near.api.getContract().contractId,\n      draftGroupIndex,\n      amount,\n    );\n  };\n\n  return (\n    <button className=\"button\" type=\"button\" onClick={handleFund}>Fund</button>\n  );\n}\n\nexport default FundButton;\n","import { useContext } from 'react';\n\nimport Select from '@mui/material/Select';\n\nimport {\n  TextField,\n  InputLabel,\n  MenuItem,\n} from '@mui/material';\n\nimport { INearProps, NearContext } from '../../../services/near';\n\ntype TProps = {\n  selectedAddress: string,\n  setSelectedAddress: Function,\n};\n\nfunction DaoSelector({ selectedAddress, setSelectedAddress }: TProps): any {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const { daos } = near.currentUser;\n\n  if (daos.length > 0 && (selectedAddress === '' || !daos.includes(selectedAddress))) {\n    setSelectedAddress(daos[0]);\n  }\n\n  const handleSelectedDaoAddressChange = (event: any) => {\n    setSelectedAddress(event.target.value as string);\n  };\n\n  if (daos.length > 0) {\n    return (\n      <div>\n        <InputLabel>Select DAO contract address</InputLabel>\n        <Select\n          required\n          sx={{ marginBottom: 3, width: 1 }}\n          value={selectedAddress}\n          onChange={handleSelectedDaoAddressChange}\n        >\n          {daos.map((dao) => <MenuItem value={dao}>{dao}</MenuItem>)}\n        </Select>\n      </div>\n    );\n  }\n\n  return (\n    <TextField\n      required\n      sx={{ marginBottom: 3, width: 1 }}\n      id=\"outlined-helperText\"\n      label=\"DAO contract address\"\n      onChange={handleSelectedDaoAddressChange}\n    />\n  );\n}\n\nexport default DaoSelector;\n","import {\n  TextField,\n} from '@mui/material';\n\ntype TProps = {\n  proposalDescription: string,\n  setProposalDescription: Function,\n};\n\nfunction DaoProposalDescription({ proposalDescription, setProposalDescription }: TProps): any {\n  const handleDescriptionChange = (e: any) => {\n    setProposalDescription(e.target.value as string);\n  };\n\n  return (\n    <TextField\n      sx={{ width: 1 }}\n      id=\"outlined-multiline-static\"\n      label=\"Proposal description\"\n      multiline\n      minRows={5}\n      onChange={handleDescriptionChange}\n      defaultValue={proposalDescription}\n    />\n  );\n}\n\nexport default DaoProposalDescription;\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { buildFundDraftGroupProposalLink } from '../../services/DAOs/astroDAO/utils';\n\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\n\nfunction FundWithDaoButton(props: { draftGroupIndex: number | undefined, amount: any }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  const defaultDescription = `Fund draft group ${draftGroupIndex} with amount ${amount?.label}. Draft group link: ${window.location.href.replace(/\\/admin/, '')}`;\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState('');\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (draftGroupIndex === undefined) {\n    throw Error('Cannot fund draft group without index');\n  }\n\n  if (amount?.value === undefined) {\n    throw Error('Cannot fund draft group without specified amount');\n  }\n\n  console.log('AMOUNT', amount);\n\n  const handleFund = () => {\n    const link = buildFundDraftGroupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      near.tokenApi.getContract().contractId,\n      amount.value,\n      draftGroupIndex,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Fund with DAO</button>\n      <Dialog open={open} sx={{ padding: 1, minWidth: 1 }} onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleFund}>\n          <DialogTitle>\n            Fund with DAO\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent style={{ minWidth: '320px', paddingTop: '1.25em' }}>\n            <DaoSelector selectedAddress={astroDAOContractAddress} setSelectedAddress={setAstroDAOContractAddress} />\n            <DaoProposalDescription proposalDescription={description} setProposalDescription={setDescription} />\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Fund</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n\nexport default FundWithDaoButton;\n","import { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\n\nimport { LoadingButton } from '@mui/lab';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction DeleteDraftGroupButton(props: { draftGroupId: number, draftIds: [number], disabled: boolean }) {\n  const { draftGroupId, draftIds, disabled } = props;\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { enqueueSnackbar } = useSnackbar();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [inProgress, setInProgress] = useState<boolean>(false);\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleDelete = () => {\n    const perform = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n\n      setInProgress(true);\n\n      // discard draft group\n      try {\n        await near.api.discardDraftGroup(draftGroupId);\n        enqueueSnackbar(`Discarded draft group ${draftGroupId}`, { variant: 'success' });\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          if (!message.includes('cannot discard, draft group already discarded')) {\n            enqueueSnackbar(`Failed to discard draft group ${draftGroupId}: ${message}`, { variant: 'error' });\n            setInProgress(false);\n            return;\n          }\n        } else {\n          throw new Error('unreachable');\n        }\n      }\n\n      // delete all drafts\n      try {\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Delete drafts',\n            async () => {\n              const result = await near.api.deleteDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        enqueueSnackbar(`Deleted draft group ${draftGroupId}`, { variant: 'success' });\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/draft_groups`);\n        window.location.reload();\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          enqueueSnackbar(`Failed to discard draft group ${draftGroupId}: ${message}`, { variant: 'error' });\n          setInProgress(false);\n        } else {\n          throw new Error('unreachable');\n        }\n      }\n    };\n\n    perform();\n  };\n\n  return (\n    <LoadingButton\n      className=\"button compact red\"\n      type=\"button\"\n      variant=\"contained\"\n      onClick={handleDelete}\n      loading={inProgress}\n      disabled={disabled || inProgress}\n    >\n      Delete\n    </LoadingButton>\n  );\n}\n\nexport default DeleteDraftGroupButton;\n","import { useState, useEffect, useContext } from 'react';\nimport { Alert } from '@mui/material';\nimport {\n  useNavigate, useParams, useLocation, Link,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport { LoadingButton } from '@mui/lab';\n\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport TokenAmountPreview from '../../components/TokenAmountPreview';\nimport FundButton from '../../components/FundButton';\nimport FundWithDaoButton from '../../components/FundWithDaoButton';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\n\nexport default function PageDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  const location = useLocation();\n  const { enqueueSnackbar } = useSnackbar();\n  const draftGroupId: number = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n  const [isConverted, setIsConverted] = useState<string>('pending');\n\n  useEffect(() => {\n    const perform = async () => {\n      setIsConverted('pending');\n      console.log(`fetchIsConverted: ${draftGroupId} ${'pending'}`);\n\n      if (!near) return;\n\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n      const msg = args.msg && JSON.parse(args.msg);\n      const msgDraftGroupId = msg && msg.draft_group_id;\n\n      console.log(methodName, successValue, args, msg, msgDraftGroupId);\n\n      const result = methodName === 'ft_transfer_call' && msgDraftGroupId !== undefined && msgDraftGroupId === draftGroupId;\n\n      if (result) {\n        setIsConverted('converted');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'converted'}`);\n      } else {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n      }\n    };\n    perform();\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n\n      console.log(`fetchDraftGroup called: ${draftGroupId} ${isConverted}`);\n      if (!near) return;\n      console.log(isConverted);\n      if (isConverted === 'pending') {\n        return;\n      }\n\n      const result = await near.api.getDraftGroup(draftGroupId);\n      setDraftGroup(result || 'not_found');\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId, isConverted]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup || draftGroup === 'not_found') {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  const navigate = useNavigate();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleConvert = () => {\n    const convertDrafts = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      try {\n        setInProgress(true);\n        const draftIds = draftGroup.draft_indices;\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Convert drafts',\n            async () => {\n              const result = await near.api.convertDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        enqueueSnackbar(`Converted drafts for draft group ${draftGroupId}`, { variant: 'success' });\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/lockups`);\n        window.location.reload();\n      } catch (e) {\n        console.log(`ERROR: ${e}`);\n      } finally {\n        setInProgress(false);\n      }\n    };\n\n    convertDrafts();\n  };\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  if (draftGroup === 'not_found') {\n    const currentContractName = location.pathname.split('/')[1];\n    return (\n      <div className=\"container\">\n        <h1>{isConverted === 'converted' ? `Success! Draft group ${draftGroupId} have been converted!` : 'Draft group not found.'}</h1>\n        <div>\n          {!(isConverted === 'converted') && 'It may have been converted, deleted, or have never existed at all.' || true}\n          <br />\n          Check\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups`}>lockups</Link>\n          {' '}\n          to find converted lockups or\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/draft_groups`}>draft groups</Link>\n          {' '}\n          to see all existing draft groups.\n        </div>\n      </div>\n    );\n  }\n\n  const amount = {\n    value: draftGroup.total_amount,\n    label: convertAmount(draftGroup.total_amount, token.decimals) || '',\n  };\n\n  if (!near) return null;\n  const { isAdmin } = near.currentUser;\n\n  return (\n    <div className=\"container\">\n      <div className=\"draft-group-preview-wrapper draft-group-preview-inner\">\n        <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n          <h5>\n            {`Draft group ${draftGroupId}`}\n            {' '}\n            {draftGroup.discarded && (<span className=\"discarded-marker\">DISCARDED</span>)}\n          </h5>\n          <TokenAmountPreview token={token} amount={amount.label} />\n        </div>\n        {!draftGroup.funded && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            {!draftGroup.discarded && isAdmin && <FundButton draftGroupIndex={draftGroupId} amount={amount.value} /> }\n            {!draftGroup.discarded && <FundWithDaoButton draftGroupIndex={draftGroupId} amount={amount} />}\n            <DeleteDraftGroupButton\n              draftGroupId={draftGroup.id}\n              draftIds={draftGroup.draft_indices}\n              disabled={draftGroup.funded}\n            />\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length > 0 && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            <LoadingButton\n              className=\"button\"\n              type=\"button\"\n              onClick={handleConvert}\n              loading={inProgress}\n              variant=\"contained\"\n              color=\"success\"\n            >\n              Convert\n            </LoadingButton>\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length === 0 && (\n          <div style={{ marginTop: 20 }}>\n            <Alert severity=\"success\">Draft Group converted</Alert>\n          </div>\n        )}\n      </div>\n\n      {(!draftGroup.funded || draftGroup.draft_indices.length > 0) && (\n        <DraftsTable lockups={drafts} token={token} adminControls={adminControls} progressShow />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport TokenIcon from '../../components/TokenIcon';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\n\nexport default function PageDraftGroupsIndex({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  const currentContractName = location.pathname.split('/')[1];\n  const importDraftGroupPath = `/${currentContractName}/admin/import_draft_group`;\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h1>\n          All draft groups\n        </h1>\n\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell align=\"center\">ID</TableCell>\n              <TableCell align=\"center\">Funded</TableCell>\n              <TableCell align=\"center\">Number&nbsp;of&nbsp;lockups</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              {adminControls && <TableCell align=\"right\" width=\"0%\">Delete</TableCell>}\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {draftGroups.map((group) => (\n              <TableRow key={group.id}>\n                <TableCell align=\"center\">\n                  <Link to={`/${currentContractName}/${adminControls ? 'admin/' : ''}draft_groups/${group.id}`}>{group.id}</Link>\n                </TableCell>\n                <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n                <TableCell align=\"center\">{group.draft_indices.length}</TableCell>\n                <TableCell align=\"right\">\n                  {convertAmount(group.total_amount, token.decimals)}\n                &nbsp;\n                  {token.symbol}\n                &nbsp;\n                  <TokenIcon url={token.icon || ''} size={32} />\n                </TableCell>\n                {adminControls && (\n                  <TableCell align=\"right\">\n                    {!group.funded && (\n                    <DeleteDraftGroupButton\n                      draftGroupId={group.id}\n                      draftIds={group.draft_indices}\n                      disabled={group.funded}\n                    />\n                    )}\n                  </TableCell>\n                )}\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n\n        {adminControls && (\n        <Link to={importDraftGroupPath}>\n          <button className=\"button\" type=\"button\">Import Draft Group</button>\n        </Link>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Box } from '@mui/material';\nimport { useSnackbar } from 'notistack';\n\nimport { FACTORY_CONTRACT_NAME } from '../../config';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function NewLockupContract() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near, signIn }: { near: INearProps | null, signIn: () => void } = useContext(NearContext);\n\n  const handleDeployLockupContract = (e: any) => {\n    e.preventDefault();\n\n    const perform = async () => {\n      try {\n        if (!near?.currentUser?.signedAccountId) {\n          throw new Error('expected signedAccountId to be present');\n        }\n\n        // const lockupCreator: string = near.signedAccountId;\n        const lockupOperators: string[] = e.target.elements.lockup_operators.value\n          .split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n        const draftOperators: string[] = e.target.elements.draft_operators.value\n          .split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n        const tokenAccountId: string = e.target.elements.token_account_id.value;\n        const lockupSubaccountId: string = e.target.elements.lockup_subaccount_id.value;\n\n        if (lockupOperators.length === 0) {\n          throw new Error('empty lockup operators');\n        }\n\n        if (tokenAccountId.length === 0) {\n          throw new Error('empty tokenAccountId');\n        }\n\n        if (lockupSubaccountId.length === 0) {\n          throw new Error('empty lockupSubaccountId');\n        }\n\n        // const message = `\n        //   lockup_creator: ${lockupCreator}\n        //   lockup_operators: ${JSON.stringify(lockupOperators)}\n        //   token_account_id: ${tokenAccountId}\n        //   lockup_subaccount_id: ${lockupSubaccountId}\n        // `;\n        // alert(message);\n\n        const result = await near.factoryApi.create(\n          lockupSubaccountId,\n          tokenAccountId,\n          lockupOperators,\n          draftOperators,\n          `${window.location.origin + window.location.pathname}#/${lockupSubaccountId}.${FACTORY_CONTRACT_NAME}/admin/lockups`,\n        );\n\n        console.log(result);\n\n        return result;\n      } catch (error) {\n        console.log(error);\n        enqueueSnackbar((error as any).toString(), { variant: 'error' });\n        return null;\n      }\n    };\n\n    perform();\n  };\n\n  if (!(near)) {\n    return null;\n  }\n\n  return (\n    <div>\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n            <div className=\"nav\">\n              <Link className=\"nav-link\" to=\"/\">Home</Link>\n            </div>\n          </Box>\n        </div>\n      </div>\n\n      <div className=\"container new-lockup-contract\">\n        <h2>\n          Create Lockup Contract for your Fungible Tokens\n        </h2>\n\n        <form className=\"form-submit\" onSubmit={handleDeployLockupContract}>\n          <div className=\"form-wrapper\">\n\n            <p>On this page you can deploy your own copy of lockup contract. Some more elaborative description follows here.</p>\n            <div className=\"form-row\">\n              <span>Contract creator: </span>\n              <div className=\"form-cell\">\n                {near.currentUser.signedAccountId && <strong>{near.currentUser.signedAccountId}</strong>}\n                <button className=\"button\" type=\"button\" onClick={signIn}>\n                  {near.currentUser.signedAccountId && 'Login as someone else' || 'Login'}\n                </button>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <span>Lockup operators: </span>\n              <input type=\"text\" id=\"lockup_operators\" />\n            </div>\n            <div className=\"form-row\">\n              <span>Draft operators: </span>\n              <input type=\"text\" id=\"draft_operators\" />\n            </div>\n            <div className=\"form-row\">\n              <span>Fungible token contract address: </span>\n              <input type=\"text\" id=\"token_account_id\" />\n            </div>\n            <div className=\"form-row\">\n              <span>New Lockup Contract Address: </span>\n              <input type=\"text\" id=\"lockup_subaccount_id\" />\n            </div>\n\n            <button className=\"button submit\" type=\"submit\" disabled={!near.currentUser.signedAccountId}>\n              Deploy Contract\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { DateTimePicker } from '@mui/x-date-pickers/DateTimePicker';\nimport { TextField } from '@mui/material';\n\ntype TProps = {\n  value: Date | null,\n  setValue: (newValue: Date | null) => any,\n  label: String,\n  minTime: Date | null,\n};\nexport default function UTCDateTimePicker(props: TProps) {\n  const {\n    value, setValue, label, minTime,\n  } = props;\n\n  const offsetMs = 1_000 * 60 * new Date().getTimezoneOffset();\n\n  return (\n    <DateTimePicker\n      label={label}\n      value={value && new Date(value.getTime() + offsetMs)}\n      minDateTime={minTime && new Date(minTime.getTime() + offsetMs)}\n      onChange={(newValue) => {\n        setValue(newValue && new Date(newValue.getTime() - offsetMs));\n      }}\n      ampm={false}\n      renderInput={\n        (params) => (\n          <TextField\n            sx={{ margin: '0px 0 24px' }}\n            margin=\"normal\"\n            fullWidth\n            variant=\"standard\"\n            {...params}\n            inputProps={{\n              ...params.inputProps,\n              placeholder: 'YYYY-MM-DD hh:mm:ss UTC',\n            }}\n          />\n        )\n      }\n      inputFormat=\"yyyy-MM-dd HH:mm:ss 'UTC'\"\n    />\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport BN from 'bn.js';\nimport Big from 'big.js';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear, startOfDay, addDays } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TSchedule } from '../../services/api';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setStartDate', newValue?.getTime());\n    setStartDate(newValue);\n    setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n  const [accountId, setAccountId] = useState<string>('');\n  const [accountStatus, setAccountStatus] = useState<string>('pending'); // pending success error\n  const [amount, setAmount] = useState<string>('');\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleChangeAmount = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const perform = async () => {\n      if (!near) return;\n      const { value } = event.target;\n\n      setAmount(value);\n    };\n\n    perform();\n  };\n\n  const handleChangeAccountId = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const perform = async () => {\n      if (!near) return;\n      const { value } = event.target;\n\n      console.log(accountStatus, setAccountStatus);\n\n      setAccountId(value);\n      setAccountStatus('pending');\n\n      try {\n        const { total } = (await (await near.near.account(value)).getAccountBalance());\n        console.log(total);\n        setAccountStatus('success');\n      } catch (e) {\n        setAccountStatus('error');\n      }\n    };\n\n    perform();\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n    if (!near.currentUser.signedAccountId) {\n      throw new Error('signedAccountId requred to set lockup terminator');\n    }\n    if (!startDate) {\n      throw Error('Start date not set');\n    }\n\n    e.preventDefault();\n\n    console.log(amount);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const lockupTotalAmount = new Big(amount).mul(new Big(10).pow(token.decimals))\n      .round(0, Big.roundDown).toString();\n\n    const getScheduleList = (date: Date, balanceInput: string, selected: string): [TSchedule, TSchedule | null] => {\n      const balance = new BN(balanceInput);\n\n      const schedules: { [key: string]: TSchedule } = {\n        '4y_cliff_1y_25': [\n          { timestamp: addYear(date, 0), balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: balance.divn(4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n\n      const schedulePairs: { [key: string]: [TSchedule, TSchedule | null] } = {\n        '4_year': [schedules['4y_cliff_1y_25'], null],\n        '4_year_vested': [schedules['4y_cliff_1y_25'], schedules['4y_cliff_1y_25']],\n      };\n\n      return schedulePairs[selected];\n    };\n\n    const [lockupSchedule, vestingSchedule] = getScheduleList(startDate, lockupTotalAmount, schedule);\n\n    near.tokenApi.createLockup(\n      lockupContractId,\n      lockupTotalAmount.toString(),\n      accountId,\n      lockupSchedule,\n      vestingSchedule,\n    );\n  };\n\n  const validAmount = !Number.isNaN(parseFloat(amount));\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n              onChange={handleChangeAccountId}\n              color={accountStatus === 'success' ? 'success' : accountStatus === 'error' ? 'error' : 'primary'}\n            />\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n              onChange={handleChangeAmount}\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <UTCDateTimePicker\n                value={startDate}\n                setValue={(newValue) => {\n                  console.log('setStartDate', newValue?.getTime());\n                  setStartDate(newValue);\n                }}\n                label=\"Start date and time\"\n                minTime={null}\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button disabled={!startDate || accountStatus === 'error' || !validAmount} className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n","export default function TimestampDateDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth(), 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const formatted = `${year}-${month}-${monthDay} UTC`;\n\n  return (\n    <span className=\"timestamp-display\">\n      {formatted}\n    </span>\n  );\n}\n","import {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\n\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\n\ntype TUIElement<Ctype> = {\n  currentState: {\n    value: Ctype,\n    setValue: any,\n  },\n};\n\ntype TProps = {\n  currentState: {\n    value: boolean,\n    setValue: any,\n  },\n  handlers: {\n    onClose: any,\n    onSubmit: any,\n  },\n  dialog: {\n    dateTimePicker: TUIElement<Date | null>,\n    daoSelector?: TUIElement<string>,\n    daoProposalDescription?: TUIElement<string>,\n  },\n};\n\nfunction TerminateModal({ currentState, handlers, dialog }: TProps) {\n  return (\n    <Dialog open={currentState.value} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handlers.onClose}>\n      <form className=\"form-submit\">\n        <DialogTitle>\n          Terminate Lockup\n          <IconButton\n            aria-label=\"close\"\n            onClick={handlers.onClose}\n            sx={{\n              position: 'absolute',\n              right: 8,\n              top: 8,\n            }}\n          >\n            <CloseRoundedIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent sx={{ maxWidth: '320px' }}>\n          <LocalizationProvider dateAdapter={AdapterDateFns}>\n            {dialog.dateTimePicker && (\n              <UTCDateTimePicker\n                value={dialog.dateTimePicker.currentState.value}\n                setValue={(newValue) => {\n                  dialog.dateTimePicker.currentState.setValue(newValue);\n                }}\n                label=\"Custom termination date and time\"\n                minTime={new Date()}\n              />\n            )}\n            { dialog?.daoSelector && (\n              <DaoSelector\n                selectedAddress={dialog.daoSelector.currentState.value}\n                setSelectedAddress={dialog.daoSelector.currentState.setValue}\n              />\n            ) }\n            { dialog?.daoProposalDescription && (\n              <DaoProposalDescription\n                proposalDescription={dialog.daoProposalDescription.currentState.value}\n                setProposalDescription={dialog.daoProposalDescription.currentState.setValue}\n              />\n            ) }\n          </LocalizationProvider>\n          <span style={{ minHeight: '40px' }} />\n          <button className=\"button red fullWidth\" style={{ marginTop: '40px' }} type=\"button\" onClick={handlers.onSubmit}>\n            Terminate\n          </button>\n        </DialogContent>\n      </form>\n    </Dialog>\n  );\n}\n\nexport default TerminateModal;\n","import { useContext, useState } from 'react';\n\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport TerminateModal from '../TerminateModal';\nimport { startOfDay, addDays } from '../../utils';\n\nfunction TerminateLockup(\n  props: {\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: { beneficiary_id: String, vesting_schedule: [] | null } | null,\n    token: TMetadata,\n    buttonText: string,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n    buttonText,\n  } = props;\n\n  const { enqueueSnackbar } = useSnackbar();\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setDate', newValue?.getTime());\n    setDate(newValue);\n\n    return setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = async () => {\n    if (!enqueueSnackbar) return;\n\n    const ts = date ? date.getTime() / 1000 : null;\n    const result = await near.api.terminate(lockupIndex, ts);\n    const amount = new Big(result as any).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n    console.log(amount);\n    const message = `Terminated lockup #${lockupIndex}, refunded ${amount} ${token.symbol}`;\n    enqueueSnackbar(message, { variant: 'success' });\n    setTimeout(() => window.location.reload(), 1000);\n  };\n\n  const canTerminate = adminControls && config;\n\n  const modalProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminateLockup,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: (newValue: Date | null) => {\n            console.log('setDate', newValue?.getTime());\n            setDate(newValue);\n          },\n        },\n      },\n    },\n  };\n\n  return (\n    <>\n      {canTerminate && (\n        <button\n          className=\"button\"\n          type=\"button\"\n          onClick={handleOpen}\n        >\n          {buttonText}\n        </button>\n      )}\n      { open && <TerminateModal {...modalProps} /> }\n    </>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport TerminateModal from '../TerminateModal';\nimport { buildTerminateLockupProposalLink } from '../../services/DAOs/astroDAO/utils';\n\nfunction TerminateWithDaoButton(\n  props: {\n    accountId: string,\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: { beneficiary_id: String, vesting_schedule: [] | null } | null,\n    token: TMetadata,\n    buttonText: string,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    accountId,\n    adminControls,\n    lockupIndex,\n    config,\n    buttonText,\n  } = props;\n\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n  const location = useLocation();\n\n  const currentContractName = location.pathname.split('/')[1];\n  const pathname = `/${currentContractName}/lockups/${accountId}/${lockupIndex}`;\n  const uri = new URL(window.location.href);\n  uri.hash = `#${pathname}`;\n  const defaultDescription = `Terminate lockup ${lockupIndex}. Lockup link: ${uri.toString()}`;\n\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState((config?.beneficiary_id || '') as string);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminate = () => {\n    const link = buildTerminateLockupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      lockupIndex,\n      date ? date.getTime() / 1000 : null,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  const canTerminate = adminControls && config;\n\n  const modalProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminate,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: setDate,\n        },\n      },\n      daoSelector: {\n        currentState: {\n          value: astroDAOContractAddress,\n          setValue: setAstroDAOContractAddress,\n        },\n      },\n      daoProposalDescription: {\n        currentState: {\n          value: description,\n          setValue: setDescription,\n        },\n      },\n    },\n  };\n\n  return (\n    <div>\n      <button\n        className=\"button\"\n        disabled={!canTerminate}\n        type=\"button\"\n        onClick={handleOpen}\n        style={{ marginTop: 0 }}\n      >\n        {buttonText}\n      </button>\n      { open && <TerminateModal {...modalProps} /> }\n    </div>\n  );\n}\n\nexport default TerminateWithDaoButton;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\n\nimport TimestampDateDisplay from '../TimestampDateDisplay';\nimport Chart from '../Chart';\nimport { convertAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TerminateLockup from '../TerminateLockup';\nimport TerminateWithDaoButton from '../TerminateWithDaoButton';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\n\nexport default function Row(props: { adminControls: boolean, row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { adminControls, row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { isAdmin } = near.currentUser;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  const selectedAccountPage = window.location.href.split('/').pop() === row.account_id;\n\n  const selectedLockupId = window.location.href.split('/').pop() === row.id.toString();\n\n  const claimedAmount = `${convertAmount(row.claimed_balance, token.decimals)}`;\n  const availbleAmount = `${convertAmount(row.unclaimed_balance, token.decimals)}`;\n  const vestedAmount = `${convertAmount(row.total_balance - row.claimed_balance - row.unclaimed_balance, token.decimals)}`;\n  const unvestedAmount = `${convertAmount(row.total_balance - row.total_balance, token.decimals)}`;\n\n  let payerMessage;\n  if (!row.termination_config?.beneficiary_id) {\n    payerMessage = 'This lockup cannot be terminated';\n  } else {\n    payerMessage = `Unvested amount will return to ${row.termination_config?.beneficiary_id}`;\n  }\n\n  const terminatorId = row?.termination_config?.beneficiary_id;\n\n  const terminateButton = (terminator: string) => {\n    if (!adminControls) {\n      return null;\n    }\n    return (\n      <>\n        <div>\n          {isAdmin && (\n            <TerminateLockup\n              token={token}\n              adminControls={adminControls}\n              lockupIndex={row.id}\n              config={row.termination_config}\n              buttonText={terminator ? 'Terminate' : 'No termination config'}\n            />\n          )}\n        </div>\n        <div>\n          <TerminateWithDaoButton\n            accountId={row.account_id}\n            token={token}\n            adminControls={adminControls}\n            lockupIndex={row.id}\n            config={row.termination_config}\n            buttonText={terminator ? 'Terminate with Dao' : 'No termination config'}\n          />\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedLockupId ? <Link to={`${row.id}`}>{row.id}</Link> : row.id}\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedAccountPage && !selectedLockupId ? <Link to={row.account_id}>{row.account_id}</Link> : row.account_id}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[0].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[row.schedule.length - 1].timestamp} />\n        </TableCell>\n        <TableCell align=\"center\">\n          {vestingSchedule ? 'Yes' : 'No'}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span>\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{claimedAmount}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span>\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{availbleAmount}</b>\n                  {' '}\n                  Available\n                </span>\n                <span>\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{vestedAmount}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span>\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{unvestedAmount}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n)}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar\">\n              <div style={{ width: `${row.total_balance === '0' ? '100' : (row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${row.total_balance === '0' ? '0' : (row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${row.total_balance === '0' ? '0' : ((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n                &nbsp;\n              </div>\n              <div style={{ width: `${row.total_balance === '0' ? '0' : (row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n            </div>\n          </Tooltip>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4F7FC' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n              {vestingSchedule && (\n              <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n              )}\n\n              <div className=\"lockup-row-column chart\">\n                <div style={{ height: 300 }}>\n                  <Chart data={chartData([row], token.decimals)} />\n                </div>\n\n                <div className=\"terminate\">\n                  <span className=\"fine-print\">{payerMessage}</span>\n                  {terminatorId && terminateButton(terminatorId)}\n\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable(\n  { lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean },\n) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"center\">Terminatable</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  TextField,\n} from '@mui/material';\n\nimport { useRef } from 'react';\n\nexport default function FavouriteAccounts({\n  tokenContractId, favouriteAccounts, uniqueUsers, onSave,\n}: {\n  tokenContractId: string, favouriteAccounts: string[], uniqueUsers: string[], onSave: Function,\n}) {\n  console.log('unique users', uniqueUsers);\n\n  const inputRef = useRef<null | HTMLInputElement>(null);\n\n  const parseAccounts = (input: string): string[] => input.replaceAll(' ', '').split(',');\n\n  const handleSaveFavouriteAccounts = (): void => {\n    const localStorageValue = (value: string[]): string => JSON.stringify({ favouriteAccounts: value });\n\n    if (!inputRef?.current?.value) {\n      localStorage.setItem(tokenContractId, localStorageValue([]));\n      onSave([]);\n      return;\n    }\n\n    const newFavouriteAccounts = parseAccounts(inputRef.current.value);\n    onSave(newFavouriteAccounts);\n    localStorage.setItem(tokenContractId, localStorageValue(newFavouriteAccounts));\n  };\n\n  const handleChangeFavouriteAccounts = (e: any) => {\n    const { value } = e.target;\n\n    const realAccouns = parseAccounts(value).filter((account) => account.match(/.*(\\.)(near|testnet)$/));\n\n    if (favouriteAccounts.toString() !== realAccouns.toString()) {\n      handleSaveFavouriteAccounts();\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex', marginBottom: '2em' }}>\n      <TextField\n        inputProps={{\n          sx: {\n            margin: 0,\n          },\n        }}\n        size=\"small\"\n        sx={{ width: 1, padding: 0, margin: 0 }}\n        id=\"outlined-helperText\"\n        label=\"My accounts\"\n        placeholder=\"Comma separated list of your near accounts\"\n        defaultValue={favouriteAccounts.join(', ')}\n        inputRef={inputRef}\n        onKeyPress={(e) => e.key === 'Enter' && handleSaveFavouriteAccounts()}\n        onChange={handleChangeFavouriteAccounts}\n      />\n    </div>\n  );\n}\n","import {\n  TableContainer,\n} from '@mui/material';\nimport { useContext, useState } from 'react';\n\nimport { Link } from 'react-router-dom';\nimport Chart from '../../components/Chart';\n\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport FavouriteAccounts from '../../components/FavouriteAccounts';\nimport { chartData } from '../../services/chartHelpers';\n\ntype TToken = TMetadata & { contractId: string };\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TToken, adminControls: boolean }) {\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  const {\n    near,\n  }: {\n    near: INearProps,\n  } = useContext(NearContext);\n\n  const { signedIn, isAdmin } = near.currentUser;\n\n  const storedData = localStorage.getItem(token.contractId);\n  const favouriteAccountsFromLocalStorage = storedData ? JSON.parse(storedData)?.favouriteAccounts : [];\n  const [favouriteAccounts, setFavouriteAccounts] = useState<string[]>(favouriteAccountsFromLocalStorage);\n  const favouriteAccountsLockups = lockups.filter((lockup) => favouriteAccounts.includes(lockup.account_id));\n\n  const lockupsPage = (lockupsList: any): any => {\n    if (lockupsList.length > 0) {\n      return (\n        <>\n          <Chart data={chartData(lockupsList, token.decimals)} />\n\n          { signedIn && adminControls && isAdmin && <CreateLockup token={token} /> }\n\n          <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }}>\n            <LockupsTable lockups={lockupsList} token={token} adminControls={adminControls} />\n          </TableContainer>\n        </>\n      );\n    }\n\n    return (\n      <div>\n        There are no lockups yet.\n        {adminControls && (\n          <div>\n            {isAdmin && 'Create single lockup or create a batch of lockups via' || 'Create a batch of lockups via'}\n            {' '}\n            <Link to={`/${near.lockupContractId}/admin/import_draft_group`}>Draft Groups</Link>\n            .\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  console.log('favouriteAccountsLockups', favouriteAccountsLockups);\n\n  if (adminControls) {\n    return (\n      <div className=\"main\">\n        <div className=\"container\">\n          {lockupsPage(lockups)}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <FavouriteAccounts\n          tokenContractId={token.contractId}\n          favouriteAccounts={favouriteAccounts}\n          uniqueUsers={uniqueUsers}\n          onSave={setFavouriteAccounts}\n        />\n        {lockupsPage(favouriteAccountsLockups)}\n      </div>\n    </div>\n  );\n}\n","import {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  IconButton,\n  Button,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nexport default function ConfirmDialog(props: { message: string, isOpen: boolean, closeFn: any, callback: any }) {\n  const {\n    message,\n    isOpen,\n    closeFn,\n    callback,\n  } = props;\n\n  const handleConfirm = () => {\n    closeFn();\n    callback();\n  };\n\n  return (\n    <Dialog open={isOpen} sx={{ padding: 2 }} maxWidth=\"md\" onClose={closeFn}>\n      <DialogTitle>\n        Confirmation\n        <IconButton\n          aria-label=\"close\"\n          sx={{\n            position: 'absolute',\n            right: 8,\n            top: 8,\n          }}\n          onClick={closeFn}\n        >\n          <CloseRoundedIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent sx={{ minWidth: '320px' }}>\n        <div>{message}</div>\n      </DialogContent>\n      <DialogActions>\n        <Button color=\"error\" onClick={closeFn}>Cancel</Button>\n        <Button color=\"success\" variant=\"contained\" onClick={handleConfirm}>Confirm</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\n\nimport ConfirmDialog from '../ConfirmDialog';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountPreview from '../TokenAmountPreview';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, total: String }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { accountId, token, total } = params;\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [dialogConfirmCallback, setDialogConfirmCallback] = useState<any>(() => null);\n  const closeDialog = () => setIsDialogOpen(false);\n  const openDialog = () => setIsDialogOpen(true);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    const perform = async () => {\n      if (!near) return;\n      if (!near.tokenApi) return;\n      if (!near.noLoginTokenApi) return;\n      if (!near.tokenContractId) return;\n\n      const storageBalance = await near.tokenApi.storageBalanceOf(accountId);\n      const isStoragePaid = (storageBalance !== null) && true;\n      if (isStoragePaid) {\n        near.noLoginApi.claim(accountId);\n      } else {\n        const bounds = await near.tokenApi.storageBalanceBounds();\n        const amount = bounds.max;\n\n        const callback = () => {\n          near.noLoginTokenApi.storageDeposit(near.tokenContractId, accountId, amount);\n        };\n        setDialogConfirmCallback(() => callback);\n        openDialog();\n      }\n    };\n\n    perform();\n  };\n\n  const depositConfirmMessage = `\n    Your account doesn't have storage deposit on the token contract. You will be redirected to pay for the storage, after that you will be able to claim your tokens.\n  `.trim();\n\n  return (\n    <div className=\"claim-wrapper\">\n      <h5>Total available</h5>\n      <TokenAmountPreview token={token} amount={total} />\n      <button className=\"button fullWidth\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n      <ConfirmDialog message={depositConfirmMessage} isOpen={isDialogOpen} closeFn={closeDialog} callback={dialogConfirmCallback} />\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId, id } = useParams();\n\n  const lockups = allLockups.filter((x) => {\n    if (id) {\n      return x.id.toString() === id;\n    }\n\n    return x.account_id === userId || x.id.toString() === userId;\n  });\n\n  const totalUnclaimedBalance = lockups.reduce((acc, obj) => acc + parseFloat(obj.unclaimed_balance), 0);\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n\n        {!adminControls && <ClaimAllLockups accountId={userId} token={token} total={convertAmount(totalUnclaimedBalance, token.decimals)} />}\n\n        <TableContainer sx={{ boxShadow: 'unset' }}>\n          <Table className=\"main-table\" aria-label=\"collapsible table\">\n            <TableHead className=\"table-head\">\n              <TableRow>\n                <TableCell />\n                <TableCell align=\"left\">ID</TableCell>\n                <TableCell align=\"left\">Account ID</TableCell>\n                <TableCell align=\"right\">Start&nbsp;date</TableCell>\n                <TableCell align=\"right\">End&nbsp;date</TableCell>\n                <TableCell align=\"right\">Terminatable</TableCell>\n                <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n                <TableCell align=\"center\">Progress</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {lockups.map((lockup) => (\n                <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n              ))}\n            </TableBody>\n          </Table>\n        </TableContainer>\n\n      </div>\n    </div>\n  );\n}\n","import { Link, NavLink, useLocation } from 'react-router-dom';\nimport { useContext, useEffect } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  useEffect(() => {\n    console.log(location.pathname);\n\n    return () => {};\n  }, [location]);\n\n  if (!near) return null;\n\n  const {\n    signedIn,\n    signedAccountId,\n    isAdmin,\n    isDraftOperator,\n    isCouncilMember,\n  } = near.currentUser;\n\n  const lockupsPageViewPolicy = adminControls && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          <div className=\"nav\">\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/lockups` : `/${currentContractName}/lockups`}>Lockups</NavLink>\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/draft_groups` : `/${currentContractName}/draft_groups`}>Lockup Drafts</NavLink>\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/about` : `/${currentContractName}/about`}>About</NavLink>\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span className=\"account-name\">\n                {signedAccountId}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return <div className=\"container login\">{children}</div>;\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n\n  const showAlertForUser = signedIn && !(isAdmin || isCouncilMember || isDraftOperator);\n  const showLockups = signedIn && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <Auth>\n      { showAlertForUser && <Alert sx={{ margin: 2, width: '500px' }} severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { showLockups && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PayForContractStorage() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const handlePay = () => {\n    const perform = async () => {\n      if (!near) {\n        return;\n      }\n      if (!near.tokenApi) {\n        return;\n      }\n      const bounds = await near.tokenApi.storageBalanceBounds();\n      const amount = bounds.max;\n\n      console.log(amount);\n      const result = await near.tokenApi.storageDeposit(near.lockupContractId, amount);\n      console.log(result);\n    };\n    perform();\n  };\n\n  return (\n    <div>\n      <div style={{ maxWidth: 640, margin: 'auto', paddingTop: 20 }}>\n        <p>\n          Please pay for the account storage in fungible token contract.\n          This is necessary to allow lockup contract to hold locked fungible token funds.\n          This is a one time payment for the lockup contract.\n          Additionally, all users claiming lockups will have to pay for the\n          storage for their account too.\n        </p>\n\n        <button className=\"button fullWidth\" type=\"button\" onClick={handlePay}>\n          Pay\n        </button>\n      </div>\n    </div>\n  );\n}\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport PayForContractStorage from '../PayForContractStorage';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n  if (!near) return null;\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n  const currentPathname = location.pathname;\n  const currentContractName = location.pathname.split('/')[1];\n  const currentPathWithoutContract = location.pathname.split(currentContractName)[1];\n  const draftGroupURL = currentPathWithoutContract.includes('/draft');\n\n  if (!signedIn || !(isAdmin || isCouncilMember || isDraftOperator)) {\n    if (draftGroupURL) {\n      return <Navigate to={currentPathname.replace(/\\/admin/, '')} replace />;\n    }\n    return <Navigate to={`/${currentContractName}/admin`} replace />;\n  }\n\n  if (!near.isContractFtStoragePaid) {\n    return (\n      <div className=\"container\">\n        <PayForContractStorage />\n      </div>\n    );\n  }\n\n  return children;\n}\n","import { Box, InputAdornment, TextField } from '@mui/material';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { ChangeEvent, useState } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { DEFAULT_CONTRACT_NAME } from '../../config';\n\nexport default function Homepage(\n  { lockups }: { lockups: any[] },\n) {\n  const [address, setAddress] = useState(DEFAULT_CONTRACT_NAME);\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n  };\n  const navigate = useNavigate();\n\n  const handleOpenLockupContract = () => {\n    const url = `/${address}/lockups`;\n    navigate(url);\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container home\">\n\n          <ul className=\"home-list\">\n            <li>\n              <div>\n                <span>Total contracts</span>\n                <b>256</b>\n              </div>\n            </li>\n            <li>\n              <div>\n                <span>Total locked</span>\n                <b>$5,336,000</b>\n              </div>\n            </li>\n            <li>\n              <div>\n                <span>Total lockups</span>\n                <b>{lockups?.length || 42}</b>\n              </div>\n            </li>\n          </ul>\n\n          <h2>Manage token vesting on NEAR</h2>\n          <p>Create new lockup contract to be used by startup</p>\n\n          <Link to=\"/new_lockup_contract\" className=\"button link-button\">Create Lockup Contract</Link>\n\n          <div className=\"line\" />\n\n          <div className=\"search-container\">\n            <TextField\n              variant=\"outlined\"\n              value={address}\n              onChange={handleChange}\n              className=\"input\"\n              placeholder=\"Enter existing Lockup contract address\"\n              InputProps={{\n                startAdornment: (\n                  <InputAdornment position=\"start\">\n                    <SearchIcon />\n                  </InputAdornment>\n                ),\n              }}\n            />\n            <button className=\"button\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\">\n              Search\n            </button>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","export default function NotFoundContract() {\n  return (\n    <div className=\"container\">\n      Contract not found\n    </div>\n  );\n}\n","import {\n  Link, useLocation,\n} from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nimport '../../styles/footer.scss';\n\nexport default function Footer() {\n  const location = useLocation();\n  const currentPathname = location.pathname;\n  const isAdminView = location.pathname.includes('admin');\n\n  const index = currentPathname.indexOf('/', 1);\n  const updatedPathname = `${currentPathname.substring(0, index)}/admin${currentPathname.substring(index, currentPathname.length)}`;\n\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  return (\n    <div className=\"footer\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to=\"/terms\">Terms</Link>\n            <Link className=\"nav-link\" to=\"/privacy\">Privacy</Link>\n            {isAdminView ? <Link className=\"nav-link\" to={currentPathname.replace(/\\/admin/, '')}>User view</Link>\n              : <Link className=\"nav-link\" to={updatedPathname}>Admin view</Link>}\n          </div>\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { useParams } from 'react-router-dom';\nimport { useContext, useEffect, useState } from 'react';\nimport DraftsTableRow from '../../components/DraftsTable/row';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PageDraft({\n  token, adminControls,\n}: { token: TMetadata, adminControls: boolean }) {\n  const draftId = parseInt(useParams().draftId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draft, setDraft] = useState<any>();\n\n  useEffect(() => {\n    const fetchDraft = async () => {\n      console.log('fetchDraft called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDrafts([draftId]);\n      const drafts = result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] }));\n      setDraft(drafts[0]);\n    };\n\n    fetchDraft(); // .catch(console.error);\n  }, [near, draftId]);\n\n  console.log(draft);\n\n  const progressShow = true;\n\n  return (\n    <div className=\"container\">\n      {draft && (\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell />\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"left\">Account ID</TableCell>\n            <TableCell align=\"right\">Start&nbsp;date</TableCell>\n            <TableCell align=\"right\">End&nbsp;date</TableCell>\n            <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n            {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <DraftsTableRow pageIndex={-1} row={draft} token={token} adminControls={adminControls} progressShow={progressShow} />\n        </TableBody>\n      </Table>\n      )}\n    </div>\n  );\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { txLinkInExplorer, nearTo } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport NewLockupContract from '../../pages/NewLockupContract';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\nimport Homepage from '../../pages/Homepage';\nimport NotFoundContract from '../../pages/NotFoundContract';\nimport Footer from '../Footer';\nimport PageDraft from '../../pages/PageDraft';\n\nfunction Customer({\n  lockups, token, contractId, near,\n}: {\n  lockups: any, token: TMetadata, contractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={contractId && near && <Lockups lockups={lockups} token={{ ...token, contractId }} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId/:id\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups\" element={<PageDraftGroupsIndex token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<PageDraftGroup token={token} adminControls={false} />} />\n        <Route path=\"/drafts/:draftId\" element={<PageDraft token={token} adminControls={false} />} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({\n  lockups, token, tokenContractId, near,\n}: {\n  lockups: any, token: TMetadata, tokenContractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  const showLockups = tokenContractId && near;\n\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={tokenContractId} />} />\n        <Route path=\"/lockups\" element={showLockups && <RequireAuth><Lockups lockups={lockups} token={{ ...token, contractId: tokenContractId }} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId/:id\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/drafts/:draftId\" element={<RequireAuth><PageDraft token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} adminControls /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    if (!enqueueSnackbar) return;\n    if (!near) return;\n    if (!token) return;\n    if (token.spec === '') {\n      return;\n    }\n\n    const perform = async () => {\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n\n      if (methodName === 'claim') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          if (unpacked !== '0') {\n            const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n            enqueueSnackbar(`Claimed ${amount} ${token.symbol}`, { variant: 'success' });\n            return;\n          }\n        }\n        enqueueSnackbar(`Claim failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      if (methodName === 'storage_deposit') {\n        const unpacked = JSON.parse(atob(successValue));\n        const amount = parseFloat(nearTo(unpacked.total, 9)).toString();\n        console.log(amount);\n        const accountId = args.account_id;\n        const message = `Successfully paid ${amount}N for FT storage of ${accountId}`;\n        enqueueSnackbar(message, { variant: 'success' });\n        return;\n      }\n\n      if (methodName === 'ft_transfer_call') {\n        const txMsg = JSON.parse(args.msg);\n        console.log(txMsg);\n        if (txMsg.schedule) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          const totalBalance = txMsg.schedule[txMsg.schedule.length - 1].balance;\n          if (totalBalance === unpacked) {\n            const statusMessage = `Created lockup for ${txMsg.account_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success' });\n            return;\n          }\n\n          const statusMessage = `Failed to create lockup for ${txMsg.account_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n        if (txMsg.draft_group_id !== null) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          if (unpacked !== '0') {\n            const statusMessage = `Funded draft group ${txMsg.draft_group_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success' });\n            return;\n          }\n          const statusMessage = `Failed to fund draft group ${txMsg.draft_group_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n\n        enqueueSnackbar(`Transaction performed, TODO ${txHash}!`, { variant: 'warning' });\n        return;\n      }\n\n      if (methodName === 'terminate') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          console.log(unpacked);\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          const message = `Terminated lockup #${args.lockup_index}, unvested amount: ${amount}`;\n          enqueueSnackbar(message, { variant: 'success' });\n          return;\n        }\n        enqueueSnackbar(`Terminate lockup failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      const message = `UNHANDLED Transaction \"${methodName}\" : ${txLinkInExplorer(txHash)}`;\n      enqueueSnackbar(message, { variant: 'warning' });\n    };\n\n    perform();\n  }, [enqueueSnackbar, near, token]);\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      if (near.tokenContractId) {\n        load();\n      }\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/\" element={<Homepage lockups={lockups} />} />\n        <Route path=\"/new_lockup_contract/\" element={<NewLockupContract />} />\n        <Route path=\"/:cid/*\" element={contractId && near && <Customer lockups={lockups} token={token} contractId={contractId} near={near} />} />\n        <Route path=\"/:cid/admin/*\" element={contractId && near && <Admin lockups={lockups} token={token} tokenContractId={contractId} near={near} />} />\n        <Route path=\"/:cid/not_found_contract/\" element={<NotFoundContract />} />\n        <Route path=\"*\" element={<NotFoundContract />} />\n      </Routes>\n      <Footer />\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport { SnackbarProvider, useSnackbar } from 'notistack';\nimport { IconButton } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\n\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nfunction SnackbarCloseButton(props: { snackbarKey: any }) {\n  const { snackbarKey } = props;\n  const { closeSnackbar } = useSnackbar();\n\n  return (\n    <IconButton onClick={() => closeSnackbar(snackbarKey)}>\n      <CloseIcon style={{ color: 'white' }} />\n    </IconButton>\n  );\n}\n\n/* eslint react/no-unstable-nested-components: \"off\" */\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    try {\n      connect();\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        currentUser: {\n          signedIn: false,\n          signedAccountId: null,\n          isAdmin: false,\n          isDraftOperator: false,\n          isCouncilMember: false,\n          daos: [],\n        },\n      });\n    },\n  }), [near]);\n\n  const handleClose = () => {\n    const url = new URL(window.location.href);\n    const sp = new URLSearchParams(url.search);\n    sp.delete('transactionHashes');\n    url.search = sp.toString();\n    window.history.pushState({}, null as any, url.toString());\n  };\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <SnackbarProvider\n          autoHideDuration={null}\n          action={(snackbarKey) => <SnackbarCloseButton snackbarKey={snackbarKey} />}\n          onClose={handleClose}\n        >\n          <App />\n        </SnackbarProvider>\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}