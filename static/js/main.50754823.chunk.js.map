{"version":3,"sources":["hooks/useLocalStorage.ts","config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/NoLoginTokenApi.ts","services/tokenApi.ts","services/factoryApi.ts","services/DAOs/astroDAO/api.ts","services/DAOs/astroDAO/utils.ts","services/near.ts","services/useTitle.ts","pages/About/index.tsx","components/TimestampDateDisplay/index.tsx","components/Chart/index.tsx","components/TokenIcon/index.tsx","components/TokenAmountDisplay/index.tsx","components/TimestampDisplay/index.tsx","components/ScheduleTable/index.tsx","services/scheduleHelpers.ts","services/chartHelpers.ts","components/Snackbars/Snackbar/index.tsx","components/Snackbars/SuccessPartials/index.tsx","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","services/spreadsheetImport.ts","components/TokenAmountPreview/index.tsx","components/Snackbars/FailurePartials/index.tsx","components/Snackbars/index.ts","components/ImportDraftGroup/index.tsx","components/FundButton/index.tsx","components/WithDao/DaoSelector/index.tsx","components/WithDao/DaoProposalDescription/index.tsx","components/FundWithDaoButton/index.tsx","components/DeleteDraftGroupButton/index.tsx","pages/PageDraftGroup/index.tsx","components/SuggestConvertDialog/index.tsx","services/SuggestContext.ts","pages/PageDraftGroupsIndex/index.tsx","components/AddRemoveInput/index.tsx","pages/NewLockupContract/index.tsx","components/UTCDateTimePicker/index.tsx","components/CreateLockup/index.tsx","components/TerminateModal/index.tsx","components/TerminateLockup/index.tsx","components/TerminateWithDaoButton/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","components/FavouriteAccounts/index.tsx","pages/Lockups/index.tsx","components/ConfirmDialog/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/PayForContractStorage/index.tsx","components/RequireAuth/index.tsx","pages/Homepage/index.tsx","pages/NotFoundContract/index.tsx","components/Footer/index.tsx","pages/PageDraft/index.tsx","pages/Terms/index.tsx","pages/Privacy/index.tsx","components/Snackbars/WarningPartials/index.tsx","services/transactionResultParser.ts","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["useLocalStorage","key","defaultValue","useState","value","localStorage","getItem","JSON","parse","getStorageValue","setValue","useEffect","setItem","stringify","FACTORY_CONTRACT_NAME","process","CONTRACT_NAME","contractNameFromUrl","window","location","hash","split","getCurrentContractName","console","log","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","factoryContractName","Error","getConfig","MAX_GAS","Big","DP","PE","pseudoUtcIsoDateTime","unixSeconds","formatted","date","Date","pad","input","width","toString","padStart","year","getUTCFullYear","month","getUTCMonth","monthDay","getUTCDate","pseudoUtcIsoDate","hours","getUTCHours","minutes","getUTCMinutes","seconds","getUTCSeconds","pseudoUtcIsoTime","nearTo","digits","mode","div","toFixed","undefined","formatTokenAmount","tokenDecimals","roundDown","addYear","setUTCFullYear","getTime","startOfDay","msInDay","Math","floor","addDays","days","dumpLocalStorage","dumpKey","dumpValue","Object","keys","map","restoreLocalStorage","data","clear","forEach","record","toCompactString","string","leftPad","rightPad","length","slice","txLinkInExplorer","txHash","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","args","gas","convert_drafts","draft_ids","draftGroupId","discard_draft_group","draft_group_id","draftIds","delete_drafts","lockupIndex","timestamp","terminate","lockup_index","termination_timestamp","amount","get_token_account_id","get_deposit_whitelist","get_draft_operators_whitelist","get_lockups_paged","then","response","successUrl","href","requestSignIn","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","total","parseFloat","utils","format","formatNearAmount","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","lockupIds","amounts","x","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","NoLoginTokenApi","tokenAccountId","storage_deposit","TokenApi","contractId","lockupContractId","lockupTotalAmount","userAccountId","lockupSchedule","vestingSchedule","ftTransferCall","receiver_id","msg","schedule","vesting_schedule","Schedule","try_convert","meta","deposit","rest","ft_transfer_call","ft_metadata","storage_balance_of","storage_balance_bounds","DEPLOY_DEPOSIT","mul","pow","FACTORY_CHANGE_METHODS","FactoryApi","name","depositWhitelist","draftOperatorsWhitelist","callbackUrl","argsRaw","token_account_id","deposit_whitelist","draft_operators_whitelist","argsPacked","create","init_function","init_args","FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS","DAO_VIEW_METHODS","AstroDaoApi","get_policy","policy","canProposalRoles","roles","role","permissions","includes","canProposalGroups","kind","Group","flat","member","buildProposalFormLink","contractAddress","action","variant","details","smartContractAddress","methodName","json","actionsGas","actionDeposit","params","customFunctionCallProposalFormLink","daoCouncilMembers","accountAddress","api","getCouncilMembers","councilsMembers","buildFundDraftGroupProposalLink","description","lockupContractAddress","tokenContractAddress","amountValue","draftGroupIndex","daoContractAddress","encodeURIComponent","ONE_YOKTO","buildTerminateLockupProposalLink","NearContext","createContext","connectNear","some","configTemplate","nearAPI","BrowserLocalStorageKeyStore","headers","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","noLoginTokenApi","signedAccountId","tokenContractId","isAdmin","isDraftOperator","daos","lockupContractFound","getTokenAccountId","getDepositWhitelist","getDraftOperatorsWhitelist","dcm","Promise","all","dwID","daosCouncilMembers","userDaosCouncils","daoCMs","values","pop","type","tokenApi","isContractFtStoragePaid","storageBalanceOf","storageBalance","factoryApi","rpcProvider","JsonRpcProvider","currentUser","signedIn","isCouncilMember","lockupContractNone","suggestConvertDialog","open","setOpen","DEFAULT_USE_TITLE_OPTIONS","restoreOnUnmount","document","title","options","prevTitle","About","useTitle","className","Box","sx","display","to","src","alt","TimestampDateDisplay","props","formattedWithTime","Chart","xMax","yMax","xMin","min","unlocked","vested","computedMin","computedMax","formatNumber","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","option","useUTC","text","top","left","textStyle","fontWeight","fontFamily","fontSize","color","opacity","tooltip","trigger","axisPointer","legend","bottom","selectedMode","icon","grid","right","containLabel","xAxis","boundaryGap","splitNumber","max","yAxis","series","valueFormatter","showSymbol","areaStyle","markLine","lineStyle","symbol","claimed","style","borderRadius","TokenIcon","url","size","height","verticalAlign","TokenAmountDisplay","token","decimals","TimestampDisplay","ScheduleTable","Table","TableHead","TableRow","TableCell","align","TableBody","scope","defaultProps","interpolate","checkpoint0","checkpoint1","x0","y0","x1","y1","xM","add","sub","interpolateRaw","interpolateAtY","yM","lt","gte","parseInt","roundUp","interpolateRawAtY","interpolateSchedule","i","sumSchedules","schedules","timestamps","Array","from","Set","sort","y","plus","push","terminateScheduleAtAmount","finishTimestamp","eq","finishCheckpoint","calcBalancesRaw","row","now","totalBalanceRaw","claimedBalanceRaw","claimed_balance","unclaimedBalanceRaw","vestedBalanceFullRaw","termination_config","vestedBalanceRaw","unvestedBalanceRaw","unclaimed","unvested","shatterSchedule","extraTimestamps","presentTimestamps","chartData","lockupsList","startTime","lockupSchedules","round","minTimestampsLockup","minTimestampsVesting","minTimestamp","vestingSchedules","sumVesting","sumLockup","convertSchedule","s","totalClaimed","reduce","acc","sumClaimed","existingCheckpoints","flatMap","realMinTimestamp","maxTimestamp","dailyCheckpoints","allCheckpoints","finishTime","useStyles","makeStyles","root","maxWidth","minHeight","boxShadow","simpleRoot","card","padding","simpleCard","actionRoot","marginBottom","justifyContent","simplaActionRoot","typography1","icons","marginLeft","expand","transition","collapse","backgroundColor","Snackbar","forwardRef","ref","classes","closeSnackbar","useSnackbar","handleDismiss","useCallback","body","Card","CardActions","header","IconButton","onClick","Paper","anchorOrigin","vertical","horizontal","enqueueCustomSnackbar","hook","content","success","typography","Typography","DraftsTableRow","useLocation","opened","pageIndex","adminControls","progressShow","enqueueSnackbar","useContext","colSpan","message","currentContractName","pathname","selectedDraftId","draftPage","importDraftPage","balancesRaw","origin","onCopy","autoHideDuration","Tooltip","placement","arrow","Collapse","in","timeout","unmountOnExit","DraftsTable","lockups","lockup","BN","prototype","toJSON","prefixErrorWith","prefix","callback","e","parseSpreadsheetColumns","lines","trim","table","line","columns","fromEntries","col","colIdx","parseDuration","pattern","match","groups","week","day","hour","minute","second","parseCliffInfo","parts","durationRaw","percentageRaw","duration","percentage","parsePercentage","parseHumanFriendlySchedule","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","allowedKeys","isValid","parseValidAccountId","parseTokenAmount","lockup_schedule","datePlusDurationMul","mulInput","UTC","toUnix","toLockupSchedule","inputTotalAmount","decimalsMultiplier","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","cliffAmount","muln","divn","clone","gt","tmCliff","tmFirstStep","cpStart","cpPreCliff","cpCliff","cpFinish","unshift","tms","tm","increment","cps","stepBalance","cpsStart","concat","parseLockup","rawSpreadsheetRow","vestingSchedulePacked","f","checkpoint","lockupBalance","vestingBalance","lte","assertValidTerminationSchedule","TokenAmountPreview","failure","transactionLink","button","textTransform","Button","event","preventDefault","SUCCESS_DEFAULT_OPTIONS","parseAmount","unpacked","claimSnack","storageDepositSnack","createLockupSnack","txMsg","fundDraftGroupSnack","terminateLockupSnack","deleteDraftGroupSnack","positive","negative","discardDraftGroupSnack","ImportDraftGroup","setData","parseErrors","setParseErrors","importProgress","setImportProgress","navigate","useNavigate","withNotification","func","handleClickImport","accountIds","createDraftGroup","chunkSize","chunk","lockup_create","createDrafts","path","balances","calcTotalBalance","TextareaAutosize","placeholder","minRows","maxRows","onChange","target","spreadsheetInput","errorsFiltered","LoadingButton","disabled","loading","FundButton","fundDraftGroup","getContract","DaoSelector","selectedAddress","setSelectedAddress","handleSelectedDaoAddressChange","InputLabel","Select","required","dao","MenuItem","TextField","margin","label","DaoProposalDescription","proposalDescription","setProposalDescription","multiline","FundWithDaoButton","formattedAmount","defaultDescription","replace","setDescription","astroDAOContractAddress","setAstroDAOContractAddress","handleClose","Dialog","minWidth","onClose","onSubmit","link","focus","DialogTitle","position","DialogContent","paddingTop","DialogActions","DeleteDraftGroupButton","inProgress","setInProgress","perform","discardNotificationMessage","discardDraftGroup","deleteNotificationMessage","deleteDrafts","reload","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","isConverted","setIsConverted","searchParams","URLSearchParams","search","transactionHashesRaw","get","txStatus","transaction","actions","FunctionCall","method_name","successValue","status","SuccessValue","atob","msgDraftGroupId","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","discarded","total_amount","funded","convertDrafts","marginTop","Alert","severity","SuggestConvertDialog","performConvert","convertAndClose","DialogContentText","SuggestContext","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","importDraftGroupPath","candidateForConvert","reverse","find","suggestContext","group","AddRemoveInput","accountIdCheck","accountStatuses","initState","accountName","inputFields","setInputFields","addInputField","rows","handleChange","list","inputField","number","splice","removeInputFields","NewLockupContract","signIn","reSignIn","shouldClearState","setShouldClearState","setTokenAccountId","setName","lockupOperators","setLockupOperators","draftOperators","setDraftOperators","PENDING","FOUND","NOT_FOUND","subAccountPattern","nameWithFactoryContractName","setAccountStatuses","enqueueAccountIdCheck","validateAccountExists","allUniqueAccountIds","lockupOperatorsMissing","draftOperatorsMissing","lockupSubaccountId","elements","lockup_subaccount_id","array","UTCDateTimePicker","minTime","offsetMs","getTimezoneOffset","DateTimePicker","minDateTime","newValue","ampm","renderInput","fullWidth","inputProps","inputFormat","CreateLockup","startDate","setStartDate","setSchedule","setAccountId","setAmount","handleCreateLockup","balanceInput","selected","getScheduleList","createLockup","validAmount","FormControl","handleChangeAccountId","helperText","InputProps","endAdornment","InputAdornment","LocalizationProvider","dateAdapter","AdapterDateFns","TerminateModal","currentState","handlers","dialog","dateTimePicker","terminationMode","setTerminationMode","terminationTimestamp","vestedAmount","trimmedLockupSchedule","trimmedVestingSchedule","terminateSchedule","trimmedLockup","lineHeight","RadioGroup","_event","FormControlLabel","control","Radio","daoSelector","daoProposalDescription","TerminateLockup","buttonText","setDate","handleTerminateLockup","ts","canTerminate","modalProps","TerminateWithDaoButton","uri","URL","beneficiary_id","Row","hasBeenOpen","setHasBeenOpen","payerMessage","selectedAccountPage","selectedLockupId","claimedAmount","availbleAmount","unvestedAmount","terminator","terminatorId","total_balance","LockupsTable","FavouriteAccounts","favouriteAccounts","uniqueUsers","onSave","inputRef","useRef","parseAccounts","replaceAll","handleSaveFavouriteAccounts","localStorageValue","current","newFavouriteAccounts","join","onKeyPress","realAccouns","Lockups","storedData","favouriteAccountsFromLocalStorage","setFavouriteAccounts","favouriteAccountsLockups","lockupsPage","TableContainer","ConfirmDialog","isOpen","closeFn","ClaimAllLockups","obj","unclaimed_balance","isDialogOpen","setIsDialogOpen","dialogConfirmCallback","setDialogConfirmCallback","depositConfirmMessage","claimSpecificLockups","storageBalanceBounds","bounds","storageDeposit","UserLockups","allLockups","userId","Claim","Header","lockupsPageViewPolicy","Auth","children","Authorize","showAlertForUser","showLockups","PayForContractStorage","textAlign","RequireAuth","currentPathname","draftGroupURL","Homepage","address","setAddress","setError","handleOpenLockupContract","startAdornment","NotFoundContract","Footer","isAdminView","showSwitch","indexOf","updatedPathname","substring","startsWith","viewSwitchLink","PageDraft","draftId","setDraft","fetchDraft","Terms","Privacy","warning","parseTxResultUrl","resultUrl","fetchTxStatus","fetch","method","Customer","element","Admin","App","contractState","setContractState","setContractId","reference","reference_hash","spec","setToken","isInteger","active","load","loadAllLockups","ftMetadata","metadata","SnackbarCloseButton","snackbarKey","NearApp","setNear","nearConn","connect","useMemo","suggestOpen","setSuggestOpen","suggestValue","Provider","sp","delete","history","pushState","maxSnack","render","getElementById"],"mappings":"iXAoBeA,MAVf,SAAyBC,EAAaC,GACpC,MAA0BC,oBAAS,kBATrC,SAAyBF,EAAaC,GACpC,IAAME,EAAQC,aAAaC,QAAQL,GACnC,OAAIG,EACKG,KAAKC,MAAMJ,GAEbF,EAIkCO,CAAgBR,EAAKC,MAA9D,mBAAOE,EAAP,KAAcM,EAAd,KAMA,OAJAC,qBAAU,WACRN,aAAaO,QAAQX,EAAKM,KAAKM,UAAUT,MACxC,CAACH,EAAKG,IAEF,CAACA,EAAOM,I,iBCNJI,EAAwBC,+BAUxBC,EAPkB,WAC7B,IAAMC,EAAsBC,OAAOC,SAASC,KAAKC,MAAM,KAAK,GAC5D,MAA4B,wBAAxBJ,EAAsDH,EAEnDG,EAGoBK,GAE7BC,QAAQC,IAAIR,GA0EL,IAAMS,EAvEb,WACE,IAAMC,EAAMX,uUAAYY,uBAAyB,cACjD,OAAQD,GACN,IAAK,aACL,IAAK,UACH,MAAO,CACLE,UAAW,UACXC,QAAS,+BACTC,aAAcd,EACde,UAAW,0BACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBpB,GAEzB,IAAK,cACL,IAAK,UACH,MAAO,CACLc,UAAW,UACXC,QAAS,+BACTC,aAAcd,EACde,UAAW,kCACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBpB,GAEzB,IAAK,UACH,MAAO,CACLc,UAAW,UACXC,QAAS,+BACTC,aAAcd,EACde,UAAW,kCACXC,UAAW,kCACXC,YAAa,oCACbC,oBAAqBpB,GAEzB,IAAK,QACH,MAAO,CACLmB,YAAa,GACbD,UAAW,GACXJ,UAAW,QACXC,QAAS,wBACTE,UAAW,+BACXD,aAAcd,EACdkB,oBAAqBpB,GAEzB,IAAK,OACL,IAAK,KACH,MAAO,CACLmB,YAAa,GACbD,UAAW,GACXD,UAAW,GACXH,UAAW,cACXC,QAAS,kCACTC,aAAcd,EACdkB,oBAAqBpB,GAEzB,IAAK,aACH,MAAO,CACLmB,YAAa,GACbD,UAAW,GACXD,UAAW,GACXH,UAAW,sBACXC,QAAS,kCACTC,aAAcd,EACdkB,oBAAqBpB,GAEzB,QACE,MAAMqB,MAAM,6BAAD,OAA8BT,EAA9B,4CAIKU,GC9FTC,EAAU,KAGvBC,IAAIC,GAAK,GACTD,IAAIE,GAAK,GACF,IA4BMC,EAAuB,SAACC,GACnC,IAAMC,EAAS,UA3Be,SAACD,GAC/B,IAAME,EAAO,IAAIC,KAAmB,IAAdH,GAChBI,EAAM,SAACC,EAAwBC,GAAzB,OAA2CD,EAAME,WAAWC,SAASF,EAAO,MAElFG,EAAOL,EAAIF,EAAKQ,iBAAkB,GAClCC,EAAQP,EAAIF,EAAKU,cAAgB,EAAG,GACpCC,EAAWT,EAAIF,EAAKY,aAAc,GAIxC,MAFe,UAAML,EAAN,YAAcE,EAAd,YAAuBE,GAmBjBE,CAAiBf,GAAvB,YAde,SAACA,GAC/B,IAAME,EAAO,IAAIC,KAAmB,IAAdH,GAChBI,EAAM,SAACC,EAAwBC,GAAzB,OAA2CD,EAAME,WAAWC,SAASF,EAAO,MAElFU,EAAQZ,EAAIF,EAAKe,cAAe,GAChCC,EAAUd,EAAIF,EAAKiB,gBAAiB,GACpCC,EAAUhB,EAAIF,EAAKmB,gBAAiB,GAI1C,MAFe,UAAML,EAAN,YAAeE,EAAf,YAA0BE,GAMaE,CAAiBtB,IAEvE,OAAOC,GAIIsB,EAAS,SAAC7D,GAAuE,IAA3D8D,EAA0D,uDAnC5D,EAmC8BC,EAA8B,uCAG3F,OADA7B,IAAIC,GAAK,GACFD,IAAIlC,GAAS,KAAKgE,IAAlB,SAAsB,GAAM,KAAIC,QAAmB,IAAXH,OAAeI,EAAYJ,EAAQC,IAcvEI,EAAoB,SAACnE,EAAeoE,GAAhB,OAA0C,IAAIlC,IAAIlC,GAAOgE,IAAf,SAAmB,GAAMI,IAAeH,QApDlF,EAoD6G/B,IAAImC,YAErIC,EAAU,SAAC9B,EAAYO,GAAb,OAA8B,IAAIN,KAAK,IAAIA,KAAKD,GAAM+B,eAAgB/B,EAAKQ,iBAAoBD,IAAOyB,UAAY,KAC5HC,EAAa,SAACjC,GACzB,IAAMkC,EAAU,MAGhB,OAFe,IAAIjC,KAAKkC,KAAKC,MAAMpC,EAAKgC,UAAYE,GAAWA,IAIpDG,EAAU,SAACrC,EAAYsC,GAIlC,OAFe,IAAIrC,KAAKD,EAAKgC,UADb,MACmCM,IAKxCC,EAAmB,WAA+B,IAA9BC,EAA6B,uDAAX,OAC3CC,EAAYC,OAAOC,KAAKlF,cAAcmF,KAAI,SAACvF,GAAD,MAAS,CAACA,EAAKI,aAAaC,QAAQL,OAEpFI,aAAaO,QAAQwE,EAAS7E,KAAKM,UAAUwE,KAGlCI,EAAsB,WAA+B,IAA9BL,EAA6B,uDAAX,OAC9CM,EAAOrF,aAAaC,QAAQ8E,GAElC,GAAKM,EAAL,CAIA,IAAML,EAAY9E,KAAKC,MAAMkF,GAE7BrF,aAAasF,QAEbN,EAAUO,SAAQ,SAACC,GAAD,OAAqBxF,aAAaO,QAAQiF,EAAO,GAAIA,EAAO,SAGnEC,EAAkB,SAACC,GAAiE,IAAjDC,EAAgD,uDAA9B,GAAIC,EAA0B,uDAAP,GACvF,OAAIF,EAAOG,OAAS,GACZ,GAAN,OAAUH,EAAOI,MAAM,EAAGH,GAA1B,cAAwCD,EAAOI,OAAOF,IAEjDF,GAGIK,EAAmB,SAACC,GAAD,gBAAuB5E,EAAOQ,YAA9B,yBAA0DoE,I,wBC/FpFC,EAAsB,CAC1B,kBACA,yBACA,aACA,oBACA,uBACA,wBACA,iCAGIC,EAAwB,CAC5B,eACA,gBACA,qBACA,gBACA,iBACA,YACA,sBACA,iBA6EIC,E,WAOJ,WAAYC,GAAa,yBANjBA,UAMgB,OAJhBC,cAIgB,OAFhBC,sBAEgB,EACtBC,KAAKH,KAAOA,EACZG,KAAKD,iBAAmB,IAAIE,mBAAiBJ,EAAMA,EAAKhF,OAAOK,cAC/D8E,KAAKF,SAAW,IAAII,WAClBF,KAAKD,iBAAiBI,UACtBH,KAAKH,KAAKhF,OAAOK,aACjB,CAAEkF,YAAaV,EAAqBW,cAAeV,I,4FAIvD,4BAAAW,EAAA,sEACuBN,KAAKF,SAASS,yBADrC,cACQC,EADR,yBAESA,EAAO5B,KAAI,mCAAE6B,EAAF,KAAcC,EAAd,YAAqChC,OAAOiC,OAAOD,EAAO,CAAEE,GAAIH,QAFpF,gD,wHAKA,WAAoBI,GAApB,eAAAP,EAAA,sEACuBN,KAAKF,SAASgB,gBAAgB,CAAED,UADvD,cACQL,EADR,UAGIA,EAAOI,GAAKC,GAHhB,kBAMSL,GANT,gD,qHASA,WAAgBO,GAAhB,eAAAT,EAAA,sEACuBN,KAAKF,SAASkB,WAAW,CAAED,YADlD,cACQP,EADR,yBAGSA,GAHT,gD,4HAMA,4BAAAF,EAAA,sEACuBN,KAAKF,SAASmB,qBADrC,cACQT,EADR,yBAESA,GAFT,gD,sHAKA,WAAkBE,GAAlB,eAAAJ,EAAA,sEACuBN,KAAKF,SAASoB,aAAa,CAAER,UADpD,cACQF,EADR,yBAGSA,GAHT,gD,wHAMA,WAAmBW,GAAnB,eAAAb,EAAA,sEACuBN,KAAKF,SAASsB,cAAc,CAAEC,KAAM,CAAEF,UAAUG,IAAK,oBAD5E,cACQd,EADR,yBAGSA,GAHT,gD,yHAMA,WAAoBO,GAApB,eAAAT,EAAA,sEACuBN,KAAKF,SAASyB,eAAe,CAAEF,KAAM,CAAEG,UAAWT,GAAWO,IAAK,oBADzF,cACQd,EADR,yBAGSA,GAHT,gD,6HAMA,WAAwBiB,GAAxB,eAAAnB,EAAA,sEACuBN,KAAKF,SAAS4B,oBAAoB,CAAEL,KAAM,CAAEM,eAAgBF,KADnF,cACQjB,EADR,yBAGSA,GAHT,gD,wHAMA,WAAmBoB,GAAnB,eAAAtB,EAAA,sEACuBN,KAAKF,SAAS+B,cAAc,CAAER,KAAM,CAAEG,UAAWI,KADxE,cACQpB,EADR,yBAGSA,GAHT,gD,qHAMA,WAAgBsB,EAAqBC,GAArC,eAAAzB,EAAA,+EAEyBN,KAAKF,SAASkC,UAAU,CAC3CX,KAAM,CAAEY,aAAcH,EAAaI,sBAAuBH,GAC1DT,IAAK7F,EACL0G,ODhLiB,IC2KvB,cAEU3B,EAFV,yBAOWA,GAPX,sCASI7F,QAAQC,IAAR,MACMW,MAAM,2BAVhB,yD,8EAcA,WACE,OAAOyE,KAAKH,O,iCAGd,WACE,OAAOG,KAAKD,mB,yBAGd,WACE,OAAOC,KAAKF,W,+BAGd,WACE,OAAQE,KAAKF,SAA6BsC,yB,iCAG5C,WACE,OAAQpC,KAAKF,SAA6BuC,0B,wCAG5C,WACE,OAAOrC,KAAKF,SAASwC,kC,4BAGvB,WACE,OAAQtC,KAAKF,SAA6ByC,oBAAoBC,MAC5D,SAACC,GAAD,OAAmBA,EAAS7D,KAAI,mCAAEgC,EAAF,KAAM9B,EAAN,YAA+BJ,OAAOiC,OAAO7B,EAAM,CAAE8B,e,oBAIzF,WACE,IAAM8B,EAAU,UAAMpI,OAAOC,SAASoI,MAChCzH,EAAiD,yBAAlC8E,KAAKH,KAAKhF,OAAOK,aAClC8E,KAAKH,KAAKhF,OAAOK,aACjB8E,KAAKH,KAAKhF,OAAOS,oBACrB0E,KAAKD,iBAAiB6C,cAAc1H,OAAcwC,EAAWgF,K,qBAG/D,WACE1C,KAAKD,iBAAiB8C,UACtB7C,KAAKH,KAAKhF,OAAOiI,SAAS/D,U,4BAG5B,WACE,OAAOiB,KAAKD,iBAAiBgD,iB,4DAG/B,WAAcC,GAAd,SAAA1C,EAAA,+EACSN,KAAKH,KAAKM,QAAQ6C,IAD3B,gD,uHAIA,WAAkBA,GAAlB,mBAAA1C,EAAA,sEACwBN,KAAKG,QAAQ6C,GADrC,cACQ7C,EADR,OAEM8C,EAAU,KAFhB,kBAIoB9C,EAAQ+C,oBAJ5B,OAIUC,EAJV,OA3OuBhB,EAgPAgB,EAAEC,MAArBH,EAhP8CI,WAAWC,QAAMC,OAAOC,iBAAiBrB,GAAU,MA2OrG,kDAOIxH,QAAQ8I,MAAM,qBAPlB,iCASSR,GATT,kCA3OsB,IAACd,IA2OvB,qB,8DAaavC,I,0BC7PT8D,EAAqB,uCAAG,WAAOC,EAAeC,GAAtB,mBAAAtD,EAAA,sEACAqD,EAASE,MAAM,CACzCC,aAAc,uBACdC,WAAYH,EACZI,SAAU,eAJgB,UACtBC,EADsB,iBAOvBA,EAActF,YAPS,OAOvB,EAAoBW,OAPG,sBAQpB/D,MAAM,mCARc,kBAWtB2I,EAAoBD,EAActF,KAAKwF,QAAO,SAAC9K,GAAD,cAAsD,kBAAvC,OAAOA,QAAP,IAAOA,GAAP,UAAOA,EAAK+K,kBAAZ,aAAO,EAAiBC,aAA4D,gBAA7B,OAAHhL,QAAG,IAAHA,GAAA,UAAAA,EAAK+K,kBAAL,eAAiBC,sBAX5G,IAavBH,KAAmB5E,OAbI,sBAcpB/D,MAAM,wCAdc,gCAiBrB2I,EAAkB,IAjBG,2CAAH,wDAoBZR,ICdThE,EAAsB,CAAC,IACvBC,EAAwB,CAAC,SAQzB2E,E,WAGJ,WAAYzE,GAAa,yBAFjBA,UAEgB,EACtBG,KAAKH,KAAOA,E,gFAGd,WAAY+D,GAAZ,SAAAtD,EAAA,6DACE/B,IADF,SAGQyB,KAAKuE,6BAA6BX,GAH1C,uBAKQ5D,KAAKwE,gBAAgBC,MAAM,GAAIhJ,GALvC,OAOEuE,KAAKH,KAAKhF,OAAOiI,SAAS4B,QAP5B,gD,gIAUA,WAA2Bd,EAAmBe,GAA9C,SAAArE,EAAA,6DACE/B,IADF,SAGQyB,KAAKuE,6BAA6BX,GAH1C,uBAKQ5D,KAAKwE,gBAAgBC,MAAM,CAAEG,QAASD,EAAU/F,KAAI,SAACiG,GAAD,MAAO,CAACA,EAAG,UAAUpJ,GALjF,OAOEuE,KAAKH,KAAKhF,OAAOiI,SAAS4B,QAP5B,gD,0IAUA,WACEd,GADF,6BAAAtD,EAAA,6DAEEpF,EAFF,+BAEyB8E,KAAKH,KAAKhF,OAAOK,aAF1C,SAImCwI,EAC/B1D,KAAKH,KAAKiF,WAAWnB,SACrBC,GANJ,OAIQmB,EAJR,OASEtL,aAAaO,QAAb,UACKkB,EADL,oBAEEvB,KAAKM,UAAU,CAAE2J,YAAWoB,QAAS,CAACD,EAAmBE,eAX7D,gD,kFAeA,WACE,OAAO,IAAI/E,WACR,IAAID,mBAAiBD,KAAKH,KAAMG,KAAKH,KAAKhF,OAAOK,cAAeiF,UACjEH,KAAKH,KAAKhF,OAAOK,aACjB,CAAEkF,YAAaV,EAAqBW,cAAeV,Q,KAK1C2E,IC5DTY,EAAqB,CAAC,IACtBC,EAAuB,CAAC,mBAQxBC,E,WAGJ,WAAYvF,GAAa,yBAFjBA,UAEgB,EACtBG,KAAKH,KAAOA,E,yFAGd,WAAqBwF,EAAwBzB,EAAmBzB,GAAhE,SAAA7B,EAAA,6DACE/B,IADF,SAGQyB,KAAKuE,6BAA6BX,GAH1C,uBAKQ5D,KAAKwE,cAAca,GAAgBC,gBAAgB,CACvDjE,KAAM,CAAE0C,WAAYH,GACpBtC,IAAK7F,EACL0G,WARJ,OAWEnC,KAAKH,KAAKhF,OAAOiI,SAAS4B,QAX5B,gD,4IAcA,WACEd,GADF,6BAAAtD,EAAA,6DAEEpF,EAFF,+BAEyB8E,KAAKH,KAAKhF,OAAOK,aAF1C,SAImCwI,EAC/B1D,KAAKH,KAAKiF,WAAWnB,SACrBC,GANJ,OAIQmB,EAJR,OASEtL,aAAaO,QAAb,UACKkB,EADL,oBAEEvB,KAAKM,UAAU,CAAE2J,YAAWoB,QAAS,CAACD,EAAmBE,eAX7D,gD,kFAeA,SAAc/J,GACZ,OAAO,IAAIgF,WACR,IAAID,mBAAiBD,KAAKH,KAAMG,KAAKH,KAAKhF,OAAOK,cAAeiF,UACjEjF,EACA,CAAEkF,YAAa8E,EAAoB7E,cAAe8E,Q,KAKzCC,I,oBCtDT3J,GAAU,KAGVyJ,GAAqB,CACzB,cACA,qBACA,0BAGIC,GAAuB,CAC3B,mBACA,mBAqCII,G,WAGJ,WAAYxF,EAAoCyF,GAAqB,yBAF7D1F,cAE4D,EAClEE,KAAKF,SAAW,IAAII,WAClBH,EAAiBI,UACjBqF,EACA,CAAEpF,YAAa8E,GAAoB7E,cAAe8E,K,+CAItD,WACE,OAAOnF,KAAKF,W,iEAGd,WACE2F,EACAC,EACAC,EACAC,EACAC,GALF,eAAAvF,EAAA,sEAOuBN,KAAK8F,eAAe,CACvCC,YAAaN,EACbtD,OAAQuD,EAAkBrJ,WAC1B2J,IAAK,CACHjC,WAAY4B,EACZM,SAAUL,EACVM,iBAAkBL,EAAkB,CAAEM,SAAUN,GAAoB,QAb1E,cAOQrF,EAPR,yBAiBSA,GAjBT,gD,kIAoBA,WAAqBiF,EAA0BhE,EAAsBU,GAArE,eAAA7B,EAAA,sEACuBN,KAAK8F,eAAe,CACvCC,YAAaN,EACbtD,SACA6D,IAAK,CACHrE,eAAgBF,EAChB2E,YNnFmB,QM6EzB,cACQ5F,EADR,yBAUSA,GAVT,gD,8HAaA,WACE6F,GADF,iCAAA/F,EAAA,6DAMEgB,EANF,+BAMQ7F,GACN6K,EAPF,+BA/FgB,EAwGNN,EAAiBK,EAAjBL,IAAQO,EATlB,YAS2BF,EAT3B,aAWQrG,KAAKF,SAAS0G,iBAAd,aACFR,IAAKrM,KAAKM,UAAU+L,IAASO,GAC/BjF,EACAgF,GAdJ,gD,mFAkBA,SAAe1C,EAAmBzB,GAChC,OAAOnC,KAAKF,SAASwF,gBAAgB,CACnCjE,KAAM,CAAE0C,WAAYH,GACpBtC,IAAK7F,GACL0G,a,wBAIJ,WACE,OAAOnC,KAAKF,SAAS2G,YAAY,M,8BAGnC,SAAiB7C,GACf,OAAO5D,KAAKF,SAAS4G,mBAAmB,CAAE3C,WAAYH,M,kCAGxD,WACE,OAAO5D,KAAKF,SAAS6G,6B,KAIVpB,MCtITqB,GAAiB,IAAIlL,IAAI,IAAImL,IAAI,IAAInL,IAAI,IAAIoL,IAAI,KAAKzK,WAEtD0K,GAAyB,CAC7B,UAcIC,G,WAGJ,WAAYjH,EAAoCyF,GAAqB,yBAF7D1F,cAE4D,EAClEE,KAAKF,SAAW,IAAII,WAClBH,EAAiBI,UACjBqF,EACA,CAAEpF,YAAa,GAAIC,cAAe0G,K,+CAItC,WACE,OAAO/G,KAAKF,W,2DAGd,WACEmH,EACA5B,EACA6B,EACAC,EACAC,GALF,mBAAA9G,EAAA,6DAOQ+G,EAAU,CACdC,iBAAkBjC,EAClBkC,kBAAmBL,EACnBM,0BAA2BL,GAEvBM,EAAa9N,KAAKM,UAAUoN,GAZpC,SAauBrH,KAAKF,SAAS4H,OAAO,CACxCrG,KAAM,CACJ4F,OACAU,cAAe,MACfC,UAAWH,GAEbL,cACA9F,IArDU,KAsDVa,OAAQyE,KArBZ,cAaQpG,EAbR,OAwBE7F,QAAQC,IAAI4F,GAxBd,kBA0BSA,GA1BT,gD,sEA8BawG,M,SCjETa,GAA4C,CAAC,mBAAoB,iBAEjEC,GAAmB,CACvB,cASIC,G,WAGJ,WAAYhI,EAAoCyF,GAAqB,yBAF7D1F,cAE4D,EAClEE,KAAKF,SAAW,IAAII,WAClBH,EAAiBI,UACjBqF,EACA,CAAEpF,YAAa0H,GAAkBzH,cAAe,K,+CAIpD,WACE,OAAOL,KAAKF,W,sEAGd,gCAAAQ,EAAA,sEACuBN,KAAKF,SAASkI,aADrC,UACQC,EADR,OAMkC,KAJ1BC,EAAmBD,EAAOE,MAAMhE,QACpC,SAACiE,GAAD,eAAmB,OAAJA,QAAI,IAAJA,GAAA,UAAAA,EAAMC,mBAAN,eAAmBC,SAAST,GAA0C,OAAtE,OAA6EO,QAA7E,IAA6EA,GAA7E,UAA6EA,EAAMC,mBAAnF,aAA6E,EAAmBC,SAAST,GAA0C,SAG/IvI,OANvB,yCAOW,IAPX,cAUQiJ,EAAoBL,EAAiBtJ,KAAI,SAACwJ,GAAD,oBAAeA,QAAf,IAAeA,GAAf,UAAeA,EAAMI,YAArB,aAAe,EAAYC,SAV5E,kBAYSF,EAAkBG,OAAOvE,QAAO,SAACwE,GAAD,OAAiBA,MAZ1D,gD,6DAgBaZ,MClCFa,GAAwB,SACnCC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACA/H,GAEA,IAAMgI,EAAS,CACbN,UACAC,uBACAC,aACAC,OACAC,aACA9H,MACAgF,QAAS+C,GAGX,MAAM,GAAN,OA3BqB,mCA2BrB,gBAAgCR,EAAhC,6BAAoEC,EAApE,oBAAsFC,EAAtF,mBAAwGpP,KAAKM,UAAUqP,KAG5GC,GAAqC,SAChDV,EACAG,EACAC,EACAC,EACAC,EACAC,EACAC,GAPgD,IAQhD/H,EARgD,uDA5B3B,MA4B2B,OASrCsH,GACXC,EACA,kBACA,4BACAG,EACAC,EACAC,EACAC,EACAC,EACAC,EACA/H,IAGWkI,GAAiB,uCAAG,WAAOzJ,EAAoC0J,GAA3C,iBAAAnJ,EAAA,sEAEvBoJ,EAAM,IAAI3B,GAAYhI,EAAkB0J,GAFjB,SAGCC,EAAIC,oBAHL,cAGvBC,EAHuB,yCAKnBH,EAAiBG,IALE,uCAO7BjP,QAAQC,IAAI,eAAZ,MAP6B,uBAQtB8C,GARsB,yDAAH,wDAYjBmM,GAAkC,SAC7CC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,IAAMnB,EAAUoB,mBAAmBN,GAE7BX,EAAO,CACXpD,YAAagE,EACb5H,OAAQ8H,EACRjE,IAAKrM,KAAKM,UAAU,CAAE0H,eAAgBuI,EAAiB9D,YTzEhC,QS8EzB,OAAOmD,GACLY,EACAnB,EACAgB,EAZiB,mBAcjBb,EARiB,MACGkB,+BAaXC,GAAmC,SAC9CR,EACAC,EACAjI,EACAC,EACAoI,GAEA,IAAMnB,EAAUoB,mBAAmBN,GASnC,OAAOP,GACLY,EACAnB,EACAe,EAXiB,YACN,CACX9H,aAAcH,EACdI,sBAAuBH,GAEN,MACGsI,+BClEXE,GAAcC,wBAAmB,MAEjCC,GAAW,uCAAG,8EAAAnK,EAAA,6DACrB7G,aAAaC,QAAQ,SACvBmF,IAGE4G,EAAmBnL,OAAOC,SAASC,KAAKC,MAAM,KAAK,IAAM,GACzD,CAAC,GAAI,QAAS,UAAW,QAAS,uBAAuBiQ,MAAK,SAAC7F,GAAD,OAAOY,IAAqBZ,OAC5FY,EAAmB,wBAEf5K,EATmB,2BASQ8P,GATR,IASwBzP,aAAcuK,IAEzD3C,EAAW,IAAI8H,YAAkBC,4BAXd,SAYND,UAAA,aAAkBE,QAAS,GAAIhI,YAAajI,IAZtC,cAYnBgF,EAZmB,OAanB6J,EAAM,IAAI9J,EAAQC,GAElBkL,EAAkB,IAAIH,YAAkBI,iBAfrB,UAgBCJ,UAAA,aAAkBE,QAAS,GAAIhI,SAAUiI,GAAoBlQ,IAhB9D,eAgBnBoQ,EAhBmB,OAiBnBC,EAAa,IAAI5G,EAAW2G,GAC5BE,EAAkB,IAAI/F,EAAgB6F,GAEtClL,EAAmB,IAAI6K,mBAAyB/K,EAAMhF,EAAOK,cAC7DkQ,EAAkBrL,EAAiBgD,eACrCsI,EAA0B,4BAC1BC,GAAmB,EACnBC,GAA2B,EAC3BrE,EAA6B,GAC7BC,EAAoC,GACpCqE,EAAiB,GACjBC,GAAsB,EA5BD,oBA8BC/B,EAAIgC,oBA9BL,eA8BvBL,EA9BuB,iBA+BE3B,EAAIiC,sBA/BN,eA+BvBzE,EA/BuB,iBAgCSwC,EAAIkC,6BAhCb,eAgCvBzE,EAhCuB,OAiCvBxM,QAAQC,IAAI,mBAAoBsM,GAChCoE,EAAUpE,EAAiBoB,SAAS8C,GACpCzQ,QAAQC,IAAI,UAAW0Q,GACvBC,EAAkBpE,EAAwBmB,SAAS8C,GACnDzQ,QAAQC,IAAI,kBAAmB2Q,GACzBM,EAAMrC,GACZ7O,QAAQC,IAAIiR,GAvCW,UAwCWC,QAAQC,IAAI7E,EAAiBtI,KAAI,SAACoN,GAAD,OAA0BxC,GAAkBzJ,EAAkBiM,OAxC1G,QAwCjBC,EAxCiB,OAwCmH9H,QAAO,SAAC3K,GAAD,QAAaA,KAC9JmB,QAAQC,IAAIqR,IAEQ,QADdC,EAAmBD,EAAmB9H,QAAO,SAACgI,GAAD,OAAYzN,OAAO0N,OAAOD,GAAQE,MAAM/D,SAAS8C,aAChF,IAAhBc,OAAA,EAAAA,EAAkB5M,QAAS,IAC7BkM,EAAOU,EAAiBtN,KAAI,SAACuN,GAAD,OAAYzN,OAAOC,KAAKwN,GAAQE,OAAS,OAEvE1R,QAAQC,IAAI,mBAAoBsR,GAChCvR,QAAQC,IAAI,iBAAkBqR,GAC9BtR,QAAQC,IAAI,OAAQ4Q,GAhDG,mDAkDvB7Q,QAAQC,IAAR,MAEiC,wBApDV,KAoDC0R,KACtB3R,QAAQC,IAAI,sBAEZD,QAAQC,IAAR,gCAvDqB,eA0DnB2R,EAAW,IAAIhH,GAASxF,EAAkBsL,GAE5CmB,GAA0B,EA5DL,oBA+DMD,EAASE,iBAAiBhH,GA/DhC,QA+DjBiH,EA/DiB,OAiEvBjB,GAAsB,EACtBe,EAA8C,OAAnBE,IAA4B,EACvD/R,QAAQC,IAAI4R,GAnEW,mDAqEvB7R,QAAQC,IAAR,MArEuB,eAwEnB+R,EAAa,IAAI3F,GACrBjH,EACAlF,EAAOS,qBAGHsR,EAAc,IAAIhC,YAAkBiC,gBACxChS,EAAOI,SA9EgB,kBAiFlB,CACLJ,SACA6O,MACA2B,kBACAH,aACAqB,WACAI,aACAG,YAAa,CACXC,WAAY3B,EACZE,UACAC,kBACAyB,gBAAiBxB,EAAKlM,OAAS,EAC/B8L,kBACAI,QAEFL,kBACAyB,cACAJ,0BACA/G,mBACAgG,sBACAwB,mBAAyC,yBAArBxH,EACpB5F,OACAqN,qBAAsB,CACpBC,MAAM,EACNC,QAAS,kBAAM,SAzGM,mEAAH,qD,UC7ClBC,GAA6C,CACjDC,kBAAkB,GAmBL,OAAoB,qBAAbC,SAhBtB,SAAkBC,GAAsE,IAAvDC,EAAsD,uDAA3BJ,GAC1DtT,qBAAU,WACR,IAAM2T,EAAYH,SAASC,MAI3B,OAHID,SAASC,QAAUA,IAAOD,SAASC,MAAQA,GAG3CC,GAAWA,EAAQH,iBACd,WACLC,SAASC,MAAQE,GAId,iBAIiD,a,QCrB7C,SAASC,KAGtB,OAFAC,GAAS,oBAAqB,CAAEN,kBAAkB,IAGhD,uBAAKO,UAAU,OAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,2BAIN,uBAAKJ,UAAU,YAAf,UACE,wDAEA,0CAEA,iCACE,gLACA,uKACA,6NAIA,kWASF,wCAEA,iCACE,2NAEA,gCACE,oQAMA,4GACA,4JACA,sHAIJ,0CAEA,iCACE,uEACA,gCACE,2FACA,gQAMA,mWAOA,+OAMA,mIAOJ,2DAEA,iCAEE,sBAAKK,IAAI,4FAA4FC,IAAI,gCACzG,0FACA,yJACA,kJACA,2FACA,kGACA,wFACA,qFACA,+H,uKCpGK,SAASC,GAAqBC,GAC3C,IAAQvS,EAAgBuS,EAAhBvS,YAEFE,EAAO,IAAIC,KAAmB,IAAdH,GAEhBI,EAAM,SAACC,EAAwBC,GAAzB,OAA2CD,EAAME,WAAWC,SAASF,EAAO,MAElFG,EAAOL,EAAIF,EAAKQ,iBAAkB,GAClCC,EAAQP,EAAIF,EAAKU,cAAgB,EAAG,GACpCC,EAAWT,EAAIF,EAAKY,aAAc,GAElCE,EAAQZ,EAAIF,EAAKe,cAAe,GAChCC,EAAUd,EAAIF,EAAKiB,gBAAiB,GACpCC,EAAUhB,EAAIF,EAAKmB,gBAAiB,GAEpCpB,EAAS,UAAMQ,EAAN,YAAcE,EAAd,YAAuBE,GAChC2R,EAAiB,UAAM/R,EAAN,YAAcE,EAAd,YAAuBE,EAAvB,YAAmCG,EAAnC,YAA4CE,EAA5C,YAAuDE,EAAvD,QAEvB,OACE,uBAAM2Q,UAAU,2BAA2BL,MAAOc,EAAlD,SACGvS,I,8BChBQ,SAASwS,GAAT,GAAkI,IAAjHzP,EAAgH,EAAhHA,KAAM0P,EAA0G,EAA1GA,KAAMC,EAAoG,EAApGA,KACpCC,EAAOvQ,KAAKwQ,IAAL,MAAAxQ,KAAI,CAASW,EAAK8P,SAAS,GAAG,IAA1B,oBAAkC9P,EAAK+P,OAAO,GAAG,IAAM,CAAC/P,EAAK+P,OAAO,GAAG,KAAO,MAC/FlU,QAAQC,IAAI,OAAQ8T,EAAO,KAC3B/T,QAAQC,IAAI,OAAQ4T,GACpB7T,QAAQC,IAAI,aAAc4T,GAASA,EAA8B,KAAtBA,EAAOE,EAAO,MACzD,IAAMI,EAAcN,GAAsD,KAA7CE,EAAO,IAA8B,KAAtBF,EAAOE,EAAO,MACpDK,EAAcP,GAA+C,KAAtCA,EAA8B,KAAtBA,EAAOE,EAAO,MACnD/T,QAAQC,IAAI,cAAekU,GAC3BnU,QAAQC,IAAI,cAAemU,GAE3B,IAAMC,EAAe,SAACnK,GAAD,OAAe,IAAIoK,KAAKC,aAAa,QAAS,CAAEC,sBAAuB,EAAGC,sBAAuB,IAAK7L,OAAOF,WAAWwB,KAEvIwK,EAAS,CACbC,QAAQ,EACR9B,MAAO,CACL,CACE+B,KAAM,iCACNC,IAAK,OAELC,KAAM,MAENC,UAAW,CACTC,WAAY,MACZC,WAAY,0CACZC,SAAU,OACVC,MAAO,UACPC,QAAS,KAIfC,QAAS,CACPC,QAAS,OACTC,YAAa,CACX5D,KAAM,UAGV6D,OAAQ,CACNC,OAAQ,KACRC,cAAc,EACdC,KAAM,UAERC,KAAM,CACJf,IAAK,OACLC,KAAM,OACNe,MAAO,OACPJ,OAAQ,MACRK,cAAc,GAEhBC,MAAO,CACL,CACEpE,KAAM,OACNqE,YAAa,CAAC,KAAM,MACpBC,YAAa,GACbjC,IAAKG,EACL+B,IAAK9B,IAGT+B,MAAO,CACL,CACExE,KAAM,QACNuE,IAAKpC,IAGTsC,OAAQ,CACN,CACEf,QAAS,CACPgB,eAAgBhC,GAElBiC,YAAY,EACZhK,KAAM,SACNqF,KAAM,OACNwD,MAAO,UACPoB,UAAW,CACTnB,QAAS,GAEXoB,SAAU,CACRrS,KAAM,CACJ,CACE,CAAE4R,MAAO,IAAIzU,KAAQ6U,MAAO,GAC5B,CAAEJ,MAAO,IAAIzU,KAAQ6U,MAAOrC,GAAQ,SAGxC2C,UAAW,CACT9E,KAAM,SACNwD,MAAO,WAETuB,OAAQ,QAEVvS,KAAMA,EAAK+P,QAEb,CACEmB,QAAS,CACPgB,eAAgBhC,GAElBiC,YAAY,EACZhK,KAAM,WACNqF,KAAM,OACNwD,MAAO,UACPoB,UAAW,CACTnB,QAAS,GAEXjR,KAAMA,EAAK8P,UAEb,CACEoB,QAAS,CACPgB,eAAgBhC,GAElBiC,YAAY,EACZhK,KAAM,UACNqF,KAAM,OACNwD,MAAO,UACPoB,UAAW,CACTnB,QAAS,GAEXjR,KAAMA,EAAKwS,WAIjB,OAAO,eAAC,KAAD,CAAcjC,OAAQA,EAAQkC,MAAO,CAAEC,aAAc,MC1H/C,SAASC,GAAUnI,GAChC,IAAQoI,EAAcpI,EAAdoI,IAAKC,EAASrI,EAATqI,KACb,OACE,sBACEJ,MAAO,CACLK,OAAQD,EAAMvV,MAAOuV,EAAME,cAAe,UAE5C3D,IAAKwD,EACLvD,IAAI,eCDK,SAAS2D,GAAmBxI,GACzC,IAAQyI,EAAkBzI,EAAlByI,MAAO5P,EAAWmH,EAAXnH,OAEf,OACE,wBAAM0L,UAAU,SAASL,MAAOrL,EAAhC,UACGxE,EAAkBwE,EAAQ4P,EAAMC,UAChC,IACAD,EAAMV,OACN,IACD,eAACI,GAAD,CAAWC,IAAKK,EAAMzB,MAAQ,GAAIqB,KAAM,QChB/B,SAASM,GAAiB5D,GACvC,IAAQvS,EAAgBuS,EAAhBvS,YAEFE,EAAO,IAAIC,KAAmB,IAAdH,GAEhBI,EAAM,SAACC,EAAwBC,GAAzB,OAA2CD,EAAME,WAAWC,SAASF,EAAO,MAElFG,EAAOL,EAAIF,EAAKQ,iBAAkB,GAClCC,EAAQP,EAAIF,EAAKU,cAAgB,EAAG,GACpCC,EAAWT,EAAIF,EAAKY,aAAc,GAElCE,EAAQZ,EAAIF,EAAKe,cAAe,GAChCC,EAAUd,EAAIF,EAAKiB,gBAAiB,GACpCC,EAAUhB,EAAIF,EAAKmB,gBAAiB,GAEpCpB,EAAS,UAAMQ,EAAN,YAAcE,EAAd,YAAuBE,EAAvB,YAAmCG,EAAnC,YAA4CE,EAA5C,YAAuDE,EAAvD,QAEf,OACE,uBAAM2Q,UAAU,2BAA2BL,MAAOzR,EAAlD,SACGA,ICPQ,SAASmW,GAAc5I,GACpC,IAAQrD,EAA2BqD,EAA3BrD,SAAUuH,EAAiBlE,EAAjBkE,MAAOuE,EAAUzI,EAAVyI,MAEzB,OACE,uBAAKlE,UAAU,sBAAf,UACE,8BAAKL,IACL,gBAAC2E,GAAA,EAAD,CAAOtE,UAAU,cAAc8D,KAAK,QAAQ,aAAW,YAAvD,UACE,eAACS,GAAA,EAAD,UACE,gBAACC,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,yBACA,eAACA,GAAA,EAAD,CAAWC,MAAM,QAAjB,oCAGJ,eAACC,GAAA,EAAD,UACGvM,EAASrH,KAAI,SAACiG,GAAD,OACZ,gBAACwN,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,CAAWG,MAAM,MAAjB,SACE,sBAAK5E,UAAU,SAAf,SACE,eAACoE,GAAD,CAAkBnW,YAAa+I,EAAE9C,gBAGrC,eAACuQ,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACT,GAAD,CAAoB3P,OAAQ0C,EAAE5B,QAAS8O,MAAOA,QAPnClN,EAAE9C,sBJkG7BwM,GAAMmE,aAAe,CACnBlE,KAAM,KACNC,KAAM,MK3HD,IAkCMkE,GAAc,SAACC,EAA0BC,EAA0B9Q,GAS9E,MAAO,CAAEA,YAAWkB,QA3CQ,SAAC6P,EAAYC,EAAYC,EAAYC,EAAYC,GAC7E,GAAIF,GAAMF,EACR,MAAM,IAAIvX,MAAM,iBAElB,GAAI2X,EAAKJ,GAAMI,GAAMF,EACnB,MAAM,IAAIzX,MAAM,mBASlB,OANW,IAAIG,MAAIqX,GAAII,IACpB,IAAIzX,MAAIuX,GAAIG,IAAI,IAAI1X,MAAIqX,IACtBlM,IAAI,IAAInL,MAAIwX,EAAG7W,YAAY+W,IAAI,IAAI1X,MAAIoX,EAAGzW,cAC1CmB,IAAI,IAAI9B,MAAIsX,EAAG3W,YAAY+W,IAAI,IAAI1X,MAAIoX,EAAGzW,eAGrCoB,QAAQ,EAAG/B,MAAImC,WAqBTwV,CACdT,EAAY7Q,UACZ6Q,EAAY3P,QACZ4P,EAAY9Q,UACZ8Q,EAAY5P,QACZlB,KAMSuR,GAAiB,SAACV,EAA0BC,EAA0B5P,GASjF,MAAO,CAAElB,UAtCsB,SAAC+Q,EAAYC,EAAYC,EAAYC,EAAYM,GAChF,GAAIP,GAAMF,EACR,MAAM,IAAIvX,MAAM,iBAElB,GAAI,IAAIG,MAAI6X,GAAIC,GAAG,IAAI9X,MAAIqX,KAAQ,IAAIrX,MAAI6X,GAAIE,IAAIR,GACjD,MAAM,IAAI1X,MAAM,mBAGlB,IAAM2X,EAAK,IAAIxX,MAAIoX,GAAIK,IACpB,IAAIzX,MAAIsX,GAAII,IAAI,IAAI1X,MAAIoX,IACtBjM,IAAI,IAAInL,MAAI6X,EAAGlX,YAAY+W,IAAI,IAAI1X,MAAIqX,EAAG1W,cAC1CmB,IAAI,IAAI9B,MAAIuX,EAAG5W,YAAY+W,IAAI,IAAI1X,MAAIqX,EAAG1W,eAG/C,OAAOqX,SAASR,EAAGzV,QAAQ,EAAG/B,MAAIiY,SAAU,IAgB1BC,CAChBhB,EAAY7Q,UACZ6Q,EAAY3P,QACZ4P,EAAY9Q,UACZ8Q,EAAY5P,QACZA,GAGkBA,YAGT4Q,GAAsB,SAAC5N,EAAyBlE,GAC3D,GAAwB,IAApBkE,EAAS3G,OACX,MAAM,IAAI/D,MAAM,kBAGlB,GAAIwG,EAAYkE,EAAS,GAAGlE,UAC1B,MAAO,CAAEA,YAAWkB,QAASgD,EAAS,GAAGhD,SAG3C,GAAIlB,GAAakE,EAASA,EAAS3G,OAAS,GAAGyC,UAC7C,MAAO,CAAEA,YAAWkB,QAASgD,EAASA,EAAS3G,OAAS,GAAG2D,SAI7D,IAAK,IAAI6Q,EAAI,EAAGA,EAAI7N,EAAS3G,OAAS,EAAGwU,IACvC,KAAI7N,EAAS6N,EAAI,GAAG/R,WAAaA,GAIjC,OAAO4Q,GAAY1M,EAAS6N,GAAI7N,EAAS6N,EAAI,GAAI/R,GAGnD,MAAM,IAAIxG,MAAM,gBAGLwY,GAAe,SAACC,GAC3B,GAAyB,IAArBA,EAAU1U,OACZ,MAAM,IAAI/D,MAAM,sBAGlB,IAAM0Y,EAAaC,MAAMC,KAAK,IAAIC,IAAIJ,EAAUtL,OAAO9J,KAAI,SAACiG,GAAD,OAAOA,EAAE9C,aAAWsS,MAC7E,SAACxP,EAAGyP,GAAJ,OAAUzP,EAAIyP,OAGV9T,EAAoB,GAY1B,OAVAyT,EAAWjV,SAAQ,SAAC+C,GAGlB,IAFA,IAAII,EAAS,IAAIzG,MAAI,GAEZoY,EAAI,EAAGA,EAAIE,EAAU1U,OAAQwU,IAAK,CACzC,IAAM7Q,EAAU,IAAIvH,MAAImY,GAAoBG,EAAUF,GAAI/R,GAAWkB,SACrEd,EAASA,EAAOoS,KAAKtR,GAEvBzC,EAAOgU,KAAK,CAAEzS,YAAWkB,QAASd,EAAO9F,gBAGpCmE,GA4DIiU,GAA4B,SAACxO,EAAqB9D,EAAgBuS,GAC7E,GAAwB,IAApBzO,EAAS3G,OACX,MAAM,IAAI/D,MAAM,kBAGlB,GAAI,IAAIG,MAAIyG,GAAQwS,GAAG,IAAIjZ,MAAI,MAC7B,MAAO,CACLuK,EAAS,GACT,CAAElE,UAAW5D,KAAK0S,IAAI5K,EAAS,GAAGlE,UAAY,EAAG2S,GAAkBzR,QAASgD,EAAS,GAAGhD,UAI5F,GAAI,IAAIvH,MAAIyG,GAAQsR,IAAI,IAAI/X,MAAIuK,EAASA,EAAS3G,OAAS,GAAG2D,UAC5D,OAAOgD,EAAS1G,MAAM,EAAG0G,EAAS3G,QAKpC,IAFA,IAAMkB,EAAS,GAENsT,EAAI,EAAGA,EAAI7N,EAAS3G,OAAS,EAAGwU,GAAK,EAAG,CAG/C,GAFAtT,EAAOgU,KAAKvO,EAAS6N,IAEjB,IAAIpY,MAAIyG,GAAQqR,GAAG,IAAI9X,MAAIuK,EAAS6N,EAAI,GAAG7Q,UAAW,CACxD,IAAM2R,EAAmBtB,GAAerN,EAAS6N,GAAI7N,EAAS6N,EAAI,GAAI3R,GAEtE,OADA3B,EAAOgU,KAAKI,GACLpU,EAGT,GAAI,IAAI9E,MAAIyG,GAAQwS,GAAG,IAAIjZ,MAAIuK,EAAS6N,EAAI,GAAG7Q,UAE7C,OADAzC,EAAOgU,KAAKvO,EAAS6N,EAAI,IAClBtT,EAIX,MAAM,IAAIjF,MAAM,gBAWLsZ,GAAkB,SAACC,EAAUC,GAA+B,IAAD,MAChEC,EAAkBF,EAAI7O,SAAS6O,EAAI7O,SAAS3G,OAAS,GAAG2D,QACxDgS,EAAoBH,EAAII,iBAAmB,IAE3CC,EAAsB,IAAIzZ,MAAImY,GAAoBiB,EAAI7O,SAAU8O,GAAK9R,SAASmQ,IAAI,IAAI1X,MAAIuZ,IAAoBxX,UAChH2X,EAAuB,KACrBvP,GAAkB,UAAAiP,EAAI5O,wBAAJ,eAAsBC,YAAtB,UAAkC2O,EAAIO,0BAAtC,iBAAkC,EAAwBnP,wBAA1D,aAAkC,EAA0CC,UAElGiP,EADEvP,EACqBgO,GAAoBhO,EAAiBkP,GAAK9R,QAE1C6R,EAAI7O,SAAS6O,EAAI7O,SAAS3G,OAAS,GAAG2D,QAE/D,IAAMqS,EAAmB,IAAI5Z,MAAI0Z,GAC9BhC,IAAI,IAAI1X,MAAIuZ,IACZ7B,IAAI,IAAI1X,MAAIyZ,IACZ9Y,WACGkZ,EAAqB,IAAI7Z,MAAIsZ,GAChC5B,IAAI,IAAI1X,MAAI0Z,IACZ/Y,WAGH,OAFA1B,QAAQC,IAAIoa,EAAiBC,EAAmBE,EAAqBG,EAAkBC,GAEhF,CACLjE,QAAS2D,EACTO,UAAWL,EACXtG,OAAQyG,EACRG,SAAUF,EACVnS,MAAO4R,IAIEU,GAAkB,SAACzP,EAAqB0P,GACnD,IAAMC,EAAoB3P,EAASrH,KAAI,SAACiG,GAAD,OAAOA,EAAE9C,aAGhD,OAF6BmS,MAAMC,KAAK,IAAIC,IAAJ,uBAAYwB,GAAZ,aAAkCD,MAAmBtB,OACnEzV,KAAI,SAACmD,GAAD,OAAe8R,GAAoB5N,EAAUlE,OCxOhE8T,GAAY,SAACC,EAAoBlY,GAAgC,IAAD,EACrEmY,EAAY,IAAI9Z,KACtBtB,QAAQC,IAAR,qBAA0Bkb,EAAYxW,OAAtC,qBAAyDyW,IAEzD,IAAMC,EAAkB9B,MAAMC,KAC5B2B,EAAYlX,KAAI,SAACiG,GAAD,OAAOA,EAAEoB,aAGrB8O,EAAM5W,KAAK8X,OAAM,IAAIha,MAAO+B,UAAY,KACxCkY,EAAsBJ,EAAYlX,KAAI,SAACiG,GAAD,OAAOA,EAAEoB,SAAS,GAAGlE,aAC3DoU,EAAuBL,EAAYlX,KAAI,SAACiG,GAAD,sBAAOA,QAAP,IAAOA,GAAP,UAAOA,EAAGwQ,0BAAV,iBAAO,EAAuBnP,iBAAiB,UAA/C,aAAO,EAA4CnE,aAAWoC,QAAO,SAACU,GAAD,OAAOA,KAEnHuR,EAAejY,KAAKwQ,IAAL,MAAAxQ,KAAI,aAAQ+X,GAAR,oBAAgCC,GAAhC,CAAsDpB,KAEzEsB,EAAmBnC,MAAMC,KAC7B2B,EAAYlX,KAAI,SAACiG,GAAO,IAAD,MApBEsP,EAAsBlR,EAsBvCzC,GAAU,OAADqE,QAAC,IAADA,GAAA,UAAAA,EAAGwQ,0BAAH,mBAAuBnP,wBAAvB,eAAyCC,YAAzC,OACVtB,QADU,IACVA,GADU,UACVA,EAAGqB,wBADO,aACV,EAAqBC,UAC1B,OAAI3F,IACGA,IAzBgB2T,EAyBciC,EAzBQnT,EAyBM4B,EAAEoB,SAASpB,EAAEoB,SAAS3G,OAAS,GAAG2D,QAzBf,CAC1E,CAAElB,UAAWoS,EAAO,EAAGlR,QAAS,KAChC,CAAElB,UAAWoS,EAAMlR,kBA2BfqT,EAAavC,GAAasC,GAC1BE,EAAYxC,GAAaiC,GAEzBM,EAAWhX,OAAS,IAClBgX,EAAWA,EAAWhX,OAAS,GAAGyC,UAAYwU,EAAUA,EAAUjX,OAAS,GAAGyC,WAChFuU,EAAW9B,KAAK+B,EAAUA,EAAUjX,OAAS,IAE3CgX,EAAWA,EAAWhX,OAAS,GAAGyC,UAAYwU,EAAUA,EAAUjX,OAAS,GAAGyC,WAChFwU,EAAU/B,KAAK8B,EAAWA,EAAWhX,OAAS,KAIlD,IAAMkX,EAAkB,SAACvQ,EAAqB+L,GAAtB,OAA2C/L,EAASrH,KAAI,SAAC6X,GAAD,MAAoB,CAAe,IAAdA,EAAE1U,UAAkBpE,EAAkB8Y,EAAExT,QAAS+O,QAEhJ0E,EAAeZ,EAAYlX,KAAI,SAACiG,GAAD,OAAOA,EAAEqQ,iBAAmB,OAAKyB,QAAO,SAACC,EAAK/R,GAAN,OAAY,IAAInJ,MAAIkb,GAAKzD,IAAI,IAAIzX,MAAImJ,IAAIpH,YAAW,KAG7HoZ,EAAapC,GAA0B8B,EAAWG,EAAc,IAEhE,UAAAG,EAAWA,EAAWvX,OAAS,UAA/B,eAAmCyC,aAAcwU,EAAUA,EAAUjX,OAAS,GAAGyC,WACnF8U,EAAWrC,KAAK,CACdzS,UAAWwU,EAAUA,EAAUjX,OAAS,GAAGyC,UAC3CkB,QAAS4T,EAAWA,EAAWvX,OAAS,GAAG2D,UAW/C,IAPA,IAAM6T,EAAsB,CAACP,EAAWD,EAAYO,GACjDE,SAAQ,SAAC9Q,GAAD,OAAcA,EAASrH,KAAI,SAACiG,GAAD,OAAOA,EAAE9C,gBAEzCiV,EAAmB7Y,KAAKwQ,IAAL,MAAAxQ,KAAI,aAAQ2Y,IAC/BG,EAAe9Y,KAAK0S,IAAL,MAAA1S,KAAI,aAAQ2Y,IAE3BI,EAAmB,GAChBpD,EAAI,QAAEkD,EAAmB,GAApB,MAA0C,GAAqBlD,EAAImD,EAAcnD,GAAM,MACnGoD,EAAiB1C,KAAKV,GAExB,IAAMqD,EAAc,uBAAOL,GAAwBI,GAEnDL,EAAanB,GAAgBmB,EAAYM,GACzCZ,EAAYb,GAAgBa,EAAWY,GACvCb,EAAaZ,GAAgBY,EAAYa,GAEzC,IAAMC,EAAa,IAAInb,KAGvB,OAFAtB,QAAQC,IAAR,qBAA0Bkb,EAAYxW,OAAtC,sBAA0DyW,EAA1D,sBAAiFqB,EAAWpZ,UAAY+X,EAAU/X,WAAa,MAExH,CACL4Q,SAAUkH,EAAYxW,OAASkX,EAAgBD,EAAW3Y,GAAiB,GAC3EiR,OAAQiH,EAAYxW,OAASkX,EAAgBF,EAAY1Y,GAAiB,GAC1E0T,QAASwE,EAAYxW,OAASkX,EAAgBK,EAAYjZ,GAAiB,K,wCC5EzEyZ,GAAYC,cAAW,iBAAO,CAClCC,KAAM,CACJ,2BAA4B,CAC1Bnb,MAAO,mBACPob,SAAU,mBACVC,UAAW,oBAEbC,UAAW,+CACXlG,aAAc,QAEhBmG,WAAY,CACV,2BAA4B,CAC1Bvb,MAAO,mBACPob,SAAU,oBAEZE,UAAW,+CACXlG,aAAc,QAEhBoG,KAAM,CACJxb,MAAO,OACPyb,QAAS,OACTH,UAAW,OACXlG,aAAc,QAEhBsG,WAAY,CACV1b,MAAO,OACPyb,QAAS,YACTH,UAAW,OACXlG,aAAc,QAEhBuG,WAAY,CACVF,QAAS,EACTG,aAAc,MACdC,eAAgB,iBAElBC,iBAAkB,CAChBL,QAAS,GAEXM,YAAa,CACXrI,MAAO,uBACPH,WAAY,IACZE,SAAU,QAEZuI,MAAO,CACLC,WAAY,QAEdC,OAAQ,CACNT,QAAS,EACTU,WAAY,WAEdC,SAAU,CACRX,QAAS,MACTY,gBAAiB,UACjBf,UAAW,OACXlG,aAAc,WAUZkH,GAAWC,sBAAW,SAACtK,EAAeuK,GAC1C,IAAMC,EAAUxB,KACRyB,EAAkBC,cAAlBD,cAEFE,EAAgBC,uBAAY,WAChCH,EAAczK,EAAMzN,MACnB,CAACyN,EAAMzN,GAAIkY,IAEd,OACE,eAAC,IAAD,CAAiBF,IAAKA,EAAK/K,UAAWQ,EAAM6K,KAAOL,EAAQtB,KAAOsB,EAAQlB,WAA1E,SACE,gBAACwB,GAAA,EAAD,CAAMtL,UAAWQ,EAAM6K,KAAOL,EAAQjB,KAAOiB,EAAQf,WAArD,UACE,gBAACsB,GAAA,EAAD,CAAaP,QAAS,CAAEtB,KAAMlJ,EAAM6K,KAAOL,EAAQd,WAAac,EAAQX,kBAAxE,UACI7J,EAAMgL,QAAUhL,EAAMgL,OAAO/B,MAC/B,sBAAKzJ,UAAWgL,EAAQT,MAAxB,SACE,eAACkB,EAAA,EAAD,CAAYzL,UAAWgL,EAAQP,OAAQiB,QAASP,EAAhD,SACE,eAAC,IAAD,WAIJ3K,EAAM6K,MACN,eAACM,GAAA,EAAD,CAAO3L,UAAWgL,EAAQL,SAA1B,SACInK,EAAM6K,KAAK5B,gBAQnBmC,GAAe,CACnBC,SAAU,MACVC,WAAY,SAGDC,GAAwB,SAACC,EAAgBX,EAAuBG,EAAkB5L,GAA1D,OAA4EoM,EAC/G,GADmH,aAGjHJ,gBACAK,QAAS,SAACzgB,GAAD,OAAiB,eAACqf,GAAD,CAAgB9X,GAAIvH,EAAK6f,OAAMG,aACtD5L,K,UC1EQsM,GAFC,CAAEb,KAlCL,SAAC3J,GAWZ,OAVa,SAAc+H,GACzB,IAAMuB,EAAUvB,GAAW,iBAAO,CAChC0C,WAAY,CACVnK,SAAU,WAFEyH,GAMhB,OAAO,eAAC2C,GAAA,EAAD,CAAYpM,UAAWgL,EAAQmB,WAA/B,SAA4CzK,MA0B/B8J,OApBT,SAAC9J,GAiBd,OAhBe,SAAgB+H,GAC7B,IAAMuB,EAAUvB,GAAW,iBAAO,CAChC0C,WAAY,CACVlK,MAAO,uBACPH,WAAY,IACZE,SAAU,WAJEyH,GAQhB,OACE,eAAC2C,GAAA,EAAD,CAAYlR,QAAQ,YAAY8E,UAAWgL,EAAQmB,WAAnD,SACGzK,OCAM,SAAS2K,GAAe7L,GAAuI,IAAD,EACrK9T,EAAW4f,cAEfC,EACE/L,EADF+L,OAAQC,EACNhM,EADMgM,UAAWvF,EACjBzG,EADiByG,IAAK/C,EACtB1D,EADsB0D,MAAOuI,EAC7BjM,EAD6BiM,cAAeC,EAC5ClM,EAD4CkM,aAEhD,EAAwBhhB,mBAAS6gB,GAAjC,mBAAOjN,EAAP,KAAaC,EAAb,KACQoN,EAAoBzB,cAApByB,gBAEN3a,EAGE4a,qBAAWlQ,IAHb1K,KAKF,EAAuBtG,mBAAiB4E,KAAKC,OAAM,IAAInC,MAAO+B,UAAY,MAA1E,mBAAO+W,EAAP,UAEA,IAAKlV,EAAM,OAAO,KAElB,GAAIiV,aAAevZ,MACjB,OACE,eAAC8W,GAAA,EAAD,UACE,eAACC,GAAA,EAAD,CAAWf,MAAO,CAAEsG,QAAS,GAAK6C,QAAS,EAA3C,SACE,uBAAK7M,UAAU,YAAf,UACG,OACAwM,EACA,KACAvF,EAAI6F,eAOf,IAAM9U,EAAe,OAAGiP,QAAH,IAAGA,GAAH,UAAGA,EAAK5O,wBAAR,aAAG,EAAuBC,SAEzCyU,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GAEnDqgB,EAAkBvgB,EAASsgB,SAASpgB,MAAM,KAAK4R,QAAUyI,EAAIlU,GAAGvE,WAChE0e,EAAYxgB,EAASsgB,SAASpgB,MAAM,KAAK6N,SAAS,UAClD0S,EAAkBzgB,EAASsgB,SAASpgB,MAAM,KAAK6N,SAAS,sBAExD2S,EAAcpG,GAAgBC,EAAKC,GAEzC,OACE,uCACE,gBAAC1C,GAAA,EAAD,CAAUxE,UAAWV,EAAI,2BAAwBiN,EAAS,SAAW,IAAQ,UAA7E,UACE,eAAC9H,GAAA,EAAD,UACE,eAACgH,EAAA,EAAD,CACE,aAAW,aACX3H,KAAK,QACL4H,QAAS,kBAAMnM,GAASD,IAH1B,SAKGA,EAAO,eAAC,KAAD,IAA0B,eAAC,KAAD,QAGtC,gBAACmF,GAAA,EAAD,CAAWC,MAAM,OAAjB,UACGuI,GAAmBC,GAAaC,EAC7BlG,EAAIlU,GAEJ,eAAC,IAAD,CACEqN,GAAIqM,EAAa,WACTM,EADS,yBAC2B9F,EAAIlU,IAD/B,WAETga,EAFS,mBAEqB9F,EAAIlU,IAH5C,SAKGkU,EAAIlU,MAGToa,GACF,eAAC,mBAAD,CACEzL,KAAI,UAAKjV,OAAOC,SAAS2gB,OAArB,cAAiCN,EAAjC,mBAA+D9F,EAAIlU,IACvEua,OAAQ,kBAAMvB,GAAsBY,EAAiB,KAAMT,GAAQV,OAAO,UAAW,CAAE+B,iBAAkB,OAF3G,SAIE,eAAC9B,EAAA,EAAD,CAAY,aAAW,YAAvB,SACE,eAAC,KAAD,WAKN,eAAChH,GAAA,EAAD,CAAWC,MAAM,OAAjB,SACGrT,EAAgB4V,EAAI/Q,cAEvB,eAACuO,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACnE,GAAD,CAAsBtS,YAAagZ,EAAI7O,SAAS,GAAGlE,cAErD,eAACuQ,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACnE,GAAD,CAAsBtS,YAAagZ,EAAI7O,SAAS6O,EAAI7O,SAAS3G,OAAS,GAAGyC,cAE3E,eAACuQ,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACT,GAAD,CAAoB3P,OAAQ8Y,EAAY7X,MAAO2O,MAAOA,MAEvDwI,GACD,eAACjI,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,eAAC8I,GAAA,EAAD,CACE7N,MACE,uBAAKK,UAAU,wBAAf,UACE,wBAAMA,UAAU,SAAhB,UACE,oBAAGA,UAAU,UAAb,kBACA,6BAAIlQ,EAAkBsd,EAAY3J,QAASS,EAAMC,YAChD,IAHH,aAMA,wBAAMnE,UAAU,SAAhB,UACE,oBAAGA,UAAU,YAAb,kBACA,6BAAIlQ,EAAkBsd,EAAYzF,UAAWzD,EAAMC,YAClD,IAHH,eAMA,wBAAMnE,UAAU,SAAhB,UACE,oBAAGA,UAAU,SAAb,kBACA,6BAAIlQ,EAAkBsd,EAAYpM,OAAQkD,EAAMC,YAC/C,IAHH,YAMA,wBAAMnE,UAAU,SAAhB,UACE,oBAAGA,UAAU,WAAb,kBACA,6BAAIlQ,EAAkBsd,EAAYxF,SAAU1D,EAAMC,YACjD,IAHH,iBAQJsJ,UAAU,MACVC,OAAK,EA9BP,SAgCE,sBAAK1N,UAAU,qBAAf,SACE,uBAAKA,UAAU,eAAf,UACE,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAAMiH,WAAW4X,EAAY3J,SAAWjO,WAAW4X,EAAY7X,OAAU,IAAzE,MAAmFyK,UAAU,UAAhH,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAAMiH,WAAW4X,EAAYzF,WAAanS,WAAW4X,EAAY7X,OAAU,IAA3E,MAAqFyK,UAAU,YAAlH,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAAMiH,WAAW4X,EAAYpM,QAAUxL,WAAW4X,EAAY7X,OAAU,IAAxE,MAAkFyK,UAAU,SAA/G,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAAMiH,WAAW4X,EAAYxF,UAAYpS,WAAW4X,EAAY7X,OAAU,IAA1E,MAAoFyK,UAAU,WAAjH,8BASV,eAACwE,GAAA,EAAD,CAAUxE,UAAWuM,EAAS,kBAAoB,WAAlD,SACE,eAAC9H,GAAA,EAAD,CAAWf,MAAO,CAAEsG,QAAS,GAAK6C,QAAS,EAA3C,SACE,eAACc,GAAA,EAAD,CAAUC,GAAItO,EAAMuO,QAAQ,OAAOC,eAAa,EAAhD,SACE,uBAAK9N,UAAU,aAAf,UACE,eAACqE,GAAD,CAAejM,SAAU6O,EAAI7O,SAAUuH,MAAM,kBAAkBuE,MAAOA,IACrElM,GACC,eAACqM,GAAD,CAAejM,SAAUJ,EAAiB2H,MAAM,mBAAmBuE,MAAOA,IAE5E,sBAAKlE,UAAU,0BAAf,SACE,sBAAK0D,MAAO,CAAEK,OAAQ,KAAtB,SACE,eAACrD,GAAD,CAAOzP,KAAM+W,GAAU,CAACf,GAAM/C,EAAMC,4BC3KvC,SAAS4J,GAAT,GAE0E,IADvFC,EACsF,EADtFA,QAAS9J,EAC6E,EAD7EA,MAAOuI,EACsE,EADtEA,cAAeC,EACuD,EADvDA,aAE/B,OACE,gBAACpI,GAAA,EAAD,CAAOtE,UAAU,aAAa,aAAW,oBAAzC,UACE,eAACuE,GAAA,EAAD,CAAWvE,UAAU,aAArB,SACGgO,EAAQvc,OAAS,GAClB,gBAAC+S,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,IACA,eAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,uBAAM1E,UAAU,SAAhB,kBACxB,eAACyE,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,uBAAM1E,UAAU,SAAhB,0BACxB,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,gCACzB,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,8BACzB,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,4BACxB0M,GAAgB,eAACjI,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAIrB,eAACC,GAAA,EAAD,UACGqJ,EAAQjd,KAAI,SAACkd,EAAQhI,GAAT,OACX,eAACoG,GAAD,CAAgCG,UAAWvG,EAAI,EAAGgB,IAAKgH,EAAQ/J,MAAOA,EAAOuI,cAAeA,EAAeC,aAAcA,EAAcH,QAAQ,GAA1H0B,EAAOlb,Y,4CCzBtCmb,KAAGC,UAAUC,OAAS,WACpB,OAAOjc,KAAK3D,YAGd,IAAM6f,GAAkB,SAACC,EAAgBC,GACvC,IACE,OAAOA,IACP,MAAOC,GACP,KAAMA,aAAa9gB,OAAQ,MAAM,IAAIA,MAAM,eAE3C,MADA8gB,EAAE1B,QAAF,UAAewB,EAAf,aAA0BE,EAAE1B,SACtB0B,IAIGC,GAA0B,SAACngB,GACtC,IAEMogB,EAAQpgB,EAAMqgB,OAAO/hB,MADZ,MAEf,GAAI8hB,EAAMjd,QAAU,EAClB,MAAO,GAET,IAAMmd,EAAQF,EAAM3d,KAAI,SAAC8d,GAAD,OAAUA,EAAKjiB,MANxB,MAMsCmE,KAAI,SAACiG,GAAD,OAAOA,EAAE2X,aAClE,eAAgCC,GAAzBE,EAAP,KAMA,OANA,WAE6B/d,KAAI,SAACkW,GAAD,OAASpW,OAAOke,YAC/CD,EAAQ/d,KAAI,SAACie,EAAKC,GAAN,MAAiB,CAACD,EAAK/H,EAAIgI,IAAW,YAmDzCC,GAAgB,SAAC5gB,GAE5B,IAAM6gB,EAAO,aAAG,gFAAH,4DACPC,EAAQ9gB,EAAM8gB,MAAMD,GAC1B,IAAKC,EACH,MAAM,IAAI1hB,MAAM,oBAGlB,IAAM2hB,EAASD,GAASA,EAAMC,QAAU,GAWxC,MAVe,CACb3gB,KAAMmX,SAASwJ,EAAO3gB,KAAM,KAAO,EACnCE,MAAOiX,SAASwJ,EAAOzgB,MAAO,KAAO,EACrC0gB,KAAMzJ,SAASwJ,EAAOC,KAAM,KAAO,EACnCC,IAAK1J,SAASwJ,EAAOE,IAAK,KAAO,EACjCC,KAAM3J,SAASwJ,EAAOG,KAAM,KAAO,EACnCC,OAAQ5J,SAASwJ,EAAOI,OAAQ,KAAO,EACvCC,OAAQ7J,SAASwJ,EAAOK,OAAQ,KAAO,IAyB9BC,GAAiB,SAACrhB,GAC7B,IAAMshB,EAAQthB,EAAM1B,MAAM,KAC1B,GAAqB,IAAjBgjB,EAAMne,OACR,MAAM,IAAI/D,MAAM,oBAElB,kBAAqCkiB,EAArC,GAAOC,EAAP,KAAoBC,EAApB,KACMC,EAAWb,GAAcW,GACzBG,EAAa3B,GAAgB,cAAc,kBArB3B,SAAC/f,GACvB,IAAMA,EAAM8gB,MAAM,SAChB,MAAM,IAAI1hB,MAAM,4BAGlB,IAAMsiB,EAAanK,SAASvX,EAAO,IAEnC,GAAI0hB,EAAa,GAAKA,EAAa,IACjC,MAAM,IAAItiB,MAAM,4BAGlB,OAAOsiB,EAUgDC,CAAgBH,MACvE,MAAO,CAAEC,WAAUC,eAWRE,GAA6B,SAAC9X,GACzC,IAAMwX,EAAQxX,EAASxL,MAAM,KAC7B,GAAqB,IAAjBgjB,EAAMne,OACR,MAAM,IAAI/D,MAAM,qDAGlB,kBAKIkiB,EALJ,GACEO,EADF,KAEEC,EAFF,KAGEC,EAHF,KAIEC,EAJF,KAOMC,EAAiBlC,GAAgB,mBAAmB,kBA/F9B,SAACna,GAC7B,IAAKA,EAAUkb,MAAM,sCACnB,MAAM,IAAI1hB,MAAM,qBAElB,IAAMiF,EAAS,IAAIvE,KAAK8F,GACxB,GAAIsc,OAAOC,MAAM9d,EAAOxC,WACtB,MAAM,IAAIzC,MAAM,qBAGlB,OAAOiF,EAsFyD+d,CAAeP,MACzEQ,EAAgBtC,GAAgB,YAAY,kBAAMa,GAAckB,MAChEQ,EAAYvC,GAAgB,SAAS,kBAAMsB,GAAeU,MAC1DQ,EAAexC,GAAgB,iBAAiB,kBAAMa,GAAcoB,MAE1E,MAAO,CACLC,iBACAI,gBACAG,cAAeF,EAAUb,SACzBgB,gBAAiBH,EAAUZ,WAC3Ba,iBAaSG,GAAwB,SAAC1iB,GACpC,IAAM2iB,EAAc,CAAC,aAAc,SAAU,kBAAmB,oBAOhE,GANApgB,OAAOC,KAAKxC,GAAO6C,SAAQ,SAAC3F,GAC1B,IAAKylB,EAAYxW,SAASjP,GACxB,MAAM,IAAIkC,MAAJ,0BAA6BlC,EAA7B,UAIL8C,EAAM4H,WAAY,MAAM,IAAIxI,MAAM,iCACvC,IAAMqI,EApJ2B,SAACA,GAClC,IAAImb,GAAU,EAKd,GAJInb,EAAUtE,OAAS,IAAGyf,GAAU,GAChCnb,EAAUtE,OAAS,KAAIyf,GAAU,GAChCnb,EAAUqZ,MAAM,oBAAmB8B,GAAU,GAE9CA,EACF,OAAOnb,EAET,MAAM,IAAIrI,MAAM,2BA2IEyjB,CAAoB7iB,EAAM4H,YAE5C,IAAK5H,EAAMgG,OAAQ,MAAM,IAAI5G,MAAM,6BACnC,IAAM4G,EAzIwB,SAACA,GAC/B,GAAIA,EAAO8a,MAAM,uBACf,OAAO9a,EAET,MAAM,IAAI5G,MAAM,wBAqID0jB,CAAiB9iB,EAAMgG,QAEtC,IAAKhG,EAAM+iB,gBAAiB,MAAM,IAAI3jB,MAAM,sCAC5C,IAAMqK,EAAiBsW,GAAgB,mBAAmB,kBAAM6B,GAA2B5hB,EAAM+iB,oBAC7FrZ,EAAkB,KAMtB,OAJI1J,EAAM+J,mBACRL,EAAkBqW,GAAgB,oBAAoB,kBAAM6B,GAA2B5hB,EAAM+J,sBAGxF,CACLnC,WAAYH,EACZzB,SACA+c,gBAAiBtZ,EACjBM,iBAAkBL,IAmBTsZ,GAAsB,SAACnjB,EAAY4hB,EAAuBwB,GACrE,IAAMvY,EAAM1I,KAAKC,MAAMghB,GASvB,OARe,IAAInjB,KAAKA,KAAKojB,IAC3BrjB,EAAKQ,iBAAmBohB,EAASrhB,KAAOsK,EACxC7K,EAAKU,cAAgBkhB,EAASnhB,MAAQoK,EACtC7K,EAAKY,cAAgC,EAAhBghB,EAAST,KAAWS,EAASR,KAAOvW,EACzD7K,EAAKe,cAAgB6gB,EAASP,KAAOxW,EACrC7K,EAAKiB,gBAAkB2gB,EAASN,OAASzW,EACzC7K,EAAKmB,gBAAkBygB,EAASL,OAAS1W,KAKhCyY,GAAS,SAACtjB,GAAD,OAAyBmC,KAAKC,MAAM,IAAInC,KAAKD,GAAMgC,UAAY,MAExEuhB,GAAmB,SAACtZ,EAAiCuZ,EAA+B5hB,GAC/F,KAAMA,GAAiB,GAAKA,IAAkBO,KAAKC,MAAMR,IACvD,MAAM,IAAIrC,MAAM,0BAElB,IAAMkkB,EAAqB,IAAI/jB,IAAI,IAAIoL,IAAIlJ,GAEnCwgB,EAAmBnY,EAAnBmY,eACFsB,EAAiBP,GAAoBf,EAAgBnY,EAAS0Y,cAAe,GAC7EgB,EAAoBR,GAAoBO,EAAgB3C,GAAc,SAAU,GAChF6C,EAAkBT,GAAoBf,EAAgBnY,EAASuY,cAAe,GAG9EqB,EAAc,IAAI9D,KAAG,IAAIrgB,IAAI8jB,GAAkB3Y,IAAI4Y,GAAoBxJ,MAAM,EAAGva,IAAImC,WAAWxB,YAC/FyjB,EAAc,IAAI/D,KAAG8D,GAAaE,KAAK9Z,EAAS2Y,iBAAiBoB,KAAK,KAAKC,QAEjF,GAAIH,EAAYI,GAAGL,GACjB,MAAM,IAAItkB,MAAM,oCAElB,GAAImkB,EAAiBE,EACnB,MAAM,IAAIrkB,MAAM,2CAElB,GAAImkB,EAAiBtB,EACnB,MAAM,IAAI7iB,MAAM,6CAGlB,IAAQmjB,EAAiBzY,EAAjByY,aAEFyB,EAAUT,EACVU,EAAcjB,GAAoBO,EAAgBhB,EAAc,GACtE,GAAIY,GAAOc,IAAgBd,GAAOa,GAChC,MAAM,IAAI5kB,MAAM,uCAElB,GAAI+jB,GAAOc,GAAed,GAAOa,KAAa,EAAG,CAC/C,IAAME,EAAU,CAAEte,UAAWud,GAAOlB,GAAiBnb,QAAS,IAAI8Y,KAAG,KAAK1f,YACpEikB,EAAa,CAAEve,UAAWud,GAAOK,GAAoB1c,QAAS,IAAI8Y,KAAG,KAAK1f,YAC1EkkB,EAAU,CAAExe,UAAWud,GAAOI,GAAiBzc,QAAS6c,EAAYzjB,YACpEmkB,EAAW,CAAEze,UAAWud,GAAOM,GAAkB3c,QAAS4c,EAAYxjB,YAEtEmE,EAAS,GAUf,OATAA,EAAOigB,QAAQD,GACXD,EAAQxe,UAAYye,EAASze,WAC/BvB,EAAOigB,QAAQF,GAEjB/f,EAAOigB,QAAQH,GACXD,EAAQte,UAAYue,EAAWve,WACjCvB,EAAOigB,QAAQJ,GAGV7f,EAQP,IALF,IAAMkgB,EAAM,GAGNC,EAAK,KAEA7M,EAAI,EAAGA,EADC,IACaA,GAAK,EAAG,CAEpC,IADA6M,EAAKxB,GAAoBO,EAAgBhB,EAAc5K,KAC7C8L,EAAiB,CACzBe,EAAKf,EACLc,EAAIlM,KAAKmM,GACT,MAGF,GADAD,EAAIlM,KAAKmM,GACLD,EAAIphB,QATO,IAUb,MAAM,IAAI/D,MAAM,qCAKtB,IAAMqlB,EAAYf,EAAYzM,IAAI0M,GAAaE,KAAKU,EAAIphB,OAAS,GAE3DuhB,EAAoBH,EAAI3J,SAAQ,SAAC4J,EAAI7M,GACzC,GAAmB,IAAf4M,EAAIphB,OACN,MAAO,CAAC,CAAEyC,UAAWud,GAAOM,GAAkB3c,QAAS4c,EAAYxjB,aAErE,GAAU,IAANyX,EACF,MAAO,CAAC,CAAE/R,UAAWud,GAAOqB,GAAK1d,QAAS6c,EAAYzjB,aAExD,IAAMykB,EAAchN,IAAM4M,EAAIphB,OAAS,EACnCugB,EACAC,EAAY3M,IAAIyN,EAAUb,KAAKjM,IAAIzX,WACvC,MAAO,CACL,CAAE0F,UAAWud,GAAOqB,GAAM,EAAG1d,QAAS6c,EAAY3M,IAAIyN,EAAUb,KAAKjM,EAAI,IAAIzX,YAC7E,CAAE0F,UAAWud,GAAOqB,GAAK1d,QAAS6d,EAAYzkB,gBAI5C0kB,EAAyB,GACzBV,EAAU,CAAEte,UAAWud,GAAOlB,GAAiBnb,QAAS,IAAI8Y,KAAG,KAAK1f,YACpEikB,EAAa,CAAEve,UAAWud,GAAOK,GAAoB1c,QAAS,IAAI8Y,KAAG,KAAK1f,YAQhF,OANA0kB,EAASN,QAAQH,GACbD,EAAQte,UAAYue,EAAWve,WACjCgf,EAASN,QAAQJ,GAGJU,EAASC,OAAOH,IAWpBI,GAAc,SAACC,EAAsCtjB,EAAuBiD,GACvF,IAAMiU,EAAM+J,GAAsBqC,GAE5Btb,EAAiB2Z,GAAiBzK,EAAIoK,gBAAiBpK,EAAI3S,OAAQvE,GACrEujB,EAAwB,KAE5B,GAAIrM,EAAI5O,iBAAkB,CACxB,IAAML,EAAkB0Z,GAAiBzK,EAAI5O,iBAAkB4O,EAAI3S,OAAQvE,INjPjC,SAACgI,EAA2BC,GACxE,IAAMub,EAAI,SAACvc,GAAD,gBAAkBhJ,EAAqBgJ,GAAvC,SAEVe,EAAe5G,SAAQ,SAACqiB,GACtB,IAAQtf,EAAcsf,EAAdtf,UACFuf,EAAgBD,EAAWpe,QAC3Bse,EAAiB1N,GAAoBhO,EAAiB9D,GAAWkB,QACvE,IAAM,IAAIvH,MAAI4lB,GAAeE,IAAI,IAAI9lB,MAAI6lB,IACvC,MAAM,IAAIhmB,MAAJ,sEAAyE6lB,EAAErf,GAA3E,aAA0FA,EAA1F,SAGV8D,EAAgB7G,SAAQ,SAACqiB,GACvB,IAAQtf,EAAcsf,EAAdtf,UACFuf,EAAgBzN,GAAoBjO,EAAgB7D,GAAWkB,QAC/Dse,EAAiBF,EAAWpe,QAClC,IAAM,IAAIvH,MAAI4lB,GAAeE,IAAI,IAAI9lB,MAAI6lB,IACvC,MAAM,IAAIhmB,MAAJ,sEAAyE6lB,EAAErf,GAA3E,aAA0FA,EAA1F,SMkOR0f,CAA+B7b,EAAgBC,GAC/Csb,EAAwB,CAAEhb,SAAUN,GAGtC,MAAO,CACLjF,GAAIC,EACJkD,WAAY+Q,EAAI/Q,WAChBkC,SAAUL,EACVM,iBAAkBib,ICrWP,SAASO,GAAmBpY,GACzC,IAAQyI,EAAkBzI,EAAlByI,MAAO5P,EAAWmH,EAAXnH,OAEf,OACE,uBAAK0L,UAAU,aAAaL,MAAOrL,EAAnC,UACE,uBAAK0L,UAAU,eAAf,UACGlQ,EAAkBwE,EAAQ4P,EAAMC,UAChC,IACAD,EAAMV,UAET,eAACI,GAAD,CAAWC,IAAKK,EAAMzB,MAAQ,GAAIqB,KAAM,Q,cCqC/BgQ,GAFC,CAAEzI,KA7CL,SAAC0I,GAsBZ,OArBa,SAActK,GACzB,IAAMuB,EAAUvB,GAAW,iBAAO,CAChCuK,OAAQ,CACNhK,QAAS,UACTiK,cAAe,OACfjS,SAAU,WAJEyH,GAahB,OACE,eAACyK,GAAA,EAAD,CAAQpQ,KAAK,QAAQ9D,UAAWgL,EAAQgJ,OAAQtI,QANlC,SAACyI,GACfA,EAAMC,iBACN3nB,OAAO6S,KAAKyU,EAAiB,WAI7B,+BA6BkBvI,OApBT,SAAC9J,GAiBd,OAhBe,SAAgB+H,GAC7B,IAAMuB,EAAUvB,GAAW,iBAAO,CAChC0C,WAAY,CACVlK,MAAO,uBACPH,WAAY,IACZE,SAAU,WAJEyH,GAQhB,OACE,eAAC2C,GAAA,EAAD,CAAYlR,QAAQ,YAAY8E,UAAWgL,EAAQmB,WAAnD,SACGzK,OClCI2S,GAA0B,CAAE9G,iBAAkB,KAErD+G,GAAc,SAACC,EAAkBpQ,GAAnB,OAA0C,IAAItW,IAAI0mB,GAAU5kB,IAAI,IAAI9B,IAAI,IAAIoL,IAAIkL,IAAWiE,MAAM,EAAGva,IAAImC,YAEtHwkB,GAAa,SAAC7H,EAAsB4H,EAAe3iB,EAAgBsS,GACvE,GAAIqQ,GAAyB,MAAbA,EAAkB,CAChC,IAAMjgB,EAASggB,GAAYC,EAAUrQ,EAAMC,UAE3C,OAAO4H,GACLY,EACAT,GAAQb,KAAR,kBAAwB/W,EAAxB,YAAkC4P,EAAMV,SACxC0I,GAAQV,OAAO,WACf6I,IAIJ,OAAOtI,GACLY,EACAmH,GAAQzI,KAAR,UAAgB1Z,EAAiBC,KACjCkiB,GAAQtI,OAAO,kBAIbiJ,GAAsB,SAAC9H,EAAsB4H,EAAe3iB,EAAgBsS,EAAYnO,GAC5F,GAAIwe,EAAU,CACZ,IAAMjgB,EAASkB,WAAWhG,EAAO+kB,EAAShf,MAAO,IAAI/G,WAErD,OAAOud,GACLY,EACAT,GAAQb,KAAR,4BAAkC/W,EAAlC,oBAAoDyB,EAApD,yBAA8EmO,EAAMV,SACpF0I,GAAQV,OAAO,WACf6I,IAIJ,OAAOtI,GACLY,EACAmH,GAAQzI,KAAR,UAAgB1Z,EAAiBC,KACjCkiB,GAAQtI,OAAO,wCAIbkJ,GAAoB,SAAC/H,EAAsB4H,EAAe3iB,EAAgBsS,EAAYyQ,GAC1F,GAAIJ,GACmBI,EAAMvc,SAASuc,EAAMvc,SAAS3G,OAAS,GAAG2D,UAE1Cmf,EAAU,CAC7B,IAAMjgB,EAASggB,GAAYC,EAAUrQ,EAAMC,UAE3C,OAAO4H,GACLY,EACAT,GAAQb,KAAR,UAAgBsJ,EAAMze,WAAtB,gCAAwD5B,EAAxD,YAAkE4P,EAAMV,SACxE0I,GAAQV,OAAO,kBACf6I,IAKN,OAAOtI,GACLY,EACAmH,GAAQzI,KAAR,UAAgB1Z,EAAiBC,KACjCkiB,GAAQtI,OAAO,4BAIboJ,GAAsB,SAACjI,EAAsB4H,EAAe3iB,EAAgBsS,EAAYyQ,GAC5F,GAAIJ,GAAyB,MAAbA,EAAkB,CAChC,IAAMjgB,EAASggB,GAAYC,EAAUrQ,EAAMC,UAE3C,OAAO4H,GACLY,EACAT,GAAQb,KAAR,sBAA4BsJ,EAAM7gB,eAAlC,+BAAuEQ,EAAvE,YAAiF4P,EAAMV,SACvF0I,GAAQV,OAAO,sBACf6I,IAIJ,OAAOtI,GACLY,EACAmH,GAAQzI,KAAR,UAAgB1Z,EAAiBC,KACjCkiB,GAAQtI,OAAO,6BAIbqJ,GAAuB,SAAClI,EAAsB4H,EAAe3iB,EAAgBsS,EAAY9P,GAC7F,GAAImgB,EAAU,CACZ,IAAMjgB,EAASggB,GAAYC,EAAUrQ,EAAMC,UAE3C,OAAO4H,GACLY,EACAT,GAAQb,KAAR,kBAAwBjX,EAAxB,6CAAyEE,EAAzE,YAAmF4P,EAAMV,SACzF0I,GAAQV,OAAO,qBACf6I,IAIJ,OAAOtI,GACLY,EACAmH,GAAQzI,KAAR,UAAgB1Z,EAAiBC,KACjCkiB,GAAQtI,OAAO,+BAIbsJ,GAAwB,SAACnI,EAAsBG,GAC/CA,EAAQiI,UACVhJ,GACEY,EACAT,GAAQb,KAAKyB,EAAQiI,UACrB7I,GAAQV,OAAO,WACf6I,IAIAvH,EAAQkI,UACVjJ,GACEY,EACAT,GAAQb,KAAKyB,EAAQkI,UACrBlB,GAAQtI,OAAO,aAKfyJ,GAAyB,SAACtI,EAAsBG,GAChDA,EAAQiI,UACVhJ,GACEY,EACAT,GAAQb,KAAKyB,EAAQiI,UACrB7I,GAAQV,OAAO,WACf6I,IAIAvH,EAAQkI,UACVjJ,GACEY,EACAT,GAAQb,KAAKyB,EAAQkI,UACrBlB,GAAQtI,OAAO,aC8EN0J,OAvMf,YAAmG,IAAvEhR,EAAsE,EAAtEA,MAAOuI,EAA+D,EAA/DA,cACjC1M,GAAS,iCAAkC,CAAEN,kBAAkB,IAE/D,IAAM/S,EAAW4f,cACTta,EAAsC4a,qBAAWlQ,IAAjD1K,KAER,EAAwBtG,mBAA2B,IAAnD,mBAAOuF,EAAP,KAAakkB,EAAb,KACA,EAAsCzpB,mBAAkB,IAAxD,mBAAO0pB,EAAP,KAAoBC,EAApB,KACA,EAA4C3pB,oBAAkB,GAA9D,mBAAO4pB,EAAP,KAAuBC,EAAvB,KAsBMC,EAAWC,cAET9I,EAAoBzB,cAApByB,gBAEF+I,EAAgB,uCAAG,WAAOtc,EAAcuc,GAArB,eAAAljB,EAAA,+EAEAkjB,IAFA,cAEfhjB,EAFe,yBAGdA,GAHc,mCAKf,gBAAajF,MALE,uBAMb,IAAIA,MAAM,eANG,cASrBqe,GACEY,EACAT,GAAQb,KAAR,UAAgBjS,EAAhB,oBAAgC,KAAE0T,UAClCgH,GAAQtI,OAAO,2BAZI,8DAAH,wDAkBhBoK,EAAiB,uCAAG,sBAAAnjB,EAAA,wFAAAA,EAAA,4CAAAA,EAAA,yDAEjBT,EAFiB,sBAGd,IAAItE,MAAM,gBAHI,cAKtB6nB,GAAkB,GALI,SAOhBG,EACJ,iBADoB,sBAEpB,sCAAAjjB,EAAA,sDACQojB,EAAaxP,MAAMC,KAAK,IAAIC,IAChCtV,EAAKqF,QAAO,SAACU,GAAD,QAASA,aAAatJ,UAAQqD,KAAI,SAACiG,GAAD,OAAQA,EAAad,gBAG5D+P,EAAI,EALf,YAKkBA,EAAI4P,EAAWpkB,QALjC,qBAMUsE,EAAY8f,EAAW5P,IACdmJ,MAAM,kBAPzB,0CASwCpd,EAAKA,KAAKM,QAAQyD,GAT1D,+BASsEV,oBATtE,iBASgBE,EAThB,EASgBA,MACRzI,QAAQC,IAAR,UAAegJ,EAAf,qBAAqCR,IAV7C,wDAYcuX,EAZd,qBAYsC/W,EAZtC,mBAac,IAAIrI,MAAMof,GAbxB,QAKyC7G,GAAK,EAL9C,uBAkBEnZ,QAAQC,IAAI,sBACZgf,GACEY,EACAT,GAAQb,KAAK,iDACba,GAAQV,OAAO,WACf6I,IAvBJ,2DAToB,uBAqCKqB,EACzB,qBADyC,sBAEzC,4BAAAjjB,EAAA,sEACuBT,EAAK6J,IAAIia,mBADhC,cACQnjB,EADR,yBAESA,GAFT,4CAvCoB,OAqChBiB,EArCgB,OA4CtBmY,GACEY,EACAT,GAAQb,KAAR,kCAAwCzX,IACxCsY,GAAQV,OAAO,uBACf6I,IAGI0B,EAAY,GAnDI,IAAAtjB,EAAA,iBAoDbwT,GApDa,iBAAAxT,EAAA,6DAqDdujB,EAAQ/kB,EAAKS,MAAMuU,EAAGA,EAAI8P,GAC1BziB,EAAS0iB,EAAMjlB,KAAI,SAACkd,GAAD,MAAa,CACpCna,eAAgBF,EAChBqiB,cAAehI,MAxDG,SA0DdyH,EACJ,gBADoB,sBAEpB,4BAAAjjB,EAAA,sEACuBT,EAAK6J,IAAIqa,aAAa5iB,GAD7C,cACQX,EADR,yBAESA,GAFT,4CA5DkB,0CAoDbsT,EAAI,EApDS,aAoDNA,EAAIhV,EAAKQ,QApDH,0CAoDbwU,GApDa,iBAoDWA,GAAK8P,EApDhB,wBAmEtBhK,GACEY,EACAT,GAAQb,KAAR,kBAAwBpa,EAAKQ,OAA7B,iBAA4CR,EAAKQ,OAAS,EAAI,IAAM,GAApE,MACAya,GAAQV,OAAO,WACf6I,IAGItH,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACnDupB,EA3EgB,WA2ELpJ,EA3EK,+BA2EqCnZ,GAE3D4hB,EAASW,GA7Ea,2GA+EtBZ,GAAkB,GA/EI,wDAAH,qDA8FvB,OACE,sBAAKvV,UAAU,OAAf,SACE,uBAAKA,UAAU,YAAf,UACE,qDAIA,uBAAKA,UAAU,6BAAf,UACE,sBAAKA,UAAU,4BAAf,SACE,uBAAKA,UAAU,2BAA2B0D,MAAO,CAAEvD,QAAS,QAA5D,UACE,gCACE,uBAAMH,UAAU,uBAAhB,wCAC2B/O,EAAKQ,OADhC,kBACgE,IAAhBR,EAAKQ,OAAe,IAAM,MAEzE,IACA2jB,EAAY3jB,OAAS,GAAM,uBAAMuO,UAAU,oBAAhB,mBAAwCoV,EAAY3jB,OAApD,uBAAyE2jB,EAAY3jB,OAAS,EAAI,IAAM,SAEtI,eAACoiB,GAAD,CAAoBvf,OA5BP,SAAC0Z,GACxB,IACMoI,EADkBpI,EAAQ1X,QAAO,SAACU,GAAD,QAAyBA,aAAatJ,UAAQqD,KAAI,SAACiG,GAAD,OAAOA,KAC/DjG,KAAI,SAACiG,GAAD,OJmONiX,EInOwCjX,GJmOLoB,SAAS6V,EAAO7V,SAAS3G,OAAS,GAAG2D,QAAzE,IAAC6Y,KIlO3Btb,EAAS,IAAI9E,IAAI,KAKrB,OAHAuoB,EAASjlB,SAAQ,SAAC6F,GAChBrE,EAASA,EAAO2S,IAAI,IAAIzX,IAAImJ,OAEvBrE,EAAOnE,WAoBwB6nB,CAAiBplB,GAAOiT,MAAOA,SAI/D,qBAAGlE,UAAU,sBAAb,sFAGG,IACD,oBAAGlL,KAAI,UAAKxI,GAAL,+BAAP,+CAJF,OASA,eAACgqB,GAAA,EAAD,CACEtW,UAAU,8BACVjN,GAAG,oBACHwjB,YAAY,cACZC,QAAS,EACTC,QAAS,EACTC,SA5KgB,SAACvC,GACzB,IAAK,IAAD,EACF,GAAI,OAACniB,QAAD,IAACA,GAAD,UAACA,EAAMiN,mBAAP,QAAC,EAAmB1B,gBACtB,MAAM,IAAI7P,MAAM,oCAElBZ,QAAQC,IAAImX,GACZ,IAAM5V,EAAQ6lB,EAAMwC,OAAOhrB,MACrBqiB,GJ6UuC4I,EI7UMtoB,EJ6UoByB,EI7UbmU,EAAMC,SJ8UvDsK,GAAwBmI,GACzB7lB,KAAI,SAACiG,EAAGhE,GAClB,IACE,OAAOogB,GAAYpc,EAAGjH,EAAeiD,EAAQ,GAC7C,MAAOwb,GACP,GAAIA,aAAa9gB,MACf,OAAO8gB,EAET,MAAM,IAAI9gB,MAAM,oBIrVVmpB,EAAiB7I,EAAQ1X,QAAO,SAACU,GAAD,OAAOA,aAAatJ,SAAOqD,KAAI,SAACiG,GAAD,OAAOA,KAC5Eme,EAAQnH,GACRqH,EAAewB,GACf,MAAOrI,GACHA,aAAa9gB,QACfynB,EAAQ,IACRE,EAAe,CAAC7G,IAChB1hB,QAAQC,IAAIyhB,IJqU8B,IAACoI,EAA0B7mB,QIrKrE,eAACge,GAAD,CAAaC,QAAS/c,EAAMiT,MAAOA,EAAOuI,cAAeA,EAAeC,cAAY,IACpF,eAACoK,GAAA,EAAD,CACEC,WAAY9lB,EAAKQ,QAAU,GAA4B,IAAvB2jB,EAAY3jB,SAAiB6jB,GAC7D5J,QAASkK,EACToB,QAAS1B,EACT7W,KAAK,SACLuB,UAAU,SALZ,0B,UCxLOiX,OArBf,SAAoBzW,GAClB,IAAQxO,EAAsC4a,qBAAWlQ,IAAjD1K,KACAqK,EAA4BmE,EAA5BnE,gBAAiB/H,EAAWkM,EAAXlM,OAEzB,IAAKtC,EACH,MAAMtE,MAAM,4BAWd,OACE,yBAAQsS,UAAU,SAASvB,KAAK,SAASiN,QATxB,WACjB1Z,EAAK0M,SAASwY,eACZllB,EAAK6J,IAAIsb,cAAcxf,WACvB0E,EACA/H,IAKF,mB,oGC2CW8iB,OA9Cf,YAA4E,IAArDC,EAAoD,EAApDA,gBAAiBC,EAAmC,EAAnCA,mBAC9BtlB,EAAsC4a,qBAAWlQ,IAAjD1K,KAER,IAAKA,EACH,MAAMtE,MAAM,4BAGd,IAAQiQ,EAAS3L,EAAKiN,YAAdtB,KAEJA,EAAKlM,OAAS,IAA0B,KAApB4lB,IAA2B1Z,EAAKlD,SAAS4c,KAC/DC,EAAmB3Z,EAAK,IAG1B,IAAM4Z,EAAiC,SAACpD,GACtCmD,EAAmBnD,EAAMwC,OAAOhrB,QAGlC,OAAIgS,EAAKlM,OAAS,EAEd,iCACE,eAAC+lB,GAAA,EAAD,0CACA,eAACC,GAAA,EAAD,CACEC,UAAQ,EACRxX,GAAI,CAAEiK,aAAc,EAAG5b,MAAO,GAC9B5C,MAAO0rB,EACPX,SAAUa,EAJZ,SAMG5Z,EAAK5M,KAAI,SAAC4mB,GAAD,OAAS,eAACC,GAAA,EAAD,CAAUjsB,MAAOgsB,EAAjB,SAAuBA,YAOhD,eAACE,GAAA,EAAD,CACEH,UAAQ,EACRxc,QAAQ,WACR4I,KAAK,QACL5D,GAAI,CAAE4X,OAAQ,SAAUvpB,MAAO,QAC/BwE,GAAG,sBACHglB,MAAM,uBACNrB,SAAUa,KC/BDS,OAlBf,YAA+F,IAA7DC,EAA4D,EAA5DA,oBAAqBC,EAAuC,EAAvCA,uBAKrD,OACE,eAACL,GAAA,EAAD,CACE3X,GAAI,CAAE3R,MAAO,GACbwE,GAAG,4BACHglB,MAAM,uBACNI,WAAS,EACT3B,QAAS,EACTE,SAX4B,SAAClI,GAC/B0J,EAAuB1J,EAAEmI,OAAOhrB,QAW9BF,aAAcwsB,KC4DLG,OA/Df,SAA2B5X,GACzB,IAAQxO,EAAsC4a,qBAAWlQ,IAAjD1K,KACAqK,EAAmCmE,EAAnCnE,gBAAiB/H,EAAkBkM,EAAlBlM,OAAQ4P,EAAU1D,EAAV0D,MAE3BmU,EAAkBvoB,EAAkBwE,EAAQ4P,EAAMC,UAElDmU,EAAkB,2BAAuBjc,EAAvB,wBAAsDgc,EAAtD,+BAA4F5rB,OAAOC,SAASoI,KAAKyjB,QAAQ,UAAW,KAC5J,EAAsC7sB,mBAAS4sB,GAA/C,mBAAOrc,EAAP,KAAoBuc,EAApB,KACA,EAA8D9sB,mBAAS,IAAvE,mBAAO+sB,EAAP,KAAgCC,EAAhC,KAEA,EAAwBhtB,oBAAS,GAAjC,mBAAO4T,EAAP,KAAaC,EAAb,KAEMoZ,EAAc,kBAAMpZ,GAAQ,IAElC,IAAKvN,EACH,MAAMtE,MAAM,4BAgBd,OACE,uCACE,yBAAQsS,UAAU,SAASvB,KAAK,SAASiN,QAtB1B,kBAAMnM,GAAQ,IAsB7B,2BACA,eAACqZ,GAAA,EAAD,CAAQtZ,KAAMA,EAAMY,GAAI,CAAE8J,QAAS,EAAG6O,SAAU,GAAKC,QAASH,EAA9D,SACE,wBAAM3Y,UAAU,cAAc+Y,SAjBjB,WAAO,IAAD,EACjBC,EAAOhd,GACXC,EACAjK,EAAK6J,IAAIsb,cAAcxf,WACvB3F,EAAK0M,SAASyY,cAAcxf,WAC5BrD,EACA+H,EACAoc,GAGF,UAAAhsB,OAAO6S,KAAK0Z,EAAM,iBAAlB,SAA6BC,SAOzB,UACE,gBAACC,GAAA,EAAD,2BAEE,eAACzN,EAAA,EAAD,CACE,aAAW,QACXC,QAASiN,EACTzY,GAAI,CACFiZ,SAAU,WACVxW,MAAO,EACPhB,IAAK,GANT,SASE,eAAC,KAAD,SAGJ,gBAACyX,GAAA,EAAD,CAAe1V,MAAO,CAAEmV,SAAU,QAASQ,WAAY,UAAvD,UACE,eAAC,GAAD,CAAahC,gBAAiBoB,EAAyBnB,mBAAoBoB,IAC3E,eAAC,GAAD,CAAwBT,oBAAqBhc,EAAaic,uBAAwBM,OAEpF,eAACc,GAAA,EAAD,CAAepZ,GAAI,CAAE8J,QAAS,kBAA9B,SACE,yBAAQhK,UAAU,4BAA4BvB,KAAK,SAAnD,6BCmDG8a,OAjHf,SAAgC/Y,GAC9B,IAAQ5M,EAAqC4M,EAArC5M,aAAcG,EAAuByM,EAAvBzM,SAAUgjB,EAAavW,EAAbuW,SACxB/kB,EAAsC4a,qBAAWlQ,IAAjD1K,KACA2a,EAAoBzB,cAApByB,gBACF6I,EAAWC,cACX/oB,EAAW4f,cAEjB,EAAoC5gB,oBAAkB,GAAtD,mBAAO8tB,EAAP,KAAmBC,EAAnB,KAEM/D,EAAgB,uCAAG,WAAOtc,EAAcuc,GAArB,eAAAljB,EAAA,+EAEAkjB,IAFA,cAEfhjB,EAFe,yBAGdA,GAHc,sCAKrBoZ,GACEY,EACAT,GAAQb,KAAR,UAAgBjS,EAAhB,2CACA0a,GAAQtI,OAAO,UARI,8DAAH,wDActB,IAAKxZ,EACH,MAAMtE,MAAM,4BA2Ed,OACE,eAACopB,GAAA,EAAD,CACE9W,UAAU,qBACVvB,KAAK,SACLvD,QAAQ,YACRwQ,QA7EiB,WACnB,IAAMgO,EAAO,uCAAG,0CAAAjnB,EAAA,yDACTT,EADS,sBAEN,IAAItE,MAAM,gBAFJ,cAKd+rB,GAAc,GAORE,EAAmD,GAZ3C,kBAgBN3nB,EAAK6J,IAAI+d,kBAAkBhmB,GAhBrB,OAiBZ+lB,EAA2B5E,SAA3B,gCAA+DnhB,GAjBnD,uDAmBR,gBAAalG,OAnBL,oBAoBVZ,QAAQC,IAAR,yBACQ+f,EArBE,KAqBFA,SACKrS,SAAS,iDAtBZ,wBAuBRkf,EAA2B3E,SAA3B,wCAAuEphB,EAAvE,aAAwFkZ,GACxF2M,GAAc,GAxBN,yDA4BJ,IAAI/rB,MAAM,eA5BN,yBA+BZunB,GAAuBtI,EAAiBgN,GA/B5B,qBAkCRE,EAAkD,GAlC1C,UAsCN9D,EAAY,IAtCN,IAAAtjB,EAAA,iBAuCHwT,GAvCG,eAAAxT,EAAA,6DAwCJujB,EAAQjiB,EAASrC,MAAMuU,EAAGA,EAAI8P,GAxC1B,SA0CJL,EACJ,gBADoB,sBAEpB,4BAAAjjB,EAAA,sEACuBT,EAAK6J,IAAIie,aAAa9D,GAD7C,cACQrjB,EADR,yBAESA,GAFT,4CA5CQ,0CAuCHsT,EAAI,EAvCD,aAuCIA,EAAIlS,EAAStC,QAvCjB,0CAuCHwU,GAvCG,iBAuCyBA,GAAK8P,EAvC9B,wBAkDZ8D,EAA0B9E,SAA1B,8BAA4DnhB,GACtDmZ,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACzD4oB,EAAS,IAAD,OAAKzI,EAAL,wBACRtgB,OAAOC,SAASqtB,SArDJ,wDAuDR,gBAAarsB,OAvDL,iBAwDVZ,QAAQC,IAAR,wBACQ+f,EAzDE,KAyDFA,QACR+M,EAA0B7E,SAA1B,wCAAsEphB,EAAtE,aAAuFkZ,GACvF2M,GAAc,GA3DJ,8BA6DJ,IAAI/rB,MAAM,eA7DN,yBAgEZonB,GAAsBnI,EAAiBkN,GAhE3B,2FAAH,qDAoEbH,KASE1C,QAASwC,EACTzC,SAAUA,GAAYyC,EANxB,qBC1FW,SAASQ,GAAT,GAAiG,IAAvE9V,EAAsE,EAAtEA,MAAOuI,EAA+D,EAA/DA,cACxC/f,EAAW4f,cACTK,EAAoBzB,cAApByB,gBACF/Y,EAAuBiS,SAASoU,cAAYrmB,cAAgB,GAAI,IAC9D5B,EAAsC4a,qBAAWlQ,IAAjD1K,KACR,EAAoCtG,mBAAc,MAAlD,mBAAOwuB,EAAP,KAAmBC,EAAnB,KACA,EAA4BzuB,mBAAgB,IAA5C,mBAAO4H,EAAP,KAAe8mB,EAAf,KACA,EAAoC1uB,oBAAkB,GAAtD,mBAAO8tB,EAAP,KAAmBC,EAAnB,KACA,EAAsC/tB,mBAAiB,WAAvD,mBAAO2uB,EAAP,KAAoBC,EAApB,KAEAva,GAAS,eAAD,OAAgBnM,EAAhB,gBAA4C,CAAE6L,kBAAkB,IAExEvT,qBAAU,WACR,IAAMwtB,EAAO,uCAAG,4CAAAjnB,EAAA,yDACd6nB,EAAe,WACfxtB,QAAQC,IAAR,4BAAiC6G,EAAjC,IAAiD,YAE5C5B,EAJS,oDAMRuoB,EAAe,IAAIC,gBAAgB/tB,OAAOC,SAAS+tB,QACnDC,EAAsCH,EAAaI,IAAI,qBAP/C,wBASZL,EAAe,WACfxtB,QAAQC,IAAR,4BAAiC6G,EAAjC,IAAiD,YAVrC,kCAaRhC,EAAS8oB,EAAqB9tB,MAAM,KAAK,GAC/CE,QAAQC,IAAI,SAAU6E,GAdR,UAeSI,EAAK+M,YAAY6b,SAAShpB,EAAQ,kBAf3C,QAeRgpB,EAfQ,OAgBd9tB,QAAQC,IAAI6tB,GAENvf,EAAauf,EAASC,YAAYC,QAAQ,GAAGC,aAAaC,YAE1DC,EAAgBL,EAASM,OAAeC,aAExC3nB,EAAO1H,KAAKC,MAAMqvB,KAAKR,EAASC,YAAYC,QAAQ,GAAGC,aAAavnB,OACpE2E,EAAM3E,EAAK2E,KAAOrM,KAAKC,MAAMyH,EAAK2E,KAClCkjB,EAAkBljB,GAAOA,EAAIrE,eAEnChH,QAAQC,IAAIsO,EAAY4f,EAAcznB,EAAM2E,EAAKkjB,GAEnB,qBAAfhgB,QAAyDxL,IAApBwrB,GAAiCA,IAAoBznB,GAGvG0mB,EAAe,aACfxtB,QAAQC,IAAR,4BAAiC6G,EAAjC,IAAiD,gBAEjD0mB,EAAe,WACfxtB,QAAQC,IAAR,4BAAiC6G,EAAjC,IAAiD,aAnCrC,4CAAH,qDAsCb8lB,MACC,CAAC1nB,EAAM4B,IAEV1H,qBAAU,WACR,IAAMovB,EAAe,uCAAG,4BAAA7oB,EAAA,yDACtB0nB,EAAc,MAEdrtB,QAAQC,IAAR,kCAAuC6G,EAAvC,YAAuDymB,IAClDroB,EAJiB,oDAKtBlF,QAAQC,IAAIstB,GACQ,YAAhBA,EANkB,iEAUDroB,EAAK6J,IAAI0f,cAAc3nB,GAVtB,OAUhBjB,EAVgB,OAWtBwnB,EAAcxnB,GAAU,aAXF,4CAAH,qDAcrB2oB,MACC,CAACtpB,EAAM4B,EAAcymB,IAExBnuB,qBAAU,WACR,IAAMsvB,EAAW,uCAAG,4BAAA/oB,EAAA,yDAClB2nB,EAAU,IACVttB,QAAQC,IAAI,sBACPiF,EAHa,oDAMbkoB,GAA6B,cAAfA,EAND,iEASGloB,EAAK6J,IAAI4f,UAAUvB,EAAWwB,eATjC,OASZ/oB,EATY,OAUlBynB,EAAUznB,EAAO5B,KAAI,SAACiG,GAAD,OAAYnG,OAAOiC,OAAOkE,EAAE,GAAGif,cAAe,CAAEljB,GAAIiE,EAAE,SAVzD,4CAAH,qDAajBwkB,MACC,CAACxpB,EAAMkoB,IAEV,IAAM1E,EAAWC,cAEXC,EAAgB,uCAAG,WAAOtc,EAAcuc,GAArB,eAAAljB,EAAA,+EAEAkjB,IAFA,cAEfhjB,EAFe,yBAGdA,GAHc,sCAKrBoZ,GACEY,EACAT,GAAQb,KAAR,UAAgBjS,EAAhB,2CACA0a,GAAQtI,OAAO,UARI,8DAAH,wDAsDtB,IAAK0O,EACH,OAAO,KAGT,GAAmB,cAAfA,EAA4B,CAC9B,IAAMnN,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACzD,OACE,uBAAKoT,UAAU,YAAf,UACE,8BAAqB,cAAhBqa,EAAA,+BAAsDzmB,EAAtD,+CAA2GA,EAA3G,sCACL,iCACE,wBADF,QAGG,IACD,eAAC,IAAD,CAAMwM,GAAE,WAAM2M,GAAN,OAA4BN,EAAgB,SAAW,GAAvD,YAAR,qBACC,IALH,+BAOG,IACD,eAAC,IAAD,CAAMrM,GAAE,WAAM2M,GAAN,OAA4BN,EAAgB,SAAW,GAAvD,iBAAR,0BACC,IATH,0CAgBN,IAAKza,EAAM,OAAO,KAClB,IAAQyL,EAAYzL,EAAKiN,YAAjBxB,QAER,OACE,uBAAKuC,UAAU,YAAf,UACE,8CAEG,IACApM,KAEH,uBAAKoM,UAAU,wDAAf,UACE,uBAAKA,UAAU,2BAA2B0D,MAAO,CAAEvD,QAAS,QAA5D,UACE,sDACkBvM,GACf,IACAsmB,EAAWyB,WAAc,uBAAM3b,UAAU,mBAAhB,0BAE5B,eAAC6T,GAAD,CAAoB3P,MAAOA,EAAO5P,OAAQ4lB,EAAW0B,mBAErD1B,EAAW2B,QAAUpP,GACrB,uBAAKzM,UAAU,kCAAf,WACIka,EAAWyB,WAAale,GAAW,eAAC,GAAD,CAAYpB,gBAAiBzI,EAAcU,OAAQ4lB,EAAW0B,gBACjG1B,EAAWyB,WAAa,eAAC,GAAD,CAAmBtf,gBAAiBzI,EAAcU,OAAQ4lB,EAAW0B,aAAc1X,MAAOA,IACpH,eAAC,GAAD,CACEtQ,aAAcsmB,EAAWnnB,GACzBgB,SAAUmmB,EAAWwB,cACrB3E,SAAUmD,EAAW2B,YAI1B3B,EAAW2B,QAAU3B,EAAWwB,cAAcjqB,OAAS,GAAKgb,GAC3D,sBAAKzM,UAAU,kCAAf,SACE,eAAC8W,GAAA,EAAD,CACE9W,UAAU,SACVvB,KAAK,SACLiN,QApGU,WACpB,IAAMoQ,EAAa,uCAAG,oCAAArpB,EAAA,yDACfT,EADe,sBAEZ,IAAItE,MAAM,gBAFE,gBAKlB+rB,GAAc,GACR1lB,EAAWmmB,EAAWwB,cACtB3F,EAAY,IAPA,IAAAtjB,EAAA,iBAQTwT,GARS,eAAAxT,EAAA,6DASVujB,EAAQjiB,EAASrC,MAAMuU,EAAGA,EAAI8P,GATpB,SAWVL,EACJ,iBADoB,sBAEpB,4BAAAjjB,EAAA,sEACuBT,EAAK6J,IAAIigB,cAAc9F,GAD9C,cACQrjB,EADR,yBAESA,GAFT,4CAbc,0CAQTsT,EAAI,EARK,YAQFA,EAAIlS,EAAStC,QARX,0CAQTwU,GARS,iBAQmBA,GAAK8P,EARxB,uBAoBlBhK,GACEY,EACAT,GAAQb,KAAR,2CAAiDzX,IACjDsY,GAAQV,OAAO,WACf6I,IAEItH,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACzD4oB,EAAS,IAAD,OAAKzI,EAAL,mBACRtgB,OAAOC,SAASqtB,SA5BE,kDA8BlBjtB,QAAQC,IAAR,wBA9BkB,yBAgClB0sB,GAAc,GAhCI,6EAAH,qDAoCnBqC,KAgEU9E,QAASwC,EACTte,QAAQ,YACR+G,MAAM,UANR,uBAYHiY,EAAW2B,QAA8C,IAApC3B,EAAWwB,cAAcjqB,QAC7C,sBAAKiS,MAAO,CAAEqY,UAAW,IAAzB,SACE,eAACC,GAAA,EAAD,CAAOC,SAAS,UAAhB,0CAKH/B,EAAW2B,QAAU3B,EAAWwB,cAAcjqB,OAAS,IACxD,eAACsc,GAAD,CAAaC,QAAS1a,EAAQ4Q,MAAOA,EAAOuI,cAAeA,EAAeC,cAAY,O,cCpO/E,SAASwP,GAAqBzgB,GAC3C,IAAQ6D,EAA8B7D,EAA9B6D,KAAMC,EAAwB9D,EAAxB8D,QAAS2a,EAAeze,EAAfye,WACfloB,EAAsC4a,qBAAWlQ,IAAjD1K,KACR,EAAoCtG,oBAAkB,GAAtD,mBAAO8tB,EAAP,KAAmBC,EAAnB,KACQ9M,EAAoBzB,cAApByB,gBACF6I,EAAWC,cACX/oB,EAAW4f,cAEjBxf,QAAQC,IAAImtB,GACZptB,QAAQC,IAAIysB,EAAYC,GAExB,IAAM/D,EAAgB,uCAAG,WAAOtc,EAAcuc,GAArB,eAAAljB,EAAA,+EAEAkjB,IAFA,cAEfhjB,EAFe,yBAGdA,GAHc,sCAKrBoZ,GACEY,EACAT,GAAQb,KAAR,UAAgBjS,EAAhB,2CACA0a,GAAQtI,OAAO,UARI,8DAAH,wDAchB2Q,EAAc,uCAAG,oCAAA1pB,EAAA,gEACfT,QADe,IACfA,KAAM6J,IADS,0DAKnB4d,GAAc,GACR1lB,EAAWmmB,EAAWwB,cACtB3F,EAAY,IAPC,IAAAtjB,EAAA,iBAQVwT,GARU,eAAAxT,EAAA,6DASXujB,EAAQjiB,EAASrC,MAAMuU,EAAGA,EAAI8P,GATnB,SAWXL,EACJ,iBADoB,sBAEpB,4BAAAjjB,EAAA,sEACuBT,EAAK6J,IAAIigB,cAAc9F,GAD9C,cACQrjB,EADR,yBAESA,GAFT,4CAbe,0CAQVsT,EAAI,EARM,YAQHA,EAAIlS,EAAStC,QARV,0CAQVwU,GARU,iBAQkBA,GAAK8P,EARvB,uBAmBnBhK,GACEY,EACAT,GAAQb,KAAR,2CAAiD6O,EAAWnnB,KAC5DmZ,GAAQV,OAAO,WACf6I,IAEItH,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACzD4oB,EAAS,IAAD,OAAKzI,EAAL,mBACRtgB,OAAOC,SAASqtB,SA3BG,kDA6BnBjtB,QAAQC,IAAR,wBA7BmB,yBA+BnB0sB,GAAc,GA/BK,6EAAH,qDAmCpB3sB,QAAQC,IAAIovB,GAEZ,IAAMC,EAAkB,WACtB,IAAM1C,EAAO,uCAAG,sBAAAjnB,EAAA,sEACR0pB,IADQ,OAEd5c,GAAQ,GAFM,2CAAH,qDAKbma,KAOIf,EAAc,WAClBpZ,GAAQ,IASV,IAAKvN,EACH,OAAO,KAmDT,OACE,+BACGkoB,GAjDH,gBAACtB,GAAA,EAAD,CACEtZ,KAAMtN,EAAKiN,YAAYC,UAAYI,GAAQ4a,EAC3CpB,QAASH,EACT,kBAAgB,qBAChB,mBAAiB,2BAJnB,UAME,gBAACO,GAAA,EAAD,CAAanmB,GAAG,qBAAhB,iCAEE,eAAC0Y,EAAA,EAAD,CACE,aAAW,QACXC,QAASiN,EACTzY,GAAI,CACFiZ,SAAU,WACVxW,MAAO,EACPhB,IAAK,GANT,SASE,eAAC,KAAD,SAGJ,eAACyX,GAAA,EAAD,UACE,gBAACiD,GAAA,EAAD,CAAmBtpB,GAAG,2BAAtB,wBAEG,IACAmnB,EAAWnnB,GACX,IAJH,yJAUF,gBAACumB,GAAA,EAAD,WACE,eAACpF,GAAA,EAAD,CAAQxI,QAASiN,EAAa1W,MAAM,QAApC,oBACA,eAAC6U,GAAA,EAAD,CACE9W,UAAU,SACVvB,KAAK,SACLiN,QAAS0Q,EACTpF,QAASwC,EACTte,QAAQ,YACR+G,MAAM,UANR,4BAgB6B,OCpJ9B,IAAMqa,GAAiB3f,wBAA+B,CAC3D2C,MAAM,EACNC,QAAS,kBAAM,QCUF,SAASgd,GAAT,GAAuG,IAAvErY,EAAsE,EAAtEA,MAAOuI,EAA+D,EAA/DA,cACpD1M,GAAS,2BAA4B,CAAEN,kBAAkB,IAEzD,IAAM/S,EAAW4f,cACTta,EAAsC4a,qBAAWlQ,IAAjD1K,KACR,EAAsCtG,mBAAgB,IAAtD,mBAAO8wB,EAAP,KAAoBC,EAApB,KAEAvwB,qBAAU,WACR,IAAMwwB,EAAgB,uCAAG,4BAAAjqB,EAAA,yDACvBgqB,EAAe,IACf3vB,QAAQC,IAAI,0BACPiF,EAHkB,iEAMFA,EAAK6J,IAAI8gB,oBANP,OAMjBhqB,EANiB,OAOvB8pB,EAAe9pB,GAPQ,2CAAH,qDAUtB+pB,MACC,CAAC1qB,IAwBJ,IAAM+a,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GACnDgwB,EAAoB,WAAO7P,EAAP,6BAEpB8P,EAAsBL,EAAYhW,MAAK,SAACxP,EAAGyP,GAAJ,OAAUzP,EAAEjE,GAAK0T,EAAE1T,MAAI+pB,UAAUC,MAAK,SAAC/lB,GAAD,OAAOA,EAAE6kB,UAEtFmB,EAAiBpQ,qBAAW0P,IAElC,OACE,sBAAKtc,UAAU,OAAf,SACE,uBAAKA,UAAU,YAAf,UACE,mDAIA,eAAC,GAAD,CACEV,KAAMmN,GAAiBuQ,EAAe1d,KACtCC,QAASyd,EAAezd,QACxB2a,WAAY2C,IAGU,IAAvBL,EAAY/qB,QACX,kEAKsB,IAAvB+qB,EAAY/qB,QACX,gBAAC6S,GAAA,EAAD,CAAOtE,UAAU,aAAa,aAAW,oBAAzC,UACE,eAACuE,GAAA,EAAD,CAAWvE,UAAU,aAArB,SACE,gBAACwE,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,CAAWC,MAAM,SAAjB,gBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,oBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,qCACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,6BACC+H,GAAiB,eAAChI,GAAA,EAAD,CAAWC,MAAM,QAAQnW,MAAM,KAA/B,yBAGtB,eAACoW,GAAA,EAAD,UACG6X,EAAYzrB,KAAI,SAACksB,GAAD,OACf,gBAACzY,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,eAAC,IAAD,CAAMtE,GAAE,WAAM2M,EAAN,YAA6BN,EAAgB,SAAW,GAAxD,wBAA0EwQ,EAAMlqB,IAAxF,SAA+FkqB,EAAMlqB,OAEvG,eAAC0R,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BuY,EAAMpB,OAAS,MAAQ,OAClD,eAACpX,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BuY,EAAMvB,cAAcjqB,SAC/C,gBAACgT,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACG5U,EAAkBmtB,EAAMrB,aAAc1X,EAAMC,UAD/C,OAGGD,EAAMV,OAHT,OAKE,eAACI,GAAD,CAAWC,IAAKK,EAAMzB,MAAQ,GAAIqB,KAAM,QAEzC2I,GACC,eAAChI,GAAA,EAAD,CAAWC,MAAM,QAAjB,UACIuY,EAAMpB,QACR,eAAC,GAAD,CACEjoB,aAAcqpB,EAAMlqB,GACpBgB,SAAUkpB,EAAMvB,cAChB3E,SAAUkG,EAAMpB,aAnBToB,EAAMlqB,YA8B5B0Z,GACD,eAAC,IAAD,CAAMrM,GAAIwc,EAAV,SACE,yBAAQ5c,UAAU,SAASvB,KAAK,SAAhC,uC,8CC1HK,SAASye,GAAe1c,GACrC,IACEvP,EACEuP,EADFvP,KAAMylB,EACJlW,EADIkW,SAAUyG,EACd3c,EADc2c,eAAgBC,EAC9B5c,EAD8B4c,gBAG5BC,EAAY,CAAC,CACjBC,YAAa,KAUf,EAAsC5xB,oBAPjB,WACnB,OAAIuF,EAAKQ,OAAS,EACTR,EAAKF,KAAI,SAACiG,GAAD,MAAgB,CAAEsmB,YAAatmB,MAE1CqmB,KAGT,mBAAOE,EAAP,KAAoBC,EAApB,KAKMC,EAAgB,WACpB,IAAMC,EAAI,uBAAOH,GAAP,CAAoB,CAC5BD,YAAa,MAEfE,EAAeE,GACfhH,EAASgH,IAULC,EAAe,SAAC3qB,EAAemhB,GACnC,MAAwBA,EAAMwC,OAAtBvd,EAAR,EAAQA,KAAMzN,EAAd,EAAcA,MACRiyB,EAAQ,aAAOL,GACrBK,EAAK5qB,GAAOoG,GAAQzN,EACpB6xB,EAAeI,GACfT,EAAexxB,GACf+qB,EAASkH,IAGX,OACE,sBAAK5d,UAAU,mBAAf,SAEIud,EAAYxsB,KAAI,SAAC8sB,EAAyB7qB,GACxC,IAAQsqB,EAAgBO,EAAhBP,YACFQ,EAAS9qB,EACf,OACE,uBAAKgN,UAAU,aAAf,UACE,wBAAOvB,KAAK,OAAOiY,SAAU,SAAClI,GAAD,OAAOmP,EAAa3qB,EAAOwb,IAAI7iB,MAAO2xB,EAAalkB,KAAK,cAAc4G,UAAU,iBAChG,IAAX8d,EAEE,eAACrS,EAAA,EAAD,CAAY,aAAW,eAAeC,QAAS+R,EAA/C,SACE,eAAC,KAAD,MAIF,eAAChS,EAAA,EAAD,CAAY,aAAW,cAAcC,QAAS,kBAhCpC,SAAC1Y,GACzB,IAAM0qB,EAAI,aAAOH,GACjBG,EAAKK,OAAO/qB,EAAO,GACnBwqB,EAAeE,GACfhH,EAASgH,GA4ByDM,CAAkBF,IAAtE,SACE,eAAC,KAAD,MAGN,uBAAK9d,UAAU,iBAAf,UACGsd,GA/CG,cA+CYF,EAAgBE,IAA8B,uBAAMtd,UAAU,MAAhB,oCAhD5D,YAiDDod,EAAgBE,IAA4B,uBAAMtd,UAAU,OAAhB,8BAfhB8d,QC9C9B,SAASG,KACtBle,GAAS,qCAAsC,CAAEN,kBAAkB,IAEnE,IAAQkN,EAAoBzB,cAApByB,gBACR,EAA0GC,qBAAWlQ,IAA7G1K,EAAR,EAAQA,KAAMksB,EAAd,EAAcA,OAAQC,EAAtB,EAAsBA,SAEtB,EAAgD5yB,EAAgB,wCAAwC,GAAxG,mBAAO6yB,EAAP,KAAyBC,EAAzB,KAEA,EAA4C9yB,EAAgB,qCAAsC,IAAlG,mBAAOiM,EAAP,KAAuB8mB,EAAvB,KACA,EAAwB/yB,EAAgB,2BAA4B,IAApE,mBAAO6N,EAAP,KAAamlB,EAAb,KAEA,EAA8ChzB,EAAgB,sCAAuC,IAArG,mBAAOizB,EAAP,KAAwBC,EAAxB,KACA,EAA4ClzB,EAAgB,qCAAsC,IAAlG,mBAAOmzB,EAAP,KAAuBC,EAAvB,KAEMC,EAAU,UACVC,EAAQ,QACRC,EAAY,YAEZC,EAAoB,gBAEpBC,EAA2B,UAAM5lB,EAAN,YAAc/M,GAE/C,EAA8CX,mBAAc,CAAE,GAAIozB,IAAlE,mBAAO1B,EAAP,KAAwB6B,EAAxB,KAEMC,EAAwB9T,sBAAW,uCAAC,WAAOrV,GAAP,iBAAAtD,EAAA,yDACnCT,EADmC,oDAExClF,QAAQC,IAAI,kBAAmBqwB,IAE3BA,EAAgBrnB,GAJoB,qDASpCA,EAAUqZ,MAAM,kBAToB,uBAUtC6P,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,KACL,2BAAKgc,GAAZ,mBAAkBhT,EAAY8oB,OAZM,iCAiBxCI,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,eACL,2BAAKgc,GAAZ,mBAAkBhT,EAAY6oB,OAnBQ,mBAuBN5sB,EAAKA,KAAKM,QAAQyD,GAvBZ,gCAuBwBV,oBAvBxB,iBAuB9BE,EAvB8B,EAuB9BA,MACRzI,QAAQC,IAAIwI,GACZ0pB,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,YACL,2BAAKgc,GAAZ,mBAAkBhT,EAAY8oB,OA3BM,kDA8BtC/xB,QAAQC,IAAR,MACAkyB,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,gBACL,2BAAKgc,GAAZ,mBAAkBhT,EAAY+oB,OAjCM,QAqCxChyB,QAAQC,IAAI,kBAAmBqwB,GArCS,0DAAD,sDAsCtC,CAACA,EAAiB6B,EAAoBjtB,IAEnCmtB,EAAqB,uCAAG,WAAOppB,GAAP,mBAAAtD,EAAA,yDACvBT,EADuB,sBACX,IAAItE,MAAM,eADC,WAExBqI,EAAUqZ,MAAM,kBAFQ,0EAMMpd,EAAKA,KAAKM,QAAQyD,GANxB,8BAMoCV,oBANpC,gBAMlBE,EANkB,EAMlBA,MACRzI,QAAQC,IAAR,UAAegJ,EAAf,qBAAqCR,IAPX,wDASpBuX,EAToB,sBASK/W,EATL,oBAUpB,IAAIrI,MAAMof,GAVU,0DAAH,sDAyH3B,GArBA5gB,qBAAU,WACHkyB,IAGLC,GAAoB,GACpBC,EAAkB,IAClBC,EAAQ,IACRE,EAAmB,IACnBE,EAAkB,OACjB,IAEHzyB,qBAAU,WAIR,IAHA,IAAMkzB,EAAsB/Y,MAAMC,KAAK,IAAIC,IAAJ,uBACjCiY,GADiC,aACbE,GADa,CACGlnB,EAAgBwnB,MAEjD/Y,EAAI,EAAGA,EAAImZ,EAAoB3tB,OAAQwU,GAAK,EAAG,CACtD,IAAMlQ,EAAYqpB,EAAoBnZ,GACtCiZ,EAAsBnpB,MAEvB,CAAC/D,KAEEA,EACJ,OAAO,KAGT,IAAMqtB,EAAyBb,EAAgBloB,QAAO,SAACU,GAAD,OAAeomB,EAAgBpmB,KAAO8nB,KACtFQ,EAAwBZ,EAAepoB,QAAO,SAACU,GAAD,OAAeomB,EAAgBpmB,KAAO8nB,KAE1F,OACE,iCACE,sBAAK9e,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,gBAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,UACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,qBACA,sBAAKJ,UAAU,MAAf,SACE,eAAC,IAAD,CAAMA,UAAU,WAAWI,GAAG,IAA9B,2BAMR,uBAAKJ,UAAU,gCAAf,UACE,kFAIA,uBAAMA,UAAU,cAAc+Y,SA9GD,SAACvK,GAClCA,EAAE4F,iBAEF,IAAMsF,EAAO,uCAAG,sCAAAjnB,EAAA,yEAEPT,QAFO,IAEPA,GAFO,UAEPA,EAAMiN,mBAFC,OAEP,EAAmB1B,gBAFZ,sBAGJ,IAAI7P,MAAM,0CAHN,OAMN0xB,EAAsB/Y,MAAMC,KAAK,IAAIC,IAAJ,uBACjCiY,GADiC,aACbE,GADa,CACGlnB,MAEjCyO,EAAI,EATD,YASIA,EAAImZ,EAAoB3tB,QAT5B,wBAUJsE,EAAYqpB,EAAoBnZ,GAV5B,SAWJkZ,EAAsBppB,GAXlB,OASoCkQ,GAAK,EATzC,0BAcNsZ,EAA6B/Q,EAAEmI,OAAO6I,SAASC,qBAAqB9zB,MAE3C,IAA3B6yB,EAAgB/sB,OAhBR,uBAiBJ,IAAI/D,MAAM,0BAjBN,WAoBkB,IAA1B8J,EAAe/F,OApBP,uBAqBJ,IAAI/D,MAAM,wBArBN,WAwBsB,IAA9B6xB,EAAmB9tB,OAxBX,uBAyBJ,IAAI/D,MAAM,4BAzBN,yBAoCSsE,EAAK8M,WAAWjF,OACnC0lB,EACA/nB,EACAgnB,EACAE,EAJmB,UAKhBjyB,OAAOC,SAAS2gB,OAAS5gB,OAAOC,SAASsgB,SALzB,aAKsCuS,EALtC,YAK4DlzB,EAL5D,mBApCT,eAoCNsG,EApCM,OA4CZ7F,QAAQC,IAAI4F,GA5CA,kBA8CLA,GA9CK,yCAgDZ7F,QAAQC,IAAR,MACAgf,GACEY,EACAT,GAAQb,KAAK,KAAe7c,YAC5BslB,GAAQtI,OAAO,UApDL,kBAsDL,MAtDK,0DAAH,qDA0DbkO,KAiDI,SACE,uBAAK1Z,UAAU,eAAf,UAEE,yGAEG,IACD,eAAC,IAAD,CAAMI,GAAG,SAAT,kBAHF,OAMA,uBAAKJ,UAAU,WAAf,UACE,sBAAKA,UAAU,iBAAf,gCACA,sBAAKA,UAAU,iBAAf,SACGhO,EAAKiN,YAAY1B,gBAChB,uCACE,kCAASvL,EAAKiN,YAAY1B,kBAC1B,yBAAQyC,UAAU,SAASvB,KAAK,SAASiN,QAASyS,EAAlD,sCAKF,yBAAQne,UAAU,SAASvB,KAAK,SAASiN,QAASwS,EAAlD,wBAMN,uBAAKle,UAAU,WAAf,UACE,sBAAKA,UAAU,iBAAf,gCACA,uBAAKA,UAAU,iBAAf,UACE,eAACkd,GAAD,CACEjsB,KAAMutB,EACN9H,SAvJoB,SAAC6G,GACnC,IAAMmC,EAAQnC,EAAYjnB,QAAO,SAACU,GAAD,OAAOA,EAAEsmB,YAAY7rB,OAAS,KAAGV,KAAI,SAACiG,GAAD,OAAOA,EAAEsmB,eAC/EmB,EAAmBiB,IAsJLvC,eAAgB+B,EAChB9B,gBAAiBA,IAEnB,sBAAKpd,UAAU,iBAAf,SAC8B,IAA3Bwe,EAAgB/sB,QAAgB,uBAAMuO,UAAU,MAAhB,8BAIvC,uBAAKA,UAAU,WAAf,UACE,sBAAKA,UAAU,iBAAf,+BACA,sBAAKA,UAAU,iBAAf,SACE,eAACkd,GAAD,CACEjsB,KAAMytB,EACNhI,SAhKmB,SAAC6G,GAClC,IAAMmC,EAAQnC,EAAYjnB,QAAO,SAACU,GAAD,OAAOA,EAAEsmB,YAAY7rB,OAAS,KAAGV,KAAI,SAACiG,GAAD,OAAOA,EAAEsmB,eAC/EqB,EAAkBe,IA+JJvC,eAAgB+B,EAChB9B,gBAAiBA,SAIvB,uBAAKpd,UAAU,WAAf,UACE,sBAAKA,UAAU,iBAAf,+CACA,uBAAKA,UAAU,iBAAf,UACE,wBACEvB,KAAK,OACL1L,GAAG,mBACHpH,MAAO6L,EACPkf,SA9LmB,SAACvC,GAClC,IAAQxoB,EAAUwoB,EAAMwC,OAAhBhrB,MACR2yB,EAAkB3yB,GAClBuzB,EAAsBvzB,MA6LV,uBAAKqU,UAAU,iBAAf,UACGxI,GAAkB4lB,EAAgB5lB,KAAoBsnB,GAAa,uBAAM9e,UAAU,MAAhB,qCAClExI,GAAkB,uBAAMwI,UAAU,MAAhB,sBACnBod,EAAgB5lB,KAAoBonB,GAAW,uBAAM5e,UAAU,OAAhB,kCAItD,uBAAKA,UAAU,WAAf,UACE,sBAAKA,UAAU,iBAAf,0CACA,uBAAKA,UAAU,iBAAf,UACE,wBAAOvB,KAAK,OAAO1L,GAAG,uBAAuBpH,MAAOyN,EAAMsd,SApM/C,SAACvC,GACxB,IAAQxoB,EAAUwoB,EAAMwC,OAAhBhrB,MACR4yB,EAAQ5yB,GACRuzB,EAAsB,GAAD,OAAIvzB,EAAJ,YAAaU,OAkMtB,uBAAK2T,UAAU,iBAAf,UACqC,OAAlC5G,EAAKgW,MAAM2P,IACV,uBAAM/e,UAAU,MAAhB,wDAEiC,OAAlC5G,EAAKgW,MAAM2P,IACV,uCACG3lB,GAAQgkB,EAAgB4B,KAAiCH,GAAU,uBAAM7e,UAAU,MAAhB,oCACnE5G,GAAQgkB,EAAgB4B,KAAiCJ,GAAY,uBAAM5e,UAAU,OAAhB,yBACrE5G,GAAQgkB,EAAgB4B,KAAiCF,GAAc,uBAAM9e,UAAU,QAAhB,mCACtE5G,GAAS,uBAAM4G,UAAU,MAAhB,kCAOrB,yBACEA,UAAU,gBACVvB,KAAK,SACLsY,WACE/kB,EAAKiN,YAAY1B,iBACd6f,EAAgB5lB,KAAoBqnB,GACpCL,EAAgB/sB,OAAS,GACS,IAAlC4tB,EAAuB5tB,QACU,IAAjC6tB,EAAsB7tB,QACtB2H,GACAgkB,EAAgB4B,KAAiCF,GACjD1lB,EAAKgW,MAAM2P,IAXlB,wC,gEC/SG,SAASY,GAAkBnf,GACxC,IACE7U,EACE6U,EADF7U,MAAOM,EACLuU,EADKvU,SAAU8rB,EACfvX,EADeuX,MAAO6H,EACtBpf,EADsBof,QAAS7I,EAC/BvW,EAD+BuW,SAG7B8I,EAAW,KAAa,IAAIzxB,MAAO0xB,oBAEzC,OACE,eAACC,GAAA,EAAD,CACEhJ,SAAUA,EACVgB,MAAOA,EACPpsB,MAAOA,GAAS,IAAIyC,KAAKzC,EAAMwE,UAAY0vB,GAC3CG,YAAaJ,GAAW,IAAIxxB,KAAKwxB,EAAQzvB,UAAY0vB,GACrDnJ,SAAU,SAACuJ,GACTh0B,EAASg0B,GAAY,IAAI7xB,KAAK6xB,EAAS9vB,UAAY0vB,KAErDK,MAAM,EACNC,YACE,SAAC1kB,GAAD,OACE,eAACoc,GAAA,EAAD,yBACE3X,GAAI,CAAE4X,OAAQ,KACdA,OAAO,SACPsI,WAAS,EACTllB,QAAQ,WACR4I,KAAK,SACDrI,GANN,IAOE4kB,WAAU,2BACL5kB,EAAO4kB,YADF,IAER9J,YAAa,gCAKrB+J,YAAY,8BCnBH,SAASC,GAAT,GAAyD,IAAjCrc,EAAgC,EAAhCA,MAEnClS,EAGE4a,qBAAWlQ,IAHb1K,KAKF,EAAwBtG,oBAAS,GAAjC,mBAAO4T,EAAP,KAAaC,EAAb,KACA,EAAkC7T,mBAAsB,MAAxD,mBAAO80B,EAAP,KAAkBC,EAAlB,KACA,EAAgC/0B,mBAAiB,UAAjD,mBAAO0M,EAAP,KAAiBsoB,EAAjB,KAOM/H,EAAc,kBAAMpZ,GAAQ,IAClC,EAAkC7T,mBAAiB,IAAnD,mBAAOqK,EAAP,KAAkB4qB,EAAlB,KACA,EAA8Cj1B,mBAAc,CAAE,GAAI,UAAlE,mBAAO0xB,EAAP,KAAwB6B,EAAxB,KACA,EAA4BvzB,mBAAiB,IAA7C,mBAAO4I,EAAP,KAAessB,EAAf,KAoEMC,EAAkB,uCAAG,WAAOrS,GAAP,yBAAA/b,EAAA,yDACpBT,EADoB,sBAEjBtE,MAAM,2BAFW,UAIpBsE,EAAKiN,YAAY1B,gBAJG,sBAKjB,IAAI7P,MAAM,oDALO,UAOpB8yB,EAPoB,sBAQjB9yB,MAAM,sBARW,OAWzB8gB,EAAE4F,iBAEFtnB,QAAQC,IAAIuH,GAENsD,GAAuB,OAAJ5F,QAAI,IAAJA,OAAA,EAAAA,EAAM6J,IAAIsb,cAAcxf,aAAc,GACzDE,EAAoB,IAAIhK,IAAIyG,GAAQ0E,IAAI,IAAInL,IAAI,IAAIoL,IAAIiL,EAAMC,WACjEiE,MAAM,EAAGva,IAAImC,WAAWxB,WAjBF,EAmBD,SAACL,EAAY2yB,EAAsBC,GACzD,IAAM3rB,EAAU,IAAI8Y,KAAG4S,GAEjB3a,EAA0C,CAC9C,iBAAkB,CAChB,CAAEjS,UAAWjE,EAAQ9B,EAAM,GAAIiH,QAAS,KACxC,CAAElB,UAAWjE,EAAQ9B,EAAM,GAAK,EAAGiH,QAAS,KAC5C,CAAElB,UAAWjE,EAAQ9B,EAAM,GAAIiH,QAASA,EAAQ+c,KAAK,GAAG3jB,YACxD,CAAE0F,UAAWjE,EAAQ9B,EAAM,GAAIiH,QAASA,EAAQ5G,cASpD,MALwE,CACtE,SAAU,CAAC2X,EAAU,kBAAmB,MACxC,gBAAiB,CAACA,EAAU,kBAAmBA,EAAU,oBAGtC4a,GAGmBC,CAAgBR,EAAW3oB,EAAmBO,GAvC/D,mBAuClBL,EAvCkB,KAuCFC,EAvCE,KAyCzBhG,EAAK0M,SAASuiB,aACZrpB,EACAC,EAAkBrJ,WAClBuH,EACAgC,EACAC,GA9CuB,4CAAH,sDAkDlBkpB,GAAe1Q,OAAOC,MAAMjb,WAAWlB,IAE7C,OACE,uCACE,yBAAQ0L,UAAU,SAASvB,KAAK,SAASiN,QAnI1B,WACjB,IAAMuU,EAAWzvB,EAAQJ,EAAW,IAAIhC,MAAS,GACjDtB,QAAQC,IAAI,eAAZ,OAA4BkzB,QAA5B,IAA4BA,OAA5B,EAA4BA,EAAU9vB,WACtCswB,EAAaR,GACb1gB,GAAQ,IA+HN,2BACA,eAACqZ,GAAA,EAAD,CAAQtZ,KAAMA,EAAMY,GAAI,CAAE8J,QAAS,GAAKL,SAAS,KAAKmP,QAASH,EAA/D,SACE,wBAAM3Y,UAAU,cAAhB,UACE,gBAACkZ,GAAA,EAAD,2BAEE,eAACzN,EAAA,EAAD,CACE,aAAW,QACXC,QAASiN,EACTzY,GAAI,CACFiZ,SAAU,WACVxW,MAAO,EACPhB,IAAK,GANT,SASE,eAAC,KAAD,SAGJ,gBAACyX,GAAA,EAAD,CAAelZ,GAAI,CAAEyJ,SAAU,SAA/B,UACE,eAACwX,GAAA,EAAD,CACEf,WAAS,EACTlgB,GAAI,CAAE6D,OAAQ,QAFhB,SAIE,eAAC8T,GAAA,EAAD,CACEC,OAAO,SACP/kB,GAAG,UACHglB,MAAM,aACNtZ,KAAK,OACL2hB,WAAS,EACTllB,QAAQ,WACR4I,KAAK,QACLnY,MAAOoK,EACP2gB,SA1FqB,SAACvC,GAElC,OAhD4B,SAACxoB,GAC7B,IAAM+tB,EAAO,uCAAG,8BAAAjnB,EAAA,yDACTT,EADS,oDAEdlF,QAAQC,IAAI,kBAAmBqwB,GAE/BuD,EAAah1B,IAETyxB,EAAgBzxB,GANN,qDAWVA,EAAMyjB,MAAM,kBAXF,uBAYZ6P,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,KACL,2BAAKgc,GAAZ,mBAAkBpd,EAAQ,eAdhB,iCAmBdszB,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,KACL,2BAAKgc,GAAZ,mBAAkBpd,EAAQ,eArBd,oBAyBoBqG,EAAKA,KAAKM,QAAQ3G,GAzBtC,gCAyB8C0J,oBAzB9C,iBAyBJE,EAzBI,EAyBJA,MACRzI,QAAQC,IAAIwI,GACZ0pB,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,KACL,2BAAKgc,GAAZ,mBAAkBpd,EAAQ,eA7BhB,mDAgCZmB,QAAQC,IAAR,MACAkyB,GAAmB,SAAClW,GAElB,OADAjc,QAAQC,IAAI,KACL,2BAAKgc,GAAZ,mBAAkBpd,EAAQ,aAnChB,QAuCdmB,QAAQC,IAAI,kBAAmBqwB,GAvCjB,2DAAH,qDA0Cb1D,IAKO0H,CADWjN,EAAMwC,OAAhBhrB,QA0FIiK,QAASG,GAA4C,UAA/BqnB,EAAgBrnB,GACtCsrB,aAActrB,GAA4C,UAA/BqnB,EAAgBrnB,IAA0B,6BAGzE,eAACorB,GAAA,EAAD,CACEf,WAAS,EACTlgB,GAAI,CAAE6b,UAAW,QAFnB,SAIE,eAAClE,GAAA,EAAD,CACEC,OAAO,SACP/kB,GAAG,SACHglB,MAAM,SACNtZ,KAAK,SACLvD,QAAQ,WACR4I,KAAK,QACLwd,WAAY,CACVC,aAAc,eAACC,GAAA,EAAD,CAAgBrI,SAAS,MAAzB,SAAgCjV,EAAMV,UAEtD4c,WAAS,EACT1J,SAvKa,SAACvC,GAC1B,IAAMuF,EAAO,uCAAG,4BAAAjnB,EAAA,yDACTT,EADS,iDAENrG,EAAUwoB,EAAMwC,OAAhBhrB,MAERi1B,EAAUj1B,GAJI,2CAAH,qDAOb+tB,KAgKYxZ,GAAI,CAAE4X,OAAQ,OAGlB,gBAACqJ,GAAA,EAAD,CACEf,WAAS,EACTlgB,GAAI,CAAE6b,UAAW,QAFnB,UAIE,eAACvE,GAAA,EAAD,CAAYzkB,GAAG,oBAAf,sBACA,gBAAC0kB,GAAA,EAAD,CACE1kB,GAAG,kBACHpH,MAAOyM,EACP2f,MAAM,WACNrB,SAxLW,SAAC/qB,GACxB+0B,EAAY/0B,EAAMgrB,OAAOhrB,QAwLby0B,WAAS,EACTllB,QAAQ,WACR4I,KAAK,QAPP,UASE,eAAC8T,GAAA,EAAD,CAAUjsB,MAAM,SAAhB,oDACA,eAACisB,GAAA,EAAD,CAAUjsB,MAAM,gBAAhB,mEAGJ,eAACw1B,GAAA,EAAD,CAAaf,WAAS,EAAClgB,GAAI,CAAE6b,UAAW,OAAQ5R,aAAc,GAA9D,SACE,eAACsX,GAAA,EAAD,CAAsBC,YAAaC,KAAgBzhB,GAAI,CAAEiK,aAAc,GAAvE,SACE,eAACwV,GAAD,CACEh0B,MAAO60B,EACPv0B,SAAU,SAACg0B,GACTnzB,QAAQC,IAAI,eAAZ,OAA4BkzB,QAA5B,IAA4BA,OAA5B,EAA4BA,EAAU9vB,WACtCswB,EAAaR,IAEflI,MAAM,sBACN6H,QAAS,KACT7I,UAAU,WAKlB,eAACuC,GAAA,EAAD,CAAepZ,GAAI,CAAE8J,QAAS,kBAA9B,SACE,yBACE+M,UAAWyJ,GAA4C,UAA/BpD,EAAgBrnB,KAA2BmrB,EACnElhB,UAAU,4BACVvB,KAAK,SACLiN,QAASmV,EAJX,8B,kCCxML,SAASe,GAAT,GAQK,IAPVC,EAOS,EAPTA,aACAzpB,EAMS,EANTA,SACAJ,EAKS,EALTA,gBACA8pB,EAIS,EAJTA,SACAC,EAGS,EAHTA,OACA7d,EAES,EAFTA,MACA+J,EACS,EADTA,OAEAnhB,QAAQC,IAAIqL,GACZ,MAA8C1M,mBAC5Cq2B,EAAOC,eAAeH,aAAal2B,MAAQ,iBAAmB,OADhE,mBAAOs2B,EAAP,KAAwBC,EAAxB,KAKMvhB,EAAOrQ,KAAK0S,IAChB5K,EAASA,EAAS3G,OAAS,GAAGyC,UAC9BkE,EAASA,EAAS3G,OAAS,GAAGyC,WAE1BiuB,GACHJ,EAAOC,eAAeH,aAAal2B,QAAU6kB,OAAOC,MAAMsR,EAAOC,eAAeH,aAAal2B,MAAMwE,WAChG,IAAI/B,KAAKkC,KAAK0S,IAAI+e,EAAOC,eAAeH,aAAal2B,MAAMwE,WAAW,IAAI/B,MAAO+B,YACjF,IAAI/B,MACR+B,UAAY,IAERiyB,EAAuBpc,GAAoBhO,EAAiBmqB,GAAsB/sB,QAElFitB,EAAwBzb,GAA0BqH,EAAO7V,SAAUgqB,EAAc,GACjFE,ExBiDyB,SAAClqB,EAAqBlE,GACrD,GAAwB,IAApBkE,EAAS3G,OACX,MAAM,IAAI/D,MAAM,kBAGlB,GAAIwG,GAAakE,EAAS,GAAGlE,UAC3B,MAAO,CACLkE,EAAS,GACT,CAAElE,UAAWkE,EAAS,GAAGlE,UAAY,EAAGkB,QAASgD,EAAS,GAAGhD,UAIjE,GAAIlB,GAAakE,EAASA,EAAS3G,OAAS,GAAGyC,UAC7C,OAAOkE,EAAS1G,MAAM,EAAG0G,EAAS3G,QAKpC,IAFA,IAAMkB,EAAS,GAENsT,EAAI,EAAGA,EAAI7N,EAAS3G,OAAS,EAAGwU,GAAK,EAAG,CAG/C,GAFAtT,EAAOgU,KAAKvO,EAAS6N,IAEjB/R,EAAYkE,EAAS6N,EAAI,GAAG/R,UAAW,CACzC,IAAM6S,EAAmBjC,GAAY1M,EAAS6N,GAAI7N,EAAS6N,EAAI,GAAI/R,GAEnE,OADAvB,EAAOgU,KAAKI,GACLpU,EAGT,GAAIuB,IAAckE,EAAS6N,EAAI,GAAG/R,UAEhC,OADAvB,EAAOgU,KAAKvO,EAAS6N,EAAI,IAClBtT,EAIX,MAAM,IAAIjF,MAAM,ewBlFe60B,CAAkBvqB,EAAiBmqB,GAE5DvhB,EAAOtQ,KAAK0S,IAChBxN,WAAWwC,EAAgBA,EAAgBvG,OAAS,GAAG2D,SACvDI,WAAWwC,EAAgBA,EAAgBvG,OAAS,GAAG2D,UAF5C9E,KAAA,IAGT,GAAM4T,EAAMC,UAEVqe,EAAgB,CACpBpqB,SAAUiqB,EACV7a,mBAAoB,CAClBnP,iBAAkB,CAChBC,SAAUgqB,IAGdjb,gBAAiB4G,EAAO5G,iBAG1B,OACE,eAACuR,GAAA,EAAD,CAAQtZ,KAAMuiB,EAAal2B,MAAOuU,GAAI,CAAE8J,QAAS,GAAKL,SAAS,KAAKmP,QAASgJ,EAAShJ,QAAtF,SACE,wBAAM9Y,UAAU,cAAhB,UACE,gBAACkZ,GAAA,EAAD,8BAEE,eAACzN,EAAA,EAAD,CACE,aAAW,QACXC,QAASoW,EAAShJ,QAClB5Y,GAAI,CACFiZ,SAAU,WACVxW,MAAO,EACPhB,IAAK,GANT,SASE,eAAC,KAAD,SAGJ,gBAACyX,GAAA,EAAD,CAAelZ,GAAI,CAAE2Y,SAAU,SAA/B,UACE,sBAAKnV,MAAO,CAAEK,OAAQ,KAAtB,SACE,eAACrD,GAAD,CAAOzP,KAAM+W,GAAU,CAACwa,GAAgBte,EAAMC,UAAWxD,KAAMA,EAAMC,KAAMA,MAE7E,uBAAKZ,UAAU,qBAAf,UACE,uBAAK0D,MAAO,CAAE+e,WAAY,QAA1B,0BAEuB,QAApBR,EAA4B,iBAAmB,GAFlD,OAKA,+BACE,eAAChe,GAAD,CAAoB3P,OAAQ8tB,EAAcle,MAAOA,SAGrD,eAACid,GAAA,EAAD,UACE,gBAACuB,GAAA,EAAD,CACE,kBAAgB,iCAChBj3B,aAAa,SACb2N,KAAK,sBACLzN,MAAOs2B,EACPvL,SAAU,SAACiM,EAAQ1C,GACjBiC,EAAmBjC,GACF,mBAAbA,EACF8B,EAAOC,eAAeH,aAAa51B,SAxEhBuE,EAAQJ,EAAW,IAAIhC,MAAS,IA0EnD2zB,EAAOC,eAAeH,aAAa51B,SAAS,OAVlD,UAcE,eAAC22B,GAAA,EAAD,CAAkBj3B,MAAM,MAAMk3B,QAAS,eAACC,GAAA,EAAD,IAAW/K,MAAM,QACxD,eAAC6K,GAAA,EAAD,CAAkBj3B,MAAM,iBAAiBk3B,QAAS,eAACC,GAAA,EAAD,IAAW/K,MAAM,+BAGvE,eAACoJ,GAAA,EAAD,CAAaf,WAAS,EAAClgB,GAAI,CAAE6b,UAAW,QAAxC,SACE,eAAC0F,GAAA,EAAD,CAAsBC,YAAaC,KAAnC,SACGI,EAAOC,gBACN,eAACrC,GAAD,CACEh0B,MAAOo2B,EAAOC,eAAeH,aAAal2B,MAC1CM,SAAU,SAACg0B,GACT8B,EAAOC,eAAeH,aAAa51B,SAASg0B,IAE9ClI,MAAM,mCACN6H,QAAS,IAAIxxB,KACb2oB,WAAgC,mBAApBkL,UAKZ,OAANF,QAAM,IAANA,OAAA,EAAAA,EAAQgB,cACR,eAAC,GAAD,CACE1L,gBAAiB0K,EAAOgB,YAAYlB,aAAal2B,MACjD2rB,mBAAoByK,EAAOgB,YAAYlB,aAAa51B,YAGhD,OAAN81B,QAAM,IAANA,OAAA,EAAAA,EAAQiB,yBACR,eAAC,GAAD,CACE/K,oBAAqB8J,EAAOiB,uBAAuBnB,aAAal2B,MAChEusB,uBAAwB6J,EAAOiB,uBAAuBnB,aAAa51B,WAGvE,uBAAMyX,MAAO,CAAEkG,UAAW,UAC1B,yBACE5J,UAAU,uBACV0D,MAAO,CAAEqY,UAAW,QACpBtd,KAAK,SACLiN,QAASoW,EAAS/I,SAClBhC,SACsB,mBAApBkL,KAGOF,EAAOC,eAAeH,aAAal2B,OACjC6kB,OAAOC,MAAMsR,EAAOC,eAAeH,aAAal2B,MAAMwE,YAEvD4xB,EAAOC,eAAeH,aAAal2B,MAAMwE,YAAa,IAAI/B,MAAO+B,WAZ7E,+BC7EK8yB,OA7Ff,SACEziB,GAQC,IAAD,QACQxO,EAAsC4a,qBAAWlQ,IAAjD1K,KAENya,EAMEjM,EANFiM,cACAxY,EAKEuM,EALFvM,YACAjH,EAIEwT,EAJFxT,OACAkX,EAGE1D,EAHF0D,MACAgf,EAEE1iB,EAFF0iB,WACAjV,EACEzN,EADFyN,OAGF,EAAwBviB,mBAAsB,MAA9C,mBAAOyC,EAAP,KAAag1B,EAAb,KAEA,EAAwBz3B,oBAAS,GAAjC,mBAAO4T,EAAP,KAAaC,EAAb,KAUA,IAAKvN,EACH,MAAMtE,MAAM,4BAGd,QAAoBmC,IAAhBoE,EACF,MAAMvG,MAAM,+CAGd,IAAM01B,EAAqB,uCAAG,4BAAA3wB,EAAA,6DACtB4wB,EAAKl1B,EAAOA,EAAKgC,UAAY,IAAO,KADd,SAEtB6B,EAAK6J,IAAI1H,UAAUF,EAAaovB,GAFV,2CAAH,qDAKrBC,EAAe7W,GAAiBzf,EAEtC,GAAI,OAACihB,QAAD,IAACA,GAAD,UAACA,EAAQzG,0BAAT,iBAAC,EAA4BnP,wBAA7B,QAAC,EAA8CC,SAEjD,OADAxL,QAAQC,IAAI,yCACL,KAET,IAAMw2B,EAAqB,CACzB1B,aAAc,CACZl2B,MAAO2T,EACPrT,SAAUsT,GAEZnH,SAAU6V,EAAO7V,SACjBJ,gBAAe,OAAEiW,QAAF,IAAEA,GAAF,UAAEA,EAAQzG,0BAAV,iBAAE,EAA4BnP,wBAA9B,aAAE,EAA8CC,SAC/DwpB,SAAU,CACRhJ,QA7BgB,kBAAMvZ,GAAQ,IA8B9BwZ,SAAUqK,GAEZrB,OAAQ,CACNC,eAAgB,CACdH,aAAc,CACZl2B,MAAOwC,EACPlC,SAAU,SAACg0B,GACTnzB,QAAQC,IAAI,UAAZ,OAAuBkzB,QAAvB,IAAuBA,OAAvB,EAAuBA,EAAU9vB,WACjCgzB,EAAQlD,OAKhB/b,QACA+J,UAGF,OACE,uCACGqV,GACC,yBACEtjB,UAAU,SACVvB,KAAK,SACLiN,QA5DW,WACjB,IAAMuU,EAAWzvB,EAAQJ,EAAW,IAAIhC,MAAS,GAIjD,OAHAtB,QAAQC,IAAI,UAAZ,OAAuBkzB,QAAvB,IAAuBA,OAAvB,EAAuBA,EAAU9vB,WACjCgzB,EAAQlD,GAED1gB,GAAQ,IAoDX,SAKG2jB,IAGH5jB,GAAQ,eAACsiB,GAAD,eAAoB2B,QC4BrBC,OAnHf,SACEhjB,GASC,IAAD,QACQxO,EAAsC4a,qBAAWlQ,IAAjD1K,KAEN+D,EAOEyK,EAPFzK,UACA0W,EAMEjM,EANFiM,cACAxY,EAKEuM,EALFvM,YACAjH,EAIEwT,EAJFxT,OACAkX,EAGE1D,EAHF0D,MACAgf,EAEE1iB,EAFF0iB,WACAjV,EACEzN,EADFyN,OAGF,EAAwBviB,mBAAsB,MAA9C,mBAAOyC,EAAP,KAAag1B,EAAb,KAEA,EAAwBz3B,oBAAS,GAAjC,mBAAO4T,EAAP,KAAaC,EAAb,KAKMwN,EAFWT,cAEoBU,SAASpgB,MAAM,KAAK,GACnDogB,EAAQ,WAAOD,EAAP,oBAAsChX,EAAtC,YAAmD9B,GAC3DwvB,EAAM,IAAIC,IAAIj3B,OAAOC,SAASoI,MACpC2uB,EAAI92B,KAAJ,WAAeqgB,GACf,IAAMsL,EAAkB,2BAAuBrkB,EAAvB,0BAAoDwvB,EAAIj1B,YAEhF,EAAsC9C,mBAAS4sB,GAA/C,mBAAOrc,EAAP,KAAoBuc,EAApB,KACA,EAA8D9sB,oBAAgB,OAANsB,QAAM,IAANA,OAAA,EAAAA,EAAQ22B,iBAAkB,IAAlG,mBAAOlL,EAAP,KAAgCC,EAAhC,KAEA,IAAK1mB,EACH,MAAMtE,MAAM,4BAGd,QAAoBmC,IAAhBoE,EACF,MAAMvG,MAAM,+CAGd,IAYM41B,EAAe7W,GAAiBzf,EAEtC,GAAI,OAACihB,QAAD,IAACA,GAAD,UAACA,EAAQzG,0BAAT,iBAAC,EAA4BnP,wBAA7B,QAAC,EAA8CC,SAEjD,OADAxL,QAAQC,IAAI,yCACL,KAET,IAAMw2B,EAAa,CACjB1B,aAAc,CACZl2B,MAAO2T,EACPrT,SAAUsT,GAEZnH,SAAU6V,EAAO7V,SACjBJ,gBAAe,OAAEiW,QAAF,IAAEA,GAAF,UAAEA,EAAQzG,0BAAV,iBAAE,EAA4BnP,wBAA9B,aAAE,EAA8CC,SAC/DwpB,SAAU,CACRhJ,QA9CgB,kBAAMvZ,GAAQ,IA+C9BwZ,SA3BoB,WAAO,IAAD,EACtBC,EAAOvc,GACXR,EACAjK,EAAK6J,IAAIsb,cAAcxf,WACvB1D,EACA9F,EAAOA,EAAKgC,UAAY,IAAO,KAC/BsoB,GAGF,UAAAhsB,OAAO6S,KAAK0Z,EAAM,iBAAlB,SAA6BC,UAoB7B8I,OAAQ,CACNC,eAAgB,CACdH,aAAc,CACZl2B,MAAOwC,EACPlC,SAAUk3B,IAGdJ,YAAa,CACXlB,aAAc,CACZl2B,MAAO8sB,EACPxsB,SAAUysB,IAGdsK,uBAAwB,CACtBnB,aAAc,CACZl2B,MAAOsQ,EACPhQ,SAAUusB,KAIhBtU,QACA+J,UAGF,OACE,iCACE,yBACEjO,UAAU,SACV+W,UAAWuM,EACX7kB,KAAK,SACLiN,QAhFa,kBAAMnM,GAAQ,IAiF3BmE,MAAO,CAAEqY,UAAW,GALtB,SAOGmH,IAED5jB,GAAQ,eAACsiB,GAAD,eAAoB2B,QCzFrB,SAASK,GAAT,GAEkE,IAAD,QAD9ErX,EAC8E,EAD9EA,OAAQE,EACsE,EADtEA,cAAexF,EACuD,EADvDA,IAAK/C,EACkD,EADlDA,MAGtB6I,EADWT,cACoBU,SAASpgB,MAAM,KAAK,GAEzD,EAAwBlB,oBAAkB,GAA1C,mBAAO4T,EAAP,KAAaC,EAAb,KACQoN,EAAoBzB,cAApByB,gBAEN3a,EAGE4a,qBAAWlQ,IAHb1K,KAKF,EAAuBtG,mBAAiB4E,KAAKC,OAAM,IAAInC,MAAO+B,UAAY,MAA1E,mBAAO+W,EAAP,KAEA,GAFA,KAEsCxb,oBAAkB,IAAxD,mBAAOm4B,EAAP,KAAoBC,EAApB,KAOA,GALA53B,qBAAU,WACRqT,EAAQgN,GACRuX,EAAevX,KACd,CAACA,KAECva,EAAM,OAAO,KAElB,IAeI+xB,EAGG,EAlBCtmB,EAAYzL,EAAKiN,YAAjBxB,QAEFzF,EAAe,OAAGiP,QAAH,IAAGA,GAAH,UAAGA,EAAKO,0BAAR,iBAAG,EAAyBnP,wBAA5B,aAAG,EAA2CC,SAE7D0rB,EAAsBv3B,OAAOC,SAASoI,KAAKlI,MAAM,KAAK4R,QAAUyI,EAAI/Q,WAEpE+tB,EAAmBx3B,OAAOC,SAASoI,KAAKlI,MAAM,KAAK4R,QAAUyI,EAAIlU,GAAGvE,WAEpE4e,EAAcpG,GAAgBC,EAAKC,GAEnCgd,EAAa,UAAMp0B,EAAkBsd,EAAY3J,QAASS,EAAMC,WAChEggB,EAAc,UAAMr0B,EAAkBsd,EAAYzF,UAAWzD,EAAMC,WACnEie,EAAY,UAAMtyB,EAAkBsd,EAAYpM,OAAQkD,EAAMC,WAC9DigB,EAAc,UAAMt0B,EAAkBsd,EAAYxF,SAAU1D,EAAMC,WAGpE,UAAC8C,EAAIO,0BAAL,OAAC,EAAwBmc,eAG3BI,EAAY,mDAAqC9c,EAAIO,0BAAzC,aAAqC,EAAwBmc,gBAFzEI,EAAe,mCAKjB,IAEyBM,EAFnBC,EAAY,OAAGrd,QAAH,IAAGA,GAAH,UAAGA,EAAKO,0BAAR,aAAG,EAAyBmc,eAmC9C,OACE,uCACE,gBAACnf,GAAA,EAAD,CAAUxE,UAAWV,EAAI,2BAAwBiN,EAAS,SAAW,IAAQ,UAA7E,UACE,eAAC9H,GAAA,EAAD,UACE,eAACgH,EAAA,EAAD,CACE,aAAW,aACX3H,KAAK,QACL4H,QAAS,WAAQnM,GAASD,GAAOwkB,GAAe,IAHlD,SAKGxkB,EAAO,eAAC,KAAD,IAA0B,eAAC,KAAD,QAGtC,gBAACmF,GAAA,EAAD,CAAWC,MAAM,OAAjB,UACIuf,EAEEhd,EAAIlU,GADJ,eAAC,IAAD,CAAMqN,GAAE,WAAM2M,GAAN,OAA4BN,EAAgB,SAAW,GAAvD,oBAAqExF,EAAI/Q,WAAzE,YAAuF+Q,EAAIlU,IAAnG,SAA0GkU,EAAIlU,MAEhHkxB,GACF,eAAC,mBAAD,CACEviB,KAAI,UAAKjV,OAAOC,SAAS2gB,OAArB,cAAiCN,EAAjC,oBAAgE9F,EAAI/Q,WAApE,YAAkF+Q,EAAIlU,IAC1Fua,OAAQ,kBAAMvB,GAAsBY,EAAiB,KAAMT,GAAQV,OAAO,UAAW,CAAE+B,iBAAkB,OAF3G,SAIE,eAAC9B,EAAA,EAAD,CAAY,aAAW,YAAvB,SACE,eAAC,KAAD,WAKN,gBAAChH,GAAA,EAAD,CAAWC,MAAM,OAAjB,UACIsf,EAEE3yB,EAAgB4V,EAAI/Q,YADpB,eAAC,IAAD,CAAMkK,GAAE,WAAM2M,GAAN,OAA4BN,EAAgB,SAAW,GAAvD,oBAAqExF,EAAI/Q,YAAjF,SAAgG7E,EAAgB4V,EAAI/Q,eAEtH8tB,GAEF,eAAC,mBAAD,CACEtiB,KAAI,UAAKjV,OAAOC,SAAS2gB,OAArB,cAAiCN,EAAjC,oBAAgE9F,EAAI/Q,YACxEoX,OAAQ,kBAAMvB,GAAsBY,EAAiB,KAAMT,GAAQV,OAAO,UAAW,CAAE+B,iBAAkB,OAF3G,SAIE,eAAC9B,EAAA,EAAD,CAAY,aAAW,YAAvB,SACE,eAAC,KAAD,WAKN,eAAChH,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACnE,GAAD,CAAsBtS,YAAagZ,EAAI7O,SAAS,GAAGlE,cAErD,eAACuQ,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACnE,GAAD,CAAsBtS,YAAagZ,EAAI7O,SAAS6O,EAAI7O,SAAS3G,OAAS,GAAGyC,cAE3E,eAACuQ,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACG1M,EAAkB,MAAQ,OAE7B,eAACyM,GAAA,EAAD,CAAWC,MAAM,QAAjB,SACE,eAACT,GAAD,CAAoB3P,OAAQ2S,EAAIsd,cAAergB,MAAOA,MAExD,eAACO,GAAA,EAAD,CAAWC,MAAM,SAAjB,SACE,eAAC8I,GAAA,EAAD,CACE7N,MACE,uBAAKK,UAAU,wBAAf,UACE,wBAAMA,UAAU,SAAhB,UACE,oBAAGA,UAAU,UAAb,kBACA,6BAAIkkB,IACH,IAHH,aAMA,wBAAMlkB,UAAU,SAAhB,UACE,oBAAGA,UAAU,YAAb,kBACA,6BAAImkB,IACH,IAHH,eAMA,wBAAMnkB,UAAU,SAAhB,UACE,oBAAGA,UAAU,SAAb,kBACA,6BAAIoiB,IACH,IAHH,YAMA,wBAAMpiB,UAAU,SAAhB,UACE,oBAAGA,UAAU,WAAb,kBACA,6BAAIokB,IACH,IAHH,iBAQJ3W,UAAU,MACVC,OAAK,EA9BP,SAgCE,sBAAK1N,UAAU,qBAAf,SACE,uBAAKA,UAAU,eAAf,UACE,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAA2B,MAAtB6e,EAAY7X,MAAgB,MAASC,WAAW4X,EAAY3J,SAAWjO,WAAW4X,EAAY7X,OAAU,IAA7G,MAAuHyK,UAAU,UAApJ,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAA2B,MAAtB6e,EAAY7X,MAAgB,IAAOC,WAAW4X,EAAYzF,WAAanS,WAAWyR,EAAIsd,eAAkB,IAA7G,MAAuHvkB,UAAU,YAApJ,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAA2B,MAAtB6e,EAAY7X,MAAgB,IAAOC,WAAW4X,EAAYpM,QAAUxL,WAAWyR,EAAIsd,eAAkB,IAA1G,MAAoHvkB,UAAU,SAAjJ,kBAGA,sBAAK0D,MAAO,CAAEnV,MAAM,GAAD,OAA2B,MAAtB6e,EAAY7X,MAAgB,IAAOC,WAAW4X,EAAYxF,UAAYpS,WAAWyR,EAAIsd,eAAkB,IAA5G,MAAsHvkB,UAAU,WAAnJ,8BAQV,eAACwE,GAAA,EAAD,CAAUxE,UAAWuM,EAAS,kBAAoB,WAAlD,SACE,eAAC9H,GAAA,EAAD,CAAWf,MAAO,CAAEsG,QAAS,GAAK6C,QAAS,EAA3C,SACE,eAACc,GAAA,EAAD,CAAUC,GAAItO,EAAMuO,QAAQ,OAAOC,eAAa,EAAhD,SACI+V,GACA,uBAAK7jB,UAAU,aAAf,UACE,eAACqE,GAAD,CAAejM,SAAU6O,EAAI7O,SAAUuH,MAAM,kBAAkBuE,MAAOA,IACrElM,GACD,eAACqM,GAAD,CAAejM,SAAUJ,EAAiB2H,MAAM,mBAAmBuE,MAAOA,IAG1E,uBAAKlE,UAAU,0BAAf,UACE,sBAAK0D,MAAO,CAAEK,OAAQ,KAAtB,SACE,eAACrD,GAAD,CAAOzP,KAAM+W,GAAU,CAACf,GAAM/C,EAAMC,cAGrCsI,GACD,uBAAKzM,UAAU,YAAf,UACE,uBAAMA,UAAU,aAAhB,SAA8B+jB,IAC7BO,IA9JMD,EA8J0BC,EA7J5C7X,EAIH,uCACE,+BACGhP,GACC,eAAC,GAAD,CACEyG,MAAOA,EACPuI,cAAeA,EACfxY,YAAagT,EAAIlU,GACjB/F,OAAQia,EAAIO,mBACZ0b,WAAYmB,EAAa,YAAc,wBACvCpW,OAAQhH,MAId,+BACE,eAAC,GAAD,CACElR,UAAWkR,EAAI/Q,WACfgO,MAAOA,EACPuI,cAAeA,EACfxY,YAAagT,EAAIlU,GACjB/F,OAAQia,EAAIO,mBACZ0b,WAAYmB,EAAa,qBAAuB,wBAChDpW,OAAQhH,SAxBP,wBCvEE,SAASud,GAAT,GAEZ,IADCxW,EACF,EADEA,QAAS9J,EACX,EADWA,MAAOuI,EAClB,EADkBA,cAElB,OACE,gBAACnI,GAAA,EAAD,CAAOtE,UAAU,aAAa,aAAW,oBAAzC,UACE,eAACuE,GAAA,EAAD,CAAWvE,UAAU,aAArB,SACE,gBAACwE,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,IACA,eAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,uBAAM1E,UAAU,SAAhB,kBACxB,eAACyE,GAAA,EAAD,CAAWC,MAAM,OAAjB,SAAwB,uBAAM1E,UAAU,SAAhB,0BACxB,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,gCACzB,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,8BACzB,eAACyE,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA0B,uBAAM1E,UAAU,SAAhB,4BAC1B,eAACyE,GAAA,EAAD,CAAWC,MAAM,QAAjB,SAAyB,uBAAM1E,UAAU,SAAhB,4BACzB,eAACyE,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA0B,uBAAM1E,UAAU,SAAhB,6BAG9B,eAAC2E,GAAA,EAAD,UACGqJ,EAAQjd,KAAI,SAACkd,GAAD,OACX,eAAC2V,GAAD,CAAqB3c,IAAKgH,EAAQ/J,MAAOA,EAAOuI,cAAeA,EAAeF,QAAQ,GAA5E0B,EAAOlb,YCvBZ,SAAS0xB,GAAT,GAIX,IAHFjnB,EAGC,EAHDA,gBAAiBknB,EAGhB,EAHgBA,kBAAmBC,EAGnC,EAHmCA,YAAaC,EAGhD,EAHgDA,OAIjD93B,QAAQC,IAAI,eAAgB43B,GAE5B,IAAME,EAAWC,iBAAgC,MAE3CC,EAAgB,SAACz2B,GAAD,OAA6BA,EAAM02B,WAAW,IAAK,IAAIp4B,MAAM,MAE7Eq4B,EAA8B,WAAa,IAAD,EACxCC,EAAoB,SAACv5B,GAAD,OAA6BG,KAAKM,UAAU,CAAEs4B,kBAAmB/4B,KAE3F,GAAI,OAACk5B,QAAD,IAACA,GAAD,UAACA,EAAUM,eAAX,QAAC,EAAmBx5B,MAGtB,OAFAC,aAAaO,QAAQqR,EAAiB0nB,EAAkB,UACxDN,EAAO,IAIT,IAAMQ,EAAuBL,EAAcF,EAASM,QAAQx5B,OAC5Di5B,EAAOQ,GACPx5B,aAAaO,QAAQqR,EAAiB0nB,EAAkBE,KAa1D,OACE,sBAAK1hB,MAAO,CAAEvD,QAAS,OAAQgK,aAAc,OAA7C,SACE,eAAC0N,GAAA,EAAD,CACEwI,WAAY,CACVngB,GAAI,CACF4X,OAAQ,IAGZhU,KAAK,QACL5D,GAAI,CAAE3R,MAAO,EAAGyb,QAAS,EAAG8N,OAAQ,GACpC/kB,GAAG,sBACHglB,MAAM,cACNxB,YAAY,6CACZ9qB,aAAci5B,EAAkBW,KAAK,MACrCR,SAAUA,EACVS,WAAY,SAAC9W,GAAD,MAAiB,UAAVA,EAAEhjB,KAAmBy5B,KACxCvO,SA1BgC,SAAClI,GACrC,IAAQ7iB,EAAU6iB,EAAEmI,OAAZhrB,MAEF45B,EAAcR,EAAcp5B,GAAO2K,QAAO,SAAChE,GAAD,OAAaA,EAAQ8c,MAAM,4BAEvEsV,EAAkBl2B,aAAe+2B,EAAY/2B,YAC/Cy2B,SCnBS,SAASO,GAAT,GAAgH,IAAD,EAA5FxX,EAA4F,EAA5FA,QAAS9J,EAAmF,EAAnFA,MAAOuI,EAA4E,EAA5EA,cAChD1M,GAAS,sBAAuB,CAAEN,kBAAkB,IAEpD,IAAMklB,EAActe,MAAMC,KAAK,IAAIC,IAAIyH,EAAQjd,KAAI,SAACiG,GAAD,OAAOA,EAAEd,gBAG1DlE,EAGE4a,qBAAWlQ,IAHb1K,KAKF,EAA8BA,EAAKiN,YAA3BC,EAAR,EAAQA,SAAUzB,EAAlB,EAAkBA,QAEZgoB,EAAa75B,aAAaC,QAAQqY,EAAMvM,YACxC+tB,EAAoCD,EAAU,UAAG35B,KAAKC,MAAM05B,UAAd,aAAG,EAAwBf,kBAAoB,GACnG,EAAkDh5B,mBAAmBg6B,GAArE,mBAAOhB,EAAP,KAA0BiB,EAA1B,KACMC,EAA2B5X,EAAQ1X,QAAO,SAAC2X,GAAD,OAAYyW,EAAkBjqB,SAASwT,EAAO/X,eAExF2vB,EAAc,SAAC5d,GACnB,OAAIA,EAAYxW,OAAS,EAErB,uCACE,eAACiP,GAAD,CAAOzP,KAAM+W,GAAUC,EAAa/D,EAAMC,YAExCjF,GAAYuN,GAAiBhP,GAAW,eAAC8iB,GAAD,CAAcrc,MAAOA,IAE/D,eAAC4hB,GAAA,EAAD,CAAgB5lB,GAAI,CAAE2J,UAAW,QAASiO,OAAQ,YAAlD,SACE,eAAC0M,GAAD,CAAcxW,QAAS/F,EAAa/D,MAAOA,EAAOuI,cAAeA,SAOvE,iCACGA,GACC,6DAEG,IACAhP,EAAW,wDAA2D,gCACtE,IACD,eAAC,IAAD,CAAM2C,GAAE,WAAMpO,EAAK4F,iBAAX,6BAAR,0BALF,OASAsH,GAAYuN,GAAiBhP,GAAW,eAAC8iB,GAAD,CAAcrc,MAAOA,QAKrE,OAAIuI,EAEA,sBAAKzM,UAAU,OAAf,SACE,uBAAKA,UAAU,YAAf,UACE,0CACC6lB,EAAY7X,QAOnB,sBAAKhO,UAAU,OAAf,SACE,uBAAKA,UAAU,YAAf,UACE,0CACA,eAACykB,GAAD,CACEjnB,gBAAiB0G,EAAMvM,WACvB+sB,kBAAmBA,EACnBC,YAAaA,EACbC,OAAQe,IAETE,EAAYD,QChFN,SAASG,GAAcvlB,GACpC,IACEsM,EAIEtM,EAJFsM,QACAkZ,EAGExlB,EAHFwlB,OACAC,EAEEzlB,EAFFylB,QACA1X,EACE/N,EADF+N,SAQF,OACE,gBAACqK,GAAA,EAAD,CAAQtZ,KAAM0mB,EAAQ9lB,GAAI,CAAE8J,QAAS,GAAKL,SAAS,KAAKmP,QAASmN,EAAjE,UACE,gBAAC/M,GAAA,EAAD,0BAEE,eAACzN,EAAA,EAAD,CACE,aAAW,QACXvL,GAAI,CACFiZ,SAAU,WACVxW,MAAO,EACPhB,IAAK,GAEP+J,QAASua,EAPX,SASE,eAAC,KAAD,SAGJ,eAAC7M,GAAA,EAAD,CAAelZ,GAAI,CAAE2Y,SAAU,SAA/B,SACE,+BAAM/L,MAER,gBAACwM,GAAA,EAAD,CAAepZ,GAAI,CAAE8J,QAAS,kBAA9B,UACE,yBAAQhK,UAAU,aAAavB,KAAK,SAASiN,QAASua,EAAtD,oBACA,yBAAQjmB,UAAU,SAASvB,KAAK,SAASiN,QA1BzB,WACpBua,IACA1X,KAwBI,2BCiCO2X,OApEf,SAAyBzqB,GACvB,IAAQzJ,EAAsC4a,qBAAWlQ,IAAjD1K,KAEN+D,EACE0F,EADF1F,UAAWmO,EACTzI,EADSyI,MAAO8J,EAChBvS,EADgBuS,QAGdzY,EAAgByY,EAAQlF,QAAO,SAACC,EAAKod,GAAN,OAAc,IAAIt4B,MAAIkb,GAAKzD,IAAI6gB,EAAIC,qBAAoB,KAAKx2B,UAEjG,EAAwClE,oBAAS,GAAjD,mBAAO26B,EAAP,KAAqBC,EAArB,KACA,EAA0D56B,oBAAc,kBAAM,QAA9E,mBAAO66B,EAAP,KAA8BC,EAA9B,KAIA,IAAKx0B,EACH,MAAMtE,MAAM,4BAGd,IAAKqI,EACH,MAAMrI,MAAM,kCAGd,IA0BM+4B,EAAwB,8KAE5B9X,OAEF,OACE,uBAAK3O,UAAU,gBAAf,UACE,uBAAKA,UAAU,qBAAf,UACE,kDACA,eAAC6T,GAAD,CAAoB3P,MAAOA,EAAO5P,OAAQiB,OAE5C,uBAAKyK,UAAU,uBAAf,UACE,0BAAQA,UAAU,SAASvB,KAAK,SAASiN,QArCjB,WAC5B,IAAMgO,EAAO,uCAAG,kCAAAjnB,EAAA,yDACTT,EADS,oDAETA,EAAK0M,SAFI,oDAGT1M,EAAKsL,gBAHI,oDAITtL,EAAKwL,gBAJI,kEAMexL,EAAK0M,SAASE,iBAAiB7I,GAN9C,WAMR8I,EANQ,SAO4B,OAAnBA,IAA4B,GAPrC,iBASZ7M,EAAKqL,WAAWqpB,qBAAqB3wB,EAAWiY,EAAQjd,KAAI,SAACiG,GAAD,OAAOA,EAAEjE,OATzD,yCAWSf,EAAK0M,SAASioB,uBAXvB,QAWNC,EAXM,OAYNtyB,EAASsyB,EAAO5jB,IAEhBuL,EAAW,WACfvc,EAAKsL,gBAAgBupB,eAAe70B,EAAKwL,gBAAiBzH,EAAWzB,IAEvEkyB,GAAyB,kBAAMjY,KA5BZ+X,GAAgB,GAWvB,4CAAH,qDAsBb5M,KAcI,kBAEG1L,EAAQvc,OAAS,EAAI,OAAS,MAEjC,eAACs0B,GAAD,CAAejZ,QAAS2Z,EAAuBT,OAAQK,EAAcJ,QApDvD,kBAAMK,GAAgB,IAoDuD/X,SAAUgY,WCpD9F,SAASO,GAAT,GAAmI,IAAnGC,EAAkG,EAA3G/Y,QAAqB9J,EAAsF,EAAtFA,MAAOuI,EAA+E,EAA/EA,cAChE,EAAuBwN,cAAf+M,EAAR,EAAQA,OAAQj0B,EAAhB,EAAgBA,GAChBgN,GAAS,SAAD,OAAUhN,EAAE,YAAQA,GAAO,IAA3B,gBAAsCi0B,EAAtC,gBAA4D,CAAEvnB,kBAAkB,IAExF,IAAMuO,EAAU+Y,EAAWzwB,QAAO,SAACU,GACjC,OAAIjE,EACKiE,EAAEjE,GAAGvE,aAAeuE,EAGtBiE,EAAEd,aAAe8wB,GAAUhwB,EAAEjE,GAAGvE,aAAew4B,KAKxD,OAFAl6B,QAAQC,IAAI,eAAgBi6B,EAAQhZ,GAGlC,sBAAKhO,UAAU,OAAf,SACE,uBAAKA,UAAU,YAAf,UAEE,gCACGgO,EAAQvc,OAAS,GAAK,MACtB,IAFH,SAIGsB,EAAE,WAAOA,GAAO,IAChB,IALH,MAOG,IACAi0B,GAAU31B,EAAgB21B,EAAQ,GAAI,QAGvCva,GAAiB,eAACwa,GAAD,CAAiBlxB,UAAWixB,EAAQ9iB,MAAOA,EAAO8J,QAASA,IAE7EA,EAAQvc,OAAS,GAAK,eAACiP,GAAD,CAAOzP,KAAM+W,GAAUgG,EAAS9J,EAAMC,YAE7D,eAAC2hB,GAAA,EAAD,CAAgB5lB,GAAI,CAAE2J,UAAW,SAAjC,SACE,gBAACvF,GAAA,EAAD,CAAOtE,UAAU,aAAa,aAAW,oBAAzC,UACE,eAACuE,GAAA,EAAD,CAAWvE,UAAU,aAArB,SACE,gBAACwE,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,IACA,eAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,OAAjB,wBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,8BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,4BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,0BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,0BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAGJ,eAACC,GAAA,EAAD,UACGqJ,EAAQjd,KAAI,SAACkd,GAAD,OACX,eAAC2V,GAAD,CAAqB3c,IAAKgH,EAAQ/J,MAAOA,EAAOuI,cAAeA,EAAeF,OAA2B,IAAnByB,EAAQvc,QAApFwc,EAAOlb,mBC9DlB,SAASm0B,GAAT,GAAgE,IAA9Cza,EAA6C,EAA7CA,cACzB/f,EAAW4f,cACXS,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GAEzD,EAIIggB,qBAAWlQ,IAHb1K,EADF,EACEA,KAAMgD,EADR,EACQA,QAWR,GANA9I,qBAAU,WAGR,OAFAY,QAAQC,IAAIL,EAASsgB,UAEd,eACN,CAACtgB,KAECsF,EAAM,OAAO,KAElB,MAMIA,EAAKiN,YALPC,EADF,EACEA,SACA3B,EAFF,EAEEA,gBACAE,EAHF,EAGEA,QACAC,EAJF,EAIEA,gBACAyB,EALF,EAKEA,gBAGIgoB,EAAwB1a,IAAkBhP,GAAW0B,GAAmBzB,GAE9E,OACE,sBAAKsC,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,gBAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,UACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,qBACA,uBAAKJ,UAAU,MAAf,UACE,eAAC,IAAD,CAASA,UAAU,WAAWI,GAAyB,WAAO2M,EAA5Boa,EAAqB,6BAAvD,qBACA,eAAC,IAAD,CAASnnB,UAAU,WAAWI,GAAyB,WAAO2M,EAA5Boa,EAAqB,uCAAvD,8BAED1a,GAAiBvN,GAChB,gBAACe,GAAA,EAAD,CAAKC,GAAI,CAAE6b,UAAW,QAAtB,UACE,uBAAM/b,UAAU,eAAhB,SACGzC,IAEH,yBAAQyC,UAAU,SAASvB,KAAK,SAASiN,QAAS1W,EAAlD,+BC1Cd,SAASoyB,GAAT,GAAsD,IAAtCC,EAAqC,EAArCA,SACd,OACE,sBAAKrnB,UAAU,YAAf,SACE,uBAAKA,UAAU,QAAf,UACE,qEACCqnB,OA8BMC,OAxBf,WACE,MAII1a,qBAAWlQ,IAHb1K,EADF,EACEA,KAAMksB,EADR,EACQA,OAKR,IAAKlsB,EAAM,OAAO,KAElB,MAEIA,EAAKiN,YADPC,EADF,EACEA,SAAUzB,EADZ,EACYA,QAAS0B,EADrB,EACqBA,gBAAiBzB,EADtC,EACsCA,gBAGhC6pB,EAAmBroB,KAAczB,GAAW0B,GAAmBzB,GAC/D8pB,EAActoB,IAAazB,GAAW0B,GAAmBzB,GAE/D,OACE,gBAAC0pB,GAAD,WACIG,GAAoB,eAACvL,GAAA,EAAD,CAAOC,SAAS,QAAhB,gCACnB/c,GAAY,yBAAQc,UAAU,SAASvB,KAAK,SAASiN,QAASwS,EAAlD,qBACbsJ,GAAe,eAAC,IAAD,CAAUpnB,GAAG,UAAUmY,SAAO,QCjCtC,SAASkP,KACtB,IAAQz1B,EAAsC4a,qBAAWlQ,IAAjD1K,KAoBR,OACE,+BACE,uBACE0R,MAAO,CACLiG,SAAU,IAAKmO,OAAQ,OAAQuB,WAAY,GAAIqO,UAAW,UAF9D,UAKE,wEACA,qUAQA,yBAAQ1nB,UAAU,SAASvB,KAAK,SAASiN,QAlC7B,WAChB,IAAMgO,EAAO,uCAAG,gCAAAjnB,EAAA,yDACTT,EADS,oDAITA,EAAK0M,SAJI,iEAOO1M,EAAK0M,SAASioB,uBAPrB,cAORC,EAPQ,OAQRtyB,EAASsyB,EAAO5jB,IAEtBlW,QAAQC,IAAIuH,GAVE,UAWOtC,EAAK0M,SAASmoB,eAAe70B,EAAK4F,iBAAkBtD,GAX3D,QAWR3B,EAXQ,OAYd7F,QAAQC,IAAI4F,GAZE,4CAAH,qDAcb+mB,KAmBI,sBCnCO,SAASiO,GAAT,GAA+D,IAAxCN,EAAuC,EAAvCA,SAC9B36B,EAAW4f,cAEfta,EAGE4a,qBAAWlQ,IAHb1K,KAIF,IAAKA,EAAM,OAAO,KAClB,MAEIA,EAAKiN,YADPC,EADF,EACEA,SAAUzB,EADZ,EACYA,QAAS0B,EADrB,EACqBA,gBAAiBzB,EADtC,EACsCA,gBAEhCkqB,EAAkBl7B,EAASsgB,SAC3BD,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GAEnDi7B,EAD6Bn7B,EAASsgB,SAASpgB,MAAMmgB,GAAqB,GAC/BtS,SAAS,UAE1D,OAAKyE,IAAczB,GAAW0B,GAAmBzB,GAO5C1L,EAAK2M,wBAQH0oB,EANH,sBAAKrnB,UAAU,YAAf,SACE,eAACynB,GAAD,MATAI,EACK,eAAC,IAAD,CAAUznB,GAAIwnB,EAAgBrP,QAAQ,UAAW,IAAKA,SAAO,IAE/D,eAAC,IAAD,CAAUnY,GAAE,WAAM2M,EAAN,UAAmCwL,SAAO,I,yBCjBlD,SAASuP,KACtB/nB,GAAS,sBAAuB,CAAEN,kBAAkB,IAEpD,MAA8B/T,mBzDDKY,wCyDCnC,mBAAOy7B,EAAP,KAAgBC,EAAhB,KACA,EAA0Bt8B,mBAAS,IAAnC,mBAAOkK,EAAP,KAAcqyB,EAAd,KAKMzS,EAAWC,cAEXyS,EAA2B,WAC/B,IAAKH,GAAWA,EAAQt2B,OAAS,EAC/Bw2B,EAAS,6CAGX,GAAKF,EAAQ3Y,MAAM,yEAAnB,CAIA6Y,EAAS,IACT,IAAMpkB,EAAG,WAAOkkB,EAAP,YACTvS,EAAS3R,GACTpX,OAAOC,SAASqtB,cANdkO,EAAS,uCASb,OACE,uBAAKjoB,UAAU,OAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,2BAIN,sBAAKJ,UAAU,OAAf,SACE,uBAAKA,UAAU,iBAAf,UAEE,+DACA,mFAEA,eAAC,IAAD,CAAMI,GAAG,uBAAuBJ,UAAU,qBAA1C,oCAEA,sBAAKA,UAAU,SAEf,uBAAKA,UAAU,mBAAf,UACE,eAAC6X,GAAA,EAAD,CACE3c,QAAQ,WACRvP,MAAOo8B,EACPrR,SA5CS,SAAClI,GACpBwZ,EAAWxZ,EAAEmI,OAAOhrB,OACpBs8B,EAAS,KA2CC3C,WAAY,SAAC9W,GACG,UAAVA,EAAEhjB,KACJ08B,KAGJloB,UAAU,cACVuW,YAAY,yCACZ+K,WAAY,CACV6G,eACE,eAAC3G,GAAA,EAAD,CAAgBrI,SAAS,QAAzB,SACE,eAAC,KAAD,OAINvjB,QAASA,EACTyrB,WAAYzrB,IAEd,yBAAQoK,UAAU,SAAS0L,QAASwc,EAA0B,aAAW,OAAOzpB,KAAK,SAArF,+BCrEG,SAAS2pB,KACtBroB,GAAS,wBAAyB,CAAEN,kBAAkB,IACtD,IAAM/S,EAAW4f,cACXkJ,EAAWC,cACX1I,EAAsBrgB,EAASsgB,SAASpgB,MAAM,KAAK,GAEzD,EAA8BlB,mBAASqhB,GAAvC,mBAAOgb,EAAP,KAAgBC,EAAhB,KACA,EAA0Bt8B,mBAAS,IAAnC,mBAAOkK,EAAP,KAAcqyB,EAAd,KAMMC,EAA2B,WAC/B,IAAKH,GAAWA,EAAQt2B,OAAS,EAC/Bw2B,EAAS,6CAGX,GAAKF,EAAQ3Y,MAAM,yEAAnB,CAIA6Y,EAAS,IACT,IAAMpkB,EAAG,WAAOkkB,EAAP,YACTvS,EAAS3R,GACTpX,OAAOC,SAASqtB,cANdkO,EAAS,uCASb,OACE,uBAAKjoB,UAAU,OAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,2BAIN,uBAAKJ,UAAU,sBAAf,UACE,uBAAKA,UAAU,mBAAf,UACE,eAAC6X,GAAA,EAAD,CACE3c,QAAQ,WACRvP,MAAOo8B,EACPrR,SAlCW,SAAClI,GACpBwZ,EAAWxZ,EAAEmI,OAAOhrB,OACpBs8B,EAAS,KAiCD3C,WAAY,SAAC9W,GACG,UAAVA,EAAEhjB,KACJ08B,KAGJloB,UAAU,kBACVuW,YAAY,yCACZ+K,WAAY,CACV6G,eACE,eAAC3G,GAAA,EAAD,CAAgBrI,SAAS,QAAzB,SACE,eAAC,KAAD,OAINvjB,QAASA,EACTyrB,WAAYzrB,IAEd,yBAAQoK,UAAU,eAAe0L,QAASwc,EAA0B,aAAW,OAAOzpB,KAAK,SAA3F,uBAKF,uBAAKuB,UAAU,QAAf,UACE,qBAAGA,UAAU,aAAb,qBAEG,IACD,uBAAMA,UAAU,MAAhB,SAAuB+M,IACtB,IAJH,+CAQA,sBAAK/M,UAAU,YAAf,SACE,eAAC,IAAD,CAAMI,GAAG,uBAAuBJ,UAAU,qBAA1C,+C,OCxEG,SAASqoB,KACtB,IAAM37B,EAAW4f,cACXsb,EAAkBl7B,EAASsgB,SAC3Bsb,EAAc57B,EAASsgB,SAASvS,SAAS,SACzCuS,EAAWtgB,EAASsgB,SAASuL,QAAQ,OAAQ,IAC7CgQ,GAAc,CAAC,GAAI,SAAU,WAAY,SAAU,wBAAwB1rB,MAAK,SAAC7F,GAAD,OAAOgW,IAAahW,KAEpGhE,EAAQ40B,EAAgBY,QAAQ,IAAK,GAEzCx2B,EAGE4a,qBAAWlQ,IAHb1K,KAyBF,OACE,sBAAKgO,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,uBAAKH,UAAU,MAAf,UACE,eAAC,IAAD,CAAMA,UAAU,WAAWI,GAAG,SAA9B,mBACA,eAAC,IAAD,CAAMJ,UAAU,WAAWI,GAAG,SAA9B,mBACA,eAAC,IAAD,CAAMJ,UAAU,WAAWI,GAAG,WAA9B,qBACCmoB,GA5BY,WACrB,IAAKv2B,EAAM,OAAO,KAClB,IAAIy2B,EAAe,UAAMb,EAAgBc,UAAU,EAAG11B,GAAnC,iBAAkD40B,EAAgBc,UAAU11B,EAAO40B,EAAgBn2B,SAatH,OAVIm2B,EAAgBc,UAAU11B,EAAO40B,EAAgBn2B,QAAQk3B,WAAW,mBACjEf,EAAgBc,UAAU11B,EAAO40B,EAAgBn2B,QAAQk3B,WAAW,YAGvE32B,EAAKiN,YAAYxB,SAAWzL,EAAKiN,YAAYE,iBAAmBnN,EAAKiN,YAAYvB,kBAGnF+qB,EAAe,UAAMb,EAAgBc,UAAU,EAAG11B,GAAnC,WAGVs1B,EACH,eAAC,IAAD,CAAMtoB,UAAU,WAAWI,GAAIwnB,EAAgBrP,QAAQ,UAAW,IAAlE,uBACA,eAAC,IAAD,CAAMvY,UAAU,WAAWI,GAAIqoB,EAA/B,wBAWmBG,YCrCZ,SAASC,GAAT,GAEmC,IADhD3kB,EAC+C,EAD/CA,MAAOuI,EACwC,EADxCA,cAEDqc,EAAUjjB,SAASoU,cAAY6O,SAAW,GAAI,IAC5C92B,EAAsC4a,qBAAWlQ,IAAjD1K,KACR,EAA0BtG,qBAA1B,mBAAOmH,EAAP,KAAck2B,EAAd,KAEAhpB,GAAS,SAAD,OAAU+oB,EAAV,gBAAiC,CAAErpB,kBAAkB,IAE7DvT,qBAAU,WACR,IAAM88B,EAAU,uCAAG,8BAAAv2B,EAAA,yDACjB3F,QAAQC,IAAI,qBACPiF,EAFY,iEAKIA,EAAK6J,IAAI4f,UAAU,CAACqN,IALxB,OAKXn2B,EALW,OAMXW,EAASX,EAAO5B,KAAI,SAACiG,GAAD,OAAYnG,OAAOiC,OAAOkE,EAAE,GAAGif,cAAe,CAAEljB,GAAIiE,EAAE,QAChF+xB,EAASz1B,EAAO,IAPC,2CAAH,qDAUhB01B,MACC,CAACh3B,EAAM82B,IAEVh8B,QAAQC,IAAI8F,GAIZ,OACE,uBAAKmN,UAAU,YAAf,UACE,wCAEG,IACA8oB,KAEFj2B,GACD,gBAACyR,GAAA,EAAD,CAAOtE,UAAU,aAAa,aAAW,oBAAzC,UACE,eAACuE,GAAA,EAAD,CAAWvE,UAAU,aAArB,SACE,gBAACwE,GAAA,EAAD,WACE,eAACC,GAAA,EAAD,IACA,eAACA,GAAA,EAAD,CAAWC,MAAM,OAAjB,gBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,OAAjB,wBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,8BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,4BACA,eAACD,GAAA,EAAD,CAAWC,MAAM,QAAjB,0BACiB,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,2BAGrB,eAACC,GAAA,EAAD,UACE,eAAC0H,GAAD,CAAgBG,WAAY,EAAGvF,IAAKpU,EAAOqR,MAAOA,EAAOuI,cAAeA,EAAeC,aAvB1E,KAuBsGH,SAAUuc,YC1DxH,SAASG,KAGtB,OAFAlpB,GAAS,oBAAqB,CAAEN,kBAAkB,IAGhD,uBAAKO,UAAU,OAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,2BAIN,sBAAKJ,UAAU,OAAf,SACE,sBAAKA,UAAU,YAAf,SACE,+CCdK,SAASkpB,KAGtB,OAFAnpB,GAAS,sBAAuB,CAAEN,kBAAkB,IAGlD,uBAAKO,UAAU,OAAf,UACE,sBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,YAAf,SACE,eAACC,GAAA,EAAD,CAAKC,GAAI,CAAEC,QAAS,QAApB,SACE,eAAC,IAAD,CAAMH,UAAU,OAAOI,GAAG,IAA1B,2BAIN,sBAAKJ,UAAU,OAAf,SACE,sBAAKA,UAAU,YAAf,SACE,iDHwCVqoB,GAAOxjB,aAAe,CAAE0jB,YAAY,GIxDpC,IAoCeY,GAFC,CAAE9d,KAlCL,SAAC3J,GAWZ,OAVa,SAAc+H,GACzB,IAAMuB,EAAUvB,GAAW,iBAAO,CAChC0C,WAAY,CACVnK,SAAU,WAFEyH,GAMhB,OAAO,eAAC2C,GAAA,EAAD,CAAYpM,UAAWgL,EAAQmB,WAA/B,SAA4CzK,MA0B/B8J,OApBT,SAAC9J,GAiBd,OAhBe,SAAgB+H,GAC7B,IAAMuB,EAAUvB,GAAW,iBAAO,CAChC0C,WAAY,CACVlK,MAAO,UACPH,WAAY,IACZE,SAAU,WAJEyH,GAQhB,OACE,eAAC2C,GAAA,EAAD,CAAYlR,QAAQ,YAAY8E,UAAWgL,EAAQmB,WAAnD,SACGzK,OCnBI0nB,GAAmB,SAACC,GAC/B,IACM3O,EADe,IAAIF,gBAAgB6O,GACgB1O,IAAI,qBAE7D,IAAKD,EACH,OAAO,KAGT,IAAM9oB,EAAS8oB,EAAqB9tB,MAAM,KAAK,GAI/C,OAFAE,QAAQC,IAAI,SAAU6E,GAEfA,GAGI03B,GAAa,uCAAG,WAAOvqB,EAAkB/D,EAAyBpJ,GAAlD,uBAAAa,EAAA,6DACrB82B,EADqB,+BAAA92B,EAAA,MACb,4BAAAA,EAAA,+EAEasM,EAAY6b,SAAShpB,EAAQoJ,GAF1C,cAEJpG,EAFI,yBAIHA,GAJG,uCAMV9H,QAAQC,IAAI,0BAA2B,CAAE6I,MAAK,OANpC,kBAQH,MARG,yDADa,8DAaJ2zB,IAbI,UAarB3O,EAbqB,gDAgBlB,MAhBkB,cAmBrBvf,EAAauf,EAASC,YAAYC,QAAQ,GAAGC,aAAaC,YAC1DxnB,EAAO1H,KAAKC,MAAMqvB,KAAKR,EAASC,YAAYC,QAAQ,GAAGC,aAAavnB,OACpEynB,EAAeL,EAASM,OAAOC,aArBV,kBAuBpB,CACL9N,OAAQuN,EACR4O,OAAQ,CACNpwB,KAAMiC,EACN7H,OACAb,OAAQsoB,GAAgB,QA5BD,4CAAH,0DCkB1B,SAASwO,GAAT,GAII,IAHFzb,EAGC,EAHDA,QAAS9J,EAGR,EAHQA,MAAOvM,EAGf,EAHeA,WAAY3F,EAG3B,EAH2BA,KAI5B,EAAiCzG,EAAgB,wCAAwC,GAAzF,mBAAU8yB,GAAV,WAMA,OAJAnyB,qBAAU,WACRmyB,GAAoB,KACnB,IAEErQ,EAGH,uCACE,eAAC,GAAD,CAAQvB,eAAe,IACvB,gBAAC,IAAD,WACE,eAAC,IAAD,CAAO0J,KAAK,IAAIuT,QAAS,eAAC,IAAD,CAAUnR,SAAO,EAACnY,GAAG,cAC9C,eAAC,IAAD,CAAO+V,KAAK,WAAWuT,QAAS/xB,GAAc3F,GAAQ,eAACwzB,GAAD,CAASxX,QAASA,EAAS9J,MAAK,2BAAOA,GAAP,IAAcvM,eAAc8U,eAAe,MACjI,eAAC,IAAD,CAAO0J,KAAK,mBAAmBuT,QAAS,eAAC5C,GAAD,CAAa9Y,QAASA,EAAS9J,MAAOA,EAAOuI,eAAe,MACpG,eAAC,IAAD,CAAO0J,KAAK,uBAAuBuT,QAAS,eAAC5C,GAAD,CAAa9Y,QAASA,EAAS9J,MAAOA,EAAOuI,eAAe,MACxG,eAAC,IAAD,CAAO0J,KAAK,gBAAgBuT,QAAS,eAACnN,GAAD,CAAsBrY,MAAOA,EAAOuI,eAAe,MACxF,eAAC,IAAD,CAAO0J,KAAK,8BAA8BuT,QAAS,eAAC1P,GAAD,CAAgB9V,MAAOA,EAAOuI,eAAe,MAChG,eAAC,IAAD,CAAO0J,KAAK,mBAAmBuT,QAAS,eAACb,GAAD,CAAW3kB,MAAOA,EAAOuI,eAAe,MAChF,eAAC,IAAD,CAAO0J,KAAK,IAAIuT,QAAS,eAACtB,GAAD,YAbV,KAmBvB,SAASuB,GAAT,GAII,IAHF3b,EAGC,EAHDA,QAAS9J,EAGR,EAHQA,MAAO1G,EAGf,EAHeA,gBAAiBxL,EAGhC,EAHgCA,KAIjC,EAAiCzG,EAAgB,wCAAwC,GAAzF,mBAAU8yB,GAAV,WAKA,GAHAnyB,qBAAU,WACRmyB,GAAoB,KACnB,KACErQ,EAAS,OAAO,KAErB,IAAMwZ,EAAchqB,GAAmBxL,EAEvC,OACE,uCACE,eAAC,GAAD,CAAQya,eAAa,IACrB,gBAAC,IAAD,WACE,eAAC,IAAD,CAAO0J,KAAK,IAAIuT,QAAS,eAAC,GAAD,MACzB,eAAC,IAAD,CAAOvT,KAAK,WAAWuT,QAASlC,GAAe,eAACG,GAAD,UAAa,eAACnC,GAAD,CAASxX,QAASA,EAAS9J,MAAK,2BAAOA,GAAP,IAAcvM,WAAY6F,IAAmBiP,eAAa,QACtJ,eAAC,IAAD,CAAO0J,KAAK,mBAAmBuT,QAAS,eAAC/B,GAAD,UAAa,eAACb,GAAD,CAAa9Y,QAASA,EAAS9J,MAAOA,EAAOuI,eAAa,QAC/G,eAAC,IAAD,CAAO0J,KAAK,uBAAuBuT,QAAS,eAAC/B,GAAD,UAAa,eAACb,GAAD,CAAa9Y,QAASA,EAAS9J,MAAOA,EAAOuI,eAAa,QACnH,eAAC,IAAD,CAAO0J,KAAK,gBAAgBuT,QAAS,eAAC/B,GAAD,UAAa,eAACpL,GAAD,CAAsBrY,MAAOA,EAAOuI,eAAa,QACnG,eAAC,IAAD,CAAO0J,KAAK,8BAA8BuT,QAAS,eAAC/B,GAAD,UAAa,eAAC3N,GAAD,CAAgB9V,MAAOA,EAAOuI,eAAa,QAC3G,eAAC,IAAD,CAAO0J,KAAK,mBAAmBuT,QAAS,eAAC/B,GAAD,UAAa,eAACkB,GAAD,CAAW3kB,MAAOA,EAAOuI,eAAa,QAC3F,eAAC,IAAD,CAAO0J,KAAK,sBAAsBuT,QAAS,eAAC/B,GAAD,UAAa,eAAC,GAAD,CAAkBzjB,MAAOA,EAAOuI,eAAa,cAM9F,SAASmd,KACtB,IAAQjd,EAAoBzB,cAApByB,gBACA3a,EAAsC4a,qBAAWlQ,IAAjD1K,KACR,EAA0CtG,mBAAS,IAAnD,mBAAOm+B,EAAP,KAAsBC,EAAtB,KACA,EAAoCp+B,mBAAwB,MAA5D,mBAAOiM,EAAP,KAAmBoyB,EAAnB,KACA,EAA0Br+B,mBAAoB,CAC5CyY,SAAU,EACV1B,KAAM,KACNrJ,KAAM,GACN4wB,UAAW,KACXC,eAAgB,KAChBC,KAAM,GACN1mB,OAAQ,KAPV,mBAAOU,EAAP,KAAcimB,EAAd,KAUAj+B,qBAAU,WACR,GAAKygB,GACA3a,GACAkS,GACc,KAAfA,EAAMgmB,KAAV,CAIA,IAAMxQ,EAAO,uCAAG,0CAAAjnB,EAAA,yDACRb,EAASw3B,GAAiB38B,OAAOC,SAAS+tB,QADlC,iEAOS6O,GACrBt3B,EAAK+M,YACL/M,EAAK6J,IAAIsb,cAAcxf,WACvB/F,GAVY,UAORgpB,EAPQ,OAad9tB,QAAQC,IAAI,YAAa6tB,GAEpBA,EAfS,iDAmBN4O,EAAW5O,EAAX4O,OACFnuB,EAAamuB,EAAOpwB,KACpB6hB,EAAeuO,EAAO72B,OACtB4hB,EAAW0G,GAAgBnvB,KAAKC,MAAMqvB,KAAKH,IACzCznB,EAASg2B,EAATh2B,KACFmhB,EAAQnhB,EAAK2E,KAAOrM,KAAKC,MAAMyH,EAAK2E,KAxB5B,KA0BNkD,EA1BM,OA2BP,UA3BO,QA8BP,oBA9BO,QAiCP,qBAjCO,QAkDP,cAlDO,gCA4BVmZ,GAAW7H,EAAiB4H,EAAU3iB,EAAQsS,GA5BpC,oCA+BVuQ,GAAoB9H,EAAiB4H,EAAU3iB,EAAQsS,EAAO1Q,EAAK0C,YA/BzD,iCAkCNye,EAAMvc,SAlCA,wBAmCRsc,GAAkB/H,EAAiB4H,EAAU3iB,EAAQsS,EAAOyQ,GAnCpD,iCAuCNnE,OAAO4Z,UAAUzV,EAAM7gB,gBAvCjB,wBAwCR8gB,GAAoBjI,EAAiB4H,EAAU3iB,EAAQsS,EAAOyQ,GAxCtD,oCA4CV5I,GACEY,EACAwc,GAAQ9d,KAAR,sCAA4CzZ,EAA5C,MACAu3B,GAAQ3d,OAAO,YA/CP,oCAmDVqJ,GAAqBlI,EAAiB4H,EAAU3iB,EAAQsS,EAAO1Q,EAAKY,cAnD1D,oCAsDV2X,GACEY,EACAwc,GAAQ9d,KAAR,iCAAuChQ,EAAvC,eAAwD1J,EAAiBC,KACzEu3B,GAAQ3d,OAAO,YAzDP,iEAAH,qDA+DbkO,OACC,CAAC/M,EAAiB3a,EAAMkS,IAE3BhY,qBAAU,WACR,IAAIm+B,GAAS,EAEb,GAAIr4B,GAAQA,EAAK4L,oBAAqB,CACpC,IAAM0sB,EAAI,uCAAG,8BAAA73B,EAAA,sEACWT,EAAK6J,IAAI0uB,iBADpB,cACLvc,EADK,gBAEYhc,EAAK0M,SAAS8rB,aAF1B,UAELC,EAFK,OAGNJ,EAHM,iDAMXF,EAASM,GACTX,EAAiB,CAAE9b,UAAS5U,KAAM,SAPvB,4CAAH,qDAUNpH,EAAKwL,iBACP8sB,IAIJ,OAAO,WAAQD,GAAS,KACvB,CAACr4B,EAAD,OAAOA,QAAP,IAAOA,OAAP,EAAOA,EAAM4L,sBAEhB1R,qBAAU,WAKR,OAJI8F,GAAQA,EAAK0M,UACfqrB,EAAc/3B,EAAK0M,SAASyY,cAAcxf,YAGrC,eACN,CAAC3F,IAEJ,IAAQgc,EAAiB6b,EAAjB7b,QAER,OACE,gBAAC,IAAD,WACE,gBAAC,IAAD,WACE,eAAC,IAAD,CAAOmI,KAAK,IAAIuT,QAAS,eAAC5B,GAAD,MACzB,eAAC,IAAD,CAAO3R,KAAK,SAASuT,QAAS,eAACT,GAAD,MAC9B,eAAC,IAAD,CAAO9S,KAAK,WAAWuT,QAAS,eAACR,GAAD,MAChC,eAAC,IAAD,CAAO/S,KAAK,SAASuT,QAAS,eAAC5pB,GAAD,MAC9B,eAAC,IAAD,CAAOqW,KAAK,wBAAwBuT,QAAS,eAACzL,GAAD,MAC7C,eAAC,IAAD,CACE9H,KAAK,UACLuT,QAAS/xB,GAAc3F,IACrBA,EAAK4L,oBACD,eAAC6rB,GAAD,CAAUzb,QAASA,EAAS9J,MAAOA,EAAOvM,WAAYA,EAAY3F,KAAMA,IACvEA,EAAKoN,mBAAqB,KAAO,eAACgpB,GAAD,OAG1C,eAAC,IAAD,CACEjS,KAAK,gBACLuT,QAAS/xB,GAAc3F,IACrBA,EAAK4L,oBACD,eAAC+rB,GAAD,CAAO3b,QAASA,EAAS9J,MAAOA,EAAO1G,gBAAiB7F,EAAY3F,KAAMA,IACzEA,EAAKoN,mBAAqB,KAAO,eAACgpB,GAAD,OAG1C,eAAC,IAAD,CAAOjS,KAAK,IAAIuT,QAAS,eAACtB,GAAD,SAE3B,eAACC,GAAD,O,OC7ON,SAASqC,GAAoBlqB,GAC3B,IAAQmqB,EAAgBnqB,EAAhBmqB,YACA1f,EAAkBC,cAAlBD,cAER,OACE,eAACQ,EAAA,EAAD,CAAYC,QAAS,kBAAMT,EAAc0f,IAAzC,SACE,eAAC,IAAD,CAAWjnB,MAAO,CAAEzB,MAAO,aAOlB,SAAS2oB,KACtB,MAAwBl/B,mBAA4B,MAApD,mBAAOsG,EAAP,KAAa64B,EAAb,KAEA3+B,qBAAU,WAAM,4CACd,4BAAAuG,EAAA,sEACqCmK,KADrC,OACQkuB,EADR,OAEED,EAAQC,GAFV,4CADc,sBAMd,KANe,WAAD,wBAOZC,GACA,MAAOvc,GACP1hB,QAAQC,IAAIyhB,MAEb,IAEH,IAAM7iB,EAAQq/B,mBAAQ,iBAAO,CAC3Bh5B,OACAksB,OAAQ,WAAO,IAAD,EAAM,OAAJlsB,QAAI,IAAJA,GAAA,UAAAA,EAAM6J,WAAN,SAAWqiB,UAC3BC,SAAU,WACHnsB,IAELA,EAAK6J,IAAI7G,UACThD,EAAK6J,IAAIqiB,WAEXlpB,QAAS,WACFhD,IAELA,EAAK6J,IAAI7G,UACT61B,EAAQ,2BACH74B,GADE,IAELiN,YAAa,CACXC,UAAU,EACV3B,gBAAiB,KACjBE,SAAS,EACTC,iBAAiB,EACjByB,iBAAiB,EACjBxB,KAAM,YAIV,CAAC3L,IAUL,EAAsCtG,oBAAS,GAA/C,mBAAOu/B,EAAP,KAAoBC,EAApB,KACMC,EAAgCH,mBAAQ,iBAAO,CACnD1rB,KAAM2rB,EACN1rB,QAAS2rB,KACP,CAACD,EAAaC,IAElB,OACE,eAAC,aAAD,UACE,eAAC5O,GAAe8O,SAAhB,CAAyBz/B,MAAOw/B,EAAhC,SACE,eAACzuB,GAAY0uB,SAAb,CAAsBz/B,MAAOA,EAA7B,SACE,eAAC,IAAD,CACE4hB,iBAAkB,KAClBtS,OAAQ,SAAC0vB,GAAD,OAAiB,eAACD,GAAD,CAAqBC,YAAaA,KAC3D7R,QArBU,WAClB,IAAMjV,EAAM,IAAI6f,IAAIj3B,OAAOC,SAASoI,MAC9Bu2B,EAAK,IAAI7Q,gBAAgB3W,EAAI4W,QACnC4Q,EAAGC,OAAO,qBACVznB,EAAI4W,OAAS4Q,EAAG78B,WAChB/B,OAAO8+B,QAAQC,UAAU,GAAI,KAAa3nB,EAAIrV,aAiBtCi9B,SAAU,EAJZ,SAME,eAAC7B,GAAD,YCzFZ8B,iBACE,eAACd,GAAD,IACAlrB,SAASisB,eAAe,W","file":"static/js/main.50754823.chunk.js","sourcesContent":["import { useState, useEffect } from 'react';\n\nfunction getStorageValue(key: string, defaultValue: any) {\n  const value = localStorage.getItem(key);\n  if (value) {\n    return JSON.parse(value);\n  }\n  return defaultValue;\n}\n\nfunction useLocalStorage(key: string, defaultValue: any) {\n  const [value, setValue] = useState(() => getStorageValue(key, defaultValue));\n\n  useEffect(() => {\n    localStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n\n  return [value, setValue];\n}\n\nexport default useLocalStorage;\n","export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n}\n\nexport const DEFAULT_CONTRACT_NAME = process.env.REACT_APP_DEFAULT_CONTRACT_NAME as string;\nexport const FACTORY_CONTRACT_NAME = process.env.REACT_APP_FACTORY_CONTRACT_NAME as string;\nexport const TRY_CONVERT = true;\n\nconst getCurrentContractName = (): string => {\n  const contractNameFromUrl = window.location.hash.split('/')[1];\n  if (contractNameFromUrl === 'new_lockup_contract') return FACTORY_CONTRACT_NAME;\n\n  return contractNameFromUrl;\n};\n\nexport const CONTRACT_NAME = getCurrentContractName();\n\nconsole.log(CONTRACT_NAME);\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\nimport { config } from './config';\n\nexport const MAX_GAS = 300_000_000_000_000;\nexport const ONE_YOCTO = 1;\n\nBig.DP = 40;\nBig.PE = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const pseudoUtcIsoDate = (unixSeconds: number) => {\n  const date = new Date(unixSeconds * 1_000);\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const formatted = `${year}-${month}-${monthDay}`;\n\n  return formatted;\n};\n\nexport const pseudoUtcIsoTime = (unixSeconds: number) => {\n  const date = new Date(unixSeconds * 1_000);\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${hours}:${minutes}:${seconds}`;\n\n  return formatted;\n};\n\nexport const pseudoUtcIsoDateTime = (unixSeconds: number) => {\n  const formatted = `${pseudoUtcIsoDate(unixSeconds)} ${pseudoUtcIsoTime(unixSeconds)}`;\n\n  return formatted;\n};\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\n\n// formats token amount, always two digits after comma, fixed, no group separators\nexport const formatTokenAmount = (value: string, tokenDecimals: number) => new Big(value).div(10 ** tokenDecimals).toFixed(NEAR_ROUND_DIGITS, Big.roundDown);\n\nexport const addYear = (date: Date, year: number) => new Date(new Date(date).setUTCFullYear((date.getUTCFullYear()) + year)).getTime() / 1000;\nexport const startOfDay = (date: Date) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(Math.floor(date.getTime() / msInDay) * msInDay);\n\n  return result;\n};\nexport const addDays = (date: Date, days: number) => {\n  const msInDay = 1_000 * 60 * 60 * 24;\n  const result = new Date(date.getTime() + msInDay * days);\n\n  return result;\n};\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n\nexport const toCompactString = (string: string, leftPad: number = 10, rightPad: number = 10) => {\n  if (string.length > 24) {\n    return `${string.slice(0, leftPad)}...${string.slice(-rightPad)}`;\n  }\n  return string;\n};\n\nexport const txLinkInExplorer = (txHash: string) => `${config.explorerUrl}/transactions/${txHash}`;\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS, ONE_YOCTO } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n  'get_draft_operators_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'convert_draft',\n  'convert_drafts',\n  'terminate',\n  'discard_draft_group',\n  'delete_drafts',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n  'get_draft_operators_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'convert_draft': any,\n  'convert_drafts': any,\n  'terminate': any,\n  'discard_draft_group': any,\n  'delete_drafts': any,\n};\n\nexport type TNearAmount = string;\nexport type TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TCheckpointWithIndex = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n  index: number;\n};\n\nexport type TSchedule = TCheckpoint[];\n\nexport type TTerminationConfig = {\n  beneficiary_id: TNearAmount,\n  vesting_schedule: {\n    Schedule: TSchedule,\n  },\n};\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TSchedule,\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n  termination_config: TTerminationConfig | null,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n    if (result) {\n      result.id = index;\n    }\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ args: { drafts }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async convertDrafts(indices: DraftIndex[]): Promise<LockupIndex[]> {\n    const result = await this.contract.convert_drafts({ args: { draft_ids: indices }, gas: '300000000000000' });\n\n    return result;\n  }\n\n  async discardDraftGroup(draftGroupId: number): Promise<any> {\n    const result = await this.contract.discard_draft_group({ args: { draft_group_id: draftGroupId } });\n\n    return result;\n  }\n\n  async deleteDrafts(draftIds: number[]): Promise<any> {\n    const result = await this.contract.delete_drafts({ args: { draft_ids: draftIds } });\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number, timestamp: number | null): Promise<void> {\n    try {\n      const result = await this.contract.terminate({\n        args: { lockup_index: lockupIndex, termination_timestamp: timestamp },\n        gas: MAX_GAS,\n        amount: ONE_YOCTO,\n      });\n      return result;\n    } catch (e) {\n      console.log(e);\n      throw Error('Cannot terminate lockup');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getWalletConnection(): WalletConnection {\n    return this.walletConnection;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  getDraftOperatorsWhitelist(): Promise<Array<string>> {\n    return this.contract.get_draft_operators_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    const contractName = this.near.config.contractName !== 'lockup_contract_none'\n      ? this.near.config.contractName\n      : this.near.config.factoryContractName;\n    this.walletConnection.requestSignIn(contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async claimSpecificLockups(accountId: string, lockupIds: number[]): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({ amounts: lockupIds.map((x) => [x, null]) }, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst TOKEN_VIEW_METHODS = [''];\nconst TOKEN_CHANGE_METHODS = ['storage_deposit'];\n\ntype TChangeMethods = {\n  'storage_deposit': any,\n};\n\ntype TTokenContract = Contract & TChangeMethods;\n\nclass NoLoginTokenApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async storageDeposit(tokenAccountId: string, accountId: string, amount: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract(tokenAccountId).storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(contractName: string): TTokenContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      contractName,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n}\n\nexport default NoLoginTokenApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TRY_CONVERT } from '../config';\nimport { TSchedule } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n  'storage_balance_of',\n  'storage_balance_bounds',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n  'storage_deposit',\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any,\n  'storage_deposit': any,\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any,\n  'storage_balance_of': any,\n  'storage_balance_bounds': any,\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TLockupCreate = {\n  account_id: string,\n  schedule: TSchedule,\n  vesting_schedule: { Schedule: TSchedule } | null,\n};\n\ntype TDraftGroupFund = {\n  draft_group_id: number,\n  try_convert: boolean,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  async createLockup(\n    lockupContractId: string,\n    lockupTotalAmount: string,\n    userAccountId: string,\n    lockupSchedule: any[],\n    vestingSchedule: TSchedule | null,\n  ): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: lockupSchedule,\n        vesting_schedule: vestingSchedule ? { Schedule: vestingSchedule } : null,\n      },\n    });\n\n    return result;\n  }\n\n  async fundDraftGroup(lockupContractId: string, draftGroupId: number, amount: string): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount,\n      msg: {\n        draft_group_id: draftGroupId,\n        try_convert: TRY_CONVERT,\n      },\n    });\n\n    return result;\n  }\n\n  async ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: TLockupCreate | TDraftGroupFund,\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): Promise<void> {\n    const { msg, ...rest } = meta;\n\n    await this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  storageDeposit(accountId: String, amount: String): Promise<any> {\n    return this.contract.storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n\n  storageBalanceOf(accountId: String): Promise<String> {\n    return this.contract.storage_balance_of({ account_id: accountId });\n  }\n\n  storageBalanceBounds(): Promise<{ min: string, max: string }> {\n    return this.contract.storage_balance_bounds();\n  }\n}\n\nexport default TokenApi;\n","import Big from 'big.js';\n\nimport {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst DEPLOY_DEPOSIT = new Big(10).mul(new Big(10).pow(24)).toString();\n\nconst FACTORY_CHANGE_METHODS = [\n  'create',\n];\n\ntype TFactoryChangeMethods = {\n  'create': (opts: {\n    args: { name: string, init_function: string, init_args: string },\n    callbackUrl: string,\n    amount: string | number,\n    gas: string | number\n  }) => any,\n};\n\ntype TFactoryContract = Contract & TFactoryChangeMethods;\n\nclass FactoryApi {\n  private contract: TFactoryContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: [], changeMethods: FACTORY_CHANGE_METHODS },\n    ) as TFactoryContract;\n  }\n\n  getContract(): TFactoryContract {\n    return this.contract;\n  }\n\n  async create(\n    name: string,\n    tokenAccountId: string,\n    depositWhitelist: string[],\n    draftOperatorsWhitelist: string[],\n    callbackUrl: string,\n  ): Promise<void> {\n    const argsRaw = {\n      token_account_id: tokenAccountId,\n      deposit_whitelist: depositWhitelist,\n      draft_operators_whitelist: draftOperatorsWhitelist,\n    };\n    const argsPacked = JSON.stringify(argsRaw);\n    const result = await this.contract.create({\n      args: {\n        name,\n        init_function: 'new',\n        init_args: argsPacked,\n      },\n      callbackUrl,\n      gas: MAX_GAS,\n      amount: DEPLOY_DEPOSIT,\n    });\n\n    console.log(result);\n\n    return result;\n  }\n}\n\nexport default FactoryApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS = ['call:AddProposal', '*:AddProposal'];\n\nconst DAO_VIEW_METHODS = [\n  'get_policy',\n];\n\ntype TAstroDaoViewMethods = {\n  'get_policy': any,\n};\n\ntype TAstroDaoContract = Contract & TAstroDaoViewMethods;\n\nclass AstroDaoApi {\n  private contract: TAstroDaoContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: DAO_VIEW_METHODS, changeMethods: [] },\n    ) as TAstroDaoContract;\n  }\n\n  getContract(): TAstroDaoContract {\n    return this.contract;\n  }\n\n  async getCouncilMembers(): Promise<string[]> {\n    const policy = await this.contract.get_policy();\n    const canProposalRoles = policy.roles.filter(\n      (role: any) => role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[0]) || role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSIONS[1]),\n    );\n\n    if (canProposalRoles.length === 0) {\n      return [];\n    }\n\n    const canProposalGroups = canProposalRoles.map((role: any) => role?.kind?.Group);\n\n    return canProposalGroups.flat().filter((member: any) => member);\n  }\n}\n\nexport default AstroDaoApi;\n","import {\n  WalletConnection,\n} from 'near-api-js';\nimport { TRY_CONVERT } from '../../../config';\n\nimport AstroDaoApi from './api';\n\n// TODO move to the .env\nconst ASTRO_DAO_HOST = 'https://testnet.app.astrodao.com';\n\nexport const MAX_GAS = '300';\nexport const ONE_YOKTO = '0.000000000000000000000001';\n\nexport const buildProposalFormLink = (\n  contractAddress: string,\n  action: string,\n  variant: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string,\n): string => {\n  const params = {\n    details,\n    smartContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    gas,\n    deposit: actionDeposit,\n  };\n\n  return `${ASTRO_DAO_HOST}/dao/${contractAddress}/proposals?action=${action}&variant=${variant}&params=${JSON.stringify(params)}`;\n};\n\nexport const customFunctionCallProposalFormLink = (\n  contractAddress: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string = MAX_GAS,\n): string => buildProposalFormLink(\n  contractAddress,\n  'create_proposal',\n  'ProposeCustomFunctionCall',\n  details,\n  smartContractAddress,\n  methodName,\n  json,\n  actionsGas,\n  actionDeposit,\n  gas,\n);\n\nexport const daoCouncilMembers = async (walletConnection: WalletConnection, accountAddress: string): Promise<any> => {\n  try {\n    const api = new AstroDaoApi(walletConnection, accountAddress);\n    const councilsMembers = await api.getCouncilMembers();\n\n    return { [accountAddress]: councilsMembers };\n  } catch (e) {\n    console.log('isDAO ERROR:', e);\n    return undefined;\n  }\n};\n\nexport const buildFundDraftGroupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  tokenContractAddress: string,\n  amountValue: string,\n  draftGroupIndex: number,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'ft_transfer_call';\n  const json = {\n    receiver_id: lockupContractAddress,\n    amount: amountValue,\n    msg: JSON.stringify({ draft_group_id: draftGroupIndex, try_convert: TRY_CONVERT }),\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    tokenContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nexport const buildTerminateLockupProposalLink = (\n  description: string,\n  lockupContractAddress: string,\n  lockupIndex: number,\n  timestamp: number | null,\n  daoContractAddress: string,\n): string => {\n  const details = encodeURIComponent(description);\n  const methodName = 'terminate';\n  const json = {\n    lockup_index: lockupIndex,\n    termination_timestamp: timestamp,\n  };\n  const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n  const actionDeposit = ONE_YOKTO;\n\n  return customFunctionCallProposalFormLink(\n    daoContractAddress,\n    details,\n    lockupContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    actionDeposit,\n  );\n};\n\nconst utils = {\n  buildProposalFormLink,\n  customFunctionCallProposalFormLink,\n  daoCouncilMembers,\n  buildFundDraftGroupProposalLink,\n  buildTerminateLockupProposalLink,\n};\n\nexport default utils;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config as configTemplate } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport NoLoginTokenApi from './NoLoginTokenApi';\nimport TokenApi from './tokenApi';\nimport FactoryApi from './factoryApi';\nimport { daoCouncilMembers } from './DAOs/astroDAO/utils';\n\nexport interface INearConfig {\n  contractName: string,\n  networkId: string,\n  nodeUrl: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n}\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  currentUser: {\n    signedIn: boolean;\n    isAdmin: boolean;\n    isDraftOperator: boolean;\n    isCouncilMember: boolean;\n    signedAccountId: string | null;\n    daos: string[];\n  }\n  tokenContractId: string;\n  lockupContractId: string;\n  lockupContractFound: boolean;\n  lockupContractNone: boolean;\n  tokenApi: TokenApi;\n  noLoginTokenApi: NoLoginTokenApi;\n  factoryApi: FactoryApi;\n  rpcProvider: nearAPI.providers.JsonRpcProvider;\n  isContractFtStoragePaid: boolean;\n  near: nearAPI.Near;\n  suggestConvertDialog: {\n    open: boolean,\n    setOpen: (newValue: boolean) => any,\n  }\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  let lockupContractId = window.location.hash.split('/')[1] || '';\n  if (['', 'terms', 'privacy', 'about', 'new_lockup_contract'].some((x) => lockupContractId === x)) {\n    lockupContractId = 'lockup_contract_none';\n  }\n  const config: INearConfig = { ...configTemplate, contractName: lockupContractId };\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n  const noLoginTokenApi = new NoLoginTokenApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  let tokenContractId: string = 'lockup_contract_not_found';\n  let isAdmin: boolean = false;\n  let isDraftOperator: boolean = false;\n  let depositWhitelist: string[] = [];\n  let draftOperatorsWhitelist: string[] = [];\n  let daos: string[] = [];\n  let lockupContractFound = false;\n  try {\n    tokenContractId = await api.getTokenAccountId();\n    depositWhitelist = await api.getDepositWhitelist();\n    draftOperatorsWhitelist = await api.getDraftOperatorsWhitelist();\n    console.log('depositWhitelist', depositWhitelist);\n    isAdmin = depositWhitelist.includes(signedAccountId);\n    console.log('isAdmin', isAdmin);\n    isDraftOperator = draftOperatorsWhitelist.includes(signedAccountId);\n    console.log('isDraftOperator', isDraftOperator);\n    const dcm = daoCouncilMembers;\n    console.log(dcm);\n    const daosCouncilMembers = (await Promise.all(depositWhitelist.map((dwID): Promise<any[]> => daoCouncilMembers(walletConnection, dwID)))).filter((value) => !!value);\n    console.log(daosCouncilMembers);\n    const userDaosCouncils = daosCouncilMembers.filter((daoCMs) => Object.values(daoCMs).pop().includes(signedAccountId));\n    if (userDaosCouncils?.length > 0) {\n      daos = userDaosCouncils.map((daoCMs) => Object.keys(daoCMs).pop() || '');\n    }\n    console.log('userDaosCouncils', userDaosCouncils);\n    console.log('councilMembers', daosCouncilMembers);\n    console.log('daos', daos);\n  } catch (e) {\n    console.log(e);\n    const nearConnectionError: any = e;\n    if (nearConnectionError.type === 'AccountDoesNotExist') {\n      console.log('contract not found');\n    } else {\n      console.log(`UNKNOWN ERROR: ${e}`);\n    }\n  }\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  let isContractFtStoragePaid = false;\n\n  try {\n    const storageBalance = await tokenApi.storageBalanceOf(lockupContractId);\n    // successful read of data from token contract AND lockup contract\n    lockupContractFound = true;\n    isContractFtStoragePaid = (storageBalance !== null) && true;\n    console.log(isContractFtStoragePaid);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const factoryApi = new FactoryApi(\n    walletConnection,\n    config.factoryContractName,\n  );\n\n  const rpcProvider = new nearAPI.providers.JsonRpcProvider(\n    config.nodeUrl,\n  );\n\n  return {\n    config,\n    api,\n    tokenContractId,\n    noLoginApi,\n    tokenApi,\n    factoryApi,\n    currentUser: {\n      signedIn: !!signedAccountId,\n      isAdmin,\n      isDraftOperator,\n      isCouncilMember: daos.length > 0,\n      signedAccountId,\n      daos,\n    },\n    noLoginTokenApi,\n    rpcProvider,\n    isContractFtStoragePaid,\n    lockupContractId,\n    lockupContractFound,\n    lockupContractNone: lockupContractId === 'lockup_contract_none',\n    near,\n    suggestConvertDialog: {\n      open: false,\n      setOpen: () => null,\n    },\n  };\n};\n","import { useEffect } from 'react';\n\nexport interface UseTitleOptions {\n  restoreOnUnmount?: boolean;\n}\n\nconst DEFAULT_USE_TITLE_OPTIONS: UseTitleOptions = {\n  restoreOnUnmount: false,\n};\n\nfunction useTitle(title: string, options: UseTitleOptions = DEFAULT_USE_TITLE_OPTIONS) {\n  useEffect(() => {\n    const prevTitle = document.title;\n    if (document.title !== title) document.title = title;\n\n    // eslint: disable\n    if (options && options.restoreOnUnmount) {\n      return () => {\n        document.title = prevTitle;\n      };\n    }\n\n    return () => {};\n  });\n}\n\nexport default typeof document !== 'undefined' ? useTitle : () => {};\n","import { Box } from '@mui/material';\nimport { Link } from 'react-router-dom';\n\nimport useTitle from '../../services/useTitle';\n\nexport default function About() {\n  useTitle('About | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"container\">\n        <h1>Fungible Token Lockup</h1>\n\n        <h2>Purpose</h2>\n\n        <div>\n          <p>Community Lockup is dApp implementing locking and vesting of any arbitrary fungible token on NEAR in the generally known sense of these words.</p>\n          <p>Lockup is a gradual release of tokens according to a specified schedule. After release tokens are in full control of the beneficiary.</p>\n          <p>\n            Vesting is a gradual allocation of tokens to the beneficiary according to a specified schedule,\n            provided certain conditions are met (for example, beneficiary keeps working for the payer).\n          </p>\n          <p>\n            Vested tokens are NOT immediately available to the beneficiary, however\n            they WILL be available to the beneficiary according to the lockup\n            schedule. Vested tokens are GUARANTEED to be received at some point in\n            the future, while unvested token amount may be withdrawn by the payer if\n            the lockup agreement is terminated.\n          </p>\n        </div>\n\n        <h2>Users</h2>\n\n        <div>\n          <p>There are two roles in the app: payer (also called admin), most commonly the employer, and beneficiaries, most commonly the employees. There is also an implicit “anyone” role.</p>\n\n          <ul>\n            <li>\n              All users (“anyone”) are able to view ALL lockup information stored\n              in the blockchain for any existing lockup contract. They are also\n              able to create new lockup contract and become admin for that new\n              lockup contract.\n            </li>\n            <li>Beneficiary users have ability to claim unlocked tokens dedicated to them</li>\n            <li>Admin users can create new lockups (one by one or via excel import) and terminate existing lockups that can be terminated</li>\n            <li>Draft operators can create draft groups, drafts, delete draft groups, drafts.</li>\n          </ul>\n        </div>\n\n        <h2>Lockups</h2>\n\n        <div>\n          <p>Each lockup has the following fields:</p>\n          <ul>\n            <li>Account ID: NEAR account id that will receive the tokens</li>\n            <li>\n              Schedule: the lockup schedule, according to which the tokens are\n              released. Is represented by a monotonous piecewise linear function .\n              Where x is the time axis and y is the amount of unlocked tokens at\n              any specific moment.\n            </li>\n            <li>\n              Vesting schedule: optional. According to this schedule tokens are\n              vested, i. e. allocated to the beneficiary irrevocably. Operator is\n              able to terminate the lockup at any effective moment in the future.\n              If this happens, then the lockup schedule is capped at the total\n              vested amount at the effective moment of termination.\n            </li>\n            <li>\n              Payer id: optional. account id that paid for the specific lockup.\n              Only recorded for terminatable lockups. If the lockup is terminated\n              - unvested tokens will be returned back to the payer upon\n              termination.\n            </li>\n            <li>\n              Claimed balance: already claimed balance for the lockup. Used for\n              tracking claim progress.\n            </li>\n          </ul>\n        </div>\n\n        <h2>Lockup and vesting logic</h2>\n\n        <div>\n\n          <img src=\"https://bafkreiaghj56tpqi5qzivzzue7kudpp5amyhbxqzgjakydp6anprtbxxu4.ipfs.nftstorage.link/\" alt=\"Lockup and vesting schedule\" />\n          <p>Consider the following lockup with a four year duration.</p>\n          <p>The vesting schedule is blue. One year cliff, then 1 / 4 is vested, then vesting is linear till the end (4 years mark).</p>\n          <p>The lockup schedule is green. Two years cliff with zero amount. Then two years of linear lockup till full amount</p>\n          <p>Consider the termination happening at the 2.6 years mark.</p>\n          <p>First, we find the vested amount for this timestamp. It is 0.65.</p>\n          <p>After that we trim the lockup schedule at that amount.</p>\n          <p>In this case, the intersection is at 3.3 year mark.</p>\n          <p>The trimmed lockup schedule capped by the horizontal red line at 0.65 of the amount.</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","export default function TimestampDateDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${year}-${month}-${monthDay}`;\n  const formattedWithTime = `${year}-${month}-${monthDay} ${hours}:${minutes}:${seconds} UTC`;\n\n  return (\n    <span className=\"nowrap timestamp-display\" title={formattedWithTime}>\n      {formatted}\n    </span>\n  );\n}\n","import ReactEcharts from 'echarts-for-react';\n\nimport '../../styles/chart.scss';\n\nexport default function Chart({ data, xMax, yMax }: { data: { vested: any[], unlocked: any[], claimed: any[] }, xMax?: number, yMax?: number }) {\n  const xMin = Math.min(...[data.unlocked[0][0], ...(data.vested[0][0] && [data.vested[0][0]] && [])]);\n  console.log('xMin', xMin / 1000);\n  console.log('xMax', xMax);\n  console.log('withOffset', xMax && (xMax + (xMax - xMin / 1000) * 0.03));\n  const computedMin = xMax && (xMin / 1000 - (xMax - xMin / 1000) * 0.03) * 1000;\n  const computedMax = xMax && (xMax + (xMax - xMin / 1000) * 0.03) * 1000;\n  console.log('computedMin', computedMin);\n  console.log('computedMax', computedMax);\n\n  const formatNumber = (x: string) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(parseFloat(x));\n\n  const option = {\n    useUTC: true,\n    title: [\n      {\n        text: 'Schedule timestamps are in UTC',\n        top: '10px',\n        // left: 'center',\n        left: '7px',\n        // right: '30px',\n        textStyle: {\n          fontWeight: '700',\n          fontFamily: '\"Roboto\",\"Helvetica\",\"Arial\",sans-serif',\n          fontSize: '14px',\n          color: '#242F57',\n          opacity: 1.0,\n        },\n      },\n    ],\n    tooltip: {\n      trigger: 'axis',\n      axisPointer: {\n        type: 'cross',\n      },\n    },\n    legend: {\n      bottom: '3%',\n      selectedMode: false,\n      icon: 'circle',\n    },\n    grid: {\n      top: '50px',\n      left: '12px',\n      right: '12px',\n      bottom: '15%',\n      containLabel: true,\n    },\n    xAxis: [\n      {\n        type: 'time',\n        boundaryGap: ['3%', '3%'],\n        splitNumber: 10,\n        min: computedMin,\n        max: computedMax,\n      },\n    ],\n    yAxis: [\n      {\n        type: 'value',\n        max: yMax,\n      },\n    ],\n    series: [\n      {\n        tooltip: {\n          valueFormatter: formatNumber,\n        },\n        showSymbol: false,\n        name: 'Vested',\n        type: 'line',\n        color: '#0069D1',\n        areaStyle: {\n          opacity: 1,\n        },\n        markLine: {\n          data: [\n            [\n              { xAxis: new Date(), yAxis: 0 },\n              { xAxis: new Date(), yAxis: yMax || 'max' },\n            ],\n          ],\n          lineStyle: {\n            type: 'dashed',\n            color: '#FF594E',\n          },\n          symbol: 'none',\n        },\n        data: data.vested,\n      },\n      {\n        tooltip: {\n          valueFormatter: formatNumber,\n        },\n        showSymbol: false,\n        name: 'Unlocked',\n        type: 'line',\n        color: '#00B988',\n        areaStyle: {\n          opacity: 1,\n        },\n        data: data.unlocked,\n      },\n      {\n        tooltip: {\n          valueFormatter: formatNumber,\n        },\n        showSymbol: false,\n        name: 'Claimed',\n        type: 'line',\n        color: '#E9AF1C',\n        areaStyle: {\n          opacity: 1,\n        },\n        data: data.claimed,\n      },\n    ],\n  };\n  return <ReactEcharts option={option} style={{ borderRadius: 10 }} />;\n}\n\nChart.defaultProps = {\n  xMax: null,\n  yMax: null,\n};\n","export default function TokenIcon(params: { url: string, size: number }) {\n  const { url, size } = params;\n  return (\n    <img\n      style={{\n        height: size, width: size, verticalAlign: 'middle',\n      }}\n      src={url}\n      alt=\"Token Icon\"\n    />\n  );\n}\n","// import Big from 'big.js';\n\nimport { TNearAmount } from '../../services/api';\nimport { formatTokenAmount } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\n\nexport default function TokenAmountDisplay(params: { token: TMetadata, amount: TNearAmount }) {\n  const { token, amount } = params;\n\n  return (\n    <span className=\"nowrap\" title={amount}>\n      {formatTokenAmount(amount, token.decimals)}\n      {' '}\n      {token.symbol}\n      {' '}\n      <TokenIcon url={token.icon || ''} size={32} />\n    </span>\n  );\n}\n","export default function TimestampDisplay(props: { unixSeconds: number }) {\n  const { unixSeconds } = props;\n\n  const date = new Date(unixSeconds * 1_000);\n\n  const pad = (input: number | string, width: number) => input.toString().padStart(width, '0');\n\n  const year = pad(date.getUTCFullYear(), 4);\n  const month = pad(date.getUTCMonth() + 1, 2);\n  const monthDay = pad(date.getUTCDate(), 2);\n\n  const hours = pad(date.getUTCHours(), 2);\n  const minutes = pad(date.getUTCMinutes(), 2);\n  const seconds = pad(date.getUTCSeconds(), 2);\n\n  const formatted = `${year}-${month}-${monthDay} ${hours}:${minutes}:${seconds} UTC`;\n\n  return (\n    <span className=\"nowrap timestamp-display\" title={formatted}>\n      {formatted}\n    </span>\n  );\n}\n","import {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport TimestampDisplay from '../TimestampDisplay';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\n\nexport default function ScheduleTable(params: { token: TMetadata, title: String, schedule: TSchedule }) {\n  const { schedule, title, token } = params;\n\n  return (\n    <div className=\"inner-table_wrapper\">\n      <h5>{title}</h5>\n      <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n        <TableHead>\n          <TableRow>\n            <TableCell>DATE (UTC)</TableCell>\n            <TableCell align=\"right\">CUMULATIVE AMOUNT</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {schedule.map((x: any) => (\n            <TableRow key={x.timestamp}>\n              <TableCell scope=\"row\">\n                <div className=\"nowrap\">\n                  <TimestampDisplay unixSeconds={x.timestamp} />\n                </div>\n              </TableCell>\n              <TableCell align=\"right\">\n                <TokenAmountDisplay amount={x.balance} token={token} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { Big } from 'big.js';\nimport { TCheckpoint, TNearTimestamp, TSchedule } from './api';\nimport { pseudoUtcIsoDateTime } from '../utils';\n\nexport const interpolateRaw = (x0: number, y0: string, x1: number, y1: string, xM: number) : string => {\n  if (x1 <= x0) {\n    throw new Error('invalid range');\n  }\n  if (xM < x0 || xM >= x1) {\n    throw new Error('xM out of bound');\n  }\n\n  const yM = new Big(y0).add(\n    (new Big(y1).sub(new Big(y0)))\n      .mul(new Big(xM.toString()).sub(new Big(x0.toString())))\n      .div(new Big(x1.toString()).sub(new Big(x0.toString()))),\n  );\n\n  return yM.toFixed(0, Big.roundDown);\n};\n\nexport const interpolateRawAtY = (x0: number, y0: string, x1: number, y1: string, yM: string) : TNearTimestamp => {\n  if (x1 <= x0) {\n    throw new Error('invalid range');\n  }\n  if (new Big(yM).lt(new Big(y0)) || new Big(yM).gte(y1)) {\n    throw new Error('yM out of bound');\n  }\n\n  const xM = new Big(x0).add(\n    (new Big(x1).sub(new Big(x0)))\n      .mul(new Big(yM.toString()).sub(new Big(y0.toString())))\n      .div(new Big(y1.toString()).sub(new Big(y0.toString()))),\n  );\n\n  return parseInt(xM.toFixed(0, Big.roundUp), 10);\n};\n\nexport const interpolate = (checkpoint0: TCheckpoint, checkpoint1: TCheckpoint, timestamp: TNearTimestamp) : TCheckpoint => {\n  const balance = interpolateRaw(\n    checkpoint0.timestamp,\n    checkpoint0.balance,\n    checkpoint1.timestamp,\n    checkpoint1.balance,\n    timestamp,\n  );\n\n  return { timestamp, balance };\n};\n\nexport const interpolateAtY = (checkpoint0: TCheckpoint, checkpoint1: TCheckpoint, balance: string) : TCheckpoint => {\n  const timestamp = interpolateRawAtY(\n    checkpoint0.timestamp,\n    checkpoint0.balance,\n    checkpoint1.timestamp,\n    checkpoint1.balance,\n    balance,\n  );\n\n  return { timestamp, balance };\n};\n\nexport const interpolateSchedule = (schedule: TCheckpoint[], timestamp: TNearTimestamp) : TCheckpoint => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (timestamp < schedule[0].timestamp) {\n    return { timestamp, balance: schedule[0].balance };\n  }\n\n  if (timestamp >= schedule[schedule.length - 1].timestamp) {\n    return { timestamp, balance: schedule[schedule.length - 1].balance };\n  }\n\n  // eslint-disable-next-line no-plusplus\n  for (let i = 0; i < schedule.length - 1; i++) {\n    if (schedule[i + 1].timestamp <= timestamp) {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    return interpolate(schedule[i], schedule[i + 1], timestamp);\n  }\n\n  throw new Error('unreachable');\n};\n\nexport const sumSchedules = (schedules: TSchedule[]) : TSchedule => {\n  if (schedules.length === 0) {\n    throw new Error('schedules is empty');\n  }\n\n  const timestamps = Array.from(new Set(schedules.flat().map((x) => x.timestamp).sort(\n    (x, y) => x - y,\n  )));\n\n  const result: TSchedule = [];\n\n  timestamps.forEach((timestamp:TNearTimestamp) => {\n    let amount = new Big(0);\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < schedules.length; i++) {\n      const balance = new Big(interpolateSchedule(schedules[i], timestamp).balance);\n      amount = amount.plus(balance);\n    }\n    result.push({ timestamp, balance: amount.toString() });\n  });\n\n  return result;\n};\n\nexport const assertValidTerminationSchedule = (lockupSchedule: TSchedule, vestingSchedule: TSchedule) => {\n  const f = (x: number) => `${pseudoUtcIsoDateTime(x)} UTC`;\n\n  lockupSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = checkpoint.balance;\n    const vestingBalance = interpolateSchedule(vestingSchedule, timestamp).balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at ${f(timestamp)} (${timestamp})`);\n    }\n  });\n  vestingSchedule.forEach((checkpoint) => {\n    const { timestamp } = checkpoint;\n    const lockupBalance = interpolateSchedule(lockupSchedule, timestamp).balance;\n    const vestingBalance = checkpoint.balance;\n    if (!(new Big(lockupBalance).lte(new Big(vestingBalance)))) {\n      throw new Error(`The lockup schedule is ahead of the termination schedule at ${f(timestamp)} (${timestamp})`);\n    }\n  });\n};\n\nexport const terminateSchedule = (schedule: TSchedule, timestamp: TNearTimestamp) => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (timestamp <= schedule[0].timestamp) {\n    return [\n      schedule[0],\n      { timestamp: schedule[0].timestamp + 1, balance: schedule[0].balance },\n    ];\n  }\n\n  if (timestamp >= schedule[schedule.length - 1].timestamp) {\n    return schedule.slice(0, schedule.length);\n  }\n\n  const result = [];\n\n  for (let i = 0; i < schedule.length - 1; i += 1) {\n    result.push(schedule[i]);\n\n    if (timestamp < schedule[i + 1].timestamp) {\n      const finishCheckpoint = interpolate(schedule[i], schedule[i + 1], timestamp);\n      result.push(finishCheckpoint);\n      return result;\n    }\n\n    if (timestamp === schedule[i + 1].timestamp) {\n      result.push(schedule[i + 1]);\n      return result;\n    }\n  }\n\n  throw new Error('unreachable');\n};\n\nexport const terminateScheduleAtAmount = (schedule: TSchedule, amount: string, finishTimestamp: TNearTimestamp) => {\n  if (schedule.length === 0) {\n    throw new Error('empty schedule');\n  }\n\n  if (new Big(amount).eq(new Big('0'))) {\n    return [\n      schedule[0],\n      { timestamp: Math.max(schedule[0].timestamp + 1, finishTimestamp), balance: schedule[0].balance },\n    ];\n  }\n\n  if (new Big(amount).gte(new Big(schedule[schedule.length - 1].balance))) {\n    return schedule.slice(0, schedule.length);\n  }\n\n  const result = [];\n\n  for (let i = 0; i < schedule.length - 1; i += 1) {\n    result.push(schedule[i]);\n\n    if (new Big(amount).lt(new Big(schedule[i + 1].balance))) {\n      const finishCheckpoint = interpolateAtY(schedule[i], schedule[i + 1], amount);\n      result.push(finishCheckpoint);\n      return result;\n    }\n\n    if (new Big(amount).eq(new Big(schedule[i + 1].balance))) {\n      result.push(schedule[i + 1]);\n      return result;\n    }\n  }\n\n  throw new Error('unreachable');\n};\n\nexport type TBalancesRaw = {\n  claimed: string,\n  unclaimed: string,\n  vested: string,\n  unvested: string,\n  total: string,\n};\n\nexport const calcBalancesRaw = (row: any, now: number): TBalancesRaw => {\n  const totalBalanceRaw = row.schedule[row.schedule.length - 1].balance;\n  const claimedBalanceRaw = row.claimed_balance || '0';\n\n  const unclaimedBalanceRaw = new Big(interpolateSchedule(row.schedule, now).balance).sub(new Big(claimedBalanceRaw)).toFixed();\n  let vestedBalanceFullRaw = null;\n  const vestingSchedule = row.vesting_schedule?.Schedule || row.termination_config?.vesting_schedule?.Schedule;\n  if (vestingSchedule) {\n    vestedBalanceFullRaw = interpolateSchedule(vestingSchedule, now).balance;\n  } else {\n    vestedBalanceFullRaw = row.schedule[row.schedule.length - 1].balance;\n  }\n  const vestedBalanceRaw = new Big(vestedBalanceFullRaw)\n    .sub(new Big(claimedBalanceRaw))\n    .sub(new Big(unclaimedBalanceRaw))\n    .toString();\n  const unvestedBalanceRaw = new Big(totalBalanceRaw)\n    .sub(new Big(vestedBalanceFullRaw))\n    .toString();\n  console.log(totalBalanceRaw, claimedBalanceRaw, unclaimedBalanceRaw, vestedBalanceRaw, unvestedBalanceRaw);\n\n  return {\n    claimed: claimedBalanceRaw,\n    unclaimed: unclaimedBalanceRaw,\n    vested: vestedBalanceRaw,\n    unvested: unvestedBalanceRaw,\n    total: totalBalanceRaw,\n  };\n};\n\nexport const shatterSchedule = (schedule: TSchedule, extraTimestamps: TNearTimestamp[]) => {\n  const presentTimestamps = schedule.map((x) => x.timestamp);\n  const timestamps: number[] = Array.from(new Set([...presentTimestamps, ...extraTimestamps])).sort();\n  const result = timestamps.map((timestamp) => interpolateSchedule(schedule, timestamp));\n  return result;\n};\n","import { Big } from 'big.js';\n\nimport {\n  TSchedule, TNearTimestamp, TNearAmount, TCheckpoint,\n} from './api';\nimport { formatTokenAmount } from '../utils';\nimport { sumSchedules, terminateScheduleAtAmount, shatterSchedule } from './scheduleHelpers';\n\nconst buildVestedSchedule = (from: TNearTimestamp, balance: TNearAmount) => [\n  { timestamp: from - 1, balance: '0' },\n  { timestamp: from, balance },\n];\n\nexport const chartData = (lockupsList: any[], tokenDecimals: number): any => {\n  const startTime = new Date();\n  console.log(`chartData([${lockupsList.length}]): start ${startTime}`);\n\n  const lockupSchedules = Array.from(\n    lockupsList.map((x) => x.schedule),\n  ) as TSchedule[];\n\n  const now = Math.round(new Date().getTime() / 1000);\n  const minTimestampsLockup = lockupsList.map((x) => x.schedule[0].timestamp);\n  const minTimestampsVesting = lockupsList.map((x) => x?.termination_config?.vesting_schedule[0]?.timestamp).filter((x) => x);\n\n  const minTimestamp = Math.min(...minTimestampsLockup, ...minTimestampsVesting, now);\n\n  const vestingSchedules = Array.from(\n    lockupsList.map((x) => {\n      // for lockups and drafts\n      const result = x?.termination_config?.vesting_schedule?.Schedule\n        || x?.vesting_schedule?.Schedule;\n      if (result) return result;\n      return result || buildVestedSchedule(minTimestamp, x.schedule[x.schedule.length - 1].balance);\n    }),\n  ) as TSchedule[];\n\n  let sumVesting = sumSchedules(vestingSchedules);\n  let sumLockup = sumSchedules(lockupSchedules);\n\n  if (sumVesting.length > 0) {\n    if (sumVesting[sumVesting.length - 1].timestamp < sumLockup[sumLockup.length - 1].timestamp) {\n      sumVesting.push(sumLockup[sumLockup.length - 1]);\n    }\n    if (sumVesting[sumVesting.length - 1].timestamp > sumLockup[sumLockup.length - 1].timestamp) {\n      sumLockup.push(sumVesting[sumVesting.length - 1]);\n    }\n  }\n\n  const convertSchedule = (schedule: TSchedule, decimals: number) => schedule.map((s: TCheckpoint) => [s.timestamp * 1000, formatTokenAmount(s.balance, decimals)]);\n\n  const totalClaimed = lockupsList.map((x) => x.claimed_balance || '0').reduce((acc, x) => new Big(acc).add(new Big(x)).toFixed(), '0');\n\n  // trim lockup schedule at claimed amount\n  let sumClaimed = terminateScheduleAtAmount(sumLockup, totalClaimed, 0);\n\n  if (sumClaimed[sumClaimed.length - 1]?.timestamp !== sumLockup[sumLockup.length - 1].timestamp) {\n    sumClaimed.push({\n      timestamp: sumLockup[sumLockup.length - 1].timestamp,\n      balance: sumClaimed[sumClaimed.length - 1].balance,\n    });\n  }\n\n  const existingCheckpoints = [sumLockup, sumVesting, sumClaimed]\n    .flatMap((schedule) => schedule.map((x) => x.timestamp));\n\n  const realMinTimestamp = Math.min(...existingCheckpoints);\n  const maxTimestamp = Math.max(...existingCheckpoints);\n\n  const dailyCheckpoints = [];\n  for (let i = ((realMinTimestamp - 1) / (60 * 60 * 24) + 1) * (60 * 60 * 24); i < maxTimestamp; i += (60 * 60 * 24)) {\n    dailyCheckpoints.push(i);\n  }\n  const allCheckpoints = [...existingCheckpoints, ...dailyCheckpoints];\n\n  sumClaimed = shatterSchedule(sumClaimed, allCheckpoints);\n  sumLockup = shatterSchedule(sumLockup, allCheckpoints);\n  sumVesting = shatterSchedule(sumVesting, allCheckpoints);\n\n  const finishTime = new Date();\n  console.log(`chartData([${lockupsList.length}]): finish ${startTime} duration ${(finishTime.getTime() - startTime.getTime()) / 1000}`);\n\n  return {\n    unlocked: lockupsList.length ? convertSchedule(sumLockup, tokenDecimals) : [],\n    vested: lockupsList.length ? convertSchedule(sumVesting, tokenDecimals) : [],\n    claimed: lockupsList.length ? convertSchedule(sumClaimed, tokenDecimals) : [],\n  };\n};\n\nexport default chartData;\n","import { forwardRef, useCallback, Ref } from 'react';\nimport { makeStyles } from '@mui/styles';\nimport { useSnackbar, SnackbarContent } from 'notistack';\nimport Paper from '@mui/material/Paper';\nimport Card from '@mui/material/Card';\nimport CardActions from '@mui/material/CardActions';\nimport IconButton from '@mui/material/IconButton';\nimport CloseIcon from '@mui/icons-material/Close';\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    '@media (min-width:600px)': {\n      width: '410px !important',\n      maxWidth: '410px !important',\n      minHeight: '120px !important',\n    },\n    boxShadow: '1px 7px 20px 0px rgba(0,0,0, 0.3) !important',\n    borderRadius: '12px',\n  },\n  simpleRoot: {\n    '@media (min-width:600px)': {\n      width: '410px !important',\n      maxWidth: '410px !important',\n    },\n    boxShadow: '1px 7px 20px 0px rgba(0,0,0, 0.3) !important',\n    borderRadius: '12px',\n  },\n  card: {\n    width: '100%',\n    padding: '24px',\n    boxShadow: 'none',\n    borderRadius: '12px',\n  },\n  simpleCard: {\n    width: '100%',\n    padding: '12px 24px',\n    boxShadow: 'none',\n    borderRadius: '12px',\n  },\n  actionRoot: {\n    padding: 0,\n    marginBottom: '8px',\n    justifyContent: 'space-between',\n  },\n  simplaActionRoot: {\n    padding: 0,\n  },\n  typography1: {\n    color: 'rgba(0, 185, 136, 1)',\n    fontWeight: 700,\n    fontSize: '16px',\n  },\n  icons: {\n    marginLeft: 'auto',\n  },\n  expand: {\n    padding: 0,\n    transition: 'all .2s',\n  },\n  collapse: {\n    padding: '8px',\n    backgroundColor: '#F4F7FC',\n    boxShadow: 'none',\n    borderRadius: '8px',\n  },\n}));\n\ntype TProps = {\n  id: number,\n  header: Function,\n  body: Function | null,\n};\n\nconst Snackbar = forwardRef((props: TProps, ref: Ref<HTMLDivElement> | undefined) => {\n  const classes = useStyles();\n  const { closeSnackbar } = useSnackbar();\n\n  const handleDismiss = useCallback(() => {\n    closeSnackbar(props.id);\n  }, [props.id, closeSnackbar]);\n\n  return (\n    <SnackbarContent ref={ref} className={props.body ? classes.root : classes.simpleRoot}>\n      <Card className={props.body ? classes.card : classes.simpleCard}>\n        <CardActions classes={{ root: props.body ? classes.actionRoot : classes.simplaActionRoot }}>\n          { props.header && props.header(makeStyles) }\n          <div className={classes.icons}>\n            <IconButton className={classes.expand} onClick={handleDismiss}>\n              <CloseIcon />\n            </IconButton>\n          </div>\n        </CardActions>\n        { props.body && (\n          <Paper className={classes.collapse}>\n            { props.body(makeStyles) }\n          </Paper>\n        ) }\n      </Card>\n    </SnackbarContent>\n  );\n});\n\nconst anchorOrigin = {\n  vertical: 'top',\n  horizontal: 'right',\n};\n\nexport const enqueueCustomSnackbar = (hook: Function, body: Function | null, header: Function, options?: any) => hook(\n  '',\n  {\n    anchorOrigin,\n    content: (key: number) => <Snackbar {...{ id: key, body, header }} />,\n    ...options,\n  },\n);\n\nexport default Snackbar;\n","import Typography from '@mui/material/Typography';\n\nconst body = (text: string) => {\n  const Body = function Body(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      typography: {\n        fontSize: '12px',\n      },\n    }))();\n\n    return <Typography className={classes.typography}>{text}</Typography>;\n  };\n\n  return Body;\n};\n\nconst header = (text: string) => {\n  const Header = function Header(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      typography: {\n        color: 'rgba(0, 185, 136, 1)',\n        fontWeight: 700,\n        fontSize: '16px',\n      },\n    }))();\n\n    return (\n      <Typography variant=\"subtitle2\" className={classes.typography}>\n        {text}\n      </Typography>\n    );\n  };\n\n  return Header;\n};\n\nconst success = { body, header };\n\nexport default success;\n","import { useState, useContext } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\nimport LinkIcon from '@mui/icons-material/Link';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { useSnackbar } from 'notistack';\n\nimport TimestampDateDisplay from '../TimestampDateDisplay';\nimport Chart from '../Chart';\nimport { formatTokenAmount, toCompactString } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\nimport { calcBalancesRaw } from '../../services/scheduleHelpers';\n\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\nimport success from '../Snackbars/SuccessPartials';\n\nexport default function DraftsTableRow(props: { opened: boolean, pageIndex: number, row: ReturnType<any>, token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  const location = useLocation();\n  const {\n    opened, pageIndex, row, token, adminControls, progressShow,\n  } = props;\n  const [open, setOpen] = useState(opened);\n  const { enqueueSnackbar } = useSnackbar();\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  const [now, _setNow] = useState<number>(Math.floor(new Date().getTime() / 1000));\n\n  if (!near) return null;\n\n  if (row instanceof Error) {\n    return (\n      <TableRow>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <div className=\"row-error\">\n            {'row '}\n            {pageIndex}\n            {': '}\n            {row.message}\n          </div>\n        </TableCell>\n      </TableRow>\n    );\n  }\n\n  const vestingSchedule = row?.vesting_schedule?.Schedule;\n\n  const currentContractName = location.pathname.split('/')[1];\n\n  const selectedDraftId = location.pathname.split('/').pop() === row.id.toString();\n  const draftPage = location.pathname.split('/').includes('drafts');\n  const importDraftPage = location.pathname.split('/').includes('import_draft_group');\n\n  const balancesRaw = calcBalancesRaw(row, now);\n\n  return (\n    <>\n      <TableRow className={open ? `expanded exp-row ${(opened ? 'opened' : '')}` : 'exp-row'}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {selectedDraftId && draftPage || importDraftPage\n            ? row.id\n            : (\n              <Link\n                to={adminControls\n                  ? `/${currentContractName}/admin/drafts/${row.id}`\n                  : `/${currentContractName}/drafts/${row.id}`}\n              >\n                {row.id}\n              </Link>\n            )}\n          {!importDraftPage && (\n          <CopyToClipboard\n            text={`${window.location.origin}/#/${currentContractName}/drafts/${row.id}`}\n            onCopy={() => enqueueCustomSnackbar(enqueueSnackbar, null, success.header('Copied'), { autoHideDuration: 1000 })}\n          >\n            <IconButton aria-label=\"copy link\">\n              <LinkIcon />\n            </IconButton>\n          </CopyToClipboard>\n          )}\n        </TableCell>\n        <TableCell align=\"left\">\n          {toCompactString(row.account_id)}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[0].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[row.schedule.length - 1].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TokenAmountDisplay amount={balancesRaw.total} token={token} />\n        </TableCell>\n        {progressShow && (\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span className=\"nowrap\">\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.claimed, token.decimals)}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.unclaimed, token.decimals)}</b>\n                  {' '}\n                  Available\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.vested, token.decimals)}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{formatTokenAmount(balancesRaw.unvested, token.decimals)}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n)}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar-outer\">\n              <div className=\"progress-bar\">\n                <div style={{ width: `${(parseFloat(balancesRaw.claimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"claimed\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.unclaimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"available\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.vested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"vested\">\n                &nbsp;\n                </div>\n                <div style={{ width: `${(parseFloat(balancesRaw.unvested) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"unvested\">\n                &nbsp;\n                </div>\n              </div>\n            </div>\n          </Tooltip>\n        </TableCell>\n        )}\n      </TableRow>\n      <TableRow className={opened ? 'expanded opened' : 'expanded'}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n              {vestingSchedule && (\n                <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n              )}\n              <div className=\"lockup-row-column chart\">\n                <div style={{ height: 300 }}>\n                  <Chart data={chartData([row], token.decimals)} />\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { TMetadata } from '../../services/tokenApi';\nimport DraftsTableRow from './row';\n\nexport default function DraftsTable({\n  lockups, token, adminControls, progressShow,\n}: { lockups: any[], token: TMetadata, adminControls: boolean, progressShow: boolean }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        {lockups.length > 0 && (\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\"><span className=\"nowrap\">ID</span></TableCell>\n          <TableCell align=\"left\"><span className=\"nowrap\">Account ID</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Start date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">End date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Total amount</span></TableCell>\n          {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n        </TableRow>\n        )}\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup, i) => (\n          <DraftsTableRow key={lockup.id} pageIndex={i + 1} row={lockup} token={token} adminControls={adminControls} progressShow={progressShow} opened={false} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import BN from 'bn.js';\nimport Big from 'big.js';\nimport { assertValidTerminationSchedule } from './scheduleHelpers';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nconst prefixErrorWith = (prefix: string, callback: () => any) => {\n  try {\n    return callback();\n  } catch (e) {\n    if (!(e instanceof Error)) throw new Error('unreachable');\n    e.message = `${prefix}: ${e.message}`;\n    throw e;\n  }\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+(\\.[0-9]+)?$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nconst parsePercentage = (input: string): number => {\n  if (!(input.match(/^\\d+$/))) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  const percentage = parseInt(input, 10);\n\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n\n  return percentage;\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = prefixErrorWith('percentage', () => parsePercentage(percentageRaw));\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = prefixErrorWith('start timestamp', () => parseTimestamp(timestampStartRaw));\n  const durationTotal = prefixErrorWith('duration', () => parseDuration(durationTotalRaw));\n  const cliffInfo = prefixErrorWith('cliff', () => parseCliffInfo(cliffInfoRaw));\n  const releaseEvery = prefixErrorWith('release every', () => parseDuration(releaseEveryRaw));\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = any;\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const allowedKeys = ['account_id', 'amount', 'lockup_schedule', 'vesting_schedule'];\n  Object.keys(input).forEach((key) => {\n    if (!allowedKeys.includes(key)) {\n      throw new Error(`unknown column '${key}'`);\n    }\n  });\n\n  if (!input.account_id) throw new Error(\"column 'account_id' not found\");\n  const accountId = parseValidAccountId(input.account_id);\n\n  if (!input.amount) throw new Error(\"column 'amount' not found\");\n  const amount = parseTokenAmount(input.amount);\n\n  if (!input.lockup_schedule) throw new Error(\"column 'lockup_schedule' not found\");\n  const lockupSchedule = prefixErrorWith('lockup schedule', () => parseHumanFriendlySchedule(input.lockup_schedule));\n  let vestingSchedule = null;\n\n  if (input.vesting_schedule) {\n    vestingSchedule = prefixErrorWith('vesting schedule', () => parseHumanFriendlySchedule(input.vesting_schedule));\n  }\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = string;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new Big(10).pow(tokenDecimals);\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(new Big(inputTotalAmount).mul(decimalsMultiplier).round(0, Big.roundDown).toString());\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const { releaseEvery } = schedule;\n\n  const tmCliff = timestampCliff;\n  const tmFirstStep = datePlusDurationMul(timestampCliff, releaseEvery, 1);\n  if (toUnix(tmFirstStep) <= toUnix(tmCliff)) {\n    throw new Error('invalid releaseEvery, zero duration');\n  }\n  if (toUnix(tmFirstStep) - toUnix(tmCliff) === 1) { // linear unlock during cliff\n    const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n    const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n    const cpCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount.toString() };\n    const cpFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount.toString() };\n\n    const result = [];\n    result.unshift(cpFinish);\n    if (cpCliff.timestamp < cpFinish.timestamp) {\n      result.unshift(cpCliff);\n    }\n    result.unshift(cpPreCliff);\n    if (cpStart.timestamp < cpPreCliff.timestamp) {\n      result.unshift(cpStart);\n    }\n\n    return result;\n  }\n\n  const tms = [];\n  {\n    // otherwise: use steps\n    let tm = null;\n    const maxSteps = 500;\n    for (let i = 0; i < maxSteps; i += 1) {\n      tm = datePlusDurationMul(timestampCliff, releaseEvery, i);\n      if (tm >= timestampFinish) {\n        tm = timestampFinish;\n        tms.push(tm);\n        break;\n      }\n      tms.push(tm);\n      if (tms.length >= maxSteps) {\n        throw new Error('too many checkpoints for schedule');\n      }\n    }\n  }\n\n  const increment = totalAmount.sub(cliffAmount).divn(tms.length - 1);\n\n  const cps: Checkpoint[] = tms.flatMap((tm, i) => {\n    if (tms.length === 1) {\n      return [{ timestamp: toUnix(timestampFinish), balance: totalAmount.toString() }];\n    }\n    if (i === 0) {\n      return [{ timestamp: toUnix(tm), balance: cliffAmount.toString() }];\n    }\n    const stepBalance = i === tms.length - 1\n      ? totalAmount\n      : cliffAmount.add(increment.muln(i)).toString();\n    return [\n      { timestamp: toUnix(tm) - 1, balance: cliffAmount.add(increment.muln(i - 1)).toString() },\n      { timestamp: toUnix(tm), balance: stepBalance.toString() },\n    ];\n  });\n\n  const cpsStart: Checkpoint[] = [];\n  const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n  const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n\n  cpsStart.unshift(cpPreCliff);\n  if (cpStart.timestamp < cpPreCliff.timestamp) {\n    cpsStart.unshift(cpStart);\n  }\n\n  const result = cpsStart.concat(cps);\n  return result;\n};\n\nexport type Lockup = {\n  id: number,\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  vesting_schedule: { Schedule: Schedule } | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number, index: number): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  const lockupSchedule = toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals);\n  let vestingSchedulePacked = null;\n\n  if (row.vesting_schedule) {\n    const vestingSchedule = toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals);\n    assertValidTerminationSchedule(lockupSchedule, vestingSchedule);\n    vestingSchedulePacked = { Schedule: vestingSchedule };\n  }\n\n  return {\n    id: index,\n    account_id: row.account_id,\n    schedule: lockupSchedule,\n    vesting_schedule: vestingSchedulePacked,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => parseLockup(x, tokenDecimals, index + 1));\n};\n\nexport type TLockupOrError = Lockup | Error;\n\nexport const parseRawSpreadsheetInputWithErrors = (spreadsheetInput: string, tokenDecimals: number): TLockupOrError[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x, index: number) => {\n    try {\n      return parseLockup(x, tokenDecimals, index + 1);\n    } catch (e) {\n      if (e instanceof Error) {\n        return e;\n      }\n      throw new Error('unreachable');\n    }\n  });\n};\n\nexport const lockupTotalBalance = (lockup: Lockup): Balance => lockup.schedule[lockup.schedule.length - 1].balance;\n","import { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\nimport { formatTokenAmount } from '../../utils';\n\nexport default function TokenAmountPreview(params: { token: TMetadata, amount: string }) {\n  const { token, amount } = params;\n\n  return (\n    <div className=\"token-info\" title={amount}>\n      <div className=\"token-amount\">\n        {formatTokenAmount(amount, token.decimals)}\n        {' '}\n        {token.symbol}\n      </div>\n      <TokenIcon url={token.icon || ''} size={32} />\n    </div>\n  );\n}\n","import Button from '@mui/material/Button';\nimport Typography from '@mui/material/Typography';\nimport { MouseEvent } from 'react';\n\nconst body = (transactionLink: string) => {\n  const Body = function Body(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      button: {\n        padding: '0px 4px',\n        textTransform: 'none',\n        fontSize: '12px',\n      },\n    }))();\n\n    const onClick = (event: MouseEvent<HTMLButtonElement>) => {\n      event.preventDefault();\n      window.open(transactionLink, '_blank');\n    };\n\n    return (\n      <Button size=\"small\" className={classes.button} onClick={onClick}>\n        See transaction\n      </Button>\n    );\n  };\n\n  return Body;\n};\n\nconst header = (text: string) => {\n  const Header = function Header(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      typography: {\n        color: 'rgba(255, 89, 78, 1)',\n        fontWeight: 700,\n        fontSize: '16px',\n      },\n    }))();\n\n    return (\n      <Typography variant=\"subtitle2\" className={classes.typography}>\n        {text}\n      </Typography>\n    );\n  };\n\n  return Header;\n};\n\nconst failure = { body, header };\n\nexport default failure;\n","import Big from 'big.js';\n\nimport success from './SuccessPartials';\nimport failure from './FailurePartials';\nimport { enqueueCustomSnackbar } from './Snackbar';\nimport { txLinkInExplorer, nearTo } from '../../utils';\n\nexport const SUCCESS_DEFAULT_OPTIONS = { autoHideDuration: 60_000 };\n\nconst parseAmount = (unpacked: string, decimals: any): any => new Big(unpacked).div(new Big(10).pow(decimals)).round(2, Big.roundDown);\n\nconst claimSnack = (enqueueSnackbar: any, unpacked: any, txHash: string, token: any) => {\n  if (unpacked && unpacked !== '0') {\n    const amount = parseAmount(unpacked, token.decimals);\n\n    return enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(`Claimed ${amount} ${token.symbol}`),\n      success.header('Success'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  return enqueueCustomSnackbar(\n    enqueueSnackbar,\n    failure.body(`${txLinkInExplorer(txHash)}`),\n    failure.header('Claim failed'),\n  );\n};\n\nconst storageDepositSnack = (enqueueSnackbar: any, unpacked: any, txHash: string, token: any, accountId: any) => {\n  if (unpacked) {\n    const amount = parseFloat(nearTo(unpacked.total, 9)).toString();\n\n    return enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(`Successfully paid ${amount}NEAR for ${accountId}'s storage of ${token.symbol}`),\n      success.header('Success'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  return enqueueCustomSnackbar(\n    enqueueSnackbar,\n    failure.body(`${txLinkInExplorer(txHash)}`),\n    failure.header('Payment for deposit storage failed'),\n  );\n};\n\nconst createLockupSnack = (enqueueSnackbar: any, unpacked: any, txHash: string, token: any, txMsg: any) => {\n  if (unpacked) {\n    const totalBalance = txMsg.schedule[txMsg.schedule.length - 1].balance;\n\n    if (totalBalance === unpacked) {\n      const amount = parseAmount(unpacked, token.decimals);\n\n      return enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`${txMsg.account_id} now has a lockup of ${amount} ${token.symbol}`),\n        success.header('Lockup created'),\n        SUCCESS_DEFAULT_OPTIONS,\n      );\n    }\n  }\n\n  return enqueueCustomSnackbar(\n    enqueueSnackbar,\n    failure.body(`${txLinkInExplorer(txHash)}`),\n    failure.header('Lockup creation failed'),\n  );\n};\n\nconst fundDraftGroupSnack = (enqueueSnackbar: any, unpacked: any, txHash: string, token: any, txMsg: any) => {\n  if (unpacked && unpacked !== '0') {\n    const amount = parseAmount(unpacked, token.decimals);\n\n    return enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(`Draft group ${txMsg.draft_group_id} funded with amount ${amount} ${token.symbol}`),\n      success.header('Draft group funded'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  return enqueueCustomSnackbar(\n    enqueueSnackbar,\n    failure.body(`${txLinkInExplorer(txHash)}`),\n    failure.header('Draft group fund failed'),\n  );\n};\n\nconst terminateLockupSnack = (enqueueSnackbar: any, unpacked: any, txHash: string, token: any, lockup_index: any) => {\n  if (unpacked) {\n    const amount = parseAmount(unpacked, token.decimals);\n\n    return enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(`Lockup #${lockup_index} was terminated. Unvested amount: ${amount} ${token.symbol}`),\n      success.header('Lockup terminated'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  return enqueueCustomSnackbar(\n    enqueueSnackbar,\n    failure.body(`${txLinkInExplorer(txHash)}`),\n    failure.header('Lockup termination failed'),\n  );\n};\n\nconst deleteDraftGroupSnack = (enqueueSnackbar: any, message: { positive?: string, negative?: string }) => {\n  if (message.positive) {\n    enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(message.positive),\n      success.header('Success'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  if (message.negative) {\n    enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(message.negative),\n      failure.header('Failure'),\n    );\n  }\n};\n\nconst discardDraftGroupSnack = (enqueueSnackbar: any, message: { positive?: string, negative?: string }) => {\n  if (message.positive) {\n    enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(message.positive),\n      success.header('Success'),\n      SUCCESS_DEFAULT_OPTIONS,\n    );\n  }\n\n  if (message.negative) {\n    enqueueCustomSnackbar(\n      enqueueSnackbar,\n      success.body(message.negative),\n      failure.header('Failure'),\n    );\n  }\n};\n\nexport {\n  claimSnack,\n  storageDepositSnack,\n  createLockupSnack,\n  fundDraftGroupSnack,\n  terminateLockupSnack,\n  deleteDraftGroupSnack,\n  discardDraftGroupSnack,\n};\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { LoadingButton } from '@mui/lab';\nimport useTitle from '../../services/useTitle';\nimport DraftsTable from '../DraftsTable';\nimport {\n  parseRawSpreadsheetInputWithErrors, TLockupOrError, Lockup, lockupTotalBalance,\n} from '../../services/spreadsheetImport';\nimport TokenAmountPreview from '../TokenAmountPreview';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nimport success from '../Snackbars/SuccessPartials';\nimport failure from '../Snackbars/FailurePartials';\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\n\nimport { SUCCESS_DEFAULT_OPTIONS } from '../Snackbars';\n\nfunction ImportDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  useTitle('Import draft group | FT Lockup', { restoreOnUnmount: true });\n\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<TLockupOrError[]>([]);\n  const [parseErrors, setParseErrors] = useState<Error[]>([]);\n  const [importProgress, setImportProgress] = useState<boolean>(false);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      if (!near?.currentUser?.signedAccountId) {\n        throw new Error('expected present signedAccountId');\n      }\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInputWithErrors(input, token.decimals);\n      const errorsFiltered = lockups.filter((x) => x instanceof Error).map((x) => x as Error);\n      setData(lockups);\n      setParseErrors(errorsFiltered);\n    } catch (e) {\n      if (e instanceof Error) {\n        setData([]);\n        setParseErrors([e]);\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      if (!(e instanceof Error)) {\n        throw new Error('unreachable');\n      }\n\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`${name} failed: ${e.message}`),\n        failure.header('Drafts creation failed'),\n      );\n      throw e;\n    }\n  };\n\n  const handleClickImport = async () => {\n    try {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      setImportProgress(true);\n\n      await withNotification(\n        'Check accounts',\n        async () => {\n          const accountIds = Array.from(new Set(\n            data.filter((x) => !(x instanceof Error)).map((x) => (x as Lockup).account_id),\n          ));\n\n          for (let i = 0; i < accountIds.length; i += 1) {\n            const accountId = accountIds[i];\n            if (!accountId.match(/^[0-9a-f]{64}$/)) {\n              try {\n                const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n                console.log(`${accountId} balance: ${total}`);\n              } catch (e) {\n                const message = `Account ID ${accountId} does not exist`;\n                throw new Error(message);\n              }\n            }\n          }\n\n          console.log('all accounts exist');\n          enqueueCustomSnackbar(\n            enqueueSnackbar,\n            success.body('Checked account existence: all accounts exist'),\n            success.header('Success'),\n            SUCCESS_DEFAULT_OPTIONS,\n          );\n        },\n      );\n\n      const draftGroupId = await withNotification(\n        'Create draft group',\n        async () => {\n          const result = await near.api.createDraftGroup();\n          return result;\n        },\n      );\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`Created draft group id: ${draftGroupId}`),\n        success.header('Draft group created'),\n        SUCCESS_DEFAULT_OPTIONS,\n      );\n\n      const chunkSize = 20;\n      for (let i = 0; i < data.length; i += chunkSize) {\n        const chunk = data.slice(i, i + chunkSize);\n        const drafts = chunk.map((lockup) => ({\n          draft_group_id: draftGroupId,\n          lockup_create: lockup,\n        }));\n        await withNotification(\n          'Create drafts',\n          async () => {\n            const result = await near.api.createDrafts(drafts);\n            return result;\n          },\n        );\n      }\n\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`Created ${data.length} draft${data.length > 1 ? 's' : ''}.`),\n        success.header('Success'),\n        SUCCESS_DEFAULT_OPTIONS,\n      );\n\n      const currentContractName = location.pathname.split('/')[1];\n      const path = `/${currentContractName}/admin/draft_groups/${draftGroupId}`;\n\n      navigate(path);\n    } catch (e) {\n      setImportProgress(false);\n    }\n  };\n\n  const calcTotalBalance = (lockups: TLockupOrError[]) => {\n    const lockupsFiltered = lockups.filter((x: TLockupOrError) => !(x instanceof Error)).map((x) => x as Lockup);\n    const balances = lockupsFiltered.map((x: Lockup) => lockupTotalBalance(x));\n    let result = new Big('0');\n\n    balances.forEach((x) => {\n      result = result.add(new Big(x));\n    });\n    return result.toString();\n  };\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h1>\n          Import Draft Group\n        </h1>\n\n        <div className=\"import-draft-group-wrapper\">\n          <div className=\"draft-group-preview-inner\">\n            <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n              <h5>\n                <span className=\"new-draft-count-text\">\n                  {`New draft group with ${data.length} lockup${data.length !== 1 ? 's' : ''}`}\n                </span>\n                {' '}\n                {parseErrors.length > 0 && (<span className=\"parse-error-label\">{`${parseErrors.length} parse error${parseErrors.length > 1 ? 's' : ''}`}</span>)}\n              </h5>\n              <TokenAmountPreview amount={calcTotalBalance(data)} token={token} />\n            </div>\n          </div>\n\n          <p className=\"standard-text-style\">\n            Copy lockups from a spreadsheet editor and paste into the area below.\n            See\n            {' '}\n            <a href={`${process.env.PUBLIC_URL}/lockup_import_example.xlsx`}>\n              example and format specifications\n            </a>\n            .\n          </p>\n          <TextareaAutosize\n            className=\"import-draft-group-textarea\"\n            id=\"spreadsheet-input\"\n            placeholder=\"Excel input\"\n            minRows={3}\n            maxRows={5}\n            onChange={handleChangeInput}\n          />\n        </div>\n        <DraftsTable lockups={data} token={token} adminControls={adminControls} progressShow />\n        <LoadingButton\n          disabled={!(data.length >= 1 && parseErrors.length === 0 && !importProgress)}\n          onClick={handleClickImport}\n          loading={importProgress}\n          type=\"button\"\n          className=\"button\"\n        >\n          Import\n        </LoadingButton>\n      </div>\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction FundButton(props: { draftGroupIndex: number, amount: string }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleFund = () => {\n    near.tokenApi.fundDraftGroup(\n      near.api.getContract().contractId,\n      draftGroupIndex,\n      amount,\n    );\n  };\n\n  return (\n    <button className=\"button\" type=\"button\" onClick={handleFund}>Fund</button>\n  );\n}\n\nexport default FundButton;\n","import { useContext } from 'react';\n\nimport Select from '@mui/material/Select';\n\nimport {\n  TextField,\n  InputLabel,\n  MenuItem,\n} from '@mui/material';\n\nimport { INearProps, NearContext } from '../../../services/near';\n\ntype TProps = {\n  selectedAddress: string,\n  setSelectedAddress: Function,\n};\n\nfunction DaoSelector({ selectedAddress, setSelectedAddress }: TProps): any {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const { daos } = near.currentUser;\n\n  if (daos.length > 0 && (selectedAddress === '' || !daos.includes(selectedAddress))) {\n    setSelectedAddress(daos[0]);\n  }\n\n  const handleSelectedDaoAddressChange = (event: any) => {\n    setSelectedAddress(event.target.value as string);\n  };\n\n  if (daos.length > 0) {\n    return (\n      <div>\n        <InputLabel>Select DAO contract address</InputLabel>\n        <Select\n          required\n          sx={{ marginBottom: 3, width: 1 }}\n          value={selectedAddress}\n          onChange={handleSelectedDaoAddressChange}\n        >\n          {daos.map((dao) => <MenuItem value={dao}>{dao}</MenuItem>)}\n        </Select>\n      </div>\n    );\n  }\n\n  return (\n    <TextField\n      required\n      variant=\"outlined\"\n      size=\"small\"\n      sx={{ margin: '24px 0', width: '100%' }}\n      id=\"outlined-helperText\"\n      label=\"DAO contract address\"\n      onChange={handleSelectedDaoAddressChange}\n    />\n  );\n}\n\nexport default DaoSelector;\n","import {\n  TextField,\n} from '@mui/material';\n\ntype TProps = {\n  proposalDescription: string,\n  setProposalDescription: Function,\n};\n\nfunction DaoProposalDescription({ proposalDescription, setProposalDescription }: TProps): any {\n  const handleDescriptionChange = (e: any) => {\n    setProposalDescription(e.target.value as string);\n  };\n\n  return (\n    <TextField\n      sx={{ width: 1 }}\n      id=\"outlined-multiline-static\"\n      label=\"Proposal description\"\n      multiline\n      minRows={5}\n      onChange={handleDescriptionChange}\n      defaultValue={proposalDescription}\n    />\n  );\n}\n\nexport default DaoProposalDescription;\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { TMetadata } from '../../services/tokenApi';\n\nimport { formatTokenAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { buildFundDraftGroupProposalLink } from '../../services/DAOs/astroDAO/utils';\n\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\n\nfunction FundWithDaoButton(props: { draftGroupIndex: number, amount: string, token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount, token } = props;\n\n  const formattedAmount = formatTokenAmount(amount, token.decimals);\n\n  const defaultDescription = `Fund draft group ${draftGroupIndex} with amount ${formattedAmount}. Draft group link: ${window.location.href.replace(/\\/admin/, '')}`;\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState('');\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleFund = () => {\n    const link = buildFundDraftGroupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      near.tokenApi.getContract().contractId,\n      amount,\n      draftGroupIndex,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Fund with DAO</button>\n      <Dialog open={open} sx={{ padding: 1, minWidth: 1 }} onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleFund}>\n          <DialogTitle>\n            Fund with DAO\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent style={{ minWidth: '320px', paddingTop: '1.25em' }}>\n            <DaoSelector selectedAddress={astroDAOContractAddress} setSelectedAddress={setAstroDAOContractAddress} />\n            <DaoProposalDescription proposalDescription={description} setProposalDescription={setDescription} />\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Fund</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n\nexport default FundWithDaoButton;\n","import { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\n\nimport { LoadingButton } from '@mui/lab';\nimport { INearProps, NearContext } from '../../services/near';\nimport { discardDraftGroupSnack, deleteDraftGroupSnack } from '../Snackbars';\n\nimport success from '../Snackbars/SuccessPartials';\nimport failure from '../Snackbars/FailurePartials';\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\n\nfunction DeleteDraftGroupButton(props: { draftGroupId: number, draftIds: [number], disabled: boolean }) {\n  const { draftGroupId, draftIds, disabled } = props;\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { enqueueSnackbar } = useSnackbar();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [inProgress, setInProgress] = useState<boolean>(false);\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`${name} failed with error: '${e}'`),\n        failure.header('Error'),\n      );\n      throw e;\n    }\n  };\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const handleDelete = () => {\n    const perform = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n\n      setInProgress(true);\n\n      type TNotificationMessage = {\n        positive?: string,\n        negative?: string\n      };\n\n      const discardNotificationMessage: TNotificationMessage = {};\n\n      // discard draft group\n      try {\n        await near.api.discardDraftGroup(draftGroupId);\n        discardNotificationMessage.positive = `Discarded draft group ${draftGroupId}`;\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          if (!message.includes('cannot discard, draft group already discarded')) {\n            discardNotificationMessage.negative = `Failed to discard draft group ${draftGroupId}: ${message}`;\n            setInProgress(false);\n            return;\n          }\n        } else {\n          throw new Error('unreachable');\n        }\n      } finally {\n        discardDraftGroupSnack(enqueueSnackbar, discardNotificationMessage);\n      }\n\n      const deleteNotificationMessage: TNotificationMessage = {};\n\n      // delete all drafts\n      try {\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Delete drafts',\n            async () => {\n              const result = await near.api.deleteDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        deleteNotificationMessage.positive = `Deleted draft group ${draftGroupId}`;\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/draft_groups`);\n        window.location.reload();\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(`ERROR: ${e}`);\n          const { message } = e;\n          deleteNotificationMessage.negative = `Failed to discard draft group ${draftGroupId}: ${message}`;\n          setInProgress(false);\n        } else {\n          throw new Error('unreachable');\n        }\n      } finally {\n        deleteDraftGroupSnack(enqueueSnackbar, deleteNotificationMessage);\n      }\n    };\n\n    perform();\n  };\n\n  return (\n    <LoadingButton\n      className=\"button compact red\"\n      type=\"button\"\n      variant=\"contained\"\n      onClick={handleDelete}\n      loading={inProgress}\n      disabled={disabled || inProgress}\n    >\n      Delete\n    </LoadingButton>\n  );\n}\n\nexport default DeleteDraftGroupButton;\n","import { useState, useEffect, useContext } from 'react';\nimport { Alert } from '@mui/material';\nimport {\n  useNavigate, useParams, useLocation, Link,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport { LoadingButton } from '@mui/lab';\n\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport TokenAmountPreview from '../../components/TokenAmountPreview';\nimport FundButton from '../../components/FundButton';\nimport FundWithDaoButton from '../../components/FundWithDaoButton';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\n\nimport success from '../../components/Snackbars/SuccessPartials';\nimport failure from '../../components/Snackbars/FailurePartials';\nimport { enqueueCustomSnackbar } from '../../components/Snackbars/Snackbar';\nimport { SUCCESS_DEFAULT_OPTIONS } from '../../components/Snackbars';\nimport useTitle from '../../services/useTitle';\n\nexport default function PageDraftGroup({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  const location = useLocation();\n  const { enqueueSnackbar } = useSnackbar();\n  const draftGroupId: number = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n  const [isConverted, setIsConverted] = useState<string>('pending');\n\n  useTitle(`Draft Group ${draftGroupId} | FT Lockup`, { restoreOnUnmount: true });\n\n  useEffect(() => {\n    const perform = async () => {\n      setIsConverted('pending');\n      console.log(`fetchIsConverted: ${draftGroupId} ${'pending'}`);\n\n      if (!near) return;\n\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n      const msg = args.msg && JSON.parse(args.msg);\n      const msgDraftGroupId = msg && msg.draft_group_id;\n\n      console.log(methodName, successValue, args, msg, msgDraftGroupId);\n\n      const result = methodName === 'ft_transfer_call' && msgDraftGroupId !== undefined && msgDraftGroupId === draftGroupId;\n\n      if (result) {\n        setIsConverted('converted');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'converted'}`);\n      } else {\n        setIsConverted('unknown');\n        console.log(`fetchIsConverted: ${draftGroupId} ${'unknown'}`);\n      }\n    };\n    perform();\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n\n      console.log(`fetchDraftGroup called: ${draftGroupId} ${isConverted}`);\n      if (!near) return;\n      console.log(isConverted);\n      if (isConverted === 'pending') {\n        return;\n      }\n\n      const result = await near.api.getDraftGroup(draftGroupId);\n      setDraftGroup(result || 'not_found');\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId, isConverted]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup || draftGroup === 'not_found') {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  const navigate = useNavigate();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`${name} failed with error: '${e}'`),\n        failure.header('Error'),\n      );\n      throw e;\n    }\n  };\n\n  const handleConvert = () => {\n    const convertDrafts = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      try {\n        setInProgress(true);\n        const draftIds = draftGroup.draft_indices;\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Convert drafts',\n            async () => {\n              const result = await near.api.convertDrafts(chunk);\n              return result;\n            },\n          );\n        }\n\n        enqueueCustomSnackbar(\n          enqueueSnackbar,\n          success.body(`Converted drafts for draft group ${draftGroupId}`),\n          success.header('Success'),\n          SUCCESS_DEFAULT_OPTIONS,\n        );\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/lockups`);\n        window.location.reload();\n      } catch (e) {\n        console.log(`ERROR: ${e}`);\n      } finally {\n        setInProgress(false);\n      }\n    };\n\n    convertDrafts();\n  };\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  if (draftGroup === 'not_found') {\n    const currentContractName = location.pathname.split('/')[1];\n    return (\n      <div className=\"container\">\n        <h1>{isConverted === 'converted' ? `Success! Draft group ${draftGroupId} have been converted!` : `Draft group ${draftGroupId} have been converted or deleted.`}</h1>\n        <div>\n          <br />\n          Check\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups`}>lockups</Link>\n          {' '}\n          to find converted lockups or\n          {' '}\n          <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/draft_groups`}>draft groups</Link>\n          {' '}\n          to see all existing draft groups.\n        </div>\n      </div>\n    );\n  }\n\n  if (!near) return null;\n  const { isAdmin } = near.currentUser;\n\n  return (\n    <div className=\"container\">\n      <h1>\n        Draft Group\n        {' '}\n        {draftGroupId}\n      </h1>\n      <div className=\"draft-group-preview-wrapper draft-group-preview-inner\">\n        <div className=\"draft-group-preview-info\" style={{ display: 'flex' }}>\n          <h5>\n            {`Draft group ${draftGroupId}`}\n            {' '}\n            {draftGroup.discarded && (<span className=\"discarded-marker\">DISCARDED</span>)}\n          </h5>\n          <TokenAmountPreview token={token} amount={draftGroup.total_amount} />\n        </div>\n        {!draftGroup.funded && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            {!draftGroup.discarded && isAdmin && <FundButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} /> }\n            {!draftGroup.discarded && <FundWithDaoButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} token={token} />}\n            <DeleteDraftGroupButton\n              draftGroupId={draftGroup.id}\n              draftIds={draftGroup.draft_indices}\n              disabled={draftGroup.funded}\n            />\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length > 0 && adminControls && (\n          <div className=\"draft-group-fund-button-wrapper\">\n            <LoadingButton\n              className=\"button\"\n              type=\"button\"\n              onClick={handleConvert}\n              loading={inProgress}\n              variant=\"contained\"\n              color=\"success\"\n            >\n              Convert\n            </LoadingButton>\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length === 0 && (\n          <div style={{ marginTop: 20 }}>\n            <Alert severity=\"success\">Draft Group converted</Alert>\n          </div>\n        )}\n      </div>\n\n      {(!draftGroup.funded || draftGroup.draft_indices.length > 0) && (\n        <DraftsTable lockups={drafts} token={token} adminControls={adminControls} progressShow />\n      )}\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport {\n  Button, IconButton, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\n} from '@mui/material';\nimport { LoadingButton } from '@mui/lab';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { useSnackbar } from 'notistack';\n\nimport { INearProps, NearContext } from '../../services/near';\n\nimport success from '../Snackbars/SuccessPartials';\nimport failure from '../Snackbars/FailurePartials';\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\nimport { SUCCESS_DEFAULT_OPTIONS } from '../Snackbars';\n\nexport default function SuggestConvertDialog(params: { open: boolean, setOpen: any, draftGroup: any | null }) {\n  const { open, setOpen, draftGroup } = params;\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n  const { enqueueSnackbar } = useSnackbar();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  console.log(draftGroup);\n  console.log(inProgress, setInProgress);\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`${name} failed with error: '${e}'`),\n        failure.header('Error'),\n      );\n      throw e;\n    }\n  };\n\n  const performConvert = async () => {\n    if (!(near?.api)) {\n      return;\n    }\n    try {\n      setInProgress(true);\n      const draftIds = draftGroup.draft_indices;\n      const chunkSize = 100;\n      for (let i = 0; i < draftIds.length; i += chunkSize) {\n        const chunk = draftIds.slice(i, i + chunkSize);\n\n        await withNotification(\n          'Convert drafts',\n          async () => {\n            const result = await near.api.convertDrafts(chunk);\n            return result;\n          },\n        );\n      }\n      enqueueCustomSnackbar(\n        enqueueSnackbar,\n        success.body(`Converted drafts for draft group ${draftGroup.id}`),\n        success.header('Success'),\n        SUCCESS_DEFAULT_OPTIONS,\n      );\n      const currentContractName = location.pathname.split('/')[1];\n      navigate(`/${currentContractName}/admin/lockups`);\n      window.location.reload();\n    } catch (e) {\n      console.log(`ERROR: ${e}`);\n    } finally {\n      setInProgress(false);\n    }\n  };\n\n  console.log(performConvert);\n\n  const convertAndClose = () => {\n    const perform = async () => {\n      await performConvert();\n      setOpen(false);\n    };\n\n    perform();\n  };\n\n  // const handleClickOpen = () => {\n  //   setOpen(true);\n  // };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  // const buttonPart = () => (\n  //   <Button variant=\"outlined\" onClick={handleClickOpen}>\n  //     Open alert dialog\n  //   </Button>\n  // );\n\n  if (!near) {\n    return null;\n  }\n\n  const dialogPart = () => (\n    <Dialog\n      open={near.currentUser.signedIn && open && draftGroup}\n      onClose={handleClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">\n        Convert draft group?\n        <IconButton\n          aria-label=\"close\"\n          onClick={handleClose}\n          sx={{\n            position: 'absolute',\n            right: 8,\n            top: 8,\n          }}\n        >\n          <CloseRoundedIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          Draft group\n          {' '}\n          {draftGroup.id}\n          {' '}\n          has been funded, but not converted yet.\n          In order to use the lockups from this group, it&apos;s necessary to convert them.\n          Convert the draft group now?\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"error\">Cancel</Button>\n        <LoadingButton\n          className=\"button\"\n          type=\"button\"\n          onClick={convertAndClose}\n          loading={inProgress}\n          variant=\"contained\"\n          color=\"success\"\n        >\n          Convert\n        </LoadingButton>\n      </DialogActions>\n    </Dialog>\n  );\n\n  return (\n    <div>\n      {draftGroup && dialogPart() || null}\n    </div>\n  );\n}\n","import { createContext } from 'react';\n\nexport type TSuggestContext = {\n  open: boolean,\n  setOpen: (newValue: boolean) => any,\n};\n\nexport const SuggestContext = createContext<TSuggestContext>({\n  open: false,\n  setOpen: () => null,\n});\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport useTitle from '../../services/useTitle';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { formatTokenAmount } from '../../utils';\nimport TokenIcon from '../../components/TokenIcon';\nimport DeleteDraftGroupButton from '../../components/DeleteDraftGroupButton';\nimport SuggestconvertDialog from '../../components/SuggestConvertDialog';\nimport { SuggestContext } from '../../services/SuggestContext';\n\nexport default function PageDraftGroupsIndex({ token, adminControls }: { token: TMetadata, adminControls: boolean }) {\n  useTitle('Draft Groups | FT Lockup', { restoreOnUnmount: true });\n\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  const currentContractName = location.pathname.split('/')[1];\n  const importDraftGroupPath = `/${currentContractName}/admin/import_draft_group`;\n\n  const candidateForConvert = draftGroups.sort((x, y) => x.id - y.id).reverse().find((x) => x.funded);\n\n  const suggestContext = useContext(SuggestContext);\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h1>\n          All draft groups\n        </h1>\n\n        <SuggestconvertDialog\n          open={adminControls && suggestContext.open}\n          setOpen={suggestContext.setOpen}\n          draftGroup={candidateForConvert}\n        />\n\n        {draftGroups.length === 0 && (\n          <div>\n            There are no draft groups yet.\n          </div>\n        )}\n\n        {draftGroups.length !== 0 && (\n          <Table className=\"main-table\" aria-label=\"collapsible table\">\n            <TableHead className=\"table-head\">\n              <TableRow>\n                <TableCell align=\"center\">ID</TableCell>\n                <TableCell align=\"center\">Funded</TableCell>\n                <TableCell align=\"center\">Number&nbsp;of&nbsp;lockups</TableCell>\n                <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n                {adminControls && <TableCell align=\"right\" width=\"0%\">Delete</TableCell>}\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {draftGroups.map((group) => (\n                <TableRow key={group.id}>\n                  <TableCell align=\"center\">\n                    <Link to={`/${currentContractName}/${adminControls ? 'admin/' : ''}draft_groups/${group.id}`}>{group.id}</Link>\n                  </TableCell>\n                  <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n                  <TableCell align=\"center\">{group.draft_indices.length}</TableCell>\n                  <TableCell align=\"right\">\n                    {formatTokenAmount(group.total_amount, token.decimals)}\n                  &nbsp;\n                    {token.symbol}\n                  &nbsp;\n                    <TokenIcon url={token.icon || ''} size={32} />\n                  </TableCell>\n                  {adminControls && (\n                    <TableCell align=\"right\">\n                      {!group.funded && (\n                      <DeleteDraftGroupButton\n                        draftGroupId={group.id}\n                        draftIds={group.draft_indices}\n                        disabled={group.funded}\n                      />\n                      )}\n                    </TableCell>\n                  )}\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        )}\n\n        {adminControls && (\n        <Link to={importDraftGroupPath}>\n          <button className=\"button\" type=\"button\">Import Draft Group</button>\n        </Link>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { IconButton } from '@mui/material';\nimport {\n  ChangeEvent, useState,\n} from 'react';\nimport AddIcon from '@mui/icons-material/Add';\nimport DeleteIcon from '@mui/icons-material/Delete';\n\nexport type TInputField = {\n  accountName: string\n};\n\nexport default function AddRemoveInput(props: { data: any, onChange: any, accountIdCheck: any, accountStatuses: any }) {\n  const {\n    data, onChange, accountIdCheck, accountStatuses,\n  } = props;\n\n  const initState = [{\n    accountName: '',\n  }];\n\n  const defaultState = () => {\n    if (data.length > 0) {\n      return data.map((x: string) => ({ accountName: x }));\n    }\n    return initState;\n  };\n\n  const [inputFields, setInputFields] = useState<TInputField[]>(defaultState);\n\n  const PENDING = 'pending';\n  const NOT_FOUND = 'not_found';\n\n  const addInputField = () => {\n    const rows = [...inputFields, {\n      accountName: '',\n    }];\n    setInputFields(rows);\n    onChange(rows);\n  };\n\n  const removeInputFields = (index: number) => {\n    const rows = [...inputFields];\n    rows.splice(index, 1);\n    setInputFields(rows);\n    onChange(rows);\n  };\n\n  const handleChange = (index: number, event: ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = event.target;\n    const list:any = [...inputFields];\n    list[index][name] = value;\n    setInputFields(list);\n    accountIdCheck(value);\n    onChange(list);\n  };\n\n  return (\n    <div className=\"add-remove-input\">\n      {\n        inputFields.map((inputField: TInputField, index: number) => {\n          const { accountName } = inputField;\n          const number = index;\n          return (\n            <div className=\"form-group\" key={number}>\n              <input type=\"text\" onChange={(e) => handleChange(index, e)} value={accountName} name=\"accountName\" className=\"form-control\" />\n              {(number === 0)\n                ? (\n                  <IconButton aria-label=\"add new item\" onClick={addInputField}>\n                    <AddIcon />\n                  </IconButton>\n                )\n                : (\n                  <IconButton aria-label=\"remove item\" onClick={() => removeInputFields(number)}>\n                    <DeleteIcon />\n                  </IconButton>\n                )}\n              <div className=\"form-row_error\">\n                {accountName && accountStatuses[accountName] === NOT_FOUND && <span className=\"red\">Account does not exist</span>}\n                {accountStatuses[accountName] === PENDING && <span className=\"gray\">Checking...</span>}\n              </div>\n            </div>\n          );\n        })\n      }\n\n    </div>\n  );\n}\n","import {\n  ChangeEvent, useCallback, useContext, useEffect, useState,\n} from 'react';\nimport { Link } from 'react-router-dom';\nimport { Box } from '@mui/material';\nimport { useSnackbar } from 'notistack';\n\nimport useTitle from '../../services/useTitle';\nimport { FACTORY_CONTRACT_NAME } from '../../config';\nimport { INearProps, NearContext } from '../../services/near';\nimport AddRemoveInput, { TInputField } from '../../components/AddRemoveInput';\nimport useLocalStorage from '../../hooks/useLocalStorage';\n\nimport { enqueueCustomSnackbar } from '../../components/Snackbars/Snackbar';\nimport success from '../../components/Snackbars/SuccessPartials';\nimport failure from '../../components/Snackbars/FailurePartials';\n\nexport default function NewLockupContract() {\n  useTitle('Create Lockup Contract | FT Lockup', { restoreOnUnmount: true });\n\n  const { enqueueSnackbar } = useSnackbar();\n  const { near, signIn, reSignIn }: { near: INearProps | null, signIn: () => void, reSignIn: () => void } = useContext(NearContext);\n\n  const [shouldClearState, setShouldClearState] = useLocalStorage('new_lockup_contract:shouldClearState', false);\n\n  const [tokenAccountId, setTokenAccountId] = useLocalStorage('new_lockup_contract:tokenAccountId', '');\n  const [name, setName] = useLocalStorage('new_lockup_contract:name', '');\n\n  const [lockupOperators, setLockupOperators] = useLocalStorage('new_lockup_contract:lockupOperators', []);\n  const [draftOperators, setDraftOperators] = useLocalStorage('new_lockup_contract:draftOperators', []);\n\n  const PENDING = 'pending';\n  const FOUND = 'found';\n  const NOT_FOUND = 'not_found';\n\n  const subAccountPattern = /^[a-z0-9_-]*$/;\n\n  const nameWithFactoryContractName = `${name}.${FACTORY_CONTRACT_NAME}`;\n\n  const [accountStatuses, setAccountStatuses] = useState<any>({ '': NOT_FOUND }); // pending success error\n\n  const enqueueAccountIdCheck = useCallback(async (accountId: string) => {\n    if (!near) return;\n    console.log('accountStatuses', accountStatuses);\n\n    if (accountStatuses[accountId]) {\n      // lookup finished or in progress\n      return;\n    }\n\n    if (accountId.match(/^[0-9a-f]{64}$/)) {\n      setAccountStatuses((acc: any) => {\n        console.log('.');\n        return { ...acc, [accountId]: FOUND };\n      });\n      return;\n    }\n\n    setAccountStatuses((acc: any) => {\n      console.log('... pending');\n      return { ...acc, [accountId]: PENDING };\n    });\n\n    try {\n      const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n      console.log(total);\n      setAccountStatuses((acc: any) => {\n        console.log('...found');\n        return { ...acc, [accountId]: FOUND };\n      });\n    } catch (e) {\n      console.log(e);\n      setAccountStatuses((acc: any) => {\n        console.log('...not found');\n        return { ...acc, [accountId]: NOT_FOUND };\n      });\n    }\n\n    console.log('accountStatuses', accountStatuses);\n  }, [accountStatuses, setAccountStatuses, near]);\n\n  const validateAccountExists = async (accountId: string) => {\n    if (!near) throw new Error('unreachable');\n    if (accountId.match(/^[0-9a-f]{64}$/)) {\n      return;\n    }\n    try {\n      const { total } = (await (await near.near.account(accountId)).getAccountBalance());\n      console.log(`${accountId} balance: ${total}`);\n    } catch (e) {\n      const message = `Account ID \"${accountId}\" does not exist`;\n      throw new Error(message);\n    }\n  };\n\n  const handleChangeTokenAccountId = (event: ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setTokenAccountId(value);\n    enqueueAccountIdCheck(value);\n  };\n\n  const handleChangeName = (event: ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    setName(value);\n    enqueueAccountIdCheck(`${value}.${FACTORY_CONTRACT_NAME}`);\n  };\n\n  const handleChangeLockupOperators = (inputFields: TInputField[]) => {\n    const array = inputFields.filter((x) => x.accountName.length > 0).map((x) => x.accountName);\n    setLockupOperators(array);\n  };\n\n  const handleChangeDraftOperators = (inputFields: TInputField[]) => {\n    const array = inputFields.filter((x) => x.accountName.length > 0).map((x) => x.accountName);\n    setDraftOperators(array);\n  };\n\n  const handleDeployLockupContract = (e: any) => {\n    e.preventDefault();\n\n    const perform = async () => {\n      try {\n        if (!near?.currentUser?.signedAccountId) {\n          throw new Error('expected signedAccountId to be present');\n        }\n\n        const allUniqueAccountIds = Array.from(new Set(\n          [...lockupOperators, ...draftOperators, tokenAccountId],\n        ));\n        for (let i = 0; i < allUniqueAccountIds.length; i += 1) {\n          const accountId = allUniqueAccountIds[i];\n          await validateAccountExists(accountId);\n        }\n\n        const lockupSubaccountId: string = e.target.elements.lockup_subaccount_id.value;\n\n        if (lockupOperators.length === 0) {\n          throw new Error('empty lockup operators');\n        }\n\n        if (tokenAccountId.length === 0) {\n          throw new Error('empty tokenAccountId');\n        }\n\n        if (lockupSubaccountId.length === 0) {\n          throw new Error('empty lockupSubaccountId');\n        }\n\n        // const message = `\n        //   lockup_creator: ${lockupCreator}\n        //   lockup_operators: ${JSON.stringify(lockupOperators)}\n        //   token_account_id: ${tokenAccountId}\n        //   lockup_subaccount_id: ${lockupSubaccountId}\n        // `;\n        // alert(message);\n\n        const result = await near.factoryApi.create(\n          lockupSubaccountId,\n          tokenAccountId,\n          lockupOperators,\n          draftOperators,\n          `${window.location.origin + window.location.pathname}#/${lockupSubaccountId}.${FACTORY_CONTRACT_NAME}/admin/lockups`,\n        );\n\n        console.log(result);\n\n        return result;\n      } catch (error) {\n        console.log(error);\n        enqueueCustomSnackbar(\n          enqueueSnackbar,\n          success.body((error as any).toString()),\n          failure.header('Error'),\n        );\n        return null;\n      }\n    };\n\n    perform();\n  };\n\n  useEffect(() => {\n    if (!shouldClearState) {\n      return;\n    }\n    setShouldClearState(false);\n    setTokenAccountId('');\n    setName('');\n    setLockupOperators([]);\n    setDraftOperators([]);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    const allUniqueAccountIds = Array.from(new Set(\n      [...lockupOperators, ...draftOperators, tokenAccountId, nameWithFactoryContractName],\n    ));\n    for (let i = 0; i < allUniqueAccountIds.length; i += 1) {\n      const accountId = allUniqueAccountIds[i];\n      enqueueAccountIdCheck(accountId);\n    }\n  }, [near]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  if (!(near)) {\n    return null;\n  }\n\n  const lockupOperatorsMissing = lockupOperators.filter((x: string) => accountStatuses[x] === NOT_FOUND);\n  const draftOperatorsMissing = draftOperators.filter((x: string) => accountStatuses[x] === NOT_FOUND);\n\n  return (\n    <div>\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n            <div className=\"nav\">\n              <Link className=\"nav-link\" to=\"/\">Home</Link>\n            </div>\n          </Box>\n        </div>\n      </div>\n\n      <div className=\"container new-lockup-contract\">\n        <h2>\n          Create Lockup Contract for your Fungible Tokens\n        </h2>\n\n        <form className=\"form-submit\" onSubmit={handleDeployLockupContract}>\n          <div className=\"form-wrapper\">\n\n            <p>\n              On this page you can deploy your own copy of lockup contract. Read more\n              {' '}\n              <Link to=\"/about\">here</Link>\n              .\n            </p>\n            <div className=\"form-row\">\n              <div className=\"form-row_title\">Contract creator: </div>\n              <div className=\"form-row_group\">\n                {near.currentUser.signedAccountId ? (\n                  <>\n                    <strong>{near.currentUser.signedAccountId}</strong>\n                    <button className=\"button\" type=\"button\" onClick={reSignIn}>\n                      Login as someone else\n                    </button>\n                  </>\n                ) : (\n                  <button className=\"button\" type=\"button\" onClick={signIn}>\n                    Login\n                  </button>\n                )}\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <div className=\"form-row_title\">Lockup operators: </div>\n              <div className=\"form-row_group\">\n                <AddRemoveInput\n                  data={lockupOperators}\n                  onChange={handleChangeLockupOperators}\n                  accountIdCheck={enqueueAccountIdCheck}\n                  accountStatuses={accountStatuses}\n                />\n                <div className=\"form-row_error\">\n                  {lockupOperators.length === 0 && <span className=\"red\">Required</span>}\n                </div>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <div className=\"form-row_title\">Draft operators: </div>\n              <div className=\"form-row_group\">\n                <AddRemoveInput\n                  data={draftOperators}\n                  onChange={handleChangeDraftOperators}\n                  accountIdCheck={enqueueAccountIdCheck}\n                  accountStatuses={accountStatuses}\n                />\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <div className=\"form-row_title\">Fungible token contract address: </div>\n              <div className=\"form-row_group\">\n                <input\n                  type=\"text\"\n                  id=\"token_account_id\"\n                  value={tokenAccountId}\n                  onChange={handleChangeTokenAccountId}\n                />\n                <div className=\"form-row_error\">\n                  {tokenAccountId && accountStatuses[tokenAccountId] === NOT_FOUND && <span className=\"red\">Account does not exist</span>}\n                  {!tokenAccountId && <span className=\"red\">Required</span>}\n                  {accountStatuses[tokenAccountId] === PENDING && <span className=\"gray\">Checking...</span>}\n                </div>\n              </div>\n            </div>\n            <div className=\"form-row\">\n              <div className=\"form-row_title\">New Lockup Subaccount Name: </div>\n              <div className=\"form-row_group\">\n                <input type=\"text\" id=\"lockup_subaccount_id\" value={name} onChange={handleChangeName} />\n                <div className=\"form-row_error\">\n                  {name.match(subAccountPattern) === null && (\n                    <span className=\"red\">Invalid characters, allowed a-z 0-9, _, -.</span>\n                  )}\n                  {name.match(subAccountPattern) !== null && (\n                    <>\n                      {name && accountStatuses[nameWithFactoryContractName] === FOUND && (<span className=\"red\">Account already exists</span>)}\n                      {name && accountStatuses[nameWithFactoryContractName] === PENDING && (<span className=\"gray\">Checking...</span>)}\n                      {name && accountStatuses[nameWithFactoryContractName] === NOT_FOUND && (<span className=\"green\">Account is available</span>)}\n                      {!name && (<span className=\"red\">Required</span>)}\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <button\n              className=\"button submit\"\n              type=\"submit\"\n              disabled={!(\n                near.currentUser.signedAccountId\n                && accountStatuses[tokenAccountId] === FOUND\n                && lockupOperators.length > 0\n                && lockupOperatorsMissing.length === 0\n                && draftOperatorsMissing.length === 0\n                && name\n                && accountStatuses[nameWithFactoryContractName] === NOT_FOUND\n                && name.match(subAccountPattern)\n              )}\n            >\n              Deploy Contract\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { DateTimePicker } from '@mui/x-date-pickers/DateTimePicker';\nimport { TextField } from '@mui/material';\n\ntype TProps = {\n  value: Date | null,\n  setValue: (newValue: Date | null) => any,\n  label: String,\n  minTime: Date | null,\n  disabled: boolean,\n};\n\nexport default function UTCDateTimePicker(props: TProps) {\n  const {\n    value, setValue, label, minTime, disabled,\n  } = props;\n\n  const offsetMs = 1_000 * 60 * new Date().getTimezoneOffset();\n\n  return (\n    <DateTimePicker\n      disabled={disabled}\n      label={label}\n      value={value && new Date(value.getTime() + offsetMs)}\n      minDateTime={minTime && new Date(minTime.getTime() + offsetMs)}\n      onChange={(newValue) => {\n        setValue(newValue && new Date(newValue.getTime() - offsetMs));\n      }}\n      ampm={false}\n      renderInput={\n        (params) => (\n          <TextField\n            sx={{ margin: '0' }}\n            margin=\"normal\"\n            fullWidth\n            variant=\"outlined\"\n            size=\"small\"\n            {...params}\n            inputProps={{\n              ...params.inputProps,\n              placeholder: 'YYYY-MM-DD hh:mm:ss UTC',\n            }}\n          />\n        )\n      }\n      inputFormat=\"yyyy-MM-dd HH:mm:ss 'UTC'\"\n    />\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n  InputLabel,\n} from '@mui/material';\nimport BN from 'bn.js';\nimport Big from 'big.js';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear, startOfDay, addDays } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TSchedule } from '../../services/api';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setStartDate', newValue?.getTime());\n    setStartDate(newValue);\n    setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n  const [accountId, setAccountId] = useState<string>('');\n  const [accountStatuses, setAccountStatuses] = useState<any>({ '': 'error' }); // pending success error\n  const [amount, setAmount] = useState<string>('');\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleChangeAmount = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const perform = async () => {\n      if (!near) return;\n      const { value } = event.target;\n\n      setAmount(value);\n    };\n\n    perform();\n  };\n\n  const handleChangeAccountId = (value: any) => {\n    const perform = async () => {\n      if (!near) return;\n      console.log('accountStatuses', accountStatuses);\n\n      setAccountId(value);\n\n      if (accountStatuses[value]) {\n        // lookup finished or in progress\n        return;\n      }\n\n      if (value.match(/^[0-9a-f]{64}$/)) {\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'success' };\n        });\n        return;\n      }\n\n      setAccountStatuses((acc: any) => {\n        console.log('.');\n        return { ...acc, [value]: 'pending' };\n      });\n\n      try {\n        const { total } = (await (await near.near.account(value)).getAccountBalance());\n        console.log(total);\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'success' };\n        });\n      } catch (e) {\n        console.log(e);\n        setAccountStatuses((acc: any) => {\n          console.log('.');\n          return { ...acc, [value]: 'error' };\n        });\n      }\n\n      console.log('accountStatuses', accountStatuses);\n    };\n\n    perform();\n  };\n\n  const handleChangeAccountIdEvent = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const { value } = event.target;\n    return handleChangeAccountId(value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n    if (!near.currentUser.signedAccountId) {\n      throw new Error('signedAccountId requred to set lockup terminator');\n    }\n    if (!startDate) {\n      throw Error('Start date not set');\n    }\n\n    e.preventDefault();\n\n    console.log(amount);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const lockupTotalAmount = new Big(amount).mul(new Big(10).pow(token.decimals))\n      .round(0, Big.roundDown).toString();\n\n    const getScheduleList = (date: Date, balanceInput: string, selected: string): [TSchedule, TSchedule | null] => {\n      const balance = new BN(balanceInput);\n\n      const schedules: { [key: string]: TSchedule } = {\n        '4y_cliff_1y_25': [\n          { timestamp: addYear(date, 0), balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: balance.divn(4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n\n      const schedulePairs: { [key: string]: [TSchedule, TSchedule | null] } = {\n        '4_year': [schedules['4y_cliff_1y_25'], null],\n        '4_year_vested': [schedules['4y_cliff_1y_25'], schedules['4y_cliff_1y_25']],\n      };\n\n      return schedulePairs[selected];\n    };\n\n    const [lockupSchedule, vestingSchedule] = getScheduleList(startDate, lockupTotalAmount, schedule);\n\n    near.tokenApi.createLockup(\n      lockupContractId,\n      lockupTotalAmount.toString(),\n      accountId,\n      lockupSchedule,\n      vestingSchedule,\n    );\n  };\n\n  const validAmount = !Number.isNaN(parseFloat(amount));\n\n  return (\n    <>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"md\" onClose={handleClose}>\n        <form className=\"form-submit\">\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <FormControl\n              fullWidth\n              sx={{ height: '70px' }}\n            >\n              <TextField\n                margin=\"normal\"\n                id=\"account\"\n                label=\"Account Id\"\n                type=\"text\"\n                fullWidth\n                variant=\"outlined\"\n                size=\"small\"\n                value={accountId}\n                onChange={handleChangeAccountIdEvent}\n                error={!!accountId && accountStatuses[accountId] === 'error'}\n                helperText={!!accountId && accountStatuses[accountId] === 'error' && 'Account does not exist'}\n              />\n            </FormControl>\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <TextField\n                margin=\"normal\"\n                id=\"amount\"\n                label=\"Amount\"\n                type=\"number\"\n                variant=\"outlined\"\n                size=\"small\"\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n                }}\n                fullWidth\n                onChange={handleChangeAmount}\n                sx={{ margin: 0 }}\n              />\n            </FormControl>\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '30px' }}\n            >\n              <InputLabel id=\"test-select-label\">Schedule</InputLabel>\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                fullWidth\n                variant=\"outlined\"\n                size=\"small\"\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <FormControl fullWidth sx={{ marginTop: '30px', marginBottom: 0 }}>\n              <LocalizationProvider dateAdapter={AdapterDateFns} sx={{ marginBottom: 0 }}>\n                <UTCDateTimePicker\n                  value={startDate}\n                  setValue={(newValue) => {\n                    console.log('setStartDate', newValue?.getTime());\n                    setStartDate(newValue);\n                  }}\n                  label=\"Start date and time\"\n                  minTime={null}\n                  disabled={false}\n                />\n              </LocalizationProvider>\n            </FormControl>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button\n              disabled={!startDate || accountStatuses[accountId] === 'error' || !validAmount}\n              className=\"button fullWidth noMargin\"\n              type=\"button\"\n              onClick={handleCreateLockup}\n            >\n              Create\n            </button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n","import { useState } from 'react';\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  RadioGroup,\n  Radio,\n  FormControl,\n  FormControlLabel,\n} from '@mui/material';\n\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\n\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport { interpolateSchedule, terminateScheduleAtAmount, terminateSchedule } from '../../services/scheduleHelpers';\nimport DaoSelector from '../WithDao/DaoSelector';\nimport DaoProposalDescription from '../WithDao/DaoProposalDescription';\nimport UTCDateTimePicker from '../UTCDateTimePicker';\nimport { startOfDay, addDays } from '../../utils';\nimport { TSchedule, TLockup } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport Chart from '../Chart';\nimport { chartData } from '../../services/chartHelpers';\n\ntype TUIElement<Ctype> = {\n  currentState: {\n    value: Ctype,\n    setValue: any,\n  },\n};\n\nexport type TProps = {\n  currentState: {\n    value: boolean,\n    setValue: any,\n  },\n  schedule: TSchedule,\n  vestingSchedule: TSchedule,\n  handlers: {\n    onClose: any,\n    onSubmit: any,\n  },\n  dialog: {\n    dateTimePicker: TUIElement<Date | null>,\n    daoSelector?: TUIElement<string>,\n    daoProposalDescription?: TUIElement<string>,\n  },\n  token: TMetadata,\n  lockup: TLockup,\n};\n\nexport function TerminateModal({\n  currentState,\n  schedule,\n  vestingSchedule,\n  handlers,\n  dialog,\n  token,\n  lockup,\n}: TProps) {\n  console.log(schedule);\n  const [terminationMode, setTerminationMode] = useState<string>(\n    dialog.dateTimePicker.currentState.value ? 'with_timestamp' : 'now',\n  );\n  const calcDefaultTimestamp = () => addDays(startOfDay(new Date()), 1);\n\n  const xMax = Math.max(\n    schedule[schedule.length - 1].timestamp,\n    schedule[schedule.length - 1].timestamp,\n  );\n  const terminationTimestamp = (\n    (dialog.dateTimePicker.currentState.value && !Number.isNaN(dialog.dateTimePicker.currentState.value.getTime()))\n      ? new Date(Math.max(dialog.dateTimePicker.currentState.value.getTime(), new Date().getTime()))\n      : new Date()\n  ).getTime() / 1_000;\n\n  const vestedAmount: string = interpolateSchedule(vestingSchedule, terminationTimestamp).balance;\n\n  const trimmedLockupSchedule = terminateScheduleAtAmount(lockup.schedule, vestedAmount, 0);\n  const trimmedVestingSchedule = terminateSchedule(vestingSchedule, terminationTimestamp);\n\n  const yMax = Math.max(\n    parseFloat(vestingSchedule[vestingSchedule.length - 1].balance),\n    parseFloat(vestingSchedule[vestingSchedule.length - 1].balance),\n  ) / 10 ** token.decimals;\n\n  const trimmedLockup = {\n    schedule: trimmedLockupSchedule,\n    termination_config: {\n      vesting_schedule: {\n        Schedule: trimmedVestingSchedule,\n      },\n    },\n    claimed_balance: lockup.claimed_balance,\n  };\n\n  return (\n    <Dialog open={currentState.value} sx={{ padding: 2 }} maxWidth=\"md\" onClose={handlers.onClose}>\n      <form className=\"form-submit\">\n        <DialogTitle>\n          Terminate Lockup\n          <IconButton\n            aria-label=\"close\"\n            onClick={handlers.onClose}\n            sx={{\n              position: 'absolute',\n              right: 8,\n              top: 8,\n            }}\n          >\n            <CloseRoundedIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent sx={{ minWidth: '720px' }}>\n          <div style={{ height: 300 }}>\n            <Chart data={chartData([trimmedLockup], token.decimals)} xMax={xMax} yMax={yMax} />\n          </div>\n          <div className=\"vested-amount-info\">\n            <div style={{ lineHeight: '30px' }}>\n              Vested amount\n              {terminationMode === 'now' ? ' (approximate)' : ''}\n              :\n            </div>\n            <div>\n              <TokenAmountDisplay amount={vestedAmount} token={token} />\n            </div>\n          </div>\n          <FormControl>\n            <RadioGroup\n              aria-labelledby=\"demo-radio-buttons-group-label\"\n              defaultValue=\"female\"\n              name=\"radio-buttons-group\"\n              value={terminationMode}\n              onChange={(_event, newValue: string) => {\n                setTerminationMode(newValue);\n                if (newValue === 'with_timestamp') {\n                  dialog.dateTimePicker.currentState.setValue(calcDefaultTimestamp());\n                } else {\n                  dialog.dateTimePicker.currentState.setValue(null);\n                }\n              }}\n            >\n              <FormControlLabel value=\"now\" control={<Radio />} label=\"now\" />\n              <FormControlLabel value=\"with_timestamp\" control={<Radio />} label=\"at specific timestamp\" />\n            </RadioGroup>\n          </FormControl>\n          <FormControl fullWidth sx={{ marginTop: '24px' }}>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              {dialog.dateTimePicker && (\n                <UTCDateTimePicker\n                  value={dialog.dateTimePicker.currentState.value}\n                  setValue={(newValue) => {\n                    dialog.dateTimePicker.currentState.setValue(newValue);\n                  }}\n                  label=\"Custom termination date and time\"\n                  minTime={new Date()}\n                  disabled={!(terminationMode === 'with_timestamp')}\n                />\n              )}\n            </LocalizationProvider>\n          </FormControl>\n          { dialog?.daoSelector && (\n            <DaoSelector\n              selectedAddress={dialog.daoSelector.currentState.value}\n              setSelectedAddress={dialog.daoSelector.currentState.setValue}\n            />\n          ) }\n          { dialog?.daoProposalDescription && (\n            <DaoProposalDescription\n              proposalDescription={dialog.daoProposalDescription.currentState.value}\n              setProposalDescription={dialog.daoProposalDescription.currentState.setValue}\n            />\n          ) }\n          <span style={{ minHeight: '40px' }} />\n          <button\n            className=\"button red fullWidth\"\n            style={{ marginTop: '20px' }}\n            type=\"button\"\n            onClick={handlers.onSubmit}\n            disabled={\n              terminationMode === 'with_timestamp'\n                && (\n                  (\n                    !dialog.dateTimePicker.currentState.value\n                    || Number.isNaN(dialog.dateTimePicker.currentState.value.getTime())\n                    || (\n                      dialog.dateTimePicker.currentState.value.getTime() <= new Date().getTime()\n                    )\n                  )\n                )\n            }\n          >\n            Terminate\n          </button>\n        </DialogContent>\n      </form>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\n\nimport { TTerminationConfig, TLockup, TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TerminateModal, TProps } from '../TerminateModal';\nimport { startOfDay, addDays } from '../../utils';\n\nfunction TerminateLockup(\n  props: {\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: TTerminationConfig | null,\n    token: TMetadata,\n    buttonText: string,\n    lockup: TLockup,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n    buttonText,\n    lockup,\n  } = props;\n\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => {\n    const newValue = addDays(startOfDay(new Date()), 1);\n    console.log('setDate', newValue?.getTime());\n    setDate(newValue);\n\n    return setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = async () => {\n    const ts = date ? date.getTime() / 1000 : null;\n    await near.api.terminate(lockupIndex, ts);\n  };\n\n  const canTerminate = adminControls && config;\n\n  if (!lockup?.termination_config?.vesting_schedule?.Schedule) {\n    console.log('lockup doesnt have termination config');\n    return null;\n  }\n  const modalProps: TProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    schedule: lockup.schedule,\n    vestingSchedule: lockup?.termination_config?.vesting_schedule?.Schedule as TSchedule,\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminateLockup,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: (newValue: Date | null) => {\n            console.log('setDate', newValue?.getTime());\n            setDate(newValue);\n          },\n        },\n      },\n    },\n    token,\n    lockup,\n  };\n\n  return (\n    <>\n      {canTerminate && (\n        <button\n          className=\"button\"\n          type=\"button\"\n          onClick={handleOpen}\n        >\n          {buttonText}\n        </button>\n      )}\n      { open && <TerminateModal {...modalProps} /> }\n    </>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TerminateModal } from '../TerminateModal';\nimport { buildTerminateLockupProposalLink } from '../../services/DAOs/astroDAO/utils';\nimport { TTerminationConfig, TLockup, TSchedule } from '../../services/api';\n\nfunction TerminateWithDaoButton(\n  props: {\n    accountId: string,\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: TTerminationConfig | null,\n    token: TMetadata,\n    buttonText: string,\n    lockup: TLockup,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    accountId,\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n    buttonText,\n    lockup,\n  } = props;\n\n  const [date, setDate] = useState<Date | null>(null);\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n  const location = useLocation();\n\n  const currentContractName = location.pathname.split('/')[1];\n  const pathname = `/${currentContractName}/lockups/${accountId}/${lockupIndex}`;\n  const uri = new URL(window.location.href);\n  uri.hash = `#${pathname}`;\n  const defaultDescription = `Terminate lockup ${lockupIndex}. Lockup link: ${uri.toString()}`;\n\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState((config?.beneficiary_id || '') as string);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminate = () => {\n    const link = buildTerminateLockupProposalLink(\n      description,\n      near.api.getContract().contractId,\n      lockupIndex,\n      date ? date.getTime() / 1000 : null,\n      astroDAOContractAddress,\n    );\n\n    window.open(link, '_blank')?.focus();\n  };\n\n  const canTerminate = adminControls && config;\n\n  if (!lockup?.termination_config?.vesting_schedule?.Schedule) {\n    console.log('lockup doesnt have termination config');\n    return null;\n  }\n  const modalProps = {\n    currentState: {\n      value: open,\n      setValue: setOpen,\n    },\n    schedule: lockup.schedule,\n    vestingSchedule: lockup?.termination_config?.vesting_schedule?.Schedule as TSchedule,\n    handlers: {\n      onClose: handleClose,\n      onSubmit: handleTerminate,\n    },\n    dialog: {\n      dateTimePicker: {\n        currentState: {\n          value: date,\n          setValue: setDate,\n        },\n      },\n      daoSelector: {\n        currentState: {\n          value: astroDAOContractAddress,\n          setValue: setAstroDAOContractAddress,\n        },\n      },\n      daoProposalDescription: {\n        currentState: {\n          value: description,\n          setValue: setDescription,\n        },\n      },\n    },\n    token,\n    lockup,\n  };\n\n  return (\n    <div>\n      <button\n        className=\"button\"\n        disabled={!canTerminate}\n        type=\"button\"\n        onClick={handleOpen}\n        style={{ marginTop: 0 }}\n      >\n        {buttonText}\n      </button>\n      { open && <TerminateModal {...modalProps} /> }\n    </div>\n  );\n}\n\nexport default TerminateWithDaoButton;\n","import { useContext, useEffect, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n  Tooltip,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport LinkIcon from '@mui/icons-material/Link';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { useSnackbar } from 'notistack';\nimport TimestampDateDisplay from '../TimestampDateDisplay';\nimport TokenAmountDisplay from '../TokenAmountDisplay';\nimport Chart from '../Chart';\nimport { formatTokenAmount, toCompactString } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TLockup } from '../../services/api';\nimport TerminateLockup from '../TerminateLockup';\nimport TerminateWithDaoButton from '../TerminateWithDaoButton';\nimport ScheduleTable from '../ScheduleTable';\nimport { chartData } from '../../services/chartHelpers';\nimport { calcBalancesRaw } from '../../services/scheduleHelpers';\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\nimport success from '../Snackbars/SuccessPartials';\n\nexport default function Row({\n  opened, adminControls, row, token,\n}: { opened: boolean, adminControls: boolean, row: TLockup, token: TMetadata }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const [open, setOpen] = useState<boolean>(false);\n  const { enqueueSnackbar } = useSnackbar();\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  const [now, _setNow] = useState<number>(Math.floor(new Date().getTime() / 1000));\n\n  const [hasBeenOpen, setHasBeenOpen] = useState<boolean>(false);\n\n  useEffect(() => {\n    setOpen(opened);\n    setHasBeenOpen(opened);\n  }, [opened]);\n\n  if (!near) return null;\n\n  const { isAdmin } = near.currentUser;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  const selectedAccountPage = window.location.href.split('/').pop() === row.account_id;\n\n  const selectedLockupId = window.location.href.split('/').pop() === row.id.toString();\n\n  const balancesRaw = calcBalancesRaw(row, now);\n\n  const claimedAmount = `${formatTokenAmount(balancesRaw.claimed, token.decimals)}`;\n  const availbleAmount = `${formatTokenAmount(balancesRaw.unclaimed, token.decimals)}`;\n  const vestedAmount = `${formatTokenAmount(balancesRaw.vested, token.decimals)}`;\n  const unvestedAmount = `${formatTokenAmount(balancesRaw.unvested, token.decimals)}`;\n\n  let payerMessage;\n  if (!row.termination_config?.beneficiary_id) {\n    payerMessage = 'This lockup cannot be terminated';\n  } else {\n    payerMessage = `Unvested amount will return to ${row.termination_config?.beneficiary_id}`;\n  }\n\n  const terminatorId = row?.termination_config?.beneficiary_id;\n\n  const terminateButton = (terminator: string) => {\n    if (!adminControls) {\n      return null;\n    }\n    return (\n      <>\n        <div>\n          {isAdmin && (\n            <TerminateLockup\n              token={token}\n              adminControls={adminControls}\n              lockupIndex={row.id}\n              config={row.termination_config}\n              buttonText={terminator ? 'Terminate' : 'No termination config'}\n              lockup={row}\n            />\n          )}\n        </div>\n        <div>\n          <TerminateWithDaoButton\n            accountId={row.account_id}\n            token={token}\n            adminControls={adminControls}\n            lockupIndex={row.id}\n            config={row.termination_config}\n            buttonText={terminator ? 'Terminate with Dao' : 'No termination config'}\n            lockup={row}\n          />\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <>\n      <TableRow className={open ? `expanded exp-row ${(opened ? 'opened' : '')}` : 'exp-row'}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => { setOpen(!open); setHasBeenOpen(true); }}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedLockupId\n            ? <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups/${row.account_id}/${row.id}`}>{row.id}</Link>\n            : row.id}\n          {!selectedLockupId && (\n          <CopyToClipboard\n            text={`${window.location.origin}/#/${currentContractName}/lockups/${row.account_id}/${row.id}`}\n            onCopy={() => enqueueCustomSnackbar(enqueueSnackbar, null, success.header('Copied'), { autoHideDuration: 1000 })}\n          >\n            <IconButton aria-label=\"copy link\">\n              <LinkIcon />\n            </IconButton>\n          </CopyToClipboard>\n          )}\n        </TableCell>\n        <TableCell align=\"left\">\n          {!selectedAccountPage\n            ? <Link to={`/${currentContractName}${adminControls ? '/admin' : ''}/lockups/${row.account_id}`}>{toCompactString(row.account_id)}</Link>\n            : toCompactString(row.account_id)}\n          {!selectedAccountPage\n          && (\n          <CopyToClipboard\n            text={`${window.location.origin}/#/${currentContractName}/lockups/${row.account_id}`}\n            onCopy={() => enqueueCustomSnackbar(enqueueSnackbar, null, success.header('Copied'), { autoHideDuration: 1000 })}\n          >\n            <IconButton aria-label=\"copy link\">\n              <LinkIcon />\n            </IconButton>\n          </CopyToClipboard>\n          )}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[0].timestamp} />\n        </TableCell>\n        <TableCell align=\"right\">\n          <TimestampDateDisplay unixSeconds={row.schedule[row.schedule.length - 1].timestamp} />\n        </TableCell>\n        <TableCell align=\"center\">\n          {vestingSchedule ? 'Yes' : 'No'}\n        </TableCell>\n        <TableCell align=\"right\">\n          <TokenAmountDisplay amount={row.total_balance} token={token} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <Tooltip\n            title={(\n              <div className=\"progress-bar__tooltip\">\n                <span className=\"nowrap\">\n                  <i className=\"claimed\">&nbsp;</i>\n                  <b>{claimedAmount}</b>\n                  {' '}\n                  Claimed\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"available\">&nbsp;</i>\n                  <b>{availbleAmount}</b>\n                  {' '}\n                  Available\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"vested\">&nbsp;</i>\n                  <b>{vestedAmount}</b>\n                  {' '}\n                  Vested\n                </span>\n                <span className=\"nowrap\">\n                  <i className=\"unvested\">&nbsp;</i>\n                  <b>{unvestedAmount}</b>\n                  {' '}\n                  Unvested\n                </span>\n              </div>\n            )}\n            placement=\"top\"\n            arrow\n          >\n            <div className=\"progress-bar-outer\">\n              <div className=\"progress-bar\">\n                <div style={{ width: `${balancesRaw.total === '0' ? '100' : (parseFloat(balancesRaw.claimed) / parseFloat(balancesRaw.total)) * 100}%` }} className=\"claimed\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.unclaimed) / parseFloat(row.total_balance)) * 100}%` }} className=\"available\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.vested) / parseFloat(row.total_balance)) * 100}%` }} className=\"vested\">\n                  &nbsp;\n                </div>\n                <div style={{ width: `${balancesRaw.total === '0' ? '0' : (parseFloat(balancesRaw.unvested) / parseFloat(row.total_balance)) * 100}%` }} className=\"unvested\">\n                  &nbsp;\n                </div>\n              </div>\n            </div>\n          </Tooltip>\n        </TableCell>\n      </TableRow>\n      <TableRow className={opened ? 'expanded opened' : 'expanded'}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            { hasBeenOpen && (\n              <div className=\"lockup-row\">\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n\n                <div className=\"lockup-row-column chart\">\n                  <div style={{ height: 300 }}>\n                    <Chart data={chartData([row], token.decimals)} />\n                  </div>\n\n                  {adminControls && (\n                  <div className=\"terminate\">\n                    <span className=\"fine-print\">{payerMessage}</span>\n                    {terminatorId && terminateButton(terminatorId)}\n\n                  </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable(\n  { lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean },\n) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\"><span className=\"nowrap\">ID</span></TableCell>\n          <TableCell align=\"left\"><span className=\"nowrap\">Account ID</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Start date (UTC)</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">End date (UTC)</span></TableCell>\n          <TableCell align=\"center\"><span className=\"nowrap\">Terminatable</span></TableCell>\n          <TableCell align=\"right\"><span className=\"nowrap\">Total amount</span></TableCell>\n          <TableCell align=\"center\"><span className=\"nowrap\">Progress</span></TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} opened={false} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  TextField,\n} from '@mui/material';\n\nimport { useRef } from 'react';\n\nexport default function FavouriteAccounts({\n  tokenContractId, favouriteAccounts, uniqueUsers, onSave,\n}: {\n  tokenContractId: string, favouriteAccounts: string[], uniqueUsers: string[], onSave: Function,\n}) {\n  console.log('unique users', uniqueUsers);\n\n  const inputRef = useRef<null | HTMLInputElement>(null);\n\n  const parseAccounts = (input: string): string[] => input.replaceAll(' ', '').split(',');\n\n  const handleSaveFavouriteAccounts = (): void => {\n    const localStorageValue = (value: string[]): string => JSON.stringify({ favouriteAccounts: value });\n\n    if (!inputRef?.current?.value) {\n      localStorage.setItem(tokenContractId, localStorageValue([]));\n      onSave([]);\n      return;\n    }\n\n    const newFavouriteAccounts = parseAccounts(inputRef.current.value);\n    onSave(newFavouriteAccounts);\n    localStorage.setItem(tokenContractId, localStorageValue(newFavouriteAccounts));\n  };\n\n  const handleChangeFavouriteAccounts = (e: any) => {\n    const { value } = e.target;\n\n    const realAccouns = parseAccounts(value).filter((account) => account.match(/.*(\\.)(near|testnet)$/));\n\n    if (favouriteAccounts.toString() !== realAccouns.toString()) {\n      handleSaveFavouriteAccounts();\n    }\n  };\n\n  return (\n    <div style={{ display: 'flex', marginBottom: '2em' }}>\n      <TextField\n        inputProps={{\n          sx: {\n            margin: 0,\n          },\n        }}\n        size=\"small\"\n        sx={{ width: 1, padding: 0, margin: 0 }}\n        id=\"outlined-helperText\"\n        label=\"My accounts\"\n        placeholder=\"Comma separated list of your near accounts\"\n        defaultValue={favouriteAccounts.join(', ')}\n        inputRef={inputRef}\n        onKeyPress={(e) => e.key === 'Enter' && handleSaveFavouriteAccounts()}\n        onChange={handleChangeFavouriteAccounts}\n      />\n    </div>\n  );\n}\n","import {\n  TableContainer,\n} from '@mui/material';\nimport { useContext, useState } from 'react';\n\nimport { Link } from 'react-router-dom';\nimport Chart from '../../components/Chart';\n\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport useTitle from '../../services/useTitle';\nimport { TMetadata } from '../../services/tokenApi';\nimport FavouriteAccounts from '../../components/FavouriteAccounts';\nimport { chartData } from '../../services/chartHelpers';\n\ntype TToken = TMetadata & { contractId: string };\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TToken, adminControls: boolean }) {\n  useTitle('Lockups | FT Lockup', { restoreOnUnmount: true });\n\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  const {\n    near,\n  }: {\n    near: INearProps,\n  } = useContext(NearContext);\n\n  const { signedIn, isAdmin } = near.currentUser;\n\n  const storedData = localStorage.getItem(token.contractId);\n  const favouriteAccountsFromLocalStorage = storedData ? JSON.parse(storedData)?.favouriteAccounts : [];\n  const [favouriteAccounts, setFavouriteAccounts] = useState<string[]>(favouriteAccountsFromLocalStorage);\n  const favouriteAccountsLockups = lockups.filter((lockup) => favouriteAccounts.includes(lockup.account_id));\n\n  const lockupsPage = (lockupsList: any): any => {\n    if (lockupsList.length > 0) {\n      return (\n        <>\n          <Chart data={chartData(lockupsList, token.decimals)} />\n\n          { signedIn && adminControls && isAdmin && <CreateLockup token={token} /> }\n\n          <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }}>\n            <LockupsTable lockups={lockupsList} token={token} adminControls={adminControls} />\n          </TableContainer>\n        </>\n      );\n    }\n\n    return (\n      <div>\n        {adminControls && (\n          <div>\n            There are no lockups yet.\n            {' '}\n            {isAdmin && 'Create single lockup or create a batch of lockups via' || 'Create a batch of lockups via'}\n            {' '}\n            <Link to={`/${near.lockupContractId}/admin/import_draft_group`}>draft groups</Link>\n            .\n          </div>\n        )}\n        { signedIn && adminControls && isAdmin && <CreateLockup token={token} /> }\n      </div>\n    );\n  };\n\n  if (adminControls) {\n    return (\n      <div className=\"main\">\n        <div className=\"container\">\n          <h1>Lockups</h1>\n          {lockupsPage(lockups)}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n        <h1>Lockups</h1>\n        <FavouriteAccounts\n          tokenContractId={token.contractId}\n          favouriteAccounts={favouriteAccounts}\n          uniqueUsers={uniqueUsers}\n          onSave={setFavouriteAccounts}\n        />\n        {lockupsPage(favouriteAccountsLockups)}\n      </div>\n    </div>\n  );\n}\n","import {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  IconButton,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nexport default function ConfirmDialog(props: { message: string, isOpen: boolean, closeFn: any, callback: any }) {\n  const {\n    message,\n    isOpen,\n    closeFn,\n    callback,\n  } = props;\n\n  const handleConfirm = () => {\n    closeFn();\n    callback();\n  };\n\n  return (\n    <Dialog open={isOpen} sx={{ padding: 2 }} maxWidth=\"md\" onClose={closeFn}>\n      <DialogTitle>\n        Confirmation\n        <IconButton\n          aria-label=\"close\"\n          sx={{\n            position: 'absolute',\n            right: 8,\n            top: 8,\n          }}\n          onClick={closeFn}\n        >\n          <CloseRoundedIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent sx={{ minWidth: '320px' }}>\n        <div>{message}</div>\n      </DialogContent>\n      <DialogActions sx={{ padding: '14px 24px 24px' }}>\n        <button className=\"button red\" type=\"button\" onClick={closeFn}>Cancel</button>\n        <button className=\"button\" type=\"button\" onClick={handleConfirm}>Confirm</button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\nimport { Big } from 'big.js';\n\nimport ConfirmDialog from '../ConfirmDialog';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountPreview from '../TokenAmountPreview';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, lockups: any[] }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    accountId, token, lockups,\n  } = params;\n\n  const total: string = lockups.reduce((acc, obj) => new Big(acc).add(obj.unclaimed_balance), '0').toFixed();\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [dialogConfirmCallback, setDialogConfirmCallback] = useState<any>(() => null);\n  const closeDialog = () => setIsDialogOpen(false);\n  const openDialog = () => setIsDialogOpen(true);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    const perform = async () => {\n      if (!near) return;\n      if (!near.tokenApi) return;\n      if (!near.noLoginTokenApi) return;\n      if (!near.tokenContractId) return;\n\n      const storageBalance = await near.tokenApi.storageBalanceOf(accountId);\n      const isStoragePaid = (storageBalance !== null) && true;\n      if (isStoragePaid) {\n        near.noLoginApi.claimSpecificLockups(accountId, lockups.map((x) => x.id));\n      } else {\n        const bounds = await near.tokenApi.storageBalanceBounds();\n        const amount = bounds.max;\n\n        const callback = () => {\n          near.noLoginTokenApi.storageDeposit(near.tokenContractId, accountId, amount);\n        };\n        setDialogConfirmCallback(() => callback);\n        openDialog();\n      }\n    };\n\n    perform();\n  };\n\n  const depositConfirmMessage = `\n    Your account doesn't have storage deposit on the token contract. You will be redirected to pay for the storage, after that you will be able to claim your tokens.\n  `.trim();\n\n  return (\n    <div className=\"claim-wrapper\">\n      <div className=\"claim-preview-info\">\n        <h5>Total available</h5>\n        <TokenAmountPreview token={token} amount={total} />\n      </div>\n      <div className=\"claim-button-wrapper\">\n        <button className=\"button\" type=\"button\" onClick={handleClaimAllLockups}>\n          Claim\n          {lockups.length > 1 ? ' all' : ''}\n        </button>\n        <ConfirmDialog message={depositConfirmMessage} isOpen={isDialogOpen} closeFn={closeDialog} callback={dialogConfirmCallback} />\n      </div>\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\n\nimport useTitle from '../../services/useTitle';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport Chart from '../../components/Chart';\nimport { chartData } from '../../services/chartHelpers';\nimport { toCompactString } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId, id } = useParams();\n  useTitle(`Lockup${id ? ` #${id}` : 's'} for ${userId} | FT Lockup`, { restoreOnUnmount: true });\n\n  const lockups = allLockups.filter((x) => {\n    if (id) {\n      return x.id.toString() === id;\n    }\n\n    return x.account_id === userId || x.id.toString() === userId;\n  });\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"main\">\n      <div className=\"container\">\n\n        <h1>\n          {lockups.length > 1 && 'All'}\n          {' '}\n          Lockup\n          {id ? ` ${id}` : 's'}\n          {' '}\n          for\n          {' '}\n          {userId && toCompactString(userId, 12, 12)}\n        </h1>\n\n        {!adminControls && <ClaimAllLockups accountId={userId} token={token} lockups={lockups} />}\n\n        {lockups.length > 1 && <Chart data={chartData(lockups, token.decimals)} />}\n\n        <TableContainer sx={{ boxShadow: 'unset' }}>\n          <Table className=\"main-table\" aria-label=\"collapsible table\">\n            <TableHead className=\"table-head\">\n              <TableRow>\n                <TableCell />\n                <TableCell align=\"left\">ID</TableCell>\n                <TableCell align=\"left\">Account ID</TableCell>\n                <TableCell align=\"right\">Start date (UTC)</TableCell>\n                <TableCell align=\"right\">End date (UTC)</TableCell>\n                <TableCell align=\"right\">Terminatable</TableCell>\n                <TableCell align=\"right\">Total amount</TableCell>\n                <TableCell align=\"center\">Progress</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {lockups.map((lockup) => (\n                <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} opened={lockups.length === 1} />\n              ))}\n            </TableBody>\n          </Table>\n        </TableContainer>\n\n      </div>\n    </div>\n  );\n}\n","import { Link, NavLink, useLocation } from 'react-router-dom';\nimport { useContext, useEffect } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  useEffect(() => {\n    console.log(location.pathname);\n\n    return () => {};\n  }, [location]);\n\n  if (!near) return null;\n\n  const {\n    signedIn,\n    signedAccountId,\n    isAdmin,\n    isDraftOperator,\n    isCouncilMember,\n  } = near.currentUser;\n\n  const lockupsPageViewPolicy = adminControls && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          <div className=\"nav\">\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/lockups` : `/${currentContractName}/lockups`}>Lockups</NavLink>\n            <NavLink className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/draft_groups` : `/${currentContractName}/draft_groups`}>Lockup Drafts</NavLink>\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span className=\"account-name\">\n                {signedAccountId}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return (\n    <div className=\"container\">\n      <div className=\"login\">\n        <h2>To start using app, please sign in</h2>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n\n  const showAlertForUser = signedIn && !(isAdmin || isCouncilMember || isDraftOperator);\n  const showLockups = signedIn && (isAdmin || isCouncilMember || isDraftOperator);\n\n  return (\n    <Auth>\n      { showAlertForUser && <Alert severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { showLockups && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PayForContractStorage() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const handlePay = () => {\n    const perform = async () => {\n      if (!near) {\n        return;\n      }\n      if (!near.tokenApi) {\n        return;\n      }\n      const bounds = await near.tokenApi.storageBalanceBounds();\n      const amount = bounds.max;\n\n      console.log(amount);\n      const result = await near.tokenApi.storageDeposit(near.lockupContractId, amount);\n      console.log(result);\n    };\n    perform();\n  };\n\n  return (\n    <div>\n      <div\n        style={{\n          maxWidth: 480, margin: 'auto', paddingTop: 20, textAlign: 'center',\n        }}\n      >\n        <h2>Please pay for fungible token storage</h2>\n        <p>\n          Please pay for the account storage in fungible token contract.\n          This is necessary to allow lockup contract to hold locked fungible token funds.\n          This is a one time payment for the lockup contract.\n          Additionally, all users claiming lockups will have to pay for the\n          storage for their account too.\n        </p>\n\n        <button className=\"button\" type=\"button\" onClick={handlePay}>\n          Pay\n        </button>\n      </div>\n    </div>\n  );\n}\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport PayForContractStorage from '../PayForContractStorage';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n  if (!near) return null;\n  const {\n    signedIn, isAdmin, isCouncilMember, isDraftOperator,\n  } = near.currentUser;\n  const currentPathname = location.pathname;\n  const currentContractName = location.pathname.split('/')[1];\n  const currentPathWithoutContract = location.pathname.split(currentContractName)[1];\n  const draftGroupURL = currentPathWithoutContract.includes('/draft');\n\n  if (!signedIn || !(isAdmin || isCouncilMember || isDraftOperator)) {\n    if (draftGroupURL) {\n      return <Navigate to={currentPathname.replace(/\\/admin/, '')} replace />;\n    }\n    return <Navigate to={`/${currentContractName}/admin`} replace />;\n  }\n\n  if (!near.isContractFtStoragePaid) {\n    return (\n      <div className=\"container\">\n        <PayForContractStorage />\n      </div>\n    );\n  }\n\n  return children;\n}\n","import { Box, InputAdornment, TextField } from '@mui/material';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { ChangeEvent, useState } from 'react';\nimport SearchIcon from '@mui/icons-material/Search';\n\nimport useTitle from '../../services/useTitle';\nimport { DEFAULT_CONTRACT_NAME } from '../../config';\n\nexport default function Homepage() {\n  useTitle('Welcome | FT Lockup', { restoreOnUnmount: true });\n\n  const [address, setAddress] = useState(DEFAULT_CONTRACT_NAME);\n  const [error, setError] = useState('');\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n    setError('');\n  };\n  const navigate = useNavigate();\n\n  const handleOpenLockupContract = () => {\n    if (!address || address.length < 5) {\n      setError('length should be more than 5 symbols');\n      return;\n    }\n    if (!address.match(/^(([a-z\\d]+[-_])*[a-z\\d]+\\.)*([a-z\\d]+[-_])*[a-z\\d]+\\.(testnet|near)$/)) {\n      setError('address should be for NEAR network');\n      return;\n    }\n    setError('');\n    const url = `/${address}/lockups`;\n    navigate(url);\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container home\">\n\n          <h2>Manage token vesting on NEAR</h2>\n          <h5>Create new lockup contract to be used by startup</h5>\n\n          <Link to=\"/new_lockup_contract\" className=\"button link-button\">Create Lockup Contract</Link>\n\n          <div className=\"line\" />\n\n          <div className=\"search-container\">\n            <TextField\n              variant=\"outlined\"\n              value={address}\n              onChange={handleChange}\n              onKeyPress={(e) => {\n                if (e.key === 'Enter') {\n                  handleOpenLockupContract();\n                }\n              }}\n              className=\"input large\"\n              placeholder=\"Enter existing Lockup contract address\"\n              InputProps={{\n                startAdornment: (\n                  <InputAdornment position=\"start\">\n                    <SearchIcon />\n                  </InputAdornment>\n                ),\n              }}\n              error={!!error}\n              helperText={error}\n            />\n            <button className=\"button\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\">\n              Search\n            </button>\n          </div>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { Box, InputAdornment, TextField } from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { ChangeEvent, useState } from 'react';\nimport { Link, useLocation, useNavigate } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function NotFoundContract() {\n  useTitle('Not Found | FT Lockup', { restoreOnUnmount: true });\n  const location = useLocation();\n  const navigate = useNavigate();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const [address, setAddress] = useState(currentContractName);\n  const [error, setError] = useState('');\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n    setError('');\n  };\n\n  const handleOpenLockupContract = () => {\n    if (!address || address.length < 5) {\n      setError('length should be more than 5 symbols');\n      return;\n    }\n    if (!address.match(/^(([a-z\\d]+[-_])*[a-z\\d]+\\.)*([a-z\\d]+[-_])*[a-z\\d]+\\.(testnet|near)$/)) {\n      setError('address should be for NEAR network');\n      return;\n    }\n    setError('');\n    const url = `/${address}/lockups`;\n    navigate(url);\n    window.location.reload();\n  };\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"container not_found\">\n        <div className=\"search-container\">\n          <TextField\n            variant=\"outlined\"\n            value={address}\n            onChange={handleChange}\n            onKeyPress={(e) => {\n              if (e.key === 'Enter') {\n                handleOpenLockupContract();\n              }\n            }}\n            className=\"input fullWidth\"\n            placeholder=\"Enter existing Lockup contract address\"\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              ),\n            }}\n            error={!!error}\n            helperText={error}\n          />\n          <button className=\"button large\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\">\n            Search\n          </button>\n        </div>\n\n        <div className=\"block\">\n          <p className=\"right_part\">\n            Contract\n            {' '}\n            <span className=\"red\">{currentContractName}</span>\n            {' '}\n            not found or is not correctly configured.\n          </p>\n\n          <div className=\"left_part\">\n            <Link to=\"/new_lockup_contract\" className=\"button link-button\">Create Lockup Contract</Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {\n  Link, useLocation,\n} from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nimport '../../styles/footer.scss';\n\nexport default function Footer() {\n  const location = useLocation();\n  const currentPathname = location.pathname;\n  const isAdminView = location.pathname.includes('admin');\n  const pathname = location.pathname.replace(/\\/*$/, '');\n  const showSwitch = !['', '/terms', '/privacy', '/about', '/new_lockup_contract'].some((x) => pathname === x);\n\n  const index = currentPathname.indexOf('/', 1);\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const viewSwitchLink = () => {\n    if (!near) return null;\n    let updatedPathname = `${currentPathname.substring(0, index)}/admin${currentPathname.substring(index, currentPathname.length)}`;\n    if (\n      (\n        currentPathname.substring(index, currentPathname.length).startsWith('/draft_groups')\n        || currentPathname.substring(index, currentPathname.length).startsWith('/drafts')\n      )\n      && !(\n        near.currentUser.isAdmin || near.currentUser.isCouncilMember || near.currentUser.isDraftOperator\n      )\n    ) {\n      updatedPathname = `${currentPathname.substring(0, index)}/admin`;\n    }\n\n    return isAdminView\n      ? <Link className=\"nav-link\" to={currentPathname.replace(/\\/admin/, '')}>User view</Link>\n      : <Link className=\"nav-link\" to={updatedPathname}>Admin view</Link>;\n  };\n\n  return (\n    <div className=\"footer\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to=\"/about\">About</Link>\n            <Link className=\"nav-link\" to=\"/terms\">Terms</Link>\n            <Link className=\"nav-link\" to=\"/privacy\">Privacy</Link>\n            {showSwitch && viewSwitchLink()}\n          </div>\n        </Box>\n      </div>\n    </div>\n  );\n}\nFooter.defaultProps = { showSwitch: true };\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { useParams } from 'react-router-dom';\nimport { useContext, useEffect, useState } from 'react';\nimport DraftsTableRow from '../../components/DraftsTable/row';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\nimport useTitle from '../../services/useTitle';\n\nexport default function PageDraft({\n  token, adminControls,\n}: { token: TMetadata, adminControls: boolean }) {\n  const draftId = parseInt(useParams().draftId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draft, setDraft] = useState<any>();\n\n  useTitle(`Draft ${draftId} | FT Lockup`, { restoreOnUnmount: true });\n\n  useEffect(() => {\n    const fetchDraft = async () => {\n      console.log('fetchDraft called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDrafts([draftId]);\n      const drafts = result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] }));\n      setDraft(drafts[0]);\n    };\n\n    fetchDraft(); // .catch(console.error);\n  }, [near, draftId]);\n\n  console.log(draft);\n\n  const progressShow = true;\n\n  return (\n    <div className=\"container\">\n      <h1>\n        Draft\n        {' '}\n        {draftId}\n      </h1>\n      {draft && (\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell />\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"left\">Account ID</TableCell>\n            <TableCell align=\"right\">Start date (UTC)</TableCell>\n            <TableCell align=\"right\">End date (UTC)</TableCell>\n            <TableCell align=\"right\">Total amount</TableCell>\n            {progressShow && <TableCell align=\"center\">Progress</TableCell>}\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <DraftsTableRow pageIndex={-1} row={draft} token={token} adminControls={adminControls} progressShow={progressShow} opened={!!draftId} />\n        </TableBody>\n      </Table>\n      )}\n    </div>\n  );\n}\n","import { Box } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function Terms() {\n  useTitle('Terms | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container\">\n          <h1>Terms</h1>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { Box } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport useTitle from '../../services/useTitle';\n\nexport default function Privacy() {\n  useTitle('Privacy | FT Lockup', { restoreOnUnmount: true });\n\n  return (\n    <div className=\"root\">\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <Link className=\"logo\" to=\"/\">LOCKUPS</Link>\n          </Box>\n        </div>\n      </div>\n      <div className=\"main\">\n        <div className=\"container\">\n          <h1>Privacy</h1>\n\n        </div>\n      </div>\n    </div>\n  );\n}\n","import Typography from '@mui/material/Typography';\n\nconst body = (text: string) => {\n  const Body = function Body(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      typography: {\n        fontSize: '12px',\n      },\n    }))();\n\n    return <Typography className={classes.typography}>{text}</Typography>;\n  };\n\n  return Body;\n};\n\nconst header = (text: string) => {\n  const Header = function Header(makeStyles: Function) {\n    const classes = makeStyles(() => ({\n      typography: {\n        color: '#E9AF1C',\n        fontWeight: 700,\n        fontSize: '16px',\n      },\n    }))();\n\n    return (\n      <Typography variant=\"subtitle2\" className={classes.typography}>\n        {text}\n      </Typography>\n    );\n  };\n\n  return Header;\n};\n\nconst warning = { body, header };\n\nexport default warning;\n","type TTxStatus = {\n  origin: any,\n  method: {\n    name: string,\n    args: any,\n    result: any | null,\n  },\n};\n\nexport const parseTxResultUrl = (resultUrl: string): string | null => {\n  const searchParams = new URLSearchParams(resultUrl);\n  const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n\n  if (!transactionHashesRaw) {\n    return null;\n  }\n\n  const txHash = transactionHashesRaw.split(',')[0];\n\n  console.log('txHash', txHash);\n\n  return txHash;\n};\n\nexport const fetchTxStatus = async (rpcProvider: any, contractAddress: string, txHash: string): Promise<TTxStatus | null> => {\n  const fetch = async (): Promise<any | null> => {\n    try {\n      const response = await rpcProvider.txStatus(txHash, contractAddress);\n\n      return response;\n    } catch (error) {\n      console.log('Transaction fetch error', { error });\n\n      return null;\n    }\n  };\n\n  const txStatus = await fetch();\n\n  if (!txStatus) {\n    return null;\n  }\n\n  const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n  const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n  const successValue = txStatus.status.SuccessValue;\n\n  return {\n    origin: txStatus,\n    method: {\n      name: methodName,\n      args,\n      result: successValue || null,\n    },\n  };\n};\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\n\nimport useLocalStorage from '../../hooks/useLocalStorage';\nimport { txLinkInExplorer } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport NewLockupContract from '../../pages/NewLockupContract';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\nimport Homepage from '../../pages/Homepage';\nimport NotFoundContract from '../../pages/NotFoundContract';\nimport Footer from '../Footer';\nimport PageDraft from '../../pages/PageDraft';\nimport Terms from '../../pages/Terms';\nimport Privacy from '../../pages/Privacy';\nimport {\n  claimSnack,\n  storageDepositSnack,\n  createLockupSnack,\n  fundDraftGroupSnack,\n  terminateLockupSnack,\n} from '../Snackbars';\nimport { enqueueCustomSnackbar } from '../Snackbars/Snackbar';\nimport warning from '../Snackbars/WarningPartials';\n\nimport { parseTxResultUrl, fetchTxStatus } from '../../services/transactionResultParser';\n\nfunction Customer({\n  lockups, token, contractId, near,\n}: {\n  lockups: any, token: TMetadata, contractId: string | null, near: INearProps | null,\n}) {\n  const [_, setShouldClearState] = useLocalStorage('new_lockup_contract:shouldClearState', true);\n\n  useEffect(() => {\n    setShouldClearState(true);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  if (!lockups) return null;\n\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"lockups\" />} />\n        <Route path=\"/lockups\" element={contractId && near && <Lockups lockups={lockups} token={{ ...token, contractId }} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId/:id\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups\" element={<PageDraftGroupsIndex token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<PageDraftGroup token={token} adminControls={false} />} />\n        <Route path=\"/drafts/:draftId\" element={<PageDraft token={token} adminControls={false} />} />\n        <Route path=\"*\" element={<NotFoundContract />} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({\n  lockups, token, tokenContractId, near,\n}: {\n  lockups: any, token: TMetadata, tokenContractId: string | null, near: INearProps | null,\n}) {\n  const [_, setShouldClearState] = useLocalStorage('new_lockup_contract:shouldClearState', true);\n\n  useEffect(() => {\n    setShouldClearState(true);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n  if (!lockups) return null;\n\n  const showLockups = tokenContractId && near;\n\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/lockups\" element={showLockups && <RequireAuth><Lockups lockups={lockups} token={{ ...token, contractId: tokenContractId }} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId/:id\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/drafts/:draftId\" element={<RequireAuth><PageDraft token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} adminControls /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    if (!enqueueSnackbar) return;\n    if (!near) return;\n    if (!token) return;\n    if (token.spec === '') {\n      return;\n    }\n\n    const perform = async () => {\n      const txHash = parseTxResultUrl(window.location.search);\n\n      if (!txHash) {\n        return;\n      }\n\n      const txStatus = await fetchTxStatus(\n        near.rpcProvider,\n        near.api.getContract().contractId,\n        txHash,\n      );\n\n      console.log('TX STATUS', txStatus);\n\n      if (!txStatus) {\n        return;\n      }\n\n      const { method } = txStatus;\n      const methodName = method.name;\n      const successValue = method.result;\n      const unpacked = successValue && JSON.parse(atob(successValue));\n      const { args } = method;\n      const txMsg = args.msg && JSON.parse(args.msg);\n\n      switch (methodName) {\n        case 'claim':\n          claimSnack(enqueueSnackbar, unpacked, txHash, token);\n          break;\n        case 'storage_deposit':\n          storageDepositSnack(enqueueSnackbar, unpacked, txHash, token, args.account_id);\n          break;\n        case 'ft_transfer_call':\n          if (txMsg.schedule) {\n            createLockupSnack(enqueueSnackbar, unpacked, txHash, token, txMsg);\n            break;\n          }\n\n          if (Number.isInteger(txMsg.draft_group_id)) {\n            fundDraftGroupSnack(enqueueSnackbar, unpacked, txHash, token, txMsg);\n            break;\n          }\n\n          enqueueCustomSnackbar(\n            enqueueSnackbar,\n            warning.body(`Transaction performed, TODO ${txHash}!`),\n            warning.header('Warning'),\n          );\n          break;\n        case 'terminate':\n          terminateLockupSnack(enqueueSnackbar, unpacked, txHash, token, args.lockup_index);\n          break;\n        default:\n          enqueueCustomSnackbar(\n            enqueueSnackbar,\n            warning.body(`UNHANDLED Transaction \"${methodName}\" : ${txLinkInExplorer(txHash)}`),\n            warning.header('Warning'),\n          );\n          break;\n      }\n    };\n\n    perform();\n  }, [enqueueSnackbar, near, token]);\n\n  useEffect(() => {\n    let active = true;\n\n    if (near && near.lockupContractFound) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      if (near.tokenContractId) {\n        load();\n      }\n    }\n\n    return () => { active = false; };\n  }, [near, near?.lockupContractFound]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/\" element={<Homepage />} />\n        <Route path=\"/terms\" element={<Terms />} />\n        <Route path=\"/privacy\" element={<Privacy />} />\n        <Route path=\"/about\" element={<About />} />\n        <Route path=\"/new_lockup_contract/\" element={<NewLockupContract />} />\n        <Route\n          path=\"/:cid/*\"\n          element={contractId && near && (\n            near.lockupContractFound\n              ? <Customer lockups={lockups} token={token} contractId={contractId} near={near} />\n              : (near.lockupContractNone ? null : <NotFoundContract />)\n          )}\n        />\n        <Route\n          path=\"/:cid/admin/*\"\n          element={contractId && near && (\n            near.lockupContractFound\n              ? <Admin lockups={lockups} token={token} tokenContractId={contractId} near={near} />\n              : (near.lockupContractNone ? null : <NotFoundContract />)\n          )}\n        />\n        <Route path=\"*\" element={<NotFoundContract />} />\n      </Routes>\n      <Footer />\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport { SnackbarProvider, useSnackbar } from 'notistack';\nimport { IconButton } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\n\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\nimport { TSuggestContext, SuggestContext } from './services/SuggestContext';\n\nimport './index.css';\n\nfunction SnackbarCloseButton(props: { snackbarKey: any }) {\n  const { snackbarKey } = props;\n  const { closeSnackbar } = useSnackbar();\n\n  return (\n    <IconButton onClick={() => closeSnackbar(snackbarKey)}>\n      <CloseIcon style={{ color: 'white' }} />\n    </IconButton>\n  );\n}\n\n/* eslint react/no-unstable-nested-components: \"off\" */\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    try {\n      connect();\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    reSignIn: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      near.api.signIn();\n    },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        currentUser: {\n          signedIn: false,\n          signedAccountId: null,\n          isAdmin: false,\n          isDraftOperator: false,\n          isCouncilMember: false,\n          daos: [],\n        },\n      });\n    },\n  }), [near]);\n\n  const handleClose = () => {\n    const url = new URL(window.location.href);\n    const sp = new URLSearchParams(url.search);\n    sp.delete('transactionHashes');\n    url.search = sp.toString();\n    window.history.pushState({}, null as any, url.toString());\n  };\n\n  const [suggestOpen, setSuggestOpen] = useState(true);\n  const suggestValue: TSuggestContext = useMemo(() => ({\n    open: suggestOpen,\n    setOpen: setSuggestOpen,\n  }), [suggestOpen, setSuggestOpen]);\n\n  return (\n    <StrictMode>\n      <SuggestContext.Provider value={suggestValue}>\n        <NearContext.Provider value={value}>\n          <SnackbarProvider\n            autoHideDuration={null}\n            action={(snackbarKey) => <SnackbarCloseButton snackbarKey={snackbarKey} />}\n            onClose={handleClose}\n            maxSnack={5}\n          >\n            <App />\n          </SnackbarProvider>\n        </NearContext.Provider>\n      </SuggestContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}