{"version":3,"sources":["config.ts","services/noLogInUsage.ts","services/api.ts","services/tokenApi.ts","services/near.ts","pages/About/index.tsx","utils.ts","components/TerminateLockup/index.tsx","components/table/row.tsx","components/CreateLockup/index.tsx","pages/Lockups/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/RequireAuth/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["CONTRACT_NAME","process","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","Error","getConfig","getFirstFullAccessKey","provider","accountId","a","query","request_type","account_id","finality","allAccessKeys","keys","length","allFullAccessKeys","filter","key","access_key","permission","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","MAX_GAS","NearApi","near","contract","walletConnection","this","WalletConnection","setContract","getAccountId","setWalletAndContractWithAuth","claim","lockupIndex","terminate","lockup_index","get_token_account_id","get_lockups_paged","then","response","map","id","data","Object","assign","successUrl","window","location","href","requestSignIn","undefined","signOut","acc_id","account","balance","getAccountBalance","b","amount","total","parseFloat","utils","format","formatNearAmount","console","error","viewMethods","changeMethods","Contract","connection","firstFullAccessKey","localStorage","setItem","JSON","stringify","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","TokenApi","contractId","meta","gas","deposit","msg","rest","ft_transfer_call","ft_metadata","NearContext","createContext","connectNear","keyStore","nearAPI","BrowserLocalStorageKeyStore","headers","api","signedAccountId","getTokenAccountId","tokenContractId","tokenApi","signedIn","About","lockups","token_account_id","className","Big","DP","convertTimestamp","time","Date","toLocaleDateString","convertAmount","value","decimals","Math","round","addYear","date","year","setFullYear","getFullYear","getTime","TerminateLockup","props","useContext","type","onClick","Row","useState","open","setOpen","row","token","TableRow","sx","borderBottom","TableCell","IconButton","size","align","to","schedule","timestamp","total_balance","symbol","style","width","claimed_balance","unclaimed_balance","background","padding","colSpan","Collapse","in","timeout","unmountOnExit","Table","TableHead","TableBody","x","component","scope","CreateLockup","startDate","setStartDate","setSchedule","handleClose","handleCreateLockup","e","preventDefault","target","elements","log","lockupContractId","getContract","userAccountId","lockupTotalAmount","getScheduleList","ts","selected","toString","ftTransferCall","receiver_id","Dialog","maxWidth","onClose","onSubmit","DialogTitle","position","right","top","DialogContent","TextField","margin","label","fullWidth","variant","InputProps","endAdornment","InputAdornment","FormControl","marginTop","Select","onChange","MenuItem","LocalizationProvider","dateAdapter","AdapterDateFns","DatePicker","newValue","renderInput","params","DialogActions","Lockups","uniqueUsers","Array","from","Set","TableContainer","boxShadow","Paper","lockup","ClaimAllLockups","UserLockups","allLockups","userId","useParams","totalClaimedBalance","reduce","acc","obj","Claim","Header","Box","display","Auth","children","Authorize","signIn","handleSignIn","replace","RequireAuth","useLocation","state","App","contractState","setContractState","setContractId","icon","name","reference","reference_hash","spec","setToken","useEffect","active","load","loadAllLockups","ftMetadata","metadata","path","element","NearApp","setNear","nearConn","connect","useMemo","Provider","render","document","getElementById"],"mappings":"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","file":"static/js/main.c1c33214.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n}\n\nconst CONTRACT_NAME = process.env.REACT_APP_CONTRACT_NAME || 'ft-lockup.demo000.ft-lockup.testnet';\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import * as nearAPI from 'near-api-js';\nimport { config } from '../config';\n\ntype TViewMethods = {\n  'get_deposit_whitelist': any,\n};\n\nexport const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport const importWhitelistedAccountsFullAccessKeys = async () => {\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const contract = new nearAPI.Contract(walletConnection.account(), config.contractName, {\n    viewMethods: ['get_deposit_whitelist'],\n    changeMethods: [],\n  }) as (nearAPI.Contract & TViewMethods);\n  const ownerAccountIds = await contract.get_deposit_whitelist() || [];\n\n  const { provider } = near.connection;\n\n  if (!ownerAccountIds?.length) {\n    throw Error('Zero lockup owners');\n  }\n\n  await Promise.all(\n    ownerAccountIds.map(async (ownerAccountId: string) => {\n      const firstFullAccessKey = await getFirstFullAccessKey(provider, ownerAccountId);\n      console.log('ffak = ', firstFullAccessKey);\n\n      localStorage.setItem(\n        `${config.contractName}_wallet_auth_key`,\n        JSON.stringify({ accountId: ownerAccountId, allKeys: [firstFullAccessKey.public_key] }),\n      );\n    }),\n  );\n\n  console.log('ownerAccountIds = ', ownerAccountIds);\n};\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { config } from '../config';\nimport { getFirstFullAccessKey } from './noLogInUsage';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'claim',\n  'terminate',\n];\n\ntype TViewMethods = {\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'claim': any,\n  'terminate': any,\n};\n\nconst MAX_GAS = 300_000_000_000_000;\n\ntype TNearAmount = string;\ntype TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TCheckpoint[],\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\nclass NearApi {\n  private near: Near;\n\n  private contract: Contract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, config.contractName);\n    this.contract = this.setContract();\n  }\n\n  async claim(accountId: string = this.walletConnection.getAccountId()): Promise<void> {\n    if (accountId !== this.walletConnection.getAccountId()) {\n      await this.setWalletAndContractWithAuth(accountId);\n    }\n\n    (this.contract as TLockupContract).claim({}, MAX_GAS);\n  }\n\n  async terminate(lockupIndex: number): Promise<void> {\n    try {\n      await (this.contract as TLockupContract).terminate(\n        { lockup_index: lockupIndex },\n        MAX_GAS,\n      );\n    } catch (e) {\n      throw Error('Cannot terminate lockup more than once');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}/lockups`;\n    this.walletConnection.requestSignIn(config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n\n  setContract(\n    contractName: string = config.contractName,\n    viewMethods: Array<string> = LOCKUP_VIEW_METHODS,\n    changeMethods: Array<string> = LOCKUP_CHANGE_METHODS,\n  ): Contract {\n    if (!this.walletConnection) {\n      throw Error('Unitialized wallet connection');\n    }\n\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      contractName,\n      { viewMethods, changeMethods },\n    );\n\n    return this.contract;\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n\n    this.walletConnection = new WalletConnection(this.near, contractName);\n    this.setContract();\n  }\n}\n\nexport default NearApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TCheckpoint } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: {\n        account_id: string,\n        schedule: TCheckpoint[],\n        claimed_balance: string,\n      },\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): void {\n    const { msg, ...rest } = meta;\n\n    this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n}\n\nexport default TokenApi;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport NearApi from './api';\nimport TokenApi from './tokenApi';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  signedIn: boolean;\n  signedAccountId: string | null;\n  tokenApi: TokenApi;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  const tokenContractId = await api.getTokenAccountId();\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  return {\n    config,\n    api,\n    signedIn: !!signedAccountId,\n    signedAccountId,\n    tokenApi,\n  };\n};\n","import { config } from '../../config';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  return (\n    <div className=\"container\">\n      <h1>About Page</h1>\n\n      <pre>\n        {`\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ${config.contractName}\n          token account id: ${token_account_id}\n\n          Total number of lockups: ${lockups.length}\n        `}\n      </pre>\n\n    </div>\n  );\n}\n","import Big from 'big.js';\n\nBig.DP = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\nexport const convertTimestamp = (time: number) => new Date(time * 1000).toLocaleDateString('en-US');\nexport const convertAmount = (value: number, decimals: number) => Math.round(\n  value / 10 ** decimals,\n);\n// @ts-ignore\n// eslint-disable-next-line max-len\nexport const addYear = (date: Date | null, year: number) => new Date(date?.setFullYear((date?.getFullYear() || 0) + year)).getTime() / 1000;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction TerminateLockup(props: { lockupIndex: number | undefined }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { lockupIndex } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = () => {\n    near.api.terminate(lockupIndex);\n  };\n\n  return (\n    <button className=\"button red fullWidth\" type=\"button\" onClick={handleTerminateLockup}>Terminate</button>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TerminateLockup from '../TerminateLockup';\n\nexport default function Row(props: { row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  // @ts-ignore\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">{row.id}</TableCell>\n        <TableCell align=\"left\"><Link to={signedIn ? `/admin/lockups/${row.account_id}` : `/lockups/${row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {(row.unclaimed_balance / row.total_balance) > 0.2\n                  && convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={7}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div className=\"inner-table_wrapper\">\n                <h5>Lockup schedule</h5>\n                <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>DATE</TableCell>\n                      <TableCell>AMOUNT</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {row.schedule.map((x: any) => (\n                      <TableRow key={x.timestamp}>\n                        <TableCell component=\"th\" scope=\"row\">\n                          {convertTimestamp(x.timestamp)}\n                        </TableCell>\n                        <TableCell>\n                          {convertAmount(x.balance, token.decimals)}\n                          &nbsp;\n                          {token.symbol}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n              {signedIn && (\n              <div className=\"terminate\">\n                <TerminateLockup lockupIndex={row.id} />\n              </div>\n              )}\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TCheckpoint } from '../../services/api';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n\n    e.preventDefault();\n\n    const { account, amount } = e.target.elements;\n\n    console.log(account.value, amount.value);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const claimedBalance = '0';\n    const userAccountId = account.value;\n    const lockupTotalAmount = amount.value * 10 ** token.decimals;\n\n    const timestamp = (startDate?.getTime() || 0) / 1000;\n\n    const getScheduleList = (ts: number, date: Date | null, balance: number, selected: string) => {\n      const list: { [key: string]: TCheckpoint[] } = {\n        '4_year': [\n          { timestamp: ts, balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: (balance / 4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n      return list[selected];\n    };\n\n    near.tokenApi.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: getScheduleList(timestamp, startDate, lockupTotalAmount, schedule),\n        claimed_balance: claimedBalance,\n      },\n    });\n  };\n\n  return (\n    <div>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n            />\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Start date\"\n                value={startDate}\n                onChange={(newValue) => {\n                  setStartDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n","import {\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport { useContext } from 'react';\nimport Row from '../../components/table/row';\nimport CreateLockup from '../../components/CreateLockup';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function Lockups({ lockups, token }: { lockups: any[], token: TMetadata }) {\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  console.log('unique users', uniqueUsers);\n\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  return (\n    <div className=\"container\">\n\n      <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }} component={Paper}>\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell />\n              <TableCell align=\"left\">ID</TableCell>\n              <TableCell align=\"left\">Account ID</TableCell>\n              <TableCell align=\"right\">Start&nbsp;date</TableCell>\n              <TableCell align=\"right\">End&nbsp;date</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              <TableCell align=\"center\">Progress</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {lockups.map((lockup) => (\n              <Row key={lockup.id} row={lockup} token={token} />\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n      {signedIn && <CreateLockup token={token} />}\n\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, total: Number }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { accountId, token, total } = params;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    near.api.claim(accountId);\n  };\n\n  return (\n    <div className=\"claim-wrapper\">\n      <h5>Total available</h5>\n      <div className=\"claim-amount\">\n        {total}\n        <span>{token.symbol}</span>\n      </div>\n      <button className=\"button\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token }: { lockups: any[], token: TMetadata }) {\n  const { userId } = useParams();\n\n  const lockups = allLockups.filter((x) => x.account_id === userId);\n\n  const totalClaimedBalance = lockups.reduce((acc, obj) => acc + convertAmount(obj.unclaimed_balance, token.decimals), 0);\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"container\">\n\n      <ClaimAllLockups accountId={userId} token={token} total={totalClaimedBalance} />\n\n      <TableContainer sx={{ boxShadow: 'unset' }} component={Paper}>\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell />\n              <TableCell align=\"left\">ID</TableCell>\n              <TableCell align=\"left\">Account ID</TableCell>\n              <TableCell align=\"right\">Start&nbsp;date</TableCell>\n              <TableCell align=\"right\">End&nbsp;date</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              <TableCell align=\"center\">Progress</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {lockups.map((lockup) => (\n              <Row key={lockup.id} row={lockup} token={token} />\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n    </div>\n  );\n}\n","import { Link } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header() {\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, signedAccountId } = near;\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        {signedIn ? (\n          <Box sx={{ display: 'flex' }}>\n            <div className=\"nav\">\n              <Link className=\"nav-link\" to=\"admin/lockups\">Lockups</Link>\n              <Link className=\"nav-link\" to=\"/about\">About</Link>\n            </div>\n            <Box sx={{ marginTop: '23px' }}>\n              <span>\n                {signedAccountId}\n                {' '}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          </Box>\n        ) : (\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to=\"/lockups\">Lockups</Link>\n            <Link className=\"nav-link\" to=\"/about\">About</Link>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return <div className=\"container login\">{children}</div>;\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  const handleSignIn = async () => {\n    signIn();\n  };\n\n  if (signedIn) {\n    return (\n      <Navigate to=\"/admin/lockups\" replace />\n    );\n  }\n\n  return (\n    <Auth>\n      <button className=\"button\" type=\"button\" onClick={handleSignIn}>Sign In</button>\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  if (!signedIn) {\n    return <Navigate to=\"/admin\" state={{ from: location }} replace />;\n  }\n\n  return children;\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function App() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      load();\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  if (Object.keys(contractState).length === 0) return null;\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Header />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"/lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={<Lockups lockups={lockups} token={token} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} />} />\n        <Route path=\"/admin\" element={<Authorize />} />\n        <Route path=\"/admin/lockups\" element={<RequireAuth><Lockups lockups={lockups} token={token} /></RequireAuth>} />\n        <Route path=\"/admin/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} /></RequireAuth>} />\n      </Routes>\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    connect();\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        signedIn: false,\n        signedAccountId: null,\n      });\n    },\n  }), [near]);\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <App />\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}