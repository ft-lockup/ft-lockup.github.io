{"version":3,"sources":["config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/tokenApi.ts","services/near.ts","pages/About/index.tsx","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","services/spreadsheetImport.ts","components/ImportDraftGroup/index.tsx","pages/PageDraftGroup/index.tsx","pages/PageDraftGroupsIndex/index.tsx","components/CreateLockup/index.tsx","components/TerminateLockup/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","pages/Lockups/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/RequireAuth/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["CONTRACT_NAME","process","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","Error","getConfig","MAX_GAS","Big","DP","convertTimestamp","time","Date","toLocaleDateString","convertAmount","value","decimals","div","toFixed","addYear","date","year","setFullYear","getFullYear","getTime","dumpLocalStorage","dumpKey","dumpValue","Object","keys","localStorage","map","key","getItem","setItem","JSON","stringify","restoreLocalStorage","data","parse","clear","forEach","record","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","lockupIndex","terminate","lockup_index","get_token_account_id","get_deposit_whitelist","get_lockups_paged","then","response","successUrl","window","location","href","requestSignIn","undefined","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","amount","total","parseFloat","utils","format","formatNearAmount","console","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","length","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","TokenApi","contractId","meta","gas","deposit","msg","rest","ft_transfer_call","ft_metadata","NearContext","createContext","connectNear","nearAPI","BrowserLocalStorageKeyStore","headers","api","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","signedAccountId","getTokenAccountId","tokenContractId","getDepositWhitelist","depositWhitelist","isAdmin","includes","tokenApi","signedIn","About","lockups","token_account_id","className","DraftsTableRow","props","useState","open","setOpen","row","token","useContext","TableRow","sx","borderBottom","TableCell","IconButton","size","onClick","align","to","schedule","timestamp","total_balance","symbol","style","width","claimed_balance","unclaimed_balance","background","padding","colSpan","Collapse","in","timeout","unmountOnExit","Table","TableHead","TableBody","x","component","scope","DraftsTable","lockup","BN","prototype","toJSON","toString","parseSpreadsheetColumns","input","lines","trim","split","table","line","columns","fromEntries","col","colIdx","parseDuration","pattern","match","groups","parseInt","month","week","day","hour","minute","second","parseHumanFriendlySchedule","parts","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","durationRaw","percentageRaw","duration","percentage","parseCliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","isValid","parseValidAccountId","parseTokenAmount","lockupSchedule","lockup_schedule","vestingSchedule","vesting_schedule","terminatorId","terminator_id","datePlusDurationMul","mulInput","mul","Math","floor","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","toUnix","toLockupSchedule","inputTotalAmount","tokenDecimals","decimalsMultiplier","pow","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","clone","cliffAmount","muln","divn","gt","checkpointStart","checkpointPreCliff","checkpointCliff","checkpointFinish","unshift","parseRawSpreadsheetInput","spreadsheetInput","rawSpreadsheetRow","terminationConfig","Schedule","termination_config","parseLockup","ImportDraftGroup","setData","importLog","setImportLog","log","message","currentLog","concat","navigate","useNavigate","handleClickImport","createDraftGroup","draftGroupId","chunkSize","i","chunk","slice","draft_group_id","createDrafts","draftIds","TextareaAutosize","placeholder","maxRows","onChange","event","target","e","type","join","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","useEffect","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","total_amount","funded","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","group","CreateLockup","startDate","setStartDate","setSchedule","handleClose","handleCreateLockup","preventDefault","elements","lockupContractId","getContract","userAccountId","lockupTotalAmount","getScheduleList","ts","selected","ftTransferCall","receiver_id","Dialog","maxWidth","onClose","onSubmit","DialogTitle","position","right","top","DialogContent","TextField","margin","label","fullWidth","variant","InputProps","endAdornment","InputAdornment","FormControl","marginTop","Select","MenuItem","LocalizationProvider","dateAdapter","AdapterDateFns","DatePicker","newValue","renderInput","params","DialogActions","TerminateLockup","disabled","Row","adminControls","LockupsTable","Lockups","uniqueUsers","Array","from","Set","TableContainer","boxShadow","Paper","ClaimAllLockups","UserLockups","allLockups","userId","totalUnclaimedBalance","reduce","acc","obj","Claim","Header","Box","display","Auth","children","Authorize","signIn","Alert","severity","replace","RequireAuth","useLocation","state","Customer","path","element","Admin","App","contractState","setContractState","setContractId","icon","name","reference","reference_hash","spec","setToken","active","load","loadAllLockups","ftMetadata","metadata","NearApp","setNear","nearConn","connect","useMemo","Provider","render","document","getElementById"],"mappings":"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","file":"static/js/main.ec4ff8e8.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n}\n\nconst CONTRACT_NAME = process.env.REACT_APP_CONTRACT_NAME || 'ft-lockup.demo001.ft-lockup.testnet';\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\n\nexport const MAX_GAS = 300_000_000_000_000;\n\nBig.DP = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\nexport const convertTimestamp = (time: number) => new Date(time * 1000).toLocaleDateString('en-US');\nexport const convertAmount = (value: number, decimals: number) => Big(value || '0').div(10 ** decimals).toFixed(NEAR_ROUND_DIGITS);\n// @ts-ignore\nexport const addYear = (date: Date | null, year: number) => new Date(date?.setFullYear((date?.getFullYear() || 0) + year)).getTime() / 1000;\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'terminate',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'terminate': any,\n};\n\ntype TNearAmount = string;\ntype TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TCheckpoint[],\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ drafts }, '200000000000000');\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number): Promise<void> {\n    try {\n      await (this.contract as TLockupContract).terminate(\n        { lockup_index: lockupIndex },\n        MAX_GAS,\n      );\n    } catch (e) {\n      throw Error('Cannot terminate lockup more than once');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    this.walletConnection.requestSignIn(this.near.config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TCheckpoint } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: {\n        account_id: string,\n        schedule: TCheckpoint[],\n        vesting_schedule: TCheckpoint[] | null,\n        claimed_balance: string,\n      },\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): void {\n    const { msg, ...rest } = meta;\n\n    this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n}\n\nexport default TokenApi;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport TokenApi from './tokenApi';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  signedIn: boolean;\n  isAdmin: boolean;\n  signedAccountId: string | null;\n  tokenApi: TokenApi;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  const tokenContractId = await api.getTokenAccountId();\n  const depositWhitelist = await api.getDepositWhitelist();\n  const isAdmin = depositWhitelist.includes(signedAccountId);\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  return {\n    config,\n    api,\n    noLoginApi,\n    signedIn: !!signedAccountId,\n    isAdmin,\n    signedAccountId,\n    tokenApi,\n  };\n};\n","import { config } from '../../config';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  return (\n    <div className=\"container\">\n      <h1>About Page</h1>\n\n      <pre>\n        {`\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ${config.contractName}\n          token account id: ${token_account_id}\n\n          Total number of lockups: ${lockups.length}\n        `}\n      </pre>\n\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function DraftsTableRow(props: { row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near;\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">{row.id}</TableCell>\n        <TableCell align=\"left\"><Link to={signedIn ? `/admin/lockups/${row.account_id}` : `/lockups/${row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={7}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div className=\"inner-table_wrapper\">\n                <h5>Lockup schedule</h5>\n                <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>DATE</TableCell>\n                      <TableCell>AMOUNT</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {row.schedule.map((x: any) => (\n                      <TableRow key={x.timestamp}>\n                        <TableCell component=\"th\" scope=\"row\">\n                          {convertTimestamp(x.timestamp)}\n                        </TableCell>\n                        <TableCell>\n                          {convertAmount(x.balance, token.decimals)}\n                          &nbsp;\n                          {token.symbol}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport DraftsTableRow from './row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function DraftsTable({ lockups, token }: { lockups: any[], token: TMetadata }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <DraftsTableRow key={lockup.id} row={lockup} token={token} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import BN from 'bn.js';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = parseInt(percentageRaw, 10);\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = parseTimestamp(timestampStartRaw);\n  const durationTotal = parseDuration(durationTotalRaw);\n  const cliffInfo = parseCliffInfo(cliffInfoRaw);\n  const releaseEvery = parseDuration(releaseEveryRaw);\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = {\n  account_id: string,\n  amount: string,\n  lockup_schedule: string,\n  vesting_schedule: string,\n  terminator_id: string,\n};\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n  terminator_id: NearAccountId | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const accountId = parseValidAccountId(input.account_id);\n  const amount = parseTokenAmount(input.amount);\n  const lockupSchedule = parseHumanFriendlySchedule(input.lockup_schedule);\n  const vestingSchedule = input.vesting_schedule === '' ? null : parseHumanFriendlySchedule(input.vesting_schedule);\n  let terminatorId = null;\n  if (vestingSchedule === null) {\n    if (input.terminator_id === '') {\n      terminatorId = null;\n    } else {\n      throw new Error('expected empty terminator_id for empty vesting_schedule');\n    }\n  } else if (input.terminator_id === '') {\n    throw new Error('expected present terminator_id for present vesting_schedule');\n  } else {\n    terminatorId = input.terminator_id;\n  }\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n    terminator_id: terminatorId,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = BN;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\ntype TerminationConfig = {\n  terminator_id: ValidAccountId,\n  vesting_schedule: {\n    Schedule: Schedule,\n  },\n};\n\nexport const buildTerminationConfig = (schedule: Schedule, terminator_id: ValidAccountId): TerminationConfig => ({\n  terminator_id,\n  vesting_schedule: {\n    Schedule: schedule,\n  },\n});\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new BN(10).pow(new BN(tokenDecimals));\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(inputTotalAmount).mul(decimalsMultiplier).clone();\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const checkpointStart = { timestamp: toUnix(timestampStart), balance: new BN('0') };\n  const checkpointPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0') };\n  const checkpointCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount };\n  const checkpointFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount };\n\n  const result = [];\n  result.unshift(checkpointFinish);\n  if (checkpointCliff.timestamp < checkpointFinish.timestamp) {\n    result.unshift(checkpointCliff);\n  }\n  result.unshift(checkpointPreCliff);\n  if (checkpointStart.timestamp < checkpointPreCliff.timestamp) {\n    result.unshift(checkpointStart);\n  }\n\n  return result;\n};\n\nexport type Lockup = {\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  claimed_balance: Balance,\n  termination_config: TerminationConfig | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  let terminationConfig;\n  if (row.vesting_schedule && row.terminator_id) {\n    terminationConfig = buildTerminationConfig(toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals), row.terminator_id);\n  } else {\n    terminationConfig = null;\n  }\n\n  return {\n    account_id: row.account_id,\n    schedule: toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals),\n    claimed_balance: new BN(0),\n    termination_config: terminationConfig,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x) => parseLockup(x, tokenDecimals));\n};\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport DraftsTable from '../DraftsTable';\nimport { parseRawSpreadsheetInput, Lockup } from '../../services/spreadsheetImport';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction ImportDraftGroup({ token }: { token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<Lockup[]>([]);\n  const [importLog, setImportLog] = useState<string[]>([]);\n\n  const log = (message: string) => {\n    console.log(message);\n    setImportLog((currentLog) => currentLog.concat([message]));\n  };\n\n  const clearLog = () => {\n    setImportLog([]);\n  };\n\n  console.log(setData);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInput(input, token.decimals);\n      setData(lockups);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const handleClickImport = async () => {\n    if (!near) {\n      throw new Error('near is null');\n    }\n    clearLog();\n    log('import started');\n    const draftGroupId = await near.api.createDraftGroup();\n    const msg = `created draft group id: ${draftGroupId}`;\n    log(msg);\n\n    const chunkSize = 100;\n    for (let i = 0; i < data.length; i += chunkSize) {\n      const chunk = data.slice(i, i + chunkSize);\n      log(`adding drafts from (${i}, ${i + chunk.length})`);\n      const drafts = chunk.map((lockup) => ({\n        draft_group_id: draftGroupId,\n        lockup,\n      }));\n      try {\n        const draftIds = await near.api.createDrafts(drafts);\n        log(`created drafts for from (${i}, ${i + chunk.length}): ${draftIds}`);\n      } catch (e) {\n        log(`ERROR: ${e}`);\n        throw e;\n      }\n    }\n\n    log('import finished');\n\n    navigate(`/admin/draft_groups/${draftGroupId}`);\n  };\n\n  return (\n    <div className=\"container\">\n      <h3>\n        Import Draft Group\n      </h3>\n      <div>\n        <TextareaAutosize\n          style={{ width: '100%' }}\n          id=\"spreadsheet-input\"\n          placeholder=\"Excel input\"\n          maxRows={5}\n          onChange={handleChangeInput}\n        />\n      </div>\n      <DraftsTable lockups={data} token={token} />\n      <br />\n      <div>\n        <button className=\"button fullWidth noMargin\" onClick={handleClickImport} type=\"button\">\n          Import\n        </button>\n      </div>\n      <br />\n      <pre id=\"import-log\">\n        {importLog.join('\\n')}\n      </pre>\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { useState, useEffect, useContext } from 'react';\nimport { useParams } from 'react-router-dom';\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PageDraftGroup({ token }: { token: TMetadata }) {\n  const draftGroupId = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n\n  console.log(token);\n  console.log(draftGroup);\n  console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroup(draftGroupId);\n      console.log(result);\n      setDraftGroup(result);\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup) {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      console.log(result);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  return (\n    <div className=\"container\">\n      <h1>\n        Draft group\n        {' '}\n        {draftGroupId}\n      </h1>\n      <div>\n        Total amount:\n        { convertAmount(draftGroup.total_amount, token.decimals) }\n      </div>\n      <div>\n        Funded:\n        { draftGroup.funded ? 'YES' : 'NO' }\n      </div>\n\n      <h3>Drafts</h3>\n\n      <DraftsTable lockups={drafts} token={token} />\n    </div>\n  );\n}\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link } from 'react-router-dom';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function PageDraftGroupsIndex({ token }: { token: TMetadata }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n  // const [drafts, setDrafts] = useState<any[]>([]);\n\n  // console.log(token);\n  // console.log(draftGroup);\n  // console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      console.log(result);\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  return (\n    <div className=\"container\">\n      <h1>\n        All draft groups\n      </h1>\n\n      <div>\n        Total count:\n        {draftGroups.length}\n      </div>\n\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"center\">Funded</TableCell>\n            <TableCell align=\"right\">Number&nbsp;of&nbsp;lockups</TableCell>\n            <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {draftGroups.map((group) => (\n            <TableRow>\n              <TableCell align=\"left\">\n                <Link to={`/admin/draft_groups/${group.id}`}>{group.id}</Link>\n              </TableCell>\n              <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n              <TableCell align=\"right\">{group.draft_indices.length}</TableCell>\n              <TableCell align=\"right\">{convertAmount(group.total_amount, token.decimals)}</TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n\n      <br />\n\n      <Link to=\"/admin/import_draft_group\">\n        <button className=\"button\" type=\"button\">ImportDraftGroup</button>\n      </Link>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TCheckpoint } from '../../services/api';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n\n    e.preventDefault();\n\n    const { account, amount } = e.target.elements;\n\n    console.log(account.value, amount.value);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const claimedBalance = '0';\n    const userAccountId = account.value;\n    const lockupTotalAmount = amount.value * 10 ** token.decimals;\n\n    const timestamp = (startDate?.getTime() || 0) / 1000;\n\n    const getScheduleList = (ts: number, date: Date | null, balance: number, selected: string) => {\n      const list: { [key: string]: TCheckpoint[] } = {\n        '4_year': [\n          { timestamp: ts, balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: (balance / 4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n        '4_year_vested': [\n          { timestamp: ts, balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: (balance / 4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n      return list[selected];\n    };\n\n    near.tokenApi.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: getScheduleList(timestamp, startDate, lockupTotalAmount, schedule),\n        vesting_schedule: schedule === '4_year_vested' ? getScheduleList(timestamp, startDate, lockupTotalAmount, schedule) : null,\n        claimed_balance: claimedBalance,\n      },\n    });\n  };\n\n  return (\n    <div>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n            />\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Start date\"\n                value={startDate}\n                onChange={(newValue) => {\n                  setStartDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction TerminateLockup(props: { lockupIndex: number | undefined, config: { terminator_id: String, vesting_schedule: [] | null } | null }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { lockupIndex, config } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  const { signedAccountId } = near;\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  console.log(config);\n\n  const handleTerminateLockup = () => {\n    near.api.terminate(lockupIndex);\n  };\n\n  return (\n    <button className=\"button red fullWidth\" disabled={!config || config.terminator_id !== signedAccountId} type=\"button\" onClick={handleTerminateLockup}>Terminate</button>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TerminateLockup from '../TerminateLockup';\n\nexport default function Row(props: { row: ReturnType<any>, token: TMetadata, adminControls: boolean }) {\n  const [open, setOpen] = useState(false);\n  const { row, token, adminControls } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">{row.id}</TableCell>\n        <TableCell align=\"left\"><Link to={`${row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={7}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div className=\"inner-table_wrapper\">\n                <h5>Lockup schedule</h5>\n                <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>DATE</TableCell>\n                      <TableCell>AMOUNT</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {row.schedule.map((x: any) => (\n                      <TableRow key={x.timestamp}>\n                        <TableCell component=\"th\" scope=\"row\">\n                          {convertTimestamp(x.timestamp)}\n                        </TableCell>\n                        <TableCell>\n                          {convertAmount(x.balance, token.decimals)}\n                          &nbsp;\n                          {token.symbol}\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n              {signedIn && isAdmin && adminControls && (\n                <div className=\"terminate\">\n                  <TerminateLockup lockupIndex={row.id} config={row.termination_config} />\n                </div>\n              )}\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable({ lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  Paper,\n  TableContainer,\n} from '@mui/material';\nimport { useContext } from 'react';\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  console.log('unique users', uniqueUsers);\n\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  return (\n    <div className=\"container\">\n\n      <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }} component={Paper}>\n        <LockupsTable lockups={lockups} token={token} adminControls={adminControls} />\n      </TableContainer>\n\n      {signedIn && adminControls && isAdmin && <CreateLockup token={token} />}\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, total: String }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { accountId, token, total } = params;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    near.noLoginApi.claim(accountId);\n  };\n\n  return (\n    <div className=\"claim-wrapper\">\n      <h5>Total available</h5>\n      <div className=\"claim-amount\">\n        {total}\n        <span>{token.symbol}</span>\n      </div>\n      <button className=\"button\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId } = useParams();\n\n  const lockups = allLockups.filter((x) => x.account_id === userId);\n\n  const totalUnclaimedBalance = lockups.reduce((acc, obj) => acc + parseFloat(obj.unclaimed_balance), 0);\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"container\">\n\n      {!adminControls && <ClaimAllLockups accountId={userId} token={token} total={convertAmount(totalUnclaimedBalance, token.decimals)} />}\n\n      <TableContainer sx={{ boxShadow: 'unset' }} component={Paper}>\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell />\n              <TableCell align=\"left\">ID</TableCell>\n              <TableCell align=\"left\">Account ID</TableCell>\n              <TableCell align=\"right\">Start&nbsp;date</TableCell>\n              <TableCell align=\"right\">End&nbsp;date</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              <TableCell align=\"center\">Progress</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {lockups.map((lockup) => (\n              <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n    </div>\n  );\n}\n","import { Link } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, signedAccountId, isAdmin } = near;\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to={adminControls && isAdmin ? '/admin/lockups' : '/lockups'}>Lockups</Link>\n            <Link className=\"nav-link\" to=\"/about\">About</Link>\n            {adminControls && (<Link className=\"nav-link\" to=\"/admin/draft_groups\">Draft Groups</Link>)}\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span>\n                {signedAccountId}\n                {' '}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return <div className=\"container login\">{children}</div>;\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  return (\n    <Auth>\n      { signedIn && !isAdmin && <Alert sx={{ margin: 2, width: '500px' }} severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { signedIn && isAdmin && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin } = near;\n\n  if (!signedIn || !isAdmin) {\n    return <Navigate to=\"/admin\" state={{ from: location }} replace />;\n  }\n\n  return children;\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\n\nfunction Customer({\n  lockups, token, contractId,\n}: { lockups: any[], token: TMetadata, contractId: string | null }) {\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"/lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={<Lockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({ lockups, token }: { lockups: any[], token: TMetadata }) {\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/lockups\" element={<RequireAuth><Lockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      load();\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  if (Object.keys(contractState).length === 0) return null;\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/*\" element={<Customer lockups={lockups} token={token} contractId={contractId} />} />\n        <Route path=\"/admin/*\" element={<Admin lockups={lockups} token={token} />} />\n      </Routes>\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    connect();\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        signedIn: false,\n        signedAccountId: null,\n      });\n    },\n  }), [near]);\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <App />\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}