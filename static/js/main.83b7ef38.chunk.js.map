{"version":3,"sources":["config.ts","utils.ts","services/api.ts","services/noLogInUsage.ts","services/noLoginApi.ts","services/NoLoginTokenApi.ts","services/tokenApi.ts","services/factoryApi.ts","services/DAOs/astroDAO/api.ts","services/DAOs/astroDAO/utils.ts","services/near.ts","pages/About/index.tsx","components/TokenIcon/index.tsx","components/ScheduleTable/index.tsx","components/DraftsTable/row.tsx","components/DraftsTable/index.tsx","services/spreadsheetImport.ts","components/ImportDraftGroup/index.tsx","components/TokenAmountPreview/index.tsx","components/FundButton/index.tsx","components/FundWithDaoButton/index.tsx","pages/PageDraftGroup/index.tsx","pages/PageDraftGroupsIndex/index.tsx","pages/NewLockupContract/index.tsx","components/CreateLockup/index.tsx","components/TerminateLockup/index.tsx","components/table/row.tsx","components/LockupsTable/index.tsx","components/FavouriteAccounts/index.tsx","pages/Lockups/index.tsx","components/ConfirmDialog/index.tsx","components/Claim/index.tsx","pages/UserLockups/index.tsx","components/Header/index.tsx","components/Authorize/index.tsx","components/PayForContractStorage/index.tsx","components/RequireAuth/index.tsx","assets/images/near.svg","components/Homepage/index.tsx","components/App/index.tsx","NearApp.tsx","index.tsx"],"names":["DEFAULT_CONTRACT_NAME","process","FACTORY_CONTRACT_NAME","FACTORY_CONTRACT_HASH","CONTRACT_NAME","contractNameFromUrl","window","location","hash","split","getCurrentContractName","console","log","config","env","REACT_APP_ENVIRONMENT","networkId","nodeUrl","contractName","walletUrl","helperUrl","explorerUrl","factoryContractName","factoryContractHash","Error","getConfig","MAX_GAS","Big","DP","PE","nearTo","value","digits","mode","div","toFixed","undefined","convertTimestamp","time","Date","toLocaleDateString","convertAmount","decimals","addYear","date","year","setFullYear","getFullYear","getTime","dumpLocalStorage","dumpKey","dumpValue","Object","keys","localStorage","map","key","getItem","setItem","JSON","stringify","restoreLocalStorage","data","parse","clear","forEach","record","txLinkInExplorer","txHash","LOCKUP_VIEW_METHODS","LOCKUP_CHANGE_METHODS","NearApi","near","contract","walletConnection","this","WalletConnection","Contract","account","viewMethods","changeMethods","a","get_draft_groups_paged","result","draftIndex","draft","assign","id","index","get_draft_group","indices","get_drafts","create_draft_group","create_draft","drafts","create_drafts","args","gas","convert_draft","draft_id","convert_drafts","draft_ids","lockupIndex","timestamp","terminate","lockup_index","termination_timestamp","amount","get_token_account_id","get_deposit_whitelist","get_lockups_paged","then","response","successUrl","href","requestSignIn","signOut","keyStore","getAccountId","acc_id","balance","getAccountBalance","b","total","parseFloat","utils","format","formatNearAmount","error","getFirstFullAccessKey","provider","accountId","query","request_type","account_id","finality","allAccessKeys","length","allFullAccessKeys","filter","access_key","permission","NoLoginApi","setWalletAndContractWithAuth","buildContract","claim","clean","connection","firstFullAccessKey","allKeys","public_key","TOKEN_VIEW_METHODS","TOKEN_CHANGE_METHODS","NoLoginTokenApi","tokenAccountId","storage_deposit","TokenApi","contractId","lockupContractId","lockupTotalAmount","userAccountId","lockupSchedule","vestingSchedule","ftTransferCall","receiver_id","toString","msg","schedule","vesting_schedule","Schedule","draftGroupId","draft_group_id","meta","deposit","rest","ft_transfer_call","ft_metadata","storage_balance_of","storage_balance_bounds","DEPLOY_DEPOSIT","mul","pow","FACTORY_CHANGE_METHODS","FactoryApi","name","depositWhitelist","callbackUrl","argsRaw","token_account_id","deposit_whitelist","argsPacked","btoa","create","access_keys","method_name","DAO_VIEW_METHODS","AstroDaoApi","get_policy","policy","canProposalRoles","roles","role","permissions","includes","canProposalGroups","kind","Group","flat","member","buildProposalFormLink","contractAddress","action","variant","details","smartContractAddress","methodName","json","actionsGas","actionDeposit","params","customFunctionCallProposalFormLink","daoCouncilMembers","accountAddress","api","getCouncilMembers","councilsMembers","NearContext","createContext","connectNear","nearAPI","BrowserLocalStorageKeyStore","headers","noLoginKeyStore","InMemoryKeyStore","noLoginNear","noLoginApi","noLoginTokenApi","signedAccountId","tokenContractId","isAdmin","isCouncilMember","getTokenAccountId","getDepositWhitelist","Promise","all","dwID","daosCouncilMembers","tokenApi","isContractFtStoragePaid","storageBalanceOf","storageBalance","factoryApi","rpcProvider","JsonRpcProvider","currentUser","signedIn","About","lockups","className","TokenIcon","url","size","style","height","width","verticalAlign","src","alt","ScheduleTable","title","token","Table","TableHead","TableRow","TableCell","align","TableBody","x","component","scope","symbol","icon","DraftsTableRow","props","useLocation","useState","open","setOpen","row","useContext","currentContractName","pathname","sx","borderBottom","IconButton","onClick","to","total_balance","claimed_balance","unclaimed_balance","background","padding","colSpan","Collapse","in","timeout","unmountOnExit","display","gap","DraftsTable","lockup","BN","prototype","toJSON","parseSpreadsheetColumns","input","lines","trim","table","line","columns","fromEntries","col","colIdx","parseDuration","pattern","match","groups","parseInt","month","week","day","hour","minute","second","parseHumanFriendlySchedule","parts","timestampStartRaw","durationTotalRaw","cliffInfoRaw","releaseEveryRaw","timestampStart","Number","isNaN","parseTimestamp","durationTotal","cliffInfo","durationRaw","percentageRaw","duration","percentage","parseCliffInfo","releaseEvery","durationCliff","percentageCliff","parseToSpreadsheetRow","isValid","parseValidAccountId","parseTokenAmount","lockup_schedule","datePlusDurationMul","mulInput","Math","floor","UTC","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","toUnix","toLockupSchedule","inputTotalAmount","tokenDecimals","decimalsMultiplier","timestampCliff","timestampPreCliff","timestampFinish","totalAmount","round","roundDown","cliffAmount","muln","divn","clone","gt","tmCliff","tmFirstStep","cpStart","cpPreCliff","cpCliff","cpFinish","unshift","tms","tm","push","increment","sub","cps","flatMap","i","stepBalance","add","cpsStart","concat","parseRawSpreadsheetInput","spreadsheetInput","rawSpreadsheetRow","parseLockup","ImportDraftGroup","setData","importProgress","setImportProgress","navigate","useNavigate","enqueueSnackbar","useSnackbar","withNotification","func","handleClickImport","createDraftGroup","chunkSize","chunk","slice","lockup_create","createDrafts","message","path","TextareaAutosize","marginTop","placeholder","maxRows","onChange","event","target","e","LoadingButton","disabled","loading","color","type","TokenAmountPreview","flex","alignContent","FundButton","draftGroupIndex","fundDraftGroup","getContract","FundWithDaoButton","defaultDescription","description","setDescription","astroDAOContractAddress","setAstroDAOContractAddress","handleClose","Dialog","minWidth","onClose","onSubmit","encodeURIComponent","tokenContractAddress","buildProposalLink","focus","DialogTitle","position","right","top","DialogContent","paddingTop","TextField","required","marginBottom","label","multiline","minRows","defaultValue","DialogActions","PageDraftGroup","useParams","draftGroup","setDraftGroup","setDrafts","inProgress","setInProgress","useEffect","fetchDraftGroup","getDraftGroup","fetchDrafts","getDrafts","draft_indices","total_amount","funded","convertDrafts","draftIds","reload","Alert","severity","PageDraftGroupsIndex","draftGroups","setDraftGroups","fetchDraftGroups","getDraftGroupsAll","importDraftGroupPath","group","NewLockupContract","signIn","Box","preventDefault","perform","lockupOperators","elements","lockup_operators","lockupSubaccountId","lockup_subaccount_id","origin","CreateLockup","startDate","setStartDate","setSchedule","handleCreateLockup","balanceInput","selected","schedules","getScheduleList","createLockup","maxWidth","margin","fullWidth","InputProps","endAdornment","InputAdornment","FormControl","Select","MenuItem","LocalizationProvider","dateAdapter","AdapterDateFns","DatePicker","newValue","renderInput","TerminateLockup","adminControls","setDate","payerMessage","handleTerminateLockup","ts","setTimeout","beneficiary_id","canTerminate","minDate","Row","termination_config","selectedAccountPage","pop","LockupsTable","FavouriteAccounts","favouriteAccounts","uniqueUsers","onSave","inputRef","useRef","handleSaveFavouriteAccounts","current","newFavouriteAccounts","replaceAll","paddingRight","join","onKeyPress","Lockups","Array","from","Set","favouriteAccountsFromLocalStorage","setFavouriteAccounts","favouriteAccountsLockups","restOfThePage","TableContainer","boxShadow","Paper","ConfirmDialog","isOpen","closeFn","callback","Button","ClaimAllLockups","isDialogOpen","setIsDialogOpen","dialogConfirmCallback","setDialogConfirmCallback","depositConfirmMessage","storageBalanceBounds","bounds","max","storageDeposit","UserLockups","allLockups","userId","totalUnclaimedBalance","reduce","acc","obj","Claim","Header","lockupsPageViewPolicy","Auth","children","Authorize","showAlertForUser","showLockups","replace","PayForContractStorage","RequireAuth","_path","_extends","arguments","source","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgNear","_ref","svgRef","titleId","viewBox","fill","xmlns","ref","d","ForwardRef","Homepage","address","setAddress","Customer","element","Admin","App","contractState","setContractState","setContractId","reference","reference_hash","spec","setToken","searchParams","URLSearchParams","search","transactionHashesRaw","get","txStatus","transaction","actions","FunctionCall","successValue","status","SuccessValue","atob","unpacked","txMsg","statusMessage","active","load","loadAllLockups","ftMetadata","metadata","SnackbarCloseButton","snackbarKey","closeSnackbar","NearApp","setNear","nearConn","connect","useMemo","Provider","autoHideDuration","URL","sp","delete","history","pushState","render","document","getElementById"],"mappings":"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","file":"static/js/main.83b7ef38.chunk.js","sourcesContent":["export interface INearConfig {\n  networkId: string,\n  nodeUrl: string,\n  contractName: string,\n  walletUrl: string,\n  helperUrl: string,\n  explorerUrl: string,\n  factoryContractName: string,\n  factoryContractHash: string,\n}\n\nexport const DEFAULT_CONTRACT_NAME = process.env.DEFAULT_CONTRACT_NAME || 'ft-lockup.demo008.ft-lockup.testnet';\nexport const FACTORY_CONTRACT_NAME = process.env.FACTORY_CONTRACT_NAME || 'factory008.ft-lockup.testnet';\nexport const FACTORY_CONTRACT_HASH = process.env.FACTORY_CONTRACT_HASH || 'DPDYZYHjRqLKZLGpvZYTLKudRrKWmN6a43Pc4MD2t9dg';\n\nconst getCurrentContractName = (): string => {\n  const contractNameFromUrl = window.location.hash.split('/')[1];\n  if (contractNameFromUrl === 'new_lockup_contract') return FACTORY_CONTRACT_NAME;\n\n  return contractNameFromUrl;\n};\n\nexport const CONTRACT_NAME = getCurrentContractName();\n\nconsole.log(CONTRACT_NAME);\n\n// TODO: move these data to envs\nfunction getConfig(): INearConfig {\n  const env = process.env.REACT_APP_ENVIRONMENT || 'development';\n  switch (env) {\n    case 'production':\n    case 'mainnet':\n      return {\n        networkId: 'mainnet',\n        nodeUrl: 'https://rpc.mainnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.near.org',\n        helperUrl: 'https://helper.mainnet.near.org',\n        explorerUrl: 'https://explorer.mainnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'development':\n    case 'testnet':\n      return {\n        networkId: 'testnet',\n        nodeUrl: 'https://rpc.testnet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.testnet.near.org',\n        helperUrl: 'https://helper.testnet.near.org',\n        explorerUrl: 'https://explorer.testnet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'betanet':\n      return {\n        networkId: 'betanet',\n        nodeUrl: 'https://rpc.betanet.near.org',\n        contractName: CONTRACT_NAME,\n        walletUrl: 'https://wallet.betanet.near.org',\n        helperUrl: 'https://helper.betanet.near.org',\n        explorerUrl: 'https://explorer.betanet.near.org',\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'local':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        networkId: 'local',\n        nodeUrl: 'http://localhost:3030',\n        walletUrl: 'http://localhost:4000/wallet',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'test':\n    case 'ci':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test',\n        nodeUrl: 'https://rpc.ci-testnet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    case 'ci-betanet':\n      return {\n        explorerUrl: '',\n        helperUrl: '',\n        walletUrl: '',\n        networkId: 'shared-test-staging',\n        nodeUrl: 'https://rpc.ci-betanet.near.org',\n        contractName: CONTRACT_NAME,\n        factoryContractName: FACTORY_CONTRACT_NAME,\n        factoryContractHash: FACTORY_CONTRACT_HASH,\n      };\n    default:\n      throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n  }\n}\n\nexport const config = getConfig();\n","import Big from 'big.js';\nimport { config } from './config';\n\nexport const MAX_GAS = 300_000_000_000_000;\nexport const ONE_YOCTO = 1;\n\nBig.DP = 40;\nBig.PE = 40;\nexport const NEAR_ROUND_DIGITS = 2;\n\nexport const toNear = (value: any) => Big(value).times(10 ** 24).round(0, Big.roundDown);\nexport const nearTo = (value: any, digits = NEAR_ROUND_DIGITS, mode?: number | undefined) => {\n  // default is 20, need at least 38 for proper rounding of any near balance\n  Big.DP = 40;\n  return Big(value || '0').div(10 ** 24).toFixed(digits === 0 ? undefined : digits, mode);\n};\nexport const nearToCeil = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundUp);\nexport const nearToFloor = (\n  value: any,\n  digits = NEAR_ROUND_DIGITS,\n) => nearTo(value, digits, Big.roundDown);\nexport const big = (value = '0') => Big(value);\nexport const tsNear2JS = (time: number) => Math.floor(time / 1000000);\nexport const convertTimestamp = (time: number) => new Date(time * 1000).toLocaleDateString('en-US');\nexport const convertAmount = (value: number, decimals: number) => Big(value || '0').div(10 ** decimals).toFixed(NEAR_ROUND_DIGITS);\n// @ts-ignore\nexport const addYear = (date: Date, year: number) => new Date(new Date(date).setFullYear((date.getFullYear()) + year)).getTime() / 1000;\n\nexport const dumpLocalStorage = (dumpKey: string = 'dump') => {\n  const dumpValue = Object.keys(localStorage).map((key) => [key, localStorage.getItem(key)]);\n\n  localStorage.setItem(dumpKey, JSON.stringify(dumpValue));\n};\n\nexport const restoreLocalStorage = (dumpKey: string = 'dump') => {\n  const data = localStorage.getItem(dumpKey);\n\n  if (!data) {\n    return;\n  }\n\n  const dumpValue = JSON.parse(data);\n\n  localStorage.clear();\n\n  dumpValue.forEach((record:string[]) => localStorage.setItem(record[0], record[1]));\n};\n\nexport const txLinkInExplorer = (txHash: string) => `${config.explorerUrl}/transactions/${txHash}`;\n","import {\n  Near, Account, Contract, WalletConnection, utils,\n} from 'near-api-js';\nimport { MAX_GAS, ONE_YOCTO } from '../utils';\n\nexport const fromNear = (amount: string): number => parseFloat(utils.format.formatNearAmount(amount || '0'));\nexport const toYoctoNear = (amount: number): string => utils.format.parseNearAmount(String(amount)) || '0';\n\nconst LOCKUP_VIEW_METHODS = [\n  'get_draft_group',\n  'get_draft_groups_paged',\n  'get_drafts',\n  'get_lockups_paged',\n  'get_token_account_id',\n  'get_deposit_whitelist',\n];\n\nconst LOCKUP_CHANGE_METHODS = [\n  'create_draft',\n  'create_drafts',\n  'create_draft_group',\n  'convert_draft',\n  'convert_drafts',\n  'terminate',\n];\n\ntype TViewMethods = {\n  'get_draft_group': any,\n  'get_draft_groups_paged': any,\n  'get_drafts': any,\n  'get_lockups_paged': any,\n  'get_token_account_id': any,\n  'get_deposit_whitelist': any,\n};\n\ntype TChangeMethods = {\n  'create_draft': any,\n  'create_drafts': any,\n  'create_draft_group': any,\n  'convert_draft': any,\n  'convert_drafts': any,\n  'terminate': any,\n};\n\nexport type TNearAmount = string;\nexport type TNearTimestamp = number;\n\nexport type TCheckpoint = {\n  timestamp: TNearTimestamp,\n  balance: TNearAmount,\n};\n\nexport type TSchedule = TCheckpoint[];\n\nexport type TLockup = {\n  id: number,\n  account_id: string,\n  claimed_balance: TNearAmount,\n  schedule: TSchedule,\n  timestamp: TNearTimestamp,\n  total_balance: TNearAmount,\n  unclaimed_balance: TNearAmount,\n};\n\nexport type TLockupContract = Contract & TViewMethods & TChangeMethods;\n\ntype Balance = string;\ntype DraftIndex = number;\ntype DraftGroupIndex = number;\ntype LockupIndex = number;\n\ntype DraftGroupView = {\n  total_amount: Balance,\n  funded: boolean,\n  draft_indices: DraftIndex[],\n};\n\ntype DraftView = {\n  draft_group_id: DraftGroupIndex,\n  lockup_id: LockupIndex | null,\n  lockup: TLockup,\n};\n\nclass NearApi {\n  private near: Near;\n\n  private contract: TLockupContract;\n\n  private walletConnection: WalletConnection;\n\n  constructor(near: Near) {\n    this.near = near;\n    this.walletConnection = new WalletConnection(near, near.config.contractName);\n    this.contract = new Contract(\n      this.walletConnection.account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n\n  async getDraftGroupsAll(): Promise<[DraftGroupView]> {\n    const result = await this.contract.get_draft_groups_paged();\n    return result.map(([draftIndex, draft]: [any, any]) => Object.assign(draft, { id: draftIndex }));\n  }\n\n  async getDraftGroup(index: number): Promise<DraftGroupView | null> {\n    const result = await this.contract.get_draft_group({ index });\n\n    return result;\n  }\n\n  async getDrafts(indices: number[]): Promise<Array<[DraftIndex, DraftView]>> {\n    const result = await this.contract.get_drafts({ indices });\n\n    return result;\n  }\n\n  async createDraftGroup(): Promise<DraftGroupIndex> {\n    const result = await this.contract.create_draft_group();\n    return result;\n  }\n\n  async createDraft(draft: any): Promise<DraftIndex> {\n    const result = await this.contract.create_draft({ draft });\n\n    return result;\n  }\n\n  async createDrafts(drafts: any[]): Promise<DraftIndex> {\n    const result = await this.contract.create_drafts({ args: { drafts }, gas: '200000000000000' });\n\n    return result;\n  }\n\n  async convertDraft(index: DraftIndex): Promise<LockupIndex> {\n    const result = await this.contract.convert_draft({ draft_id: index });\n\n    return result;\n  }\n\n  async convertDrafts(indices: DraftIndex[]): Promise<LockupIndex[]> {\n    const result = await this.contract.convert_drafts({ args: { draft_ids: indices }, gas: '200000000000000' });\n\n    return result;\n  }\n\n  async terminate(lockupIndex: number, timestamp: number | null): Promise<void> {\n    try {\n      const result = await this.contract.terminate({\n        args: { lockup_index: lockupIndex, termination_timestamp: timestamp },\n        gas: MAX_GAS,\n        amount: ONE_YOCTO,\n      });\n      return result;\n    } catch (e) {\n      console.log(e);\n      throw Error('Cannot terminate lockup');\n    }\n  }\n\n  getNear(): Near {\n    return this.near;\n  }\n\n  getWalletConnection(): WalletConnection {\n    return this.walletConnection;\n  }\n\n  getContract(): TLockupContract {\n    return this.contract as TLockupContract;\n  }\n\n  getTokenAccountId(): Promise<string> {\n    return (this.contract as TLockupContract).get_token_account_id();\n  }\n\n  getDepositWhitelist(): Promise<Array<string>> {\n    return (this.contract as TLockupContract).get_deposit_whitelist();\n  }\n\n  loadAllLockups(): Promise<TLockup[]> {\n    return (this.contract as TLockupContract).get_lockups_paged().then(\n      (response: any) => response.map(([id, data]: [number, any]) => Object.assign(data, { id })),\n    );\n  }\n\n  signIn(): void {\n    const successUrl = `${window.location.href}`;\n    this.walletConnection.requestSignIn(this.near.config.contractName, undefined, successUrl);\n  }\n\n  signOut(): void {\n    this.walletConnection.signOut();\n    this.near.config.keyStore.clear();\n  }\n\n  get_account_id(): string {\n    return this.walletConnection.getAccountId();\n  }\n\n  async account(acc_id: string): Promise<Account> {\n    return this.near.account(acc_id);\n  }\n\n  async get_balance(acc_id: string): Promise<number | null> {\n    const account = await this.account(acc_id);\n    let balance = null;\n    try {\n      const b = await account.getAccountBalance();\n      balance = fromNear(b.total);\n    } catch (e) {\n      console.error('Account not exist');\n    }\n    return balance;\n  }\n}\n\nexport default NearApi;\n","const getFirstFullAccessKey = async (provider: any, accountId: String): Promise<any> => {\n  const allAccessKeys = await provider.query({\n    request_type: 'view_access_key_list',\n    account_id: accountId,\n    finality: 'optimistic',\n  });\n\n  if (!allAccessKeys.keys?.length) {\n    throw Error('None of access keys was founded');\n  }\n\n  const allFullAccessKeys = allAccessKeys.keys.filter((key: any) => (typeof key?.access_key?.permission === 'string') && key?.access_key?.permission === 'FullAccess');\n\n  if (!allFullAccessKeys?.length) {\n    throw Error('None of full access keys was founded');\n  }\n\n  return allFullAccessKeys[0];\n};\n\nexport default getFirstFullAccessKey;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst LOCKUP_VIEW_METHODS = [''];\nconst LOCKUP_CHANGE_METHODS = ['claim'];\n\ntype TChangeMethods = {\n  'claim': any,\n};\n\ntype TLockupContract = Contract & TChangeMethods;\n\nclass NoLoginApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async claim(accountId: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract().claim({}, MAX_GAS);\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(): TLockupContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      this.near.config.contractName,\n      { viewMethods: LOCKUP_VIEW_METHODS, changeMethods: LOCKUP_CHANGE_METHODS },\n    ) as TLockupContract;\n  }\n}\n\nexport default NoLoginApi;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\nimport { MAX_GAS, dumpLocalStorage } from '../utils';\nimport getFirstFullAccessKey from './noLogInUsage';\n\nconst TOKEN_VIEW_METHODS = [''];\nconst TOKEN_CHANGE_METHODS = ['storage_deposit'];\n\ntype TChangeMethods = {\n  'storage_deposit': any,\n};\n\ntype TTokenContract = Contract & TChangeMethods;\n\nclass NoLoginTokenApi {\n  private near: Near;\n\n  constructor(near: Near) {\n    this.near = near;\n  }\n\n  async storageDeposit(tokenAccountId: string, accountId: string, amount: string): Promise<void> {\n    dumpLocalStorage();\n\n    await this.setWalletAndContractWithAuth(accountId);\n\n    await this.buildContract(tokenAccountId).storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n\n    this.near.config.keyStore.clean();\n  }\n\n  async setWalletAndContractWithAuth(\n    accountId: string,\n    contractName: string = this.near.config.contractName,\n  ): Promise<any> {\n    const firstFullAccessKey = await getFirstFullAccessKey(\n      this.near.connection.provider,\n      accountId,\n    );\n\n    localStorage.setItem(\n      `${contractName}_wallet_auth_key`,\n      JSON.stringify({ accountId, allKeys: [firstFullAccessKey.public_key] }),\n    );\n  }\n\n  buildContract(contractName: string): TTokenContract {\n    return new Contract(\n      (new WalletConnection(this.near, this.near.config.contractName)).account(),\n      contractName,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n}\n\nexport default NoLoginTokenApi;\n","import {\n  Contract, WalletConnection,\n} from 'near-api-js';\nimport { TSchedule } from './api';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst ONE_YOKTO = 1;\n\nconst TOKEN_VIEW_METHODS = [\n  'ft_metadata',\n  'storage_balance_of',\n  'storage_balance_bounds',\n];\n\nconst TOKEN_CHANGE_METHODS = [\n  'ft_transfer_call', // redirects to wallet\n  'storage_deposit',\n];\n\ntype TTokenChangeMethods = {\n  'ft_transfer_call': any,\n  'storage_deposit': any,\n};\n\ntype TTokenViewMethods = {\n  'ft_metadata': any,\n  'storage_balance_of': any,\n  'storage_balance_bounds': any,\n};\n\nexport type TMetadata = {\n  spec: string,\n  name: string,\n  symbol: string,\n  icon: string | null,\n  reference: string | null,\n  reference_hash: string | null,\n  decimals: number,\n};\n\ntype TLockupCreate = {\n  account_id: string,\n  schedule: TSchedule,\n  vesting_schedule: { Schedule: TSchedule } | null,\n};\n\ntype TDraftGroupFund = {\n  draft_group_id: number,\n};\n\ntype TTokenContract = Contract & TTokenChangeMethods & TTokenViewMethods;\n\nclass TokenApi {\n  private contract: TTokenContract;\n\n  constructor(walletConnection: WalletConnection, contractId: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: TOKEN_VIEW_METHODS, changeMethods: TOKEN_CHANGE_METHODS },\n    ) as TTokenContract;\n  }\n\n  getContract(): TTokenContract {\n    return this.contract;\n  }\n\n  async createLockup(\n    lockupContractId: string,\n    lockupTotalAmount: string,\n    userAccountId: string,\n    lockupSchedule: any[],\n    vestingSchedule: TSchedule | null,\n  ): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount: lockupTotalAmount.toString(),\n      msg: {\n        account_id: userAccountId,\n        schedule: lockupSchedule,\n        vesting_schedule: vestingSchedule ? { Schedule: vestingSchedule } : null,\n      },\n    });\n\n    return result;\n  }\n\n  async fundDraftGroup(lockupContractId: string, draftGroupId: number, amount: string): Promise<void> {\n    const result = await this.ftTransferCall({\n      receiver_id: lockupContractId,\n      amount,\n      msg: {\n        draft_group_id: draftGroupId,\n      },\n    });\n\n    return result;\n  }\n\n  async ftTransferCall(\n    meta: {\n      receiver_id: string,\n      amount: string,\n      msg: TLockupCreate | TDraftGroupFund,\n    },\n    gas = MAX_GAS,\n    deposit = ONE_YOKTO,\n  ): Promise<void> {\n    const { msg, ...rest } = meta;\n\n    await this.contract.ft_transfer_call(\n      { msg: JSON.stringify(msg), ...rest },\n      gas,\n      deposit,\n    );\n  }\n\n  storageDeposit(accountId: String, amount: String): Promise<any> {\n    return this.contract.storage_deposit({\n      args: { account_id: accountId },\n      gas: MAX_GAS,\n      amount,\n    });\n  }\n\n  ftMetadata(): Promise<TMetadata> {\n    return this.contract.ft_metadata({});\n  }\n\n  storageBalanceOf(accountId: String): Promise<String> {\n    return this.contract.storage_balance_of({ account_id: accountId });\n  }\n\n  storageBalanceBounds(): Promise<{ min: string, max: string }> {\n    return this.contract.storage_balance_bounds();\n  }\n}\n\nexport default TokenApi;\n","import Big from 'big.js';\n\nimport {\n  Contract, WalletConnection,\n} from 'near-api-js';\n\nconst MAX_GAS = 300_000_000_000_000;\nconst DEPLOY_DEPOSIT = new Big(4).mul(new Big(10).pow(24)).toString();\n\nconst FACTORY_CHANGE_METHODS = [\n  'create',\n];\n\ntype TFactoryChangeMethods = {\n  'create': (opts: {\n    args: { name: string, hash: string, access_keys: string[], method_name: string, args: string }, callbackUrl: string, amount: string | number, gas: string | number\n  }) => any,\n};\n\ntype TFactoryContract = Contract & TFactoryChangeMethods;\n\nclass FactoryApi {\n  private contract: TFactoryContract;\n\n  private hash: string;\n\n  constructor(walletConnection: WalletConnection, contractId: string, hash: string) {\n    this.contract = new Contract(\n      walletConnection.account(),\n      contractId,\n      { viewMethods: [], changeMethods: FACTORY_CHANGE_METHODS },\n    ) as TFactoryContract;\n    this.hash = hash;\n  }\n\n  getContract(): TFactoryContract {\n    return this.contract;\n  }\n\n  async create(name: string, tokenAccountId: string, depositWhitelist: string[], callbackUrl: string): Promise<void> {\n    const argsRaw = {\n      token_account_id: tokenAccountId,\n      deposit_whitelist: depositWhitelist,\n    };\n    const argsPacked = btoa(JSON.stringify(argsRaw));\n    const result = await this.contract.create({\n      args: {\n        name,\n        hash: this.hash,\n        access_keys: [],\n        method_name: 'new',\n        args: argsPacked,\n      },\n      callbackUrl,\n      gas: MAX_GAS,\n      amount: DEPLOY_DEPOSIT,\n    });\n\n    console.log(result);\n\n    return result;\n  }\n}\n\nexport default FactoryApi;\n","import {\n  Near, Contract, WalletConnection,\n} from 'near-api-js';\n\nconst FUNCTION_CALL_CREATE_PROPOSAL_PERMISSION = 'call:AddProposal';\n\nconst DAO_VIEW_METHODS = [\n  'get_policy',\n];\n\ntype TAstroDaoViewMethods = {\n  'get_policy': any,\n};\n\ntype TAstroDaoContract = Contract & TAstroDaoViewMethods;\n\nclass AstroDaoApi {\n  private near: Near;\n\n  private contract: TAstroDaoContract;\n\n  constructor(near: Near, contractId: string) {\n    this.near = near;\n    this.contract = new Contract(\n      (new WalletConnection(this.near, contractId)).account(),\n      contractId,\n      { viewMethods: DAO_VIEW_METHODS, changeMethods: [] },\n    ) as TAstroDaoContract;\n  }\n\n  getContract(): TAstroDaoContract {\n    return this.contract;\n  }\n\n  async getCouncilMembers(): Promise<string[]> {\n    const policy = await this.contract.get_policy();\n    const canProposalRoles = policy.roles.filter((role: any) => role?.permissions?.includes(FUNCTION_CALL_CREATE_PROPOSAL_PERMISSION));\n\n    if (canProposalRoles.length === 0) {\n      return [];\n    }\n\n    const canProposalGroups = canProposalRoles.map((role: any) => role?.kind?.Group);\n\n    return canProposalGroups.flat().filter((member: any) => member);\n  }\n}\n\nexport default AstroDaoApi;\n","import {\n  Near,\n} from 'near-api-js';\n\nimport AstroDaoApi from './api';\n\n// TODO move to the .env\nconst ASTRO_DAO_HOST = 'https://dev.app.astrodao.com';\n\nexport const MAX_GAS = '300';\nexport const ONE_YOKTO = '0.000000000000000000000001';\n\nexport const buildProposalFormLink = (\n  contractAddress: string,\n  action: string,\n  variant: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string,\n): string => {\n  const params = {\n    details,\n    smartContractAddress,\n    methodName,\n    json,\n    actionsGas,\n    gas,\n    deposit: actionDeposit,\n  };\n\n  return `${ASTRO_DAO_HOST}/dao/${contractAddress}/proposals?action=${action}&variant=${variant}&params=${JSON.stringify(params)}`;\n};\n\nexport const customFunctionCallProposalFormLink = (\n  contractAddress: string,\n  details: string,\n  smartContractAddress: string,\n  methodName: string,\n  json: any,\n  actionsGas: string,\n  actionDeposit: string,\n  gas: string = MAX_GAS,\n): string => buildProposalFormLink(\n  contractAddress,\n  'create_proposal',\n  'ProposeCustomFunctionCall',\n  details,\n  smartContractAddress,\n  methodName,\n  json,\n  actionsGas,\n  actionDeposit,\n  gas,\n);\n\nexport const daoCouncilMembers = async (near: Near, accountAddress: string): Promise<string[]> => {\n  try {\n    const api = new AstroDaoApi(near, accountAddress);\n    const councilsMembers = await api.getCouncilMembers();\n\n    return councilsMembers;\n  } catch (e) {\n    console.log('isDAO ERROR:', e);\n    return [];\n  }\n};\n\nconst utils = {\n  buildProposalFormLink,\n  customFunctionCallProposalFormLink,\n  daoCouncilMembers,\n};\n\nexport default utils;\n","import * as nearAPI from 'near-api-js';\nimport { createContext } from 'react';\nimport { config, INearConfig } from '../config';\nimport { restoreLocalStorage } from '../utils';\nimport NearApi from './api';\nimport NoLoginApi from './noLoginApi';\nimport NoLoginTokenApi from './NoLoginTokenApi';\nimport TokenApi from './tokenApi';\nimport FactoryApi from './factoryApi';\nimport { daoCouncilMembers } from './DAOs/astroDAO/utils';\n\nexport interface INearProps {\n  config: INearConfig;\n  api: NearApi;\n  noLoginApi: NoLoginApi\n  currentUser: {\n    signedIn: boolean;\n    isAdmin: boolean;\n    isCouncilMember: boolean;\n    signedAccountId: string | null;\n  }\n  tokenContractId: string;\n  lockupContractId: string;\n  tokenApi: TokenApi;\n  noLoginTokenApi: NoLoginTokenApi;\n  factoryApi: FactoryApi;\n  rpcProvider: nearAPI.providers.JsonRpcProvider;\n  isContractFtStoragePaid: boolean;\n}\n\nexport const NearContext = createContext<any>(null);\n\nexport const connectNear = async (): Promise<INearProps> => {\n  if (localStorage.getItem('dump')) {\n    restoreLocalStorage();\n  }\n\n  const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n  const near = await nearAPI.connect({ headers: {}, keyStore, ...config });\n  const api = new NearApi(near);\n\n  const noLoginKeyStore = new nearAPI.keyStores.InMemoryKeyStore();\n  const noLoginNear = await nearAPI.connect({ headers: {}, keyStore: noLoginKeyStore, ...config });\n  const noLoginApi = new NoLoginApi(noLoginNear);\n  const noLoginTokenApi = new NoLoginTokenApi(noLoginNear);\n\n  const walletConnection = new nearAPI.WalletConnection(near, config.contractName);\n  const signedAccountId = walletConnection.getAccountId();\n  let tokenContractId: string = '';\n  let isAdmin: boolean = false;\n  let depositWhitelist: string[] = [];\n  let isCouncilMember: boolean = false;\n  try {\n    tokenContractId = await api.getTokenAccountId();\n    depositWhitelist = await api.getDepositWhitelist();\n    console.log('depositWhitelist', depositWhitelist);\n    isAdmin = depositWhitelist.includes(signedAccountId);\n    console.log('isAdmin', isAdmin);\n    const daosCouncilMembers = (await Promise.all(depositWhitelist.map((dwID):Promise<string[]> => daoCouncilMembers(near, dwID)))).flat();\n    console.log('councilMembers', daosCouncilMembers);\n    isCouncilMember = daosCouncilMembers.includes(signedAccountId);\n    console.log('isCouncilMember', isCouncilMember);\n  } catch (e) {\n    console.log(e);\n  }\n  const tokenApi = new TokenApi(walletConnection, tokenContractId);\n\n  let isContractFtStoragePaid = false;\n  const lockupContractId = window.location.hash.split('/')[1];\n\n  try {\n    const storageBalance = await tokenApi.storageBalanceOf(lockupContractId);\n    isContractFtStoragePaid = (storageBalance !== null) && true;\n    console.log(isContractFtStoragePaid);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const factoryApi = new FactoryApi(\n    walletConnection,\n    config.factoryContractName,\n    config.factoryContractHash,\n  );\n\n  const rpcProvider = new nearAPI.providers.JsonRpcProvider(\n    config.nodeUrl,\n  );\n\n  return {\n    config,\n    api,\n    tokenContractId,\n    noLoginApi,\n    tokenApi,\n    factoryApi,\n    currentUser: {\n      signedIn: !!signedAccountId,\n      isAdmin,\n      isCouncilMember,\n      signedAccountId,\n    },\n    noLoginTokenApi,\n    rpcProvider,\n    isContractFtStoragePaid,\n    lockupContractId,\n  };\n};\n","import { config } from '../../config';\n\nexport default function About(\n  { lockups, token_account_id }: { lockups: any[], token_account_id: string | null },\n) {\n  return (\n    <div className=\"container\">\n      <h1>About Page</h1>\n\n      <pre>\n        {`\n          This page should render all useful info about contract,\n          at least ft-lockup name, token name, contract ft balance,\n\n          ft-lockup account id: ${config.contractName}\n          token account id: ${token_account_id}\n\n          Total number of lockups: ${lockups.length}\n        `}\n      </pre>\n\n    </div>\n  );\n}\n","export default function TokenIcon(params: { url: string, size: number }) {\n  const { url, size } = params;\n  return (\n    <img\n      style={{\n        height: size, width: size, verticalAlign: 'middle',\n      }}\n      src={url}\n      alt=\"Token Icon\"\n    />\n  );\n}\n","import {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { TSchedule } from '../../services/api';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport TokenIcon from '../TokenIcon';\n\nexport default function ScheduleTable(params: { token: TMetadata, title: String, schedule: TSchedule }) {\n  const { schedule, title, token } = params;\n\n  return (\n    <div className=\"inner-table_wrapper\">\n      <h5>{title}</h5>\n      <Table className=\"inner-table\" size=\"small\" aria-label=\"purchases\">\n        <TableHead>\n          <TableRow>\n            <TableCell>DATE</TableCell>\n            <TableCell align=\"right\">AMOUNT</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {schedule.map((x: any) => (\n            <TableRow key={x.timestamp}>\n              <TableCell component=\"th\" scope=\"row\">\n                {convertTimestamp(x.timestamp)}\n              </TableCell>\n              <TableCell align=\"right\">\n                {convertAmount(x.balance, token.decimals)}\n                &nbsp;\n                {token.symbol}\n                &nbsp;\n                <TokenIcon url={token.icon || ''} size={32} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\n\nexport default function DraftsTableRow(props: { row: ReturnType<any>, token: TMetadata }) {\n  const location = useLocation();\n  const [open, setOpen] = useState(false);\n  const { row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn } = near.currentUser;\n\n  const vestingSchedule = row?.vesting_schedule?.Schedule;\n\n  const currentContractName = location.pathname.split('/')[1];\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">{row.id}</TableCell>\n        <TableCell align=\"left\">\n          <Link to={signedIn ? `${currentContractName}/admin/lockups/${row.account_id}` : `${currentContractName}/lockups/${row.account_id}`}>\n            {row.account_id}\n          </Link>\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div style={{ display: 'flex', gap: 20 }}>\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                  <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport DraftsTableRow from './row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function DraftsTable({ lockups, token }: { lockups: any[], token: TMetadata }) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <DraftsTableRow key={lockup.id} row={lockup} token={token} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import BN from 'bn.js';\nimport Big from 'big.js';\n\n// TODO: replace with cleaner hack or another library\nBN.prototype.toJSON = function toJSON() {\n  return this.toString();\n};\n\nexport const parseSpreadsheetColumns = (input: string): any[] => {\n  const colSep = '\\t';\n  const rowSep = '\\n';\n  const lines = input.trim().split(rowSep);\n  if (lines.length <= 1) {\n    return [];\n  }\n  const table = lines.map((line) => line.split(colSep).map((x) => x.trim()));\n  const [columns, ...rowsSplit] = table;\n\n  const rowsParsed = rowsSplit.map((row) => Object.fromEntries(\n    columns.map((col, colIdx) => [col, row[colIdx] || '']),\n  ));\n\n  return rowsParsed;\n};\n\ntype NearAccountId = string;\n\nexport const parseValidAccountId = (accountId: string): ValidAccountId => {\n  let isValid = true;\n  if (accountId.length < 2) isValid = false;\n  if (accountId.length > 64) isValid = false;\n  if (!accountId.match(/^[a-z0-9._-]+$/)) isValid = false;\n\n  if (isValid) {\n    return accountId;\n  }\n  throw new Error('invalid near account id');\n};\n\ntype TokenAmount = string;\n\nexport const parseTokenAmount = (amount: string): TokenAmount => {\n  if (amount.match(/^[0-9]+(\\.[0-9]+)?$/)) {\n    return amount;\n  }\n  throw new Error('invalid token amount');\n};\n\nexport const parseTimestamp = (timestamp: string): Date => {\n  if (!timestamp.match(/\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\dZ/)) {\n    throw new Error('invalid timestamp');\n  }\n  const result = new Date(timestamp);\n  if (Number.isNaN(result.getTime())) {\n    throw new Error('invalid timestamp');\n  }\n\n  return result;\n};\n\ntype IsoDuration = {\n  year: number,\n  month: number,\n  week: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n};\n\nexport const parseDuration = (input: string): IsoDuration => {\n  // const pattern = /^(P(\\d+Y)?(\\d+M)?(\\d+D)?T(\\d+H)?(\\d+M)?(\\d+S)?|P(\\d+W))$/;\n  const pattern = /^P(((((?<year>\\d+)Y)?((?<month>\\d+)M)?((?<day>\\d+)D)?)(T((?<hour>\\d+)H)?((?<minute>\\d+)M)?((?<second>\\d+)S)?)?)|((?<week>\\d+)W)?)$/;\n  const match = input.match(pattern);\n  if (!match) {\n    throw new Error('invalid duration');\n  }\n\n  const groups = match && match.groups || {};\n  const result = {\n    year: parseInt(groups.year, 10) || 0,\n    month: parseInt(groups.month, 10) || 0,\n    week: parseInt(groups.week, 10) || 0,\n    day: parseInt(groups.day, 10) || 0,\n    hour: parseInt(groups.hour, 10) || 0,\n    minute: parseInt(groups.minute, 10) || 0,\n    second: parseInt(groups.second, 10) || 0,\n  };\n\n  return result;\n};\n\ntype CliffInfo = {\n  duration: IsoDuration,\n  percentage: number,\n};\n\nexport const parseCliffInfo = (input: string): CliffInfo => {\n  const parts = input.split(':');\n  if (parts.length !== 2) {\n    throw new Error('expected 2 parts');\n  }\n  const [durationRaw, percentageRaw] = parts;\n  const duration = parseDuration(durationRaw);\n  const percentage = parseInt(percentageRaw, 10);\n  if (percentage < 0 || percentage > 100) {\n    throw new Error('invalid cliff percentage');\n  }\n  return { duration, percentage };\n};\n\ntype HumanFriendlySchedule = {\n  timestampStart: Date,\n  durationTotal: IsoDuration,\n  durationCliff: IsoDuration,\n  percentageCliff: number,\n  releaseEvery: IsoDuration,\n};\n\nexport const parseHumanFriendlySchedule = (schedule: string): HumanFriendlySchedule => {\n  const parts = schedule.split('|');\n  if (parts.length !== 4) {\n    throw new Error('invalid human friendly schedule, expected 4 parts');\n  }\n\n  const [\n    timestampStartRaw,\n    durationTotalRaw,\n    cliffInfoRaw,\n    releaseEveryRaw,\n  ] = parts;\n\n  const timestampStart = parseTimestamp(timestampStartRaw);\n  const durationTotal = parseDuration(durationTotalRaw);\n  const cliffInfo = parseCliffInfo(cliffInfoRaw);\n  const releaseEvery = parseDuration(releaseEveryRaw);\n\n  return {\n    timestampStart,\n    durationTotal,\n    durationCliff: cliffInfo.duration,\n    percentageCliff: cliffInfo.percentage,\n    releaseEvery,\n  };\n};\n\ntype RawSpreadsheetRow = {\n  account_id: string,\n  amount: string,\n  lockup_schedule: string,\n  vesting_schedule: string,\n};\n\ntype SpreadsheetRow = {\n  account_id: NearAccountId,\n  amount: TokenAmount,\n  lockup_schedule: HumanFriendlySchedule,\n  vesting_schedule: HumanFriendlySchedule | null,\n};\n\nexport const parseToSpreadsheetRow = (input: RawSpreadsheetRow): SpreadsheetRow => {\n  const accountId = parseValidAccountId(input.account_id);\n  const amount = parseTokenAmount(input.amount);\n  const lockupSchedule = parseHumanFriendlySchedule(input.lockup_schedule);\n  const vestingSchedule = input.vesting_schedule === '' ? null : parseHumanFriendlySchedule(input.vesting_schedule);\n\n  return {\n    account_id: accountId,\n    amount,\n    lockup_schedule: lockupSchedule,\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseSpreadsheetToSpreadsheetRows = (input: string): SpreadsheetRow[] => {\n  const parsedStringRows = parseSpreadsheetColumns(input);\n\n  return parsedStringRows.map((x) => parseToSpreadsheetRow(x));\n};\n\ntype ValidAccountId = string;\ntype TimestampSec = number;\ntype Balance = string;\ntype Checkpoint = {\n  timestamp: TimestampSec,\n  balance: Balance,\n};\ntype Schedule = Checkpoint[];\n\nexport const datePlusDurationMul = (date: Date, duration: IsoDuration, mulInput: number): Date => {\n  const mul = Math.floor(mulInput);\n  const result = new Date(Date.UTC(\n    date.getUTCFullYear() + duration.year * mul,\n    date.getUTCMonth() + duration.month * mul,\n    date.getUTCDate() + (duration.week * 7 + duration.day) * mul,\n    date.getUTCHours() + duration.hour * mul,\n    date.getUTCMinutes() + duration.minute * mul,\n    date.getUTCSeconds() + duration.second * mul,\n  ));\n  return result;\n};\n\nexport const toUnix = (date: Date | string) => Math.floor(new Date(date).getTime() / 1000);\n\nexport const toLockupSchedule = (schedule: HumanFriendlySchedule, inputTotalAmount: TokenAmount, tokenDecimals: number): Schedule => {\n  if (!(tokenDecimals >= 0 && tokenDecimals === Math.floor(tokenDecimals))) {\n    throw new Error('invalid token decimals');\n  }\n  const decimalsMultiplier = new Big(10).pow(tokenDecimals);\n\n  const { timestampStart } = schedule;\n  const timestampCliff = datePlusDurationMul(timestampStart, schedule.durationCliff, 1);\n  const timestampPreCliff = datePlusDurationMul(timestampCliff, parseDuration('PT1S'), -1);\n  const timestampFinish = datePlusDurationMul(timestampStart, schedule.durationTotal, 1);\n\n  // clone normalizes internal structure, needed for unit test equality\n  const totalAmount = new BN(new Big(inputTotalAmount).mul(decimalsMultiplier).round(0, Big.roundDown).toString());\n  const cliffAmount = new BN(totalAmount).muln(schedule.percentageCliff).divn(100).clone();\n\n  if (cliffAmount.gt(totalAmount)) {\n    throw new Error('error: cliffAmount > totalAmount');\n  }\n  if (timestampCliff > timestampFinish) {\n    throw new Error('error: timestampCliff > timestampFinish');\n  }\n  if (timestampCliff < timestampStart) {\n    throw new Error('error: timestampPreCliff < timestampStart');\n  }\n\n  const { releaseEvery } = schedule;\n\n  const tmCliff = timestampCliff;\n  const tmFirstStep = datePlusDurationMul(timestampCliff, releaseEvery, 1);\n  if (toUnix(tmFirstStep) <= toUnix(tmCliff)) {\n    throw new Error('invalid releaseEvery, zero duration');\n  }\n  if (toUnix(tmFirstStep) - toUnix(tmCliff) === 1) { // linear unlock during cliff\n    const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n    const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n    const cpCliff = { timestamp: toUnix(timestampCliff), balance: cliffAmount.toString() };\n    const cpFinish = { timestamp: toUnix(timestampFinish), balance: totalAmount.toString() };\n\n    const result = [];\n    result.unshift(cpFinish);\n    if (cpCliff.timestamp < cpFinish.timestamp) {\n      result.unshift(cpCliff);\n    }\n    result.unshift(cpPreCliff);\n    if (cpStart.timestamp < cpPreCliff.timestamp) {\n      result.unshift(cpStart);\n    }\n\n    return result;\n  }\n\n  const tms = [];\n  {\n    // otherwise: use steps\n    let tm = timestampCliff;\n    const maxSteps = 100;\n    for (;;) {\n      if (tm >= timestampFinish) {\n        tm = timestampFinish;\n        tms.push(tm);\n        break;\n      }\n      tms.push(tm);\n      tm = datePlusDurationMul(tm, releaseEvery, 1);\n      if (tms.length >= maxSteps) {\n        throw new Error('too many checkpoints for schedule');\n      }\n    }\n  }\n\n  const increment = totalAmount.sub(cliffAmount).divn(tms.length - 1);\n\n  const cps: Checkpoint[] = tms.flatMap((tm, i) => {\n    if (tms.length === 1) {\n      return [{ timestamp: toUnix(timestampFinish), balance: totalAmount.toString() }];\n    }\n    if (i === 0) {\n      return [{ timestamp: toUnix(tm), balance: cliffAmount.toString() }];\n    }\n    const stepBalance = i === tms.length - 1\n      ? totalAmount\n      : cliffAmount.add(increment.muln(i)).toString();\n    return [\n      { timestamp: toUnix(tm) - 1, balance: cliffAmount.add(increment.muln(i - 1)).toString() },\n      { timestamp: toUnix(tm), balance: stepBalance.toString() },\n    ];\n  });\n\n  const cpsStart: Checkpoint[] = [];\n  const cpStart = { timestamp: toUnix(timestampStart), balance: new BN('0').toString() };\n  const cpPreCliff = { timestamp: toUnix(timestampPreCliff), balance: new BN('0').toString() };\n\n  cpsStart.unshift(cpPreCliff);\n  if (cpStart.timestamp < cpPreCliff.timestamp) {\n    cpsStart.unshift(cpStart);\n  }\n\n  const result = cpsStart.concat(cps);\n  return result;\n};\n\nexport type Lockup = {\n  account_id: ValidAccountId,\n  schedule: Schedule,\n  vesting_schedule: { Schedule: Schedule } | null,\n};\n\nexport const parseLockup = (rawSpreadsheetRow: RawSpreadsheetRow, tokenDecimals: number): Lockup => {\n  const row = parseToSpreadsheetRow(rawSpreadsheetRow);\n\n  let vestingSchedule = null;\n\n  if (row.vesting_schedule) {\n    vestingSchedule = { Schedule: toLockupSchedule(row.vesting_schedule, row.amount, tokenDecimals) };\n  }\n\n  return {\n    account_id: row.account_id,\n    schedule: toLockupSchedule(row.lockup_schedule, row.amount, tokenDecimals),\n    vesting_schedule: vestingSchedule,\n  };\n};\n\nexport const parseRawSpreadsheetInput = (spreadsheetInput: string, tokenDecimals: number): Lockup[] => {\n  const rows = parseSpreadsheetColumns(spreadsheetInput);\n  return rows.map((x) => parseLockup(x, tokenDecimals));\n};\n","import { TextareaAutosize } from '@mui/material';\nimport { useContext, useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport { LoadingButton } from '@mui/lab';\n\nimport DraftsTable from '../DraftsTable';\nimport { parseRawSpreadsheetInput, Lockup } from '../../services/spreadsheetImport';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction ImportDraftGroup({ token }: { token: TMetadata }) {\n  const location = useLocation();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const [data, setData] = useState<Lockup[]>([]);\n  const [importProgress, setImportProgress] = useState<boolean>(false);\n\n  const handleChangeInput = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    try {\n      if (!near?.currentUser?.signedAccountId) {\n        throw new Error('expected present signedAccountId');\n      }\n      console.log(token);\n      const input = event.target.value;\n      const lockups = parseRawSpreadsheetInput(input, token.decimals);\n      setData(lockups);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(e);\n      }\n    }\n  };\n\n  const navigate = useNavigate();\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleClickImport = async () => {\n    try {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      setImportProgress(true);\n      const draftGroupId = await withNotification(\n        'Create draft group',\n        async () => {\n          const result = await near.api.createDraftGroup();\n          return result;\n        },\n      );\n      const msg = `Created draft group id: ${draftGroupId}`;\n      enqueueSnackbar(msg, { variant: 'success' });\n\n      const chunkSize = 100;\n      for (let i = 0; i < data.length; i += chunkSize) {\n        const chunk = data.slice(i, i + chunkSize);\n        const drafts = chunk.map((lockup) => ({\n          draft_group_id: draftGroupId,\n          lockup_create: lockup,\n        }));\n        await withNotification(\n          'Create drafts',\n          async () => {\n            const result = await near.api.createDrafts(drafts);\n            return result;\n          },\n        );\n      }\n\n      const message = `Created ${data.length} draft${data.length > 1 ? 's' : ''}.`;\n      enqueueSnackbar(message, { variant: 'success' });\n\n      const currentContractName = location.pathname.split('/')[1];\n      const path = `/${currentContractName}/admin/draft_groups/${draftGroupId}`;\n\n      navigate(path);\n    } catch (e) {\n      setImportProgress(false);\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <h3>\n        Import Draft Group\n      </h3>\n      <div>\n        Copy lockups from a spreadsheet editor and paste into the area below.\n        See\n        {' '}\n        <a href={`${process.env.PUBLIC_URL}/lockup_import_example.xlsx`}>\n          example and format specifications\n        </a>\n        .\n      </div>\n      <div>\n        <TextareaAutosize\n          style={{ width: '100%', marginTop: 20 }}\n          id=\"spreadsheet-input\"\n          placeholder=\"Excel input\"\n          maxRows={5}\n          onChange={handleChangeInput}\n        />\n      </div>\n      <DraftsTable lockups={data} token={token} />\n      <br />\n      <div>\n        <LoadingButton\n          disabled={!(data.length >= 1 && !importProgress)}\n          loading={importProgress}\n          onClick={handleClickImport}\n          color=\"success\"\n          type=\"button\"\n          variant=\"contained\"\n        >\n          Import\n        </LoadingButton>\n      </div>\n    </div>\n  );\n}\nexport default ImportDraftGroup;\n","import { TMetadata } from '../../services/tokenApi';\nimport TokenIcon from '../TokenIcon';\n\nexport default function TokenAmountPreview(params: { token: TMetadata, amount: String }) {\n  const { token, amount } = params;\n\n  return (\n    <div className=\"balance-info-block\" style={{ display: 'flex' }}>\n      <div style={{ flex: 1, alignContent: 'center' }} className=\"amount-info\">\n        <div className=\"token-symbol\">\n          {token.symbol}\n        </div>\n        <div className=\"token-amount\">\n          {amount}\n        </div>\n      </div>\n      <div style={{ flex: 1 }}>\n        <TokenIcon url={token.icon || ''} size={64} />\n      </div>\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction FundButton(props: { draftGroupIndex: number | undefined, amount: string | undefined }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (draftGroupIndex === undefined) {\n    throw Error('Cannot fund draft group without index');\n  }\n\n  if (amount === undefined) {\n    throw Error('Cannot fund draft group without specified amount');\n  }\n\n  const handleFund = () => {\n    near.tokenApi.fundDraftGroup(\n      near.api.getContract().contractId,\n      draftGroupIndex,\n      amount,\n    );\n  };\n\n  return (\n    <button className=\"button fullWidth\" type=\"button\" onClick={handleFund}>Fund</button>\n  );\n}\n\nexport default FundButton;\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  TextField,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { customFunctionCallProposalFormLink, ONE_YOKTO } from '../../services/DAOs/astroDAO/utils';\n\nfunction FundWithDaoButton(props: { draftGroupIndex: number | undefined, amount: string | undefined }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { draftGroupIndex, amount } = props;\n\n  const defaultDescription = `Fund draft group ${draftGroupIndex} with amount ${amount}. Draft group link: ${window.location.href}`;\n  const [description, setDescription] = useState(defaultDescription);\n  const [astroDAOContractAddress, setAstroDAOContractAddress] = useState('');\n\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (draftGroupIndex === undefined) {\n    throw Error('Cannot fund draft group without index');\n  }\n\n  if (amount === undefined) {\n    throw Error('Cannot fund draft group without specified amount');\n  }\n\n  const buildProposalLink = (): string => {\n    const details = encodeURIComponent(description);\n    const tokenContractAddress = near.tokenApi.getContract().contractId;\n    const methodName = 'ft_transfer_call';\n    const json = {\n      receiver_id: near.api.getContract().contractId,\n      amount,\n      msg: JSON.stringify({ draft_group_id: draftGroupIndex }),\n    };\n    const actionsGas = '100'; // with this amount transaction completes in one go (without resubmit with additional gas)\n    const actionDeposit = ONE_YOKTO;\n\n    return customFunctionCallProposalFormLink(\n      astroDAOContractAddress,\n      details,\n      tokenContractAddress,\n      methodName,\n      json,\n      actionsGas,\n      actionDeposit,\n    );\n  };\n\n  const handleContractAddressChange = (e: any) => {\n    setAstroDAOContractAddress(e.target.value);\n  };\n\n  const handleDescriptionChange = (e: any) => {\n    setDescription(e.target.value);\n  };\n\n  const handleFund = () => {\n    window.open(buildProposalLink(), '_blank')?.focus();\n  };\n\n  return (\n    <div>\n      <button className=\"button fullWidth\" type=\"button\" onClick={handleOpen}>Fund with DAO</button>\n      <Dialog open={open} sx={{ padding: 1, minWidth: 1 / 3 }} onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleFund}>\n          <DialogTitle>\n            Fund with DAO\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent style={{ paddingTop: '1.25em' }}>\n            <TextField\n              required\n              sx={{ marginBottom: 3, width: 1 }}\n              id=\"outlined-helperText\"\n              label=\"DAO contract address\"\n              onChange={handleContractAddressChange}\n            />\n            <TextField\n              sx={{ width: 1 }}\n              id=\"outlined-multiline-static\"\n              label=\"Proposal description\"\n              multiline\n              minRows={5}\n              onChange={handleDescriptionChange}\n              defaultValue={description}\n            />\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button className=\"button fullWidth noMargin\" type=\"submit\">Fund</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default FundWithDaoButton;\n","import { useState, useEffect, useContext } from 'react';\nimport { Alert } from '@mui/material';\nimport { useNavigate, useParams, useLocation } from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport { LoadingButton } from '@mui/lab';\n\nimport DraftsTable from '../../components/DraftsTable';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport TokenAmountPreview from '../../components/TokenAmountPreview';\nimport FundButton from '../../components/FundButton';\nimport FundWithDaoButton from '../../components/FundWithDaoButton';\n\nexport default function PageDraftGroup({ token }: { token: TMetadata }) {\n  const location = useLocation();\n  const { enqueueSnackbar } = useSnackbar();\n  const draftGroupId = parseInt(useParams().draftGroupId || '', 10);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroup, setDraftGroup] = useState<any>(null);\n  const [drafts, setDrafts] = useState<any[]>([]);\n  const [inProgress, setInProgress] = useState<boolean>(false);\n\n  console.log(token);\n  console.log(draftGroup);\n  console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroup = async () => {\n      setDraftGroup(null);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroup(draftGroupId);\n      console.log(result);\n      setDraftGroup(result);\n    };\n\n    fetchDraftGroup(); // .catch(console.error);\n  }, [near, draftGroupId]);\n\n  useEffect(() => {\n    const fetchDrafts = async () => {\n      setDrafts([]);\n      console.log('fetchDrafts called');\n      if (!near) {\n        return;\n      }\n      if (!draftGroup) {\n        return;\n      }\n      const result = await near.api.getDrafts(draftGroup.draft_indices);\n      console.log(result);\n      setDrafts(result.map((x: any) => Object.assign(x[1].lockup_create, { id: x[0] })));\n    };\n\n    fetchDrafts(); // .catch(console.error);\n  }, [near, draftGroup]);\n\n  const navigate = useNavigate();\n\n  const withNotification = async (name: string, func: () => any): Promise<any> => {\n    try {\n      const result = await func();\n      return result;\n    } catch (e) {\n      enqueueSnackbar(`${name} failed with error: '${e}'`, { variant: 'error' });\n      throw e;\n    }\n  };\n\n  const handleConvert = () => {\n    const convertDrafts = async () => {\n      if (!near) {\n        throw new Error('near is null');\n      }\n      try {\n        setInProgress(true);\n        const draftIds = draftGroup.draft_indices;\n        const chunkSize = 100;\n        for (let i = 0; i < draftIds.length; i += chunkSize) {\n          const chunk = draftIds.slice(i, i + chunkSize);\n\n          await withNotification(\n            'Convert drafts',\n            async () => {\n              const result = await near.api.convertDrafts(chunk);\n              return result;\n            },\n          );\n        }\n        enqueueSnackbar(`Converted drafts for draft group ${draftGroupId}`, { variant: 'success' });\n        const currentContractName = location.pathname.split('/')[1];\n        navigate(`/${currentContractName}/admin/lockups`);\n        window.location.reload();\n      } catch (e) {\n        console.log(`ERROR: ${e}`);\n      } finally {\n        setInProgress(false);\n      }\n    };\n\n    convertDrafts();\n  };\n\n  if (!draftGroup) {\n    return null;\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"draft-group-preview-wrapper\">\n        <h5>\n          {`Draft group ${draftGroupId}`}\n        </h5>\n        <TokenAmountPreview token={token} amount={convertAmount(draftGroup.total_amount, token.decimals)} />\n\n        {!draftGroup.funded && (\n          <div style={{ marginTop: 20 }}>\n            {near?.currentUser?.isAdmin && <FundButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} /> }\n            <FundWithDaoButton draftGroupIndex={draftGroupId} amount={draftGroup.total_amount} />\n          </div>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length > 0 && (\n          <LoadingButton\n            className=\"button fullWidth\"\n            type=\"button\"\n            onClick={handleConvert}\n            loading={inProgress}\n            variant=\"contained\"\n            color=\"success\"\n          >\n            Convert\n          </LoadingButton>\n        )}\n        {draftGroup.funded && draftGroup.draft_indices.length === 0 && (\n          <div style={{ marginTop: 20 }}>\n            <Alert severity=\"success\">Draft Group converted</Alert>\n          </div>\n        )}\n      </div>\n\n      {(!draftGroup.funded || draftGroup.draft_indices.length > 0) && (\n        <DraftsTable lockups={drafts} token={token} />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState, useContext } from 'react';\nimport {\n  Table,\n  TableCell,\n  TableHead,\n  TableBody,\n  TableRow,\n} from '@mui/material';\nimport { Link, useLocation } from 'react-router-dom';\n\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\nimport TokenIcon from '../../components/TokenIcon';\n\nexport default function PageDraftGroupsIndex({ token }: { token: TMetadata }) {\n  const location = useLocation();\n  console.log(location);\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [draftGroups, setDraftGroups] = useState<any[]>([]);\n  // const [drafts, setDrafts] = useState<any[]>([]);\n\n  // console.log(token);\n  // console.log(draftGroup);\n  // console.log(setDraftGroup);\n\n  useEffect(() => {\n    const fetchDraftGroups = async () => {\n      setDraftGroups([]);\n      console.log('fetchDraftGroup called');\n      if (!near) {\n        return;\n      }\n      const result = await near.api.getDraftGroupsAll();\n      console.log(result);\n      setDraftGroups(result);\n    };\n\n    fetchDraftGroups(); // .catch(console.error);\n  }, [near]);\n\n  // useEffect(() => {\n  //   const fetchDrafts = async () => {\n  //     setDrafts([]);\n  //     console.log('fetchDrafts called');\n  //     if (!near) {\n  //       return;\n  //     }\n  //     if (!draftGroup) {\n  //       return;\n  //     }\n  //     const result = await near.api.getDrafts(draftGroup.draft_indices);\n  //     console.log(result);\n  //     setDrafts(result.map((x: any) => x[1].lockup));\n  //   };\n\n  //   fetchDrafts(); // .catch(console.error);\n  // }, [near, draftGroup]);\n\n  // if (!draftGroup) {\n  //   return null;\n  // }\n\n  const currentContractName = location.pathname.split('/')[1];\n  const importDraftGroupPath = `/${currentContractName}/admin/import_draft_group`;\n\n  return (\n    <div className=\"container\">\n      <h1>\n        All draft groups\n      </h1>\n\n      <Table className=\"main-table\" aria-label=\"collapsible table\">\n        <TableHead className=\"table-head\">\n          <TableRow>\n            <TableCell align=\"left\">ID</TableCell>\n            <TableCell align=\"center\">Funded</TableCell>\n            <TableCell align=\"right\">Number&nbsp;of&nbsp;lockups</TableCell>\n            <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {draftGroups.map((group) => (\n            <TableRow>\n              <TableCell align=\"left\">\n                <Link to={`/${currentContractName}/draft_groups/${group.id}`}>{group.id}</Link>\n              </TableCell>\n              <TableCell align=\"center\">{group.funded ? 'Yes' : 'No'}</TableCell>\n              <TableCell align=\"right\">{group.draft_indices.length}</TableCell>\n              <TableCell align=\"right\">\n                {convertAmount(group.total_amount, token.decimals)}\n                &nbsp;\n                {token.symbol}\n                &nbsp;\n                <TokenIcon url={token.icon || ''} size={32} />\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n\n      <br />\n\n      <Link to={importDraftGroupPath}>\n        <button className=\"button\" type=\"button\">Import Draft Group</button>\n      </Link>\n    </div>\n  );\n}\n","import { useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Box } from '@mui/material';\nimport { useSnackbar } from 'notistack';\n\nimport { FACTORY_CONTRACT_NAME } from '../../config';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function NewLockupContract() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near, signIn }: { near: INearProps | null, signIn: () => void } = useContext(NearContext);\n\n  const handleDeployLockupContract = (e: any) => {\n    e.preventDefault();\n\n    const perform = async () => {\n      try {\n        if (!near?.currentUser?.signedAccountId) {\n          throw new Error('expected signedAccountId to be present');\n        }\n\n        // const lockupCreator: string = near.signedAccountId;\n        const lockupOperators: string[] = e.target.elements.lockup_operators.value\n          .split(',').map((x: string) => x.trim()).filter((x: string) => x.length > 0);\n        const tokenAccountId: string = e.target.elements.token_account_id.value;\n        const lockupSubaccountId: string = e.target.elements.lockup_subaccount_id.value;\n\n        if (lockupOperators.length === 0) {\n          throw new Error('empty lockup operators');\n        }\n\n        if (tokenAccountId.length === 0) {\n          throw new Error('empty tokenAccountId');\n        }\n\n        if (lockupSubaccountId.length === 0) {\n          throw new Error('empty lockupSubaccountId');\n        }\n\n        // const message = `\n        //   lockup_creator: ${lockupCreator}\n        //   lockup_operators: ${JSON.stringify(lockupOperators)}\n        //   token_account_id: ${tokenAccountId}\n        //   lockup_subaccount_id: ${lockupSubaccountId}\n        // `;\n        // alert(message);\n\n        const result = await near.factoryApi.create(\n          lockupSubaccountId,\n          tokenAccountId,\n          lockupOperators,\n          `${window.location.origin + window.location.pathname}#/${lockupSubaccountId}.${FACTORY_CONTRACT_NAME}/admin/lockups`,\n        );\n\n        console.log(result);\n\n        return result;\n      } catch (error) {\n        console.log(error);\n        enqueueSnackbar((error as any).toString(), { variant: 'error' });\n        return null;\n      }\n    };\n\n    perform();\n  };\n\n  if (!(near)) {\n    return null;\n  }\n\n  return (\n    <div>\n      <div className=\"header\">\n        <div className=\"container\">\n          <Box sx={{ display: 'flex' }}>\n            <div className=\"nav\">\n              <Link className=\"nav-link\" to=\"/\">Home</Link>\n            </div>\n          </Box>\n        </div>\n      </div>\n\n      <div className=\"container new-lockup-contract\">\n        <h1>\n          Create Lockup Contract for your Fungible Tokens\n        </h1>\n\n        <form className=\"form-submit\" onSubmit={handleDeployLockupContract}>\n          <div className=\"form-wrapper\">\n\n            <div className=\"form-row\">\n              <span>Contract creator: </span>\n              <strong>{near.currentUser.signedAccountId}</strong>\n              {' '}\n              <button className=\"button\" type=\"button\" onClick={signIn}>\n                {near.currentUser.signedAccountId && 'Login as someone else' || 'Login'}\n              </button>\n            </div>\n            <div className=\"form-row\">\n              <span>Lockup operators: </span>\n              <input type=\"text\" id=\"lockup_operators\" />\n            </div>\n            <div className=\"form-row\">\n              <span>Fungible token contract address: </span>\n              <input type=\"text\" id=\"token_account_id\" />\n            </div>\n            <div className=\"form-row\">\n              <span>New Lockup Contract Address: </span>\n              <input type=\"text\" id=\"lockup_subaccount_id\" />\n            </div>\n\n            <button className=\"button middle\" type=\"submit\" disabled={!near.currentUser.signedAccountId}>\n              Deploy Contract\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  InputAdornment,\n  MenuItem,\n  Select,\n  TextField,\n} from '@mui/material';\nimport BN from 'bn.js';\nimport Big from 'big.js';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { INearProps, NearContext } from '../../services/near';\nimport { addYear } from '../../utils';\nimport { TMetadata } from '../../services/tokenApi';\nimport { TSchedule } from '../../services/api';\n\nexport default function CreateLockup({ token } : { token: TMetadata }) {\n  const {\n    near,\n  }: {\n    near: INearProps | null,\n  } = useContext(NearContext);\n\n  const [open, setOpen] = useState(false);\n  const [startDate, setStartDate] = useState<Date | null>(null);\n  const [schedule, setSchedule] = useState<string>('4_year');\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  const onScheduleSelect = (value: any) => {\n    setSchedule(value.target.value);\n  };\n\n  const handleCreateLockup = async (e: any) => {\n    if (!near) {\n      throw Error('Cannot access token api');\n    }\n    if (!near.currentUser.signedAccountId) {\n      throw new Error('signedAccountId requred to set lockup terminator');\n    }\n    if (!startDate) {\n      throw Error('Start date not set');\n    }\n\n    e.preventDefault();\n\n    const { account, amount } = e.target.elements;\n\n    console.log(account.value, amount.value);\n\n    const lockupContractId = near?.api.getContract().contractId || '';\n    const userAccountId = account.value;\n    const lockupTotalAmount = new Big(amount.value).mul(new Big(10).pow(token.decimals))\n      .round(0, Big.roundDown).toString();\n\n    const getScheduleList = (date: Date, balanceInput: string, selected: string): [TSchedule, TSchedule | null] => {\n      const balance = new BN(balanceInput);\n\n      const schedules: { [key: string]: TSchedule } = {\n        '4y_cliff_1y_25': [\n          { timestamp: addYear(date, 0), balance: '0' },\n          { timestamp: addYear(date, 1) - 1, balance: '0' },\n          { timestamp: addYear(date, 1), balance: balance.divn(4).toString() },\n          { timestamp: addYear(date, 4), balance: balance.toString() },\n        ],\n      };\n\n      const schedulePairs: { [key: string]: [TSchedule, TSchedule | null] } = {\n        '4_year': [schedules['4y_cliff_1y_25'], null],\n        '4_year_vested': [schedules['4y_cliff_1y_25'], schedules['4y_cliff_1y_25']],\n      };\n\n      return schedulePairs[selected];\n    };\n\n    const [lockupSchedule, vestingSchedule] = getScheduleList(startDate, lockupTotalAmount, schedule);\n\n    near.tokenApi.createLockup(\n      lockupContractId,\n      lockupTotalAmount.toString(),\n      userAccountId,\n      lockupSchedule,\n      vestingSchedule,\n    );\n  };\n\n  return (\n    <div>\n      <button className=\"button\" type=\"button\" onClick={handleOpen}>Create Lockup</button>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\" onSubmit={handleCreateLockup}>\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <TextField\n              margin=\"normal\"\n              id=\"account\"\n              label=\"Account Id\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n            />\n            <TextField\n              margin=\"normal\"\n              id=\"amount\"\n              label=\"Amount\"\n              type=\"number\"\n              variant=\"standard\"\n              InputProps={{\n                endAdornment: <InputAdornment position=\"end\">{token.symbol}</InputAdornment>,\n              }}\n              fullWidth\n            />\n            <br />\n            <FormControl\n              fullWidth\n              sx={{ marginTop: '20px' }}\n            >\n              <Select\n                id=\"schedule-select\"\n                value={schedule}\n                label=\"Schedule\"\n                onChange={onScheduleSelect}\n                variant=\"standard\"\n                fullWidth\n              >\n                <MenuItem value=\"4_year\">4 year lockup with 25% cliff in 1 year</MenuItem>\n                <MenuItem value=\"4_year_vested\">4 year lockup with 25% cliff in 1 year (VESTED)</MenuItem>\n              </Select>\n            </FormControl>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Start date\"\n                value={startDate}\n                onChange={(newValue) => {\n                  setStartDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n          </DialogContent>\n          <DialogActions sx={{ padding: '14px 24px 24px' }}>\n            <button disabled={!startDate} className=\"button fullWidth noMargin\" type=\"submit\">Create</button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n","import { useContext, useState } from 'react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  TextField,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\nimport { TMetadata } from '../../services/tokenApi';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction TerminateLockup(\n  props: {\n    adminControls: boolean,\n    lockupIndex: number | undefined,\n    config: { beneficiary_id: String, vesting_schedule: [] | null } | null,\n    token: TMetadata,\n  },\n) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const {\n    adminControls,\n    lockupIndex,\n    config,\n    token,\n  } = props;\n\n  const { enqueueSnackbar } = useSnackbar();\n  const [open, setOpen] = useState(false);\n  const [date, setDate] = useState<Date | null>(null);\n  const handleOpen = () => setOpen(true);\n  const handleClose = () => setOpen(false);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (lockupIndex === undefined) {\n    throw Error('Cannot terminate lockup without lockupIndex');\n  }\n\n  const handleTerminateLockup = async () => {\n    if (!enqueueSnackbar) return;\n\n    const ts = date ? date.getTime() / 1000 : null;\n    const result = await near.api.terminate(lockupIndex, ts);\n    const amount = new Big(result as any).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n    console.log(amount);\n    const message = `Terminated lockup #${lockupIndex}, refunded ${amount} ${token.symbol}`;\n    enqueueSnackbar(message, { variant: 'success' });\n    setTimeout(() => window.location.reload(), 1000);\n  };\n\n  let message;\n  let payerMessage;\n  if (!config) {\n    message = 'No termination config';\n    payerMessage = 'This lockup cannot be terminated';\n  } else {\n    message = 'Terminate';\n    payerMessage = `Unvested amount will return to ${config.beneficiary_id}`;\n  }\n\n  const canTerminate = adminControls && config;\n\n  return (\n    <div>\n      <button\n        className=\"button red fullWidth\"\n        disabled={!canTerminate}\n        type=\"button\"\n        onClick={handleOpen}\n      >\n        {message}\n      </button>\n      <span className=\"fine-print\">\n        {payerMessage}\n      </span>\n      <Dialog open={open} sx={{ padding: 2 }} maxWidth=\"xs\" onClose={handleClose}>\n        <form className=\"form-submit\">\n          <DialogTitle>\n            Create Lockup\n            <IconButton\n              aria-label=\"close\"\n              onClick={handleClose}\n              sx={{\n                position: 'absolute',\n                right: 8,\n                top: 8,\n              }}\n            >\n              <CloseRoundedIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent sx={{ maxWidth: '320px' }}>\n            <LocalizationProvider dateAdapter={AdapterDateFns}>\n              <DatePicker\n                label=\"Custom termination date\"\n                minDate={new Date()}\n                value={date}\n                onChange={(newValue) => {\n                  setDate(newValue);\n                }}\n                renderInput={\n                  (params) => (\n                    <TextField\n                      sx={{ margin: '20px 0 40px' }}\n                      margin=\"normal\"\n                      fullWidth\n                      variant=\"standard\"\n                      {...params}\n                    />\n                  )\n                }\n              />\n            </LocalizationProvider>\n            <button className=\"button red fullWidth\" type=\"button\" onClick={handleTerminateLockup}>\n              Terminate\n            </button>\n          </DialogContent>\n        </form>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default TerminateLockup;\n","import { useContext, useState } from 'react';\nimport {\n  Collapse,\n  IconButton,\n  TableCell,\n  TableRow,\n} from '@mui/material';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { Link } from 'react-router-dom';\nimport { convertAmount, convertTimestamp } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TerminateLockup from '../TerminateLockup';\nimport TokenIcon from '../TokenIcon';\nimport ScheduleTable from '../ScheduleTable';\n\nexport default function Row(props: { adminControls: boolean, row: ReturnType<any>, token: TMetadata }) {\n  const [open, setOpen] = useState(false);\n  const { adminControls, row, token } = props;\n  const {\n    near,\n  }: {\n    near: INearProps | null\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const vestingSchedule = row?.termination_config?.vesting_schedule?.Schedule;\n\n  const selectedAccountPage = window.location.href.split('/').pop() === row.account_id;\n\n  return (\n    <>\n      <TableRow className={open ? 'expanded exp-row' : 'exp-row'} sx={{ '& > *': { borderBottom: 'unset' } }}>\n        <TableCell>\n          <IconButton\n            aria-label=\"expand row\"\n            size=\"small\"\n            onClick={() => setOpen(!open)}\n          >\n            {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\n          </IconButton>\n        </TableCell>\n        <TableCell align=\"left\">\n          {row.id}\n        </TableCell>\n        <TableCell align=\"left\"><Link to={`${selectedAccountPage ? '' : row.account_id}`}>{row.account_id}</Link></TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[0].timestamp)}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertTimestamp(row.schedule[row.schedule.length - 1].timestamp)}\n        </TableCell>\n        <TableCell align=\"center\">\n          {vestingSchedule ? 'Yes' : 'No'}\n        </TableCell>\n        <TableCell align=\"right\">\n          {convertAmount(row.total_balance, token.decimals)}\n          &nbsp;\n          {token.symbol}\n          &nbsp;\n          <TokenIcon url={token.icon || ''} size={32} />\n        </TableCell>\n        <TableCell align=\"center\">\n          <div className=\"progress-bar\">\n            <div style={{ width: `${(row.claimed_balance / row.total_balance) * 100}%` }} className=\"claimed\">\n              <span>{convertAmount(row.claimed_balance, token.decimals)}</span>\n            </div>\n            <div style={{ width: `${(row.unclaimed_balance / row.total_balance) * 100}%` }} className=\"available\">\n              <span>\n                {convertAmount(row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${((row.total_balance - row.claimed_balance - row.unclaimed_balance) / row.total_balance) * 100}%` }} className=\"vested\">\n              <span>\n                {((row.total_balance - row.claimed_balance - row.unclaimed_balance)\n                  / row.total_balance) > 0.2 && convertAmount(row.total_balance\n                  - row.claimed_balance - row.unclaimed_balance, token.decimals)}\n              </span>\n            </div>\n            <div style={{ width: `${(row.total_balance - row.total_balance) * 100}%` }} className=\"unvested\">&nbsp;</div>\n          </div>\n        </TableCell>\n      </TableRow>\n      <TableRow sx={{ background: '#F4FAFF' }}>\n        <TableCell style={{ padding: 0 }} colSpan={8}>\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\n            <div className=\"lockup-row\">\n              <div style={{ display: 'flex', gap: 20 }}>\n                <ScheduleTable schedule={row.schedule} title=\"Lockup schedule\" token={token} />\n                {vestingSchedule && (\n                  <ScheduleTable schedule={vestingSchedule} title=\"Vesting schedule\" token={token} />\n                )}\n                <div className=\"terminate\">\n                  <TerminateLockup token={token} adminControls={adminControls} lockupIndex={row.id} config={row.termination_config} />\n                </div>\n              </div>\n            </div>\n          </Collapse>\n        </TableCell>\n      </TableRow>\n    </>\n  );\n}\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../table/row';\nimport { TMetadata } from '../../services/tokenApi';\n\nexport default function LockupsTable(\n  { lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean },\n) {\n  return (\n    <Table className=\"main-table\" aria-label=\"collapsible table\">\n      <TableHead className=\"table-head\">\n        <TableRow>\n          <TableCell />\n          <TableCell align=\"left\">ID</TableCell>\n          <TableCell align=\"left\">Account ID</TableCell>\n          <TableCell align=\"right\">Start&nbsp;date</TableCell>\n          <TableCell align=\"right\">End&nbsp;date</TableCell>\n          <TableCell align=\"center\">Terminatable</TableCell>\n          <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n          <TableCell align=\"center\">Progress</TableCell>\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {lockups.map((lockup) => (\n          <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n        ))}\n      </TableBody>\n    </Table>\n  );\n}\n","import {\n  TextField,\n} from '@mui/material';\n\nimport { useRef } from 'react';\n\nexport default function FavouriteAccounts({ favouriteAccounts, uniqueUsers, onSave }: { favouriteAccounts:string[], uniqueUsers: string[], onSave: Function }) {\n  console.log('unique users', uniqueUsers);\n\n  const inputRef = useRef<null | HTMLInputElement>(null);\n\n  const handleSaveFavouriteAccounts = (): void => {\n    if (!inputRef?.current?.value) {\n      localStorage.setItem('favouriteAccounts', '[]');\n      onSave([]);\n      return;\n    }\n\n    const newFavouriteAccounts = inputRef.current.value.replaceAll(' ', '').split(',');\n    onSave(newFavouriteAccounts);\n    localStorage.setItem('favouriteAccounts', JSON.stringify(newFavouriteAccounts));\n  };\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <TextField\n        sx={{ marginBottom: 3, width: 1, paddingRight: 2 }}\n        id=\"outlined-helperText\"\n        label=\"Favourite accounts\"\n        defaultValue={favouriteAccounts.join(', ')}\n        inputRef={inputRef}\n        onKeyPress={(e) => e.key === 'Enter' && handleSaveFavouriteAccounts()}\n      />\n      <button className=\"button noMargin\" type=\"button\" onClick={handleSaveFavouriteAccounts}>save</button>\n    </div>\n  );\n}\n","import {\n  Paper,\n  TableContainer,\n} from '@mui/material';\nimport { useContext, useState } from 'react';\n\nimport { Link } from 'react-router-dom';\n\nimport CreateLockup from '../../components/CreateLockup';\nimport LockupsTable from '../../components/LockupsTable';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport FavouriteAccounts from '../../components/FavouriteAccounts';\n\nexport default function Lockups({ lockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const uniqueUsers = Array.from(new Set(lockups.map((x) => x.account_id)));\n\n  const {\n    near,\n  }: {\n    near: INearProps,\n  } = useContext(NearContext);\n\n  const { signedIn, isAdmin } = near.currentUser;\n  const favouriteAccountsFromLocalStorage = JSON.parse(localStorage.getItem('favouriteAccounts') || '[]');\n\n  const [favouriteAccounts, setFavouriteAccounts] = useState<string[]>(favouriteAccountsFromLocalStorage);\n\n  const favouriteAccountsLockups = lockups.filter((lockup) => favouriteAccounts.includes(lockup.account_id));\n\n  const restOfThePage = (\n    <div>\n      {signedIn && adminControls && isAdmin && <CreateLockup token={token} />}\n\n      {lockups.length === 0 ? (\n        <div>\n          There are no lockups yet.\n          {adminControls && (\n            <div>\n              Create single lockup or create batch of them via\n              {' '}\n              <Link to={`/${near.lockupContractId}/admin/draft_groups`}>Draft Groups</Link>\n              .\n            </div>\n          )}\n        </div>\n      ) : (\n        <TableContainer sx={{ boxShadow: 'unset', margin: '0 0 20px' }} component={Paper}>\n          <LockupsTable lockups={favouriteAccountsLockups} token={token} adminControls={adminControls} />\n        </TableContainer>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"container\">\n      <FavouriteAccounts favouriteAccounts={favouriteAccounts} uniqueUsers={uniqueUsers} onSave={setFavouriteAccounts} />\n      { !!favouriteAccounts.length && restOfThePage }\n    </div>\n  );\n}\n","import {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  IconButton,\n  Button,\n} from '@mui/material';\nimport CloseRoundedIcon from '@mui/icons-material/CloseRounded';\n\nexport default function ConfirmDialog(props: { message: string, isOpen: boolean, closeFn: any, callback: any }) {\n  const {\n    message,\n    isOpen,\n    closeFn,\n    callback,\n  } = props;\n\n  const handleConfirm = () => {\n    closeFn();\n    callback();\n  };\n\n  return (\n    <Dialog open={isOpen} sx={{ padding: 2 }} maxWidth=\"md\" onClose={closeFn}>\n      <DialogTitle>\n        Confirmation\n        <IconButton\n          aria-label=\"close\"\n          sx={{\n            position: 'absolute',\n            right: 8,\n            top: 8,\n          }}\n          onClick={closeFn}\n        >\n          <CloseRoundedIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent sx={{ minWidth: '320px' }}>\n        <div>{message}</div>\n      </DialogContent>\n      <DialogActions>\n        <Button color=\"error\" onClick={closeFn}>Cancel</Button>\n        <Button color=\"success\" variant=\"contained\" onClick={handleConfirm}>Confirm</Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { useContext, useState } from 'react';\n\nimport ConfirmDialog from '../ConfirmDialog';\nimport { INearProps, NearContext } from '../../services/near';\nimport { TMetadata } from '../../services/tokenApi';\nimport TokenAmountPreview from '../TokenAmountPreview';\n\nfunction ClaimAllLockups(params: { accountId: string | undefined, token: TMetadata, total: String }) {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const { accountId, token, total } = params;\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [dialogConfirmCallback, setDialogConfirmCallback] = useState<any>(() => null);\n  const closeDialog = () => setIsDialogOpen(false);\n  const openDialog = () => setIsDialogOpen(true);\n\n  if (!near) {\n    throw Error('Cannot access lockup api');\n  }\n\n  if (!accountId) {\n    throw Error('Undefined account cannot claim');\n  }\n\n  const handleClaimAllLockups = () => {\n    const perform = async () => {\n      if (!near) return;\n      if (!near.tokenApi) return;\n      if (!near.noLoginTokenApi) return;\n      if (!near.tokenContractId) return;\n\n      const storageBalance = await near.tokenApi.storageBalanceOf(accountId);\n      const isStoragePaid = (storageBalance !== null) && true;\n      if (isStoragePaid) {\n        near.noLoginApi.claim(accountId);\n      } else {\n        const bounds = await near.tokenApi.storageBalanceBounds();\n        const amount = bounds.max;\n\n        const callback = () => {\n          near.noLoginTokenApi.storageDeposit(near.tokenContractId, accountId, amount);\n        };\n        setDialogConfirmCallback(() => callback);\n        openDialog();\n      }\n    };\n\n    perform();\n  };\n\n  const depositConfirmMessage = `\n    Your account doesn't have storage deposit on the token contract. You will be redirected to pay for the storage, after that you will be able to claim your tokens.\n  `.trim();\n\n  return (\n    <div className=\"claim-wrapper\">\n      <h5>Total available</h5>\n      <TokenAmountPreview token={token} amount={total} />\n      <button className=\"button fullWidth\" type=\"button\" onClick={handleClaimAllLockups}>Claim All</button>\n      <ConfirmDialog message={depositConfirmMessage} isOpen={isDialogOpen} closeFn={closeDialog} callback={dialogConfirmCallback} />\n    </div>\n  );\n}\n\nexport default ClaimAllLockups;\n","import { useParams } from 'react-router-dom';\nimport {\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n} from '@mui/material';\nimport Row from '../../components/table/row';\nimport ClaimAllLockups from '../../components/Claim';\nimport { TMetadata } from '../../services/tokenApi';\nimport { convertAmount } from '../../utils';\n\nexport default function UserLockups({ lockups: allLockups, token, adminControls }: { lockups: any[], token: TMetadata, adminControls: boolean }) {\n  const { userId } = useParams();\n\n  const lockups = allLockups.filter((x) => x.account_id === userId);\n\n  const totalUnclaimedBalance = lockups.reduce((acc, obj) => acc + parseFloat(obj.unclaimed_balance), 0);\n\n  console.log('user lockups', userId, lockups);\n\n  return (\n    <div className=\"container\">\n\n      {!adminControls && <ClaimAllLockups accountId={userId} token={token} total={convertAmount(totalUnclaimedBalance, token.decimals)} />}\n\n      <TableContainer sx={{ boxShadow: 'unset' }} component={Paper}>\n        <Table className=\"main-table\" aria-label=\"collapsible table\">\n          <TableHead className=\"table-head\">\n            <TableRow>\n              <TableCell />\n              <TableCell align=\"left\">ID</TableCell>\n              <TableCell align=\"left\">Account ID</TableCell>\n              <TableCell align=\"right\">Start&nbsp;date</TableCell>\n              <TableCell align=\"right\">End&nbsp;date</TableCell>\n              <TableCell align=\"right\">Terminatable</TableCell>\n              <TableCell align=\"right\">Total&nbsp;amount</TableCell>\n              <TableCell align=\"center\">Progress</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {lockups.map((lockup) => (\n              <Row key={lockup.id} row={lockup} token={token} adminControls={adminControls} />\n            ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n    </div>\n  );\n}\n","import { Link, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { Box } from '@mui/material';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function Header({ adminControls }: { adminControls: boolean }) {\n  const location = useLocation();\n  const currentContractName = location.pathname.split('/')[1];\n\n  const {\n    near, signOut,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const {\n    signedIn,\n    signedAccountId,\n    isAdmin,\n    isCouncilMember,\n  } = near.currentUser;\n\n  const lockupsPageViewPolicy = adminControls && (isAdmin || isCouncilMember);\n\n  return (\n    <div className=\"header\">\n      <div className=\"container\">\n        <Box sx={{ display: 'flex' }}>\n          <div className=\"nav\">\n            <Link className=\"nav-link\" to={lockupsPageViewPolicy ? `/${currentContractName}/admin/lockups` : `/${currentContractName}/lockups`}>Lockups</Link>\n            <Link className=\"nav-link\" to={adminControls ? `/${currentContractName}/admin/about` : `/${currentContractName}/about`}>About</Link>\n            {adminControls && (<Link className=\"nav-link\" to={`/${currentContractName}/admin/draft_groups`}>Drafts</Link>)}\n          </div>\n          {adminControls && signedIn && (\n            <Box sx={{ marginTop: '23px' }}>\n              <span>\n                {signedAccountId}\n                {' '}\n              </span>\n              <button className=\"button\" type=\"button\" onClick={signOut}>Log out</button>\n            </Box>\n          )}\n        </Box>\n      </div>\n    </div>\n  );\n}\n","import { Alert } from '@mui/material';\nimport { ReactNode, useContext } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { INearProps, NearContext } from '../../services/near';\n\nfunction Auth({ children }: { children: ReactNode }) {\n  return <div className=\"container login\">{children}</div>;\n}\n\nfunction Authorize() {\n  const {\n    near, signIn,\n  }: {\n    near: INearProps | null, signIn: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin, isCouncilMember } = near.currentUser;\n\n  const showAlertForUser = signedIn && !(isAdmin || isCouncilMember);\n  const showLockups = signedIn && (isAdmin || isCouncilMember);\n\n  return (\n    <Auth>\n      { showAlertForUser && <Alert sx={{ margin: 2, width: '500px' }} severity=\"error\">You are not admin</Alert>}\n      { !signedIn && <button className=\"button\" type=\"button\" onClick={signIn}>Sign In</button> }\n      { showLockups && <Navigate to=\"lockups\" replace />}\n    </Auth>\n  );\n}\nexport default Authorize;\n","import { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\n\nexport default function PayForContractStorage() {\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n\n  const handlePay = () => {\n    const perform = async () => {\n      if (!near) {\n        return;\n      }\n      if (!near.tokenApi) {\n        return;\n      }\n      const bounds = await near.tokenApi.storageBalanceBounds();\n      const amount = bounds.max;\n\n      console.log(amount);\n      const result = await near.tokenApi.storageDeposit(near.lockupContractId, amount);\n      console.log(result);\n    };\n    perform();\n  };\n\n  return (\n    <div>\n      <div style={{ maxWidth: 640, margin: 'auto', paddingTop: 20 }}>\n        <p>\n          Please pay for the account storage in fungible token contract.\n          This is necessary to allow lockup contract to hold locked fungible token funds.\n          This is a one time payment for the lockup contract.\n          Additionally, all users claiming lockups will have to pay for the\n          storage for their account too.\n        </p>\n\n        <button className=\"button fullWidth\" type=\"button\" onClick={handlePay}>\n          Pay\n        </button>\n      </div>\n    </div>\n  );\n}\n","import { Navigate, useLocation } from 'react-router-dom';\nimport { useContext } from 'react';\nimport { INearProps, NearContext } from '../../services/near';\nimport PayForContractStorage from '../PayForContractStorage';\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const location = useLocation();\n  const {\n    near,\n  }: {\n    near: INearProps | null, signIn: () => void, signOut: () => void,\n  } = useContext(NearContext);\n\n  if (!near) return null;\n\n  const { signedIn, isAdmin, isCouncilMember } = near.currentUser;\n\n  const currentContractName = location.pathname.split('/')[1];\n\n  if (!signedIn || !(isAdmin || isCouncilMember)) {\n    return <Navigate to={`/${currentContractName}/admin`} replace />;\n  }\n\n  if (!near.isContractFtStoragePaid) {\n    return (\n      <div className=\"container\">\n        <PayForContractStorage />\n      </div>\n    );\n  }\n\n  return children;\n}\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgNear(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 25,\n    height: 24,\n    viewBox: \"0 0 25 24\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20.0333 1.22667L14.8169 8.66669C14.4561 9.17333 15.1498 9.78667 15.6492 9.36L20.7824 5.06669C20.9212 4.95998 21.1154 5.04 21.1154 5.22667V18.64C21.1154 18.8267 20.8657 18.9067 20.7547 18.7733L5.2164 0.906667C4.71698 0.32 3.99556 0 3.1909 0H2.63596C1.19312 0 0 1.14667 0 2.56V21.44C0 22.8533 1.19312 24 2.6637 24C3.57936 24 4.43951 23.5467 4.93895 22.7733L10.1554 15.3333C10.5161 14.8267 9.82243 14.2133 9.32298 14.64L4.18979 18.9067C4.05105 19.0133 3.85682 18.9333 3.85682 18.7467V5.36002C3.85682 5.17334 4.10654 5.09333 4.21753 5.22667L19.7558 23.0933C20.2553 23.68 21.0044 24 21.7813 24H22.3363C23.8069 24 25 22.8533 25 21.44V2.56C24.9722 1.14667 23.7791 0 22.3085 0C21.3929 0 20.5327 0.453333 20.0333 1.22667Z\",\n    fill: \"#00B988\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgNear);\nexport default __webpack_public_path__ + \"static/media/near.f8591cc9.svg\";\nexport { ForwardRef as ReactComponent };","import { TextField } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport ArrowForwardRoundedIcon from '@mui/icons-material/ArrowForwardRounded';\nimport { ChangeEvent, useState } from 'react';\nimport { ReactComponent as Logo } from '../../assets/images/near.svg';\nimport { DEFAULT_CONTRACT_NAME } from '../../config';\n\nexport default function Homepage(\n  { lockups }: { lockups: any[] },\n) {\n  const [address, setAddress] = useState(DEFAULT_CONTRACT_NAME);\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setAddress(e.target.value);\n  };\n\n  const handleOpenLockupContract = () => {\n    const url = `${window.location.origin.toString()}#/${address}/lockups`;\n    window.location.assign(url);\n    window.location.reload();\n  };\n\n  return (\n    <div>\n      <div className=\"container home\">\n\n        <ul className=\"home-list\">\n          <li>\n            <span className=\"near-icon-bg\"><Logo /></span>\n            <div>\n              <span>Total contracts</span>\n              <b>256</b>\n            </div>\n          </li>\n          <li>\n            <span className=\"near-icon-bg\"><Logo /></span>\n            <div>\n              <span>Total locked</span>\n              <b>$5,336,000</b>\n            </div>\n          </li>\n          <li>\n            <span className=\"near-icon-bg\"><Logo /></span>\n            <div>\n              <span>Total lockups</span>\n              <b>{lockups?.length || 42}</b>\n            </div>\n          </li>\n        </ul>\n\n        <h2>The best DApp on NEAR to manage token vesting</h2>\n        <p>With our lockup contracts you can ....</p>\n\n        <Link to=\"/new_lockup_contract\" className=\"button large link-button\">Create new Lockup Contract</Link>\n\n      </div>\n      <div className=\"white-block\">\n        <div className=\"container home\">\n          <h2>If you already have a lockup contract, enter its address below</h2>\n          <TextField variant=\"outlined\" value={address} onChange={handleChange} className=\"input-large\" placeholder=\"Lockup contract address\" />\n          <button className=\"button link-button icon-button\" onClick={handleOpenLockupContract} aria-label=\"open\" type=\"button\" style={{ height: 56, width: 56 }}>\n            <ArrowForwardRoundedIcon />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport {\n  Routes, Route, HashRouter, Navigate,\n} from 'react-router-dom';\nimport { useSnackbar } from 'notistack';\nimport Big from 'big.js';\n\nimport { txLinkInExplorer, nearTo } from '../../utils';\nimport { INearProps, NearContext } from '../../services/near';\nimport About from '../../pages/About';\nimport ImportDraftGroup from '../ImportDraftGroup';\nimport PageDraftGroup from '../../pages/PageDraftGroup';\nimport PageDraftGroupsIndex from '../../pages/PageDraftGroupsIndex';\nimport NewLockupContract from '../../pages/NewLockupContract';\nimport Lockups from '../../pages/Lockups';\nimport UserLockups from '../../pages/UserLockups';\nimport Header from '../Header';\nimport Authorize from '../Authorize';\nimport RequireAuth from '../RequireAuth';\nimport { TMetadata } from '../../services/tokenApi';\nimport Homepage from '../Homepage';\n\nfunction Customer({\n  lockups, token, contractId, near,\n}: {\n  lockups: any, token: TMetadata, contractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  return (\n    <>\n      <Header adminControls={false} />\n      <Routes>\n        <Route path=\"/\" element={<Navigate replace to=\"lockups\" />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={contractId} />} />\n        <Route path=\"/lockups\" element={near && <Lockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/lockups/:userId\" element={<UserLockups lockups={lockups} token={token} adminControls={false} />} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nfunction Admin({\n  lockups, token, tokenContractId, near,\n}: {\n  lockups: any, token: TMetadata, tokenContractId: string | null, near: INearProps | null,\n}) {\n  if (!lockups) return null;\n\n  return (\n    <>\n      <Header adminControls />\n      <Routes>\n        <Route path=\"/\" element={<Authorize />} />\n        <Route path=\"/about\" element={<About lockups={lockups} token_account_id={tokenContractId} />} />\n        <Route path=\"/lockups\" element={near && <RequireAuth><Lockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/lockups/:userId\" element={<RequireAuth><UserLockups lockups={lockups} token={token} adminControls /></RequireAuth>} />\n        <Route path=\"/draft_groups\" element={<RequireAuth><PageDraftGroupsIndex token={token} /></RequireAuth>} />\n        <Route path=\"/draft_groups/:draftGroupId\" element={<RequireAuth><PageDraftGroup token={token} /></RequireAuth>} />\n        <Route path=\"/import_draft_group\" element={<RequireAuth><ImportDraftGroup token={token} /></RequireAuth>} />\n      </Routes>\n    </>\n  );\n}\n\nexport default function App() {\n  const { enqueueSnackbar } = useSnackbar();\n  const { near }: { near: INearProps | null } = useContext(NearContext);\n  const [contractState, setContractState] = useState({});\n  const [contractId, setContractId] = useState<string | null>(null);\n  const [token, setToken] = useState<TMetadata>({\n    decimals: 0,\n    icon: null,\n    name: '',\n    reference: null,\n    reference_hash: null,\n    spec: '',\n    symbol: '',\n  });\n\n  useEffect(() => {\n    if (!enqueueSnackbar) return;\n    if (!near) return;\n    if (!token) return;\n    if (token.spec === '') {\n      return;\n    }\n\n    const perform = async () => {\n      const searchParams = new URLSearchParams(window.location.search);\n      const transactionHashesRaw: string | null = searchParams.get('transactionHashes');\n      if (!transactionHashesRaw) {\n        return;\n      }\n      const txHash = transactionHashesRaw.split(',')[0];\n      console.log('txHash', txHash);\n      const txStatus = await near.rpcProvider.txStatus(txHash, 'sender.testnet');\n      console.log(txStatus);\n\n      const methodName = txStatus.transaction.actions[0].FunctionCall.method_name;\n\n      const successValue = (txStatus.status as any).SuccessValue;\n\n      const args = JSON.parse(atob(txStatus.transaction.actions[0].FunctionCall.args));\n\n      if (methodName === 'claim') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          if (unpacked !== '0') {\n            const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n            enqueueSnackbar(`Claimed ${amount} ${token.symbol}`, { variant: 'success' });\n            return;\n          }\n        }\n        enqueueSnackbar(`Claim failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      if (methodName === 'storage_deposit') {\n        const unpacked = JSON.parse(atob(successValue));\n        const amount = parseFloat(nearTo(unpacked.total, 9)).toString();\n        console.log(amount);\n        const accountId = args.account_id;\n        const message = `Successfully paid ${amount}N for FT storage of ${accountId}`;\n        enqueueSnackbar(message, { variant: 'success' });\n        return;\n      }\n\n      if (methodName === 'ft_transfer_call') {\n        const txMsg = JSON.parse(args.msg);\n        console.log(txMsg);\n        if (txMsg.schedule) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          const totalBalance = txMsg.schedule[txMsg.schedule.length - 1].balance;\n          if (totalBalance === unpacked) {\n            const statusMessage = `Created lockup for ${txMsg.account_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success' });\n            return;\n          }\n\n          const statusMessage = `Failed to create lockup for ${txMsg.account_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n        if (txMsg.draft_group_id !== null) {\n          const unpacked = JSON.parse(atob(successValue));\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          console.log(amount);\n          if (unpacked !== '0') {\n            const statusMessage = `Funded draft group ${txMsg.draft_group_id} with amount ${amount} ${token.symbol}`;\n            enqueueSnackbar(statusMessage, { variant: 'success' });\n            return;\n          }\n          const statusMessage = `Failed to fund draft group ${txMsg.draft_group_id}: ${txLinkInExplorer(txHash)}`;\n          enqueueSnackbar(statusMessage, { variant: 'error' });\n          return;\n        }\n\n        enqueueSnackbar(`Transaction performed, TODO ${txHash}!`, { variant: 'warning' });\n        return;\n      }\n\n      if (methodName === 'terminate') {\n        if (successValue) {\n          const unpacked = JSON.parse(atob(successValue));\n          console.log(unpacked);\n          const amount = new Big(unpacked).div(new Big(10).pow(token.decimals)).round(2, Big.roundDown);\n          const message = `Terminated lockup #${args.lockup_index}, unvested amount: ${amount}`;\n          enqueueSnackbar(message, { variant: 'success' });\n          return;\n        }\n        enqueueSnackbar(`Terminate lockup failed: ${txLinkInExplorer(txHash)}`, { variant: 'error' });\n        return;\n      }\n\n      const message = `UNHANDLED Transaction \"${methodName}\" : ${txLinkInExplorer(txHash)}`;\n      enqueueSnackbar(message, { variant: 'warning' });\n    };\n\n    perform();\n  }, [enqueueSnackbar, near, token]);\n\n  useEffect(() => {\n    let active = true;\n\n    if (near) {\n      const load = async () => {\n        const lockups = await near.api.loadAllLockups();\n        const metadata = await near.tokenApi.ftMetadata();\n        if (!active) {\n          return;\n        }\n        setToken(metadata);\n        setContractState({ lockups, name: 'name' });\n      };\n\n      if (near.tokenContractId) {\n        load();\n      }\n    }\n\n    return () => { active = false; };\n  }, [near]);\n\n  useEffect(() => {\n    if (near && near.tokenApi) {\n      setContractId(near.tokenApi.getContract().contractId);\n    }\n\n    return () => {};\n  }, [near]);\n\n  const { lockups }: any = contractState as any;\n\n  return (\n    <HashRouter>\n      <Routes>\n        <Route path=\"/\" element={<Homepage lockups={lockups} />} />\n        <Route path=\"/new_lockup_contract/\" element={<NewLockupContract />} />\n        <Route path=\"/:cid/*\" element={<Customer lockups={lockups} token={token} contractId={contractId} near={near} />} />\n        <Route path=\"/:cid/admin/*\" element={<Admin lockups={lockups} token={token} tokenContractId={contractId} near={near} />} />\n      </Routes>\n    </HashRouter>\n  );\n}\n","import {\n  StrictMode, useEffect, useMemo, useState,\n} from 'react';\nimport { SnackbarProvider, useSnackbar } from 'notistack';\nimport { IconButton } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\n\nimport App from './components/App';\nimport { NearContext, connectNear, INearProps } from './services/near';\n\nimport './index.css';\n\nfunction SnackbarCloseButton(props: { snackbarKey: any }) {\n  const { snackbarKey } = props;\n  const { closeSnackbar } = useSnackbar();\n\n  return (\n    <IconButton onClick={() => closeSnackbar(snackbarKey)}>\n      <CloseIcon style={{ color: 'white' }} />\n    </IconButton>\n  );\n}\n\n/* eslint react/no-unstable-nested-components: \"off\" */\n\nexport default function NearApp() {\n  const [near, setNear] = useState<INearProps | null>(null);\n\n  useEffect(() => {\n    async function connect() {\n      const nearConn: INearProps = await connectNear();\n      setNear(nearConn);\n    }\n\n    try {\n      connect();\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const value = useMemo(() => ({\n    near,\n    signIn: () => { near?.api?.signIn(); },\n    signOut: () => {\n      if (!near) return;\n\n      near.api.signOut();\n      setNear({\n        ...near,\n        currentUser: {\n          signedIn: false,\n          signedAccountId: null,\n          isAdmin: false,\n          isCouncilMember: false,\n        },\n      });\n    },\n  }), [near]);\n\n  const handleClose = () => {\n    const url = new URL(window.location.href);\n    const sp = new URLSearchParams(url.search);\n    sp.delete('transactionHashes');\n    url.search = sp.toString();\n    console.log(url);\n    window.history.pushState({}, null as any, url.toString());\n  };\n\n  return (\n    <StrictMode>\n      <NearContext.Provider value={value}>\n        <SnackbarProvider\n          autoHideDuration={null}\n          action={(snackbarKey) => <SnackbarCloseButton snackbarKey={snackbarKey} />}\n          onClose={handleClose}\n        >\n          <App />\n        </SnackbarProvider>\n      </NearContext.Provider>\n    </StrictMode>\n  );\n}\n","import { render } from 'react-dom';\n\nimport NearApp from './NearApp';\n\nrender(\n  <NearApp />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}